<?xml version="1.0" encoding="utf-8" ?>
<otrs_package version="1.1">
    <Name>RS4OTRS_API</Name>
    <Version>6.44.0</Version>
    <Vendor>Radiant System</Vendor>
    <URL>https://radiantsystem.com</URL>
    <License>GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007</License>
    <Description Lang="en">API for common functionality of ((OTRS)) Community Edition.</Description>
    <Description Lang="ru">API для общего функционала ((OTRS)) Community Edition.</Description>
    <Framework>6.x.x</Framework>
    <IntroInstall Lang="en" Title="Installation Information" Type="pre"><![CDATA[
<br/>
You are about to install "RS4OTRS_API" module.
    ]]></IntroInstall>
    <IntroInstall Lang="ru" Title="Информация по установке" Type="pre"><![CDATA[
<br/>
Вы собираетесь установить модуль "RS4OTRS_API"
    ]]></IntroInstall>
    <IntroInstall Lang="en" Title="Install information" Type="post"><![CDATA[
<br/>
Thank you for choosing the "RS4OTRS_API" module.<br/>
<br/>
Attention! Minimum requirements for mobile applications:<br/>
Radiant Mobile Agent v1.5 — for Android<br/>
Radiant Mobile Agent v1.5 — for iOS<br/>
<br/>
For install completion in the file zzz_otrs.conf inside section <Location /otrs> you should write:<br/>
<br/>
RewriteEngine on<br/>
RewriteRule "/api/(\w+)/(\w+)" "/otrs/json.pl?Action=$1&Subaction=$2" [QSA,L]<br/>
<br/>
and restart Apache.<br/>
<br/>
Most Apache installations have a conf.d directory included. On Linux systems you can usually find this directory under /etc/apache or /etc/apache2. Log in as root, change to the conf.d directory and link the appropriate template in /opt/otrs/scripts/apache2-httpd.include.conf to a file called zzz_otrs.conf in the Apache configuration directory (to make sure it is loaded after the other configurations). https://doc.radiantsd.com/doc/manual/admin/stable/en/html/manual-installation-of-otrs.html
    ]]></IntroInstall>
    <IntroInstall Lang="ru" Title="Информация по установке" Type="post"><![CDATA[
<br/>
Спасибо за Ваш выбор модуля RS4OTRS_API.<br/>
<br/>
Внимание! Минимальные требования для мобильных приложений:<br/>
Radiant Mobile Agent v1.5 — для Android<br/>
Radiant Mobile Agent v1.5 — для iOS<br/>
<br/>
Для завершения установки в файле zzz_otrs.conf в разделе <Location /otrs> необходимо прописать:<br/>
<br/>
RewriteEngine on<br/>
RewriteRule "/api/(\w+)/(\w+)" "/otrs/json.pl?Action=$1&Subaction=$2" [QSA,L]<br/>
<br/>
и выполнить перезапуск (restart) Apache.<br/>
<br/>
В большинстве случаев при установке Apache есть каталог conf.d. В системах Linux можно найти этот каталог в /etc/apache или /etc/apache2. Войдите в систему с правами root, перейдите в каталог conf.d и свяжите соответствующий шаблон в /opt/otrs/scripts/apache2-httpd.include.conf с файлом zzz_otrs.conf в каталоге конфигурации Apache (чтобы убедиться, что он загружается после других конфигураций). https://doc.radiantsd.com/doc/manual/admin/stable/en/html/manual-installation-of-otrs.html
    ]]></IntroInstall>
    <BuildDate>2022-01-31 14:04:25</BuildDate>
    <BuildHost>localhost</BuildHost>
    <CodeInstall Type="post"><![CDATA[
my $CodeModule = 'var::packagesetup::' . $Param{Structure}{Name}{Content};

$Kernel::OM->Get($CodeModule)->CodeInstall();
    ]]></CodeInstall>

    <CodeUninstall Type="pre"><![CDATA[
my $CodeModule = 'var::packagesetup::' . $Param{Structure}{Name}{Content};

$Kernel::OM->Get($CodeModule)->CodeUninstall();
    ]]></CodeUninstall>

    <CodeReinstall Type="pre"><![CDATA[
my $CodeModule = 'var::packagesetup::' . $Param{Structure}{Name}{Content};

$Kernel::OM->Get($CodeModule)->CodeReinstall();
    ]]></CodeReinstall>

    <CodeUpgrade Type="pre"><![CDATA[
my $CodeModule = 'var::packagesetup::' . $Param{Structure}{Name}{Content};

$Kernel::OM->Get($CodeModule)->CodeUpgrade();
    ]]></CodeUpgrade>

    <Filelist>

        <File Location="Custom/Kernel/Modules/API/Queues.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6Ok1vZHVsZXM6OkFQSTo6UXVldWVzOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwpubyB3YXJuaW5ncyAncmVkZWZpbmUnOwoKdXNlIERhdGE6OkR1bXBlcjsKCm91ciAkT2JqZWN0TWFuYWdlckRpc2FibGVkID0gMTsKCnN1YiBuZXcgewogICAgbXkgKCAkVHlwZSwgJVBhcmFtICkgPSBAXzsKCiAgICAjIGFsbG9jYXRlIG5ldyBoYXNoIGZvciBvYmplY3QKICAgIG15ICRTZWxmID0geyVQYXJhbX07CiAgICBibGVzcyggJFNlbGYsICRUeXBlICk7CgogICAgJFNlbGYtPntQYXJhbX0gPSBcJVBhcmFtOwoKICAgIHJldHVybiAkU2VsZjsKfQoKIyBUT0RPOiDQtNC+0LHQsNCy0LjRgtGMINGC0LXRgdGC0YsKc3ViIFJ1biB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRMYXlvdXRPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0Jyk7CiAgICBteSAkUGFyYW1PYmplY3QgID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OldlYjo6UmVxdWVzdCcpOwogICAgbXkgJFRpY2tldE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUaWNrZXQnKTsKCiAgICBteSAkQVBJUXVldWVPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6QVBJOjpRdWV1ZScpOwoKICAgIG15ICRTdWJhY3Rpb24gPSAkU2VsZi0+e1N1YmFjdGlvbn07CgogICAgbXkgJFN1Y2Nlc3MgPSAwOwogICAgbXkgJFJlc3VsdCA9IHt9OwoKICAgIGlmICggJFN1YmFjdGlvbiBlcSAnR2V0UXVldWVMaXN0JyApIHsKCiAgICAgICAgJFJlc3VsdCA9ICRBUElRdWV1ZU9iamVjdC0+R2V0UXVldWVMaXN0KAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2UgewoKICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiTWV0aG9kIGRvZXNuJ3QgZXhpc3QiCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkSlNPTiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpBUEk6OlV0aWwnKQogICAgICAgICAgICAgICAtPkNsZWFuSlNPTiggRGF0YSA9PiAkUmVzdWx0ICk7CgogICAgcmV0dXJuICRMYXlvdXRPYmplY3QtPkF0dGFjaG1lbnQoCiAgICAgICAgQ29udGVudFR5cGUgPT4gJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9JyAuICRMYXlvdXRPYmplY3QtPntDaGFyc2V0fSwKICAgICAgICBDb250ZW50ICAgICA9PiAkSlNPTiwKICAgICAgICBUeXBlICAgICAgICA9PiAnaW5saW5lJywKICAgICAgICBOb0NhY2hlICAgICA9PiAxLAogICAgKTsKfQoKMTsK</File>
        <File Location="Custom/Kernel/Modules/API/Customers.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6Ok1vZHVsZXM6OkFQSTo6Q3VzdG9tZXJzOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwpubyB3YXJuaW5ncyAncmVkZWZpbmUnOwoKdXNlIERhdGE6OkR1bXBlcjsKdXNlIFVSSTo6RXNjYXBlOwoKb3VyICRPYmplY3RNYW5hZ2VyRGlzYWJsZWQgPSAxOwoKc3ViIG5ldyB7CiAgICBteSAoICRUeXBlLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRTZWxmID0geyVQYXJhbX07CiAgICBibGVzcyggJFNlbGYsICRUeXBlICk7CgogICAgJFNlbGYtPntQYXJhbX0gPSBcJVBhcmFtOwoKICAgIHJldHVybiAkU2VsZjsKfQoKc3ViIFJ1biB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRMYXlvdXRPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0Jyk7CiAgICBteSAkUGFyYW1PYmplY3QgID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OldlYjo6UmVxdWVzdCcpOwogICAgbXkgJFRpY2tldE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUaWNrZXQnKTsKICAgIG15ICRDdXN0b21lclVzZXJPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q3VzdG9tZXJVc2VyJyk7CgogICAgbXkgJEFQSUN1c3RvbWVyT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6Q3VzdG9tZXInKTsKCiAgICBteSAkU3ViYWN0aW9uID0gJFNlbGYtPntTdWJhY3Rpb259OwoKICAgIG15ICRTdWNjZXNzID0gMDsKICAgIG15ICRSZXN1bHQgPSB7fTsKCiAgICBpZiAoICRTdWJhY3Rpb24gZXEgJ0dldEN1c3RvbWVyTGlzdCcgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJQ3VzdG9tZXJPYmplY3QtPkdldEN1c3RvbWVyTGlzdCgKICAgICAgICAgICAgJXsgJFNlbGYtPntQYXJhbX0gfSwKICAgICAgICAgICAgVXNlcklEID0+ICRTZWxmLT57VXNlcklEfQogICAgICAgICk7CgogICAgfSBlbHNpZiAoICRTdWJhY3Rpb24gZXEgJ0dldEN1c3RvbWVyVXNlckxpc3QnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSUN1c3RvbWVyT2JqZWN0LT5HZXRDdXN0b21lclVzZXJMaXN0KAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2lmICggJFN1YmFjdGlvbiBlcSAnR2V0Q3VzdG9tZXJVc2VyJyApIHsKCiAgICAgICAgJFJlc3VsdCA9ICRBUElDdXN0b21lck9iamVjdC0+R2V0Q3VzdG9tZXJVc2VyKAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2lmICggJFN1YmFjdGlvbiBlcSAnQ3JlYXRlQ3VzdG9tZXJVc2VyJyApIHsKCiAgICAgICAgJFJlc3VsdCA9ICRBUElDdXN0b21lck9iamVjdC0+Q3JlYXRlQ3VzdG9tZXJVc2VyKAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2UgewoKICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiTWV0aG9kIGRvZXNuJ3QgZXhpc3QiCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkSlNPTiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpBUEk6OlV0aWwnKQogICAgICAgICAgICAgICAtPkNsZWFuSlNPTiggRGF0YSA9PiAkUmVzdWx0ICk7CgogICAgcmV0dXJuICRMYXlvdXRPYmplY3QtPkF0dGFjaG1lbnQoCiAgICAgICAgQ29udGVudFR5cGUgPT4gJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9JyAuICRMYXlvdXRPYmplY3QtPntDaGFyc2V0fSwKICAgICAgICBDb250ZW50ICAgICA9PiAkSlNPTiwKICAgICAgICBUeXBlICAgICAgICA9PiAnaW5saW5lJywKICAgICAgICBOb0NhY2hlICAgICA9PiAxLAogICAgKTsKfQoKMTsK</File>
        <File Location="Custom/Kernel/Modules/API/Services.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6Ok1vZHVsZXM6OkFQSTo6U2VydmljZXM7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cm5vIHdhcm5pbmdzICdyZWRlZmluZSc7Cgp1c2UgRGF0YTo6RHVtcGVyOwoKb3VyICRPYmplY3RNYW5hZ2VyRGlzYWJsZWQgPSAxOwoKc3ViIG5ldyB7CiAgICBteSAoICRUeXBlLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgYWxsb2NhdGUgbmV3IGhhc2ggZm9yIG9iamVjdAogICAgbXkgJFNlbGYgPSB7JVBhcmFtfTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICAkU2VsZi0+e1BhcmFtfSA9IFwlUGFyYW07CgogICAgcmV0dXJuICRTZWxmOwp9CgpzdWIgUnVuIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJExheW91dE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6T3V0cHV0OjpIVE1MOjpMYXlvdXQnKTsKICAgIG15ICRQYXJhbU9iamVjdCAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6V2ViOjpSZXF1ZXN0Jyk7CiAgICBteSAkVGlja2V0T2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlRpY2tldCcpOwoKICAgIG15ICRBUElTZXJ2aWNlT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6U2VydmljZScpOwoKICAgIG15ICRTdWJhY3Rpb24gPSAkU2VsZi0+e1N1YmFjdGlvbn07CgogICAgbXkgJFN1Y2Nlc3MgPSAwOwogICAgbXkgJFJlc3VsdCA9IHt9OwoKICAgIGlmICggJFN1YmFjdGlvbiBlcSAnR2V0U2VydmljZUxpc3QnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVNlcnZpY2VPYmplY3QtPkdldFNlcnZpY2VMaXN0KAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2UgewoKICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiTWV0aG9kIGRvZXNuJ3QgZXhpc3QiCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkSlNPTiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpBUEk6OlV0aWwnKQogICAgICAgICAgICAgICAtPkNsZWFuSlNPTiggRGF0YSA9PiAkUmVzdWx0ICk7CgogICAgcmV0dXJuICRMYXlvdXRPYmplY3QtPkF0dGFjaG1lbnQoCiAgICAgICAgQ29udGVudFR5cGUgPT4gJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9JyAuICRMYXlvdXRPYmplY3QtPntDaGFyc2V0fSwKICAgICAgICBDb250ZW50ICAgICA9PiAkSlNPTiwKICAgICAgICBUeXBlICAgICAgICA9PiAnaW5saW5lJywKICAgICAgICBOb0NhY2hlICAgICA9PiAxLAogICAgKTsKfQoKMTsK</File>
        <File Location="Custom/Kernel/Modules/API/Tickets.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6Ok1vZHVsZXM6OkFQSTo6VGlja2V0cyAwLjA3OwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwpubyB3YXJuaW5ncyAncmVkZWZpbmUnOwoKdXNlIERhdGE6OkR1bXBlcjsKCm91ciAkT2JqZWN0TWFuYWdlckRpc2FibGVkID0gMTsKCnN1YiBuZXcgewogICAgbXkgKCAkVHlwZSwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkU2VsZiA9IHslUGFyYW19OwogICAgYmxlc3MoICRTZWxmLCAkVHlwZSApOwoKICAgICRTZWxmLT57UGFyYW19ID0gXCVQYXJhbTsKCiAgICAkU2VsZi0+e0xheW91dE9iamVjdH0gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0Jyk7CgogICAgcmV0dXJuICRTZWxmOwp9CgpzdWIgUnVuIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJFBhcmFtT2JqZWN0ICA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpXZWI6OlJlcXVlc3QnKTsKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VGlja2V0Jyk7CgogICAgbXkgJEFQSVRpY2tldE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpBUEk6OlRpY2tldCcpOwoKICAgIG15ICRTdWJhY3Rpb24gPSAkU2VsZi0+e1N1YmFjdGlvbn07CgogICAgbXkgJFN1Y2Nlc3MgPSAwOwogICAgbXkgJFJlc3VsdCA9IHt9OwoKICAgIGlmICggJFN1YmFjdGlvbiBlcSAnR2V0VGlja2V0TGlzdCcgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJVGlja2V0T2JqZWN0LT5HZXRUaWNrZXRMaXN0KAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2lmICggJFN1YmFjdGlvbiBlcSAnVXBkYXRlVGl0bGUnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVRpY2tldE9iamVjdC0+VXBkYXRlVGl0bGUoCiAgICAgICAgICAgICV7ICRTZWxmLT57UGFyYW19IH0sCiAgICAgICAgICAgIFVzZXJJRCA9PiAkU2VsZi0+e1VzZXJJRH0KICAgICAgICApOwoKICAgIH0gZWxzaWYgKCAkU3ViYWN0aW9uIGVxICdVcGRhdGVRdWV1ZScgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJVGlja2V0T2JqZWN0LT5VcGRhdGVRdWV1ZSgKICAgICAgICAgICAgJXsgJFNlbGYtPntQYXJhbX0gfSwKICAgICAgICAgICAgVXNlcklEID0+ICRTZWxmLT57VXNlcklEfQogICAgICAgICk7CgogICAgfSBlbHNpZiAoICRTdWJhY3Rpb24gZXEgJ1VwZGF0ZVR5cGUnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVRpY2tldE9iamVjdC0+VXBkYXRlVHlwZSgKICAgICAgICAgICAgJXsgJFNlbGYtPntQYXJhbX0gfSwKICAgICAgICAgICAgVXNlcklEID0+ICRTZWxmLT57VXNlcklEfQogICAgICAgICk7CgogICAgfSBlbHNpZiAoICRTdWJhY3Rpb24gZXEgJ1VwZGF0ZVNlcnZpY2UnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVRpY2tldE9iamVjdC0+VXBkYXRlU2VydmljZSgKICAgICAgICAgICAgJXsgJFNlbGYtPntQYXJhbX0gfSwKICAgICAgICAgICAgVXNlcklEID0+ICRTZWxmLT57VXNlcklEfQogICAgICAgICk7CgogICAgfSBlbHNpZiAoICRTdWJhY3Rpb24gZXEgJ1VwZGF0ZVNMQScgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJVGlja2V0T2JqZWN0LT5VcGRhdGVTTEEoCiAgICAgICAgICAgICV7ICRTZWxmLT57UGFyYW19IH0sCiAgICAgICAgICAgIFVzZXJJRCA9PiAkU2VsZi0+e1VzZXJJRH0KICAgICAgICApOwoKICAgIH0gZWxzaWYgKCAkU3ViYWN0aW9uIGVxICdVcGRhdGVDdXN0b21lcicgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJVGlja2V0T2JqZWN0LT5VcGRhdGVDdXN0b21lcigKICAgICAgICAgICAgJXsgJFNlbGYtPntQYXJhbX0gfSwKICAgICAgICAgICAgVXNlcklEID0+ICRTZWxmLT57VXNlcklEfQogICAgICAgICk7CgogICAgfSBlbHNpZiAoICRTdWJhY3Rpb24gZXEgJ1VwZGF0ZVBlbmRpbmdUaW1lJyApIHsKCiAgICAgICAgJFJlc3VsdCA9ICRBUElUaWNrZXRPYmplY3QtPlVwZGF0ZVBlbmRpbmdUaW1lKAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2lmICggJFN1YmFjdGlvbiBlcSAnVXBkYXRlTG9jaycgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJVGlja2V0T2JqZWN0LT5VcGRhdGVMb2NrKAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2lmICggJFN1YmFjdGlvbiBlcSAnVXBkYXRlQXJjaGl2ZUZsYWcnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVRpY2tldE9iamVjdC0+VXBkYXRlQXJjaGl2ZUZsYWcoCiAgICAgICAgICAgICV7ICRTZWxmLT57UGFyYW19IH0sCiAgICAgICAgICAgIFVzZXJJRCA9PiAkU2VsZi0+e1VzZXJJRH0KICAgICAgICApOwoKICAgIH0gZWxzaWYgKCAkU3ViYWN0aW9uIGVxICdVcGRhdGVTdGF0ZScgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJVGlja2V0T2JqZWN0LT5VcGRhdGVTdGF0ZSgKICAgICAgICAgICAgJXsgJFNlbGYtPntQYXJhbX0gfSwKICAgICAgICAgICAgVXNlcklEID0+ICRTZWxmLT57VXNlcklEfQogICAgICAgICk7CgogICAgfSBlbHNpZiAoICRTdWJhY3Rpb24gZXEgJ1VwZGF0ZU93bmVyJyApIHsKCiAgICAgICAgaWYgKCBkZWZpbmVkICRTZWxmLT57UGFyYW19e05ld1VzZXJJRH0gYW5kCiAgICAgICAgICAgICAkU2VsZi0+e1BhcmFtfXtOZXdVc2VySUR9ID09IDAgKSB7CgogICAgICAgICAgICAkU2VsZi0+e1BhcmFtfXtOZXdVc2VySUR9ID0gJFNlbGYtPntVc2VySUR9OwogICAgICAgIH0KCiAgICAgICAgJFJlc3VsdCA9ICRBUElUaWNrZXRPYmplY3QtPlVwZGF0ZU93bmVyKAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICAjIFRPRE86IHJlZmFjdG9yaW5nIGVsc2lmCiAgICB9IGVsc2lmICggJFN1YmFjdGlvbiBlcSAnVXBkYXRlUmVzcG9uc2libGUnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVRpY2tldE9iamVjdC0+VXBkYXRlUmVzcG9uc2libGUoCiAgICAgICAgICAgICV7ICRTZWxmLT57UGFyYW19IH0sCiAgICAgICAgICAgIFVzZXJJRCA9PiAkU2VsZi0+e1VzZXJJRH0KICAgICAgICApOwoKICAgIH0gZWxzaWYgKCAkU3ViYWN0aW9uIGVxICdVcGRhdGVQcmlvcml0eScgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJVGlja2V0T2JqZWN0LT5VcGRhdGVQcmlvcml0eSgKICAgICAgICAgICAgJXsgJFNlbGYtPntQYXJhbX0gfSwKICAgICAgICAgICAgVXNlcklEID0+ICRTZWxmLT57VXNlcklEfQogICAgICAgICk7CgogICAgfSBlbHNpZiAoICRTdWJhY3Rpb24gZXEgJ01hcmtUaWNrZXRBc1NlZW4nICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVRpY2tldE9iamVjdC0+TWFya1RpY2tldEFzU2VlbigKICAgICAgICAgICAgJXsgJFNlbGYtPntQYXJhbX0gfSwKICAgICAgICAgICAgVXNlcklEID0+ICRTZWxmLT57VXNlcklEfQogICAgICAgICk7CgogICAgfSBlbHNpZiAoICRTdWJhY3Rpb24gZXEgJ01hcmtBcnRpY2xlQXNTZWVuJyApIHsKCiAgICAgICAgJFJlc3VsdCA9ICRBUElUaWNrZXRPYmplY3QtPk1hcmtBcnRpY2xlQXNTZWVuKAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2lmICggJFN1YmFjdGlvbiBlcSAnR2V0QXJ0aWNsZXMnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVRpY2tldE9iamVjdC0+R2V0QXJ0aWNsZXMoCiAgICAgICAgICAgICV7ICRTZWxmLT57UGFyYW19IH0sCiAgICAgICAgICAgIFVzZXJJRCA9PiAkU2VsZi0+e1VzZXJJRH0KICAgICAgICApOwoKICAgIH0gZWxzaWYgKCAkU3ViYWN0aW9uIGVxICdDcmVhdGVUaWNrZXQnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVRpY2tldE9iamVjdC0+Q3JlYXRlVGlja2V0KAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2lmICggJFN1YmFjdGlvbiBlcSAnQ3JlYXRlQXJ0aWNsZScgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJVGlja2V0T2JqZWN0LT5DcmVhdGVBcnRpY2xlKAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2lmICggJFN1YmFjdGlvbiBlcSAnQ3JlYXRlQXR0YWNobWVudCcgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJVGlja2V0T2JqZWN0LT5DcmVhdGVBdHRhY2htZW50KAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2lmICggJFN1YmFjdGlvbiBlcSAnR2V0QXR0YWNobWVudCcgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJVGlja2V0T2JqZWN0LT5HZXRBdHRhY2htZW50KAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICAgICAgaWYgKCByZWYgJFJlc3VsdCBuZSAnSEFTSCcgKSB7CiAgICAgICAgICAgIHJldHVybiAkUmVzdWx0OwogICAgICAgIH0KCiAgICB9IGVsc2lmICggJFN1YmFjdGlvbiBlcSAnV2F0Y2hUaWNrZXQnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVRpY2tldE9iamVjdC0+V2F0Y2hUaWNrZXQoCiAgICAgICAgICAgICV7ICRTZWxmLT57UGFyYW19IH0sCiAgICAgICAgICAgIFVzZXJJRCA9PiAkU2VsZi0+e1VzZXJJRH0KICAgICAgICApOwoKICAgIH0gZWxzaWYgKCAkU3ViYWN0aW9uIGVxICdVcGRhdGVUaWNrZXQnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVRpY2tldE9iamVjdC0+VXBkYXRlVGlja2V0KAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKCiAgICB9IGVsc2UgewoKICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiTWV0aG9kIGRvZXNuJ3QgZXhpc3QiCiAgICAgICAgfTsKICAgIH0KCiAgICAjINCU0LvRjyDQstGB0LXRhSDQvtC00L3QvtGC0LjQv9C90YvRhSDQt9Cw0L/RgNC+0YHQvtCyCiAgICBpZiAoICRTdWNjZXNzICkgewogICAgICAgICRSZXN1bHQgPSB7IFJlc3BvbnNlID0+ICJPSyIgfTsKICAgIH0gZWxzaWYgKCAha2V5cyAleyAkUmVzdWx0IH0gKSB7CiAgICAgICAgJFJlc3VsdCA9IHsgUmVzcG9uc2UgPT4gIkVSUk9SIiwgTWVzc2FnZSA9PiAiRXJyb3Igd2hpbGUgdXBkYXRpbmciIH07CiAgICB9CgogICAgbXkgJEpTT04gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6QVBJOjpVdGlsJykKICAgICAgICAgICAgICAgLT5DbGVhbkpTT04oIERhdGEgPT4gJFJlc3VsdCApOwoKICAgIHJldHVybiAkU2VsZi0+e0xheW91dE9iamVjdH0tPkF0dGFjaG1lbnQoCiAgICAgICAgQ29udGVudFR5cGUgPT4gJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9JyAuICRTZWxmLT57TGF5b3V0T2JqZWN0fXtDaGFyc2V0fSwKICAgICAgICBDb250ZW50ICAgICA9PiAkSlNPTiwKICAgICAgICBUeXBlICAgICAgICA9PiAnaW5saW5lJywKICAgICAgICBOb0NhY2hlICAgICA9PiAxLAogICAgKTsKfQoKMTsK</File>
        <File Location="Custom/Kernel/Modules/API/Users.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6Ok1vZHVsZXM6OkFQSTo6VXNlcnM7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cm5vIHdhcm5pbmdzICdyZWRlZmluZSc7Cgp1c2UgRGF0YTo6RHVtcGVyOwoKb3VyICRPYmplY3RNYW5hZ2VyRGlzYWJsZWQgPSAxOwoKc3ViIG5ldyB7CiAgICBteSAoICRUeXBlLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgYWxsb2NhdGUgbmV3IGhhc2ggZm9yIG9iamVjdAogICAgbXkgJFNlbGYgPSB7JVBhcmFtfTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICAkU2VsZi0+e1BhcmFtfSA9IFwlUGFyYW07CgogICAgcmV0dXJuICRTZWxmOwp9CgpzdWIgUnVuIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJExheW91dE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6T3V0cHV0OjpIVE1MOjpMYXlvdXQnKTsKICAgIG15ICRQYXJhbU9iamVjdCAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6V2ViOjpSZXF1ZXN0Jyk7CiAgICBteSAkVGlja2V0T2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlRpY2tldCcpOwoKICAgIG15ICRBUElVc2VyT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6VXNlcicpOwoKICAgIG15ICRTdWJhY3Rpb24gPSAkU2VsZi0+e1N1YmFjdGlvbn07CgogICAgbXkgJFN1Y2Nlc3MgPSAwOwogICAgbXkgJFJlc3VsdCA9IHt9OwoKICAgIGlmICggJFN1YmFjdGlvbiBlcSAnR2V0VXNlckxpc3QnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVVzZXJPYmplY3QtPkdldFVzZXJMaXN0KAogICAgICAgICAgICAleyAkU2VsZi0+e1BhcmFtfSB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFNlbGYtPntVc2VySUR9CiAgICAgICAgKTsKICAgIH0KICAgIGVsc2lmICggJFN1YmFjdGlvbiBlcSAnR2V0VXNlclBlcm1pc3Npb25zJyApIHsKCiAgICAgICAgJFJlc3VsdCA9ICRBUElVc2VyT2JqZWN0LT5HZXRVc2VyUGVybWlzc2lvbnMoCiAgICAgICAgICAgICV7ICRTZWxmLT57UGFyYW19IH0sCiAgICAgICAgICAgIFVzZXJJRCA9PiAkU2VsZi0+e1VzZXJJRH0KICAgICAgICApOwoKICAgIH0gZWxzZSB7CgogICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJNZXRob2QgZG9lc24ndCBleGlzdCIKICAgICAgICB9OwogICAgfQoKICAgIG15ICRKU09OID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6VXRpbCcpCiAgICAgICAgICAgICAgIC0+Q2xlYW5KU09OKCBEYXRhID0+ICRSZXN1bHQgKTsKCiAgICByZXR1cm4gJExheW91dE9iamVjdC0+QXR0YWNobWVudCgKICAgICAgICBDb250ZW50VHlwZSA9PiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD0nIC4gJExheW91dE9iamVjdC0+e0NoYXJzZXR9LAogICAgICAgIENvbnRlbnQgICAgID0+ICRKU09OLAogICAgICAgIFR5cGUgICAgICAgID0+ICdpbmxpbmUnLAogICAgICAgIE5vQ2FjaGUgICAgID0+IDEsCiAgICApOwp9CgoxOwo=</File>
        <File Location="Custom/Kernel/Modules/API/Filters.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6Ok1vZHVsZXM6OkFQSTo6RmlsdGVyczsKCnVzZSBzdHJpY3Q7CnVzZSB3YXJuaW5nczsKbm8gd2FybmluZ3MgJ3JlZGVmaW5lJzsKCm91ciAkT2JqZWN0TWFuYWdlckRpc2FibGVkID0gMTsKCnN1YiBuZXcgewogICAgbXkgKCAkVHlwZSwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkU2VsZiA9IHslUGFyYW19OwogICAgYmxlc3MoICRTZWxmLCAkVHlwZSApOwoKICAgICRTZWxmLT57UGFyYW19ID0gXCVQYXJhbTsKCiAgICByZXR1cm4gJFNlbGY7Cn0KCnN1YiBSdW4gewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkTGF5b3V0T2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpPdXRwdXQ6OkhUTUw6OkxheW91dCcpOwogICAgbXkgJFBhcmFtT2JqZWN0ICA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpXZWI6OlJlcXVlc3QnKTsKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VGlja2V0Jyk7CiAgICBteSAkQ29uZmlnT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpDb25maWcnKTsKCiAgICBteSAkQVBJRmlsdGVyT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6RmlsdGVyJyk7CgogICAgbXkgJFN1YmFjdGlvbiA9ICRTZWxmLT57U3ViYWN0aW9ufTsKCiAgICBteSAkU3VjY2VzcyA9IDA7CiAgICBteSAkUmVzdWx0ID0ge307CgogICAgaWYgKCAkU3ViYWN0aW9uIGVxICdHZXRUaWNrZXRWaWV3cycgKSB7CgogICAgICAgICRSZXN1bHQgPSAkQVBJRmlsdGVyT2JqZWN0LT5HZXRUaWNrZXRWaWV3cygKICAgICAgICAgICAgJXsgJFNlbGYtPntQYXJhbX0gfSwKICAgICAgICAgICAgVXNlcklEID0+ICRTZWxmLT57VXNlcklEfQogICAgICAgICk7CgogICAgfSBlbHNlIHsKCiAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk1ldGhvZCBkb2Vzbid0IGV4aXN0IgogICAgICAgIH07CiAgICB9CgogICAgbXkgJEpTT04gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6QVBJOjpVdGlsJykKICAgICAgICAgICAgICAgLT5DbGVhbkpTT04oIERhdGEgPT4gJFJlc3VsdCApOwoKICAgIHJldHVybiAkTGF5b3V0T2JqZWN0LT5BdHRhY2htZW50KAogICAgICAgIENvbnRlbnRUeXBlID0+ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PScgLiAkTGF5b3V0T2JqZWN0LT57Q2hhcnNldH0sCiAgICAgICAgQ29udGVudCAgICAgPT4gJEpTT04sCiAgICAgICAgVHlwZSAgICAgICAgPT4gJ2lubGluZScsCiAgICAgICAgTm9DYWNoZSAgICAgPT4gMSwKICAgICk7Cn0KCjE7Cg==</File>
        <File Location="Custom/Kernel/Modules/API/System.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6Ok1vZHVsZXM6OkFQSTo6U3lzdGVtOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwpubyB3YXJuaW5ncyAncmVkZWZpbmUnOwoKdXNlIERhdGE6OkR1bXBlcjsKCm91ciAkT2JqZWN0TWFuYWdlckRpc2FibGVkID0gMTsKCnN1YiBuZXcgewogICAgbXkgKCAkVHlwZSwgJVBhcmFtICkgPSBAXzsKCiAgICAjIGFsbG9jYXRlIG5ldyBoYXNoIGZvciBvYmplY3QKICAgIG15ICRTZWxmID0geyVQYXJhbX07CiAgICBibGVzcyggJFNlbGYsICRUeXBlICk7CgogICAgJFNlbGYtPntQYXJhbX0gPSBcJVBhcmFtOwoKICAgIHJldHVybiAkU2VsZjsKfQoKIyBUT0RPOiDQtNC+0LHQsNCy0LjRgtGMINGC0LXRgdGC0YsKc3ViIFJ1biB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRMYXlvdXRPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0Jyk7CgogICAgbXkgJEFQSVN5c3RlbU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpBUEk6OlN5c3RlbScpOwoKICAgIG15ICRTdWJhY3Rpb24gPSAkU2VsZi0+e1N1YmFjdGlvbn07CgogICAgbXkgJFN1Y2Nlc3MgPSAwOwogICAgbXkgJFJlc3VsdCA9IHt9OwoKICAgIGlmICggJFN1YmFjdGlvbiBlcSAnR2V0UGFja2FnZUxpc3QnICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVN5c3RlbU9iamVjdC0+R2V0UGFja2FnZUxpc3QoCiAgICAgICAgICAgICV7ICRTZWxmLT57UGFyYW19IH0sCiAgICAgICAgICAgIFVzZXJJRCA9PiAkU2VsZi0+e1VzZXJJRH0KICAgICAgICApOwogICAgfQogICAgZWxzaWYgKCAkU3ViYWN0aW9uIGVxICdHZXREeW5hbWljRmllbGRMaXN0JyApIHsKCiAgICAgICAgJFJlc3VsdCA9ICRBUElTeXN0ZW1PYmplY3QtPkdldER5bmFtaWNGaWVsZExpc3QoCiAgICAgICAgICAgICV7ICRTZWxmLT57UGFyYW19IH0sCiAgICAgICAgICAgIFVzZXJJRCA9PiAkU2VsZi0+e1VzZXJJRH0KICAgICAgICApOwogICAgfQogICAgZWxzZSB7CgogICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJNZXRob2QgZG9lc24ndCBleGlzdCIKICAgICAgICB9OwogICAgfQoKICAgIG15ICRKU09OID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6VXRpbCcpCiAgICAgICAgICAgICAgIC0+Q2xlYW5KU09OKCBEYXRhID0+ICRSZXN1bHQgKTsKCiAgICByZXR1cm4gJExheW91dE9iamVjdC0+QXR0YWNobWVudCgKICAgICAgICBDb250ZW50VHlwZSA9PiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD0nIC4gJExheW91dE9iamVjdC0+e0NoYXJzZXR9LAogICAgICAgIENvbnRlbnQgICAgID0+ICRKU09OLAogICAgICAgIFR5cGUgICAgICAgID0+ICdpbmxpbmUnLAogICAgICAgIE5vQ2FjaGUgICAgID0+IDEsCiAgICApOwp9CgoxOwo=</File>
        <File Location="Custom/Kernel/Modules/API/Settings.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6Ok1vZHVsZXM6OkFQSTo6U2V0dGluZ3M7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cm5vIHdhcm5pbmdzICdyZWRlZmluZSc7Cgp1c2UgRGF0YTo6RHVtcGVyOwoKb3VyICRPYmplY3RNYW5hZ2VyRGlzYWJsZWQgPSAxOwoKc3ViIG5ldyB7CiAgICBteSAoICRUeXBlLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgYWxsb2NhdGUgbmV3IGhhc2ggZm9yIG9iamVjdAogICAgbXkgJFNlbGYgPSB7JVBhcmFtfTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICAkU2VsZi0+e1BhcmFtfSA9IFwlUGFyYW07CgogICAgcmV0dXJuICRTZWxmOwp9CgojIFRPRE86INC00L7QsdCw0LLQuNGC0Ywg0YLQtdGB0YLRiwpzdWIgUnVuIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJExheW91dE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6T3V0cHV0OjpIVE1MOjpMYXlvdXQnKTsKICAgIG15ICRQYXJhbU9iamVjdCAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6V2ViOjpSZXF1ZXN0Jyk7CiAgICBteSAkVGlja2V0T2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlRpY2tldCcpOwoKICAgIG15ICRBUElTZXR0aW5nT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6U2V0dGluZycpOwoKICAgIG15ICRTdWJhY3Rpb24gPSAkU2VsZi0+e1N1YmFjdGlvbn07CgogICAgbXkgJFN1Y2Nlc3MgPSAwOwogICAgbXkgJFJlc3VsdCA9IHt9OwoKICAgIGlmICggJFN1YmFjdGlvbiBlcSAnR2V0TGFuZ3VhZ2VMaXN0JyApIHsKCiAgICAgICAgJFJlc3VsdCA9ICRBUElTZXR0aW5nT2JqZWN0LT5HZXRMYW5ndWFnZUxpc3QoCiAgICAgICAgICAgICV7ICRTZWxmLT57UGFyYW19IH0sCiAgICAgICAgICAgIFVzZXJJRCA9PiAkU2VsZi0+e1VzZXJJRH0KICAgICAgICApOwoKICAgIH0gZWxzaWYgKCAkU3ViYWN0aW9uIGVxICdTZXRQdXNoTm90aWZpY2F0aW9uVG9rZW4nICkgewoKICAgICAgICAkUmVzdWx0ID0gJEFQSVNldHRpbmdPYmplY3QtPlNldFB1c2hOb3RpZmljYXRpb25Ub2tlbigKICAgICAgICAgICAgJXsgJFNlbGYtPntQYXJhbX0gfSwKICAgICAgICAgICAgVXNlcklEID0+ICRTZWxmLT57VXNlcklEfQogICAgICAgICk7CgogICAgfSBlbHNlIHsKCiAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk1ldGhvZCBkb2Vzbid0IGV4aXN0IgogICAgICAgIH07CiAgICB9CgogICAgbXkgJEpTT04gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6QVBJOjpVdGlsJykKICAgICAgICAgICAgICAgLT5DbGVhbkpTT04oIERhdGEgPT4gJFJlc3VsdCApOwoKICAgIHJldHVybiAkTGF5b3V0T2JqZWN0LT5BdHRhY2htZW50KAogICAgICAgIENvbnRlbnRUeXBlID0+ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PScgLiAkTGF5b3V0T2JqZWN0LT57Q2hhcnNldH0sCiAgICAgICAgQ29udGVudCAgICAgPT4gJEpTT04sCiAgICAgICAgVHlwZSAgICAgICAgPT4gJ2lubGluZScsCiAgICAgICAgTm9DYWNoZSAgICAgPT4gMSwKICAgICk7Cn0KCjE7Cg==</File>
        <File Location="Custom/Kernel/Modules/API/Sla.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6Ok1vZHVsZXM6OkFQSTo6U2xhOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwpubyB3YXJuaW5ncyAncmVkZWZpbmUnOwoKdXNlIERhdGE6OkR1bXBlcjsKCm91ciAkT2JqZWN0TWFuYWdlckRpc2FibGVkID0gMTsKCnN1YiBuZXcgewogICAgbXkgKCAkVHlwZSwgJVBhcmFtICkgPSBAXzsKCiAgICAjIGFsbG9jYXRlIG5ldyBoYXNoIGZvciBvYmplY3QKICAgIG15ICRTZWxmID0geyVQYXJhbX07CiAgICBibGVzcyggJFNlbGYsICRUeXBlICk7CgogICAgJFNlbGYtPntQYXJhbX0gPSBcJVBhcmFtOwoKICAgIHJldHVybiAkU2VsZjsKfQoKIyBUT0RPOiDQtNC+0LHQsNCy0LjRgtGMINGC0LXRgdGC0YsKc3ViIFJ1biB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRMYXlvdXRPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0Jyk7CiAgICBteSAkUGFyYW1PYmplY3QgID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OldlYjo6UmVxdWVzdCcpOwogICAgbXkgJFRpY2tldE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUaWNrZXQnKTsKCiAgICBteSAkQVBJU0xBT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6U0xBJyk7CgogICAgbXkgJFN1YmFjdGlvbiA9ICRTZWxmLT57U3ViYWN0aW9ufTsKCiAgICBteSAkU3VjY2VzcyA9IDA7CiAgICBteSAkUmVzdWx0ID0ge307CgogICAgaWYgKCAkU3ViYWN0aW9uIGVxICdHZXRTTEFMaXN0JyApIHsKCiAgICAgICAgJFJlc3VsdCA9ICRBUElTTEFPYmplY3QtPkdldFNMQUxpc3QoCiAgICAgICAgICAgICV7ICRTZWxmLT57UGFyYW19IH0sCiAgICAgICAgICAgIFVzZXJJRCA9PiAkU2VsZi0+e1VzZXJJRH0KICAgICAgICApOwoKICAgIH0gZWxzZSB7CgogICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJNZXRob2QgZG9lc24ndCBleGlzdCIKICAgICAgICB9OwogICAgfQoKICAgIG15ICRKU09OID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6VXRpbCcpCiAgICAgICAgICAgICAgIC0+Q2xlYW5KU09OKCBEYXRhID0+ICRSZXN1bHQgKTsKCiAgICByZXR1cm4gJExheW91dE9iamVjdC0+QXR0YWNobWVudCgKICAgICAgICBDb250ZW50VHlwZSA9PiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD0nIC4gJExheW91dE9iamVjdC0+e0NoYXJzZXR9LAogICAgICAgIENvbnRlbnQgICAgID0+ICRKU09OLAogICAgICAgIFR5cGUgICAgICAgID0+ICdpbmxpbmUnLAogICAgICAgIE5vQ2FjaGUgICAgID0+IDEsCiAgICApOwp9CgoxOwo=</File>
        <File Location="Custom/Kernel/System/Ticket/Event/CheckInstalledPackage.pm" Permission="644" Encode="Base64">cGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6VGlja2V0OjpFdmVudDo6Q2hlY2tJbnN0YWxsZWRQYWNrYWdlOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwp1c2UgdXRmODsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKAogICAgJ0tlcm5lbDo6U3lzdGVtOjpMb2cnLAogICAgJ0tlcm5lbDo6U3lzdGVtOjpUaWNrZXQnLAopOwoKc3ViIG5ldyB7CiAgICBteSAoICRUeXBlLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRTZWxmID0ge307CiAgICBibGVzcyggJFNlbGYsICRUeXBlICk7CgogICAgcmV0dXJuICRTZWxmOwp9CgpzdWIgUnVuIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgZm9yIChxdyhEYXRhIEV2ZW50IENvbmZpZykpIHsKICAgICAgICBpZiAoICEkUGFyYW17JF99ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiTmVlZCAkXyEiCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CgogICAgbXkgJE1pbmltYWxWZXJzaW9uID0gJzYuMS4yNCc7CgogICAgaWYgKCAkUGFyYW17RXZlbnR9ID1+IC9QYWNrYWdlKEluc3RhbGx8VXBncmFkZXxSZWluc3RhbGwpLyApIHsKICAgICAgICBpZiAoICRQYXJhbXtEYXRhfXtOYW1lfSBlcSAnUlM0T1RSU19BZHZhbmNlZFRpY2tldFNlYXJjaCcKICAgICAgICAgICAgYW5kIHZlcnNpb24tPnBhcnNlKCAkUGFyYW17RGF0YX17VmVyc2lvbn0gKSA+PQogICAgICAgICAgICB2ZXJzaW9uLT5wYXJzZSgkTWluaW1hbFZlcnNpb24pICkKICAgICAgICB7CiAgICAgICAgICAgICRTZWxmLT5Ub2dnbGVBdXRvbG9hZE1vZHVsZSggVG9nZ2xlID0+IDAgKTsKICAgICAgICB9CiAgICB9CiAgICBlbHNpZiAoICRQYXJhbXtFdmVudH0gZXEgJ1BhY2thZ2VVbmluc3RhbGwnICkgewogICAgICAgIGlmICggJFBhcmFte0RhdGF9e05hbWV9IGVxICdSUzRPVFJTX0FkdmFuY2VkVGlja2V0U2VhcmNoJwogICAgICAgICAgICBhbmQgdmVyc2lvbi0+cGFyc2UoICRQYXJhbXtEYXRhfXtWZXJzaW9ufSApID49CiAgICAgICAgICAgIHZlcnNpb24tPnBhcnNlKCRNaW5pbWFsVmVyc2lvbikgKQogICAgICAgIHsKICAgICAgICAgICAgJFNlbGYtPlRvZ2dsZUF1dG9sb2FkTW9kdWxlKCBUb2dnbGUgPT4gMSApOwogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gMTsKfQoKc3ViIFRvZ2dsZUF1dG9sb2FkTW9kdWxlIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJEF1dG9sb2FkVGlja2V0U2VhcmNoTmFtZSA9CiAgICAgICdBdXRvbG9hZFBlcmxQYWNrYWdlcyMjIzExMDAtUlNfVGlja2V0U2VhcmNoJzsKCiAgICBteSAkU3lzQ29uZmlnT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlN5c0NvbmZpZycpOwoKICAgICMgR2V0dGluZyBhdXRvbG9hZCBtb2R1bGUgcGFyYW0gZm9yIFRpY2tldFNlYXJjaAogICAgbXkgJUF1dG9sb2FkVGlja2V0U2VhcmNoUGFyYW0gPQogICAgICAkU3lzQ29uZmlnT2JqZWN0LT5TZXR0aW5nR2V0KCBOYW1lID0+ICRBdXRvbG9hZFRpY2tldFNlYXJjaE5hbWUgKTsKCiAgICAjIExvY2sgaXQgZm9yIGNoYW5naW5nCiAgICBteSAkRXhjbHVzaXZlTG9ja0dVSUQgPSAkU3lzQ29uZmlnT2JqZWN0LT5TZXR0aW5nTG9jaygKICAgICAgICBEZWZhdWx0SUQgPT4gJEF1dG9sb2FkVGlja2V0U2VhcmNoUGFyYW17RGVmYXVsdElEfSwKICAgICAgICBGb3JjZSAgICAgPT4gMSwKICAgICAgICBVc2VySUQgICAgPT4gMQogICAgKTsKCiAgICBpZiAoICEkRXhjbHVzaXZlTG9ja0dVSUQgKSB7CiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJDYW5ub3QgbG9jayAkQXV0b2xvYWRUaWNrZXRTZWFyY2hOYW1lISIKICAgICAgICApOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBteSAlU2V0dGluZ1VwZGF0ZVJlc3VsdCA9ICRTeXNDb25maWdPYmplY3QtPlNldHRpbmdVcGRhdGUoCiAgICAgICAgTmFtZSAgICAgICAgICAgICAgPT4gJEF1dG9sb2FkVGlja2V0U2VhcmNoTmFtZSwKICAgICAgICBJc1ZhbGlkICAgICAgICAgICA9PiAxLAogICAgICAgIFVzZXJJRCAgICAgICAgICAgID0+IDEsCiAgICAgICAgRXhjbHVzaXZlTG9ja0dVSUQgPT4gJEV4Y2x1c2l2ZUxvY2tHVUlELAogICAgICAgIEVmZmVjdGl2ZVZhbHVlICAgID0+ICRQYXJhbXtUb2dnbGV9CiAgICAgICAgPyAkQXV0b2xvYWRUaWNrZXRTZWFyY2hQYXJhbXtEZWZhdWx0VmFsdWV9CiAgICAgICAgOiBbXQogICAgKTsKCiAgICBpZiAoICEkU2V0dGluZ1VwZGF0ZVJlc3VsdHtTdWNjZXNzfSApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkNhbm5vdCBsb2NrICRBdXRvbG9hZFRpY2tldFNlYXJjaE5hbWUhIgogICAgICAgICk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIG15ICVEZXBsb3lSZXN1bHQgPSAkU3lzQ29uZmlnT2JqZWN0LT5Db25maWd1cmF0aW9uRGVwbG95KCBVc2VySUQgPT4gMSApOwoKICAgIGlmICggISREZXBsb3lSZXN1bHR7U3VjY2Vzc30gKSB7CiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJDYW5ub3QgZGVwbG95IGNvbmZpZ3VyYXRpb24gJERlcGxveVJlc3VsdHtFcnJvcn0hIgogICAgICAgICk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIHJldHVybiAxOwp9CgoxOwo=</File>
        <File Location="Custom/Kernel/System/API/Queue.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QVBJOjpRdWV1ZSAwLjAzOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwpubyB3YXJuaW5ncyAncmVkZWZpbmUnOwoKdXNlIHV0Zjg7Cgp1c2UgdmFycyBxdyhASVNBKTsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKCk7CgpzdWIgbmV3IHsKICAgIG15ICggJFR5cGUsICVQYXJhbSApID0gQF87CgogICAgbXkgJFNlbGYgPSB7fTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICByZXR1cm4gJFNlbGY7Cn0KCnN1YiBHZXRRdWV1ZUxpc3QgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICAjIFdlIG5lZWQgdG8gZ2V0IFF1ZXVlcyBhcnJheSB3aXRoIGFsbCBhY2Nlc3NpYmxlIFF1ZXVlcyBhbmQgd2l0aCBldmVyeQogICAgIyBhbmNlc3RvcnMgb2Ygb25lcyBldmVuIGlmIGFuIGFnZW50IGhhcyBub3QgZ3JvdXAgcGVybWlzc2lvbnMgdG8gdGhlbS4KICAgIG15IEBRdWV1ZUFyciA9ICgpOwoKICAgICMgQWxzbyB3ZSBuZWVkIHRvIG1ha2UgUXVldWVUcmVlIGZvciB0aGVtLgogICAgbXkgQFF1ZXVlVHJlZSA9ICgpOwoKICAgIG15ICRSZXN1bHQ7CiAgICBteSAkUXVldWVPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6UXVldWUnKTsKCiAgICAjIEdldCBhbGwgcG9zc2libGUgdmFsaWQgcXVldWVzIGZyb20gT1RSUy4KICAgICMgJFZBUjEgPSB7CiAgICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR3JvdXAgbmFtZSAgICAgUk8KICAgICMgICAgJzEnID0+ICdQb3N0bWFzdGVyJywgICAgICAjIHBvc3RtYXN0ZXIgICAxCiAgICAjICAgICc0JyA9PiAnTWlzYycsICAgICAgICAgICAgIyB1c2VycyAgICAgICAgMAogICAgIyAgICAnMycgPT4gJ0p1bmsnLCAgICAgICAgICAgICMgdXNlcnMgICAgICAgIDAKICAgICMgICAgJzInID0+ICdSYXcnLCAgICAgICAgICAgICAjIHVzZXJzICAgICAgICAwIDwtLS0gbXVzdCBiZSBpbiB0aGUgcmVzdWx0IGxpc3QKICAgICMgICAgJzUnID0+ICdSYXc6OlJhd19DaGlsZCcgICAjIHN0YXRzICAgICAgICAxCiAgICAjIH07CiAgICBteSAlQWxsUXVldWVzID0gJFF1ZXVlT2JqZWN0LT5RdWV1ZUxpc3QoIFZhbGlkID0+IDEgKTsKCiAgICAjIFJldmVyc2UgdGhlIHRha2VuIGhhc2ggaW4gb3JkZXIgdG8gZ2V0IGFjY2VzcyB0byBhIHF1ZXVlIGJ5IGl0cyBRdWV1ZSBuYW1lCiAgICBteSAlUXVldWVzUmV2ZXJzZSA9IHJldmVyc2UgJUFsbFF1ZXVlczsKCiAgICAjIFBlcm1pc3Npb25zOiBSTywgUlcKICAgIG15ICVVc2VyUXVldWVzID0gJFF1ZXVlT2JqZWN0LT5HZXRBbGxRdWV1ZXMoIFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfSApOwoKICAgICMgUGVybWlzc2lvbnM6IENSRUFURQogICAgaWYgKCAkUGFyYW17Rm9yQ3JlYXRlVGlja2V0fSApIHsKICAgICAgICBteSAlVXNlclF1ZXVlc1R5cGVDcmVhdGUgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6UXVldWUnKQogICAgICAgICAgLT5HZXRBbGxRdWV1ZXMoIFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfSwgVHlwZSA9PiAnY3JlYXRlJyApOwoKICAgICAgICAlVXNlclF1ZXVlcyA9ICggJVVzZXJRdWV1ZXMsICVVc2VyUXVldWVzVHlwZUNyZWF0ZSApOwogICAgfQoKICAgICMgTU9WRV9JTlRPCiAgICBpZiAoICRQYXJhbXtGb3JVcGRhdGVRdWV1ZX0gKSB7CiAgICAgICAgbXkgJVVzZXJRdWV1ZXNUeXBlQ3JlYXRlID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlF1ZXVlJykKICAgICAgICAgIC0+R2V0QWxsUXVldWVzKCBVc2VySUQgPT4gJFBhcmFte1VzZXJJRH0sIFR5cGUgPT4gJ21vdmVfaW50bycgKTsKCiAgICAgICAgJVVzZXJRdWV1ZXMgPSAoICVVc2VyUXVldWVzLCAlVXNlclF1ZXVlc1R5cGVDcmVhdGUgKTsKICAgIH0KCiAgICBteSAkVHJlZSAgICAgICAgPSBbXTsKICAgIG15ICVRdWV1ZUNoaWxkcyA9ICgpOwoKICAgICMgTWFrZSBUcmVlIGZvciBldmVyeSB2YWxpZCBRdWV1ZQogICAgZm9yIG15ICRRdWV1ZSAoIHNvcnQga2V5cyAlUXVldWVzUmV2ZXJzZSApIHsKCiAgICAgICAgbXkgQFN1YlF1ZXVlcyA9IHNwbGl0ICc6OicsICRRdWV1ZTsKCiAgICAgICAgaWYgKCBAU3ViUXVldWVzID09IDEgKSB7CiAgICAgICAgICAgIHB1c2ggQHskVHJlZX0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgTmFtZSAgICAgICA9PiAkU3ViUXVldWVzWy0xXSwKICAgICAgICAgICAgICAgIEZ1bGxOYW1lICAgPT4gJFF1ZXVlLAogICAgICAgICAgICAgICAgQ2hpbGRzICAgICA9PiBbXSwKICAgICAgICAgICAgICAgIElEICAgICAgICAgPT4gJFF1ZXVlc1JldmVyc2V7JFF1ZXVlfSwKICAgICAgICAgICAgICAgIEFjY2Vzc2libGUgPT4gJFVzZXJRdWV1ZXN7ICRRdWV1ZXNSZXZlcnNleyRRdWV1ZX0gfSA/IDEgOiAwCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgJFF1ZXVlQ2hpbGRzeyRRdWV1ZX0gPSAkVHJlZS0+Wy0xXXtDaGlsZHN9OwogICAgICAgICAgICBuZXh0OwogICAgICAgIH0KCiAgICAgICAgbXkgJFBhcmVudCA9IGpvaW4gJzo6JywgQFN1YlF1ZXVlc1sgMCAuLiAkI1N1YlF1ZXVlcyAtIDEgXTsKICAgICAgICBwdXNoIEB7ICRRdWV1ZUNoaWxkc3skUGFyZW50fSB9LAogICAgICAgICAgewogICAgICAgICAgICBOYW1lICAgICAgID0+ICRTdWJRdWV1ZXNbLTFdLAogICAgICAgICAgICBGdWxsTmFtZSAgID0+ICRRdWV1ZSwKICAgICAgICAgICAgQ2hpbGRzICAgICA9PiBbXSwKICAgICAgICAgICAgSUQgICAgICAgICA9PiAkUXVldWVzUmV2ZXJzZXskUXVldWV9LAogICAgICAgICAgICBBY2Nlc3NpYmxlID0+ICRVc2VyUXVldWVzeyAkUXVldWVzUmV2ZXJzZXskUXVldWV9IH0gPyAxIDogMAogICAgICAgICAgfTsKICAgICAgICAkUXVldWVDaGlsZHN7JFF1ZXVlfSA9ICRRdWV1ZUNoaWxkc3skUGFyZW50fS0+Wy0xXXtDaGlsZHN9OwogICAgfQoKICAgICMgVHJhdmVyc2UgdGhlIHRha2VuIHRyZWUgYW5kIHJlbW92ZSBhbGwgbm90IGFjY2Vzc2libGUgbm9kZXMgYW5kCiAgICAjIHRoZWlyIG5vdCBhY2Nlc3NpYmxlIHBhcmVudCBub2RlcywgZ2V0dGluZyBhIG5ldyBAUXVldWVUcmVlIGFuZAogICAgIyBAUXVldWVBcnIuIEFsbCBRdWV1ZXMgaGFzIGFkZGl0aW9uYWwgZmllbGQgQWNjZXNzaWJsZSAxfDAKICAgIGZvciBteSAkTm9kZSAoIEB7JFRyZWV9ICkgewoKICAgICAgICAjIEFkZCBjaGlsZCB3aGljaCBpcyBhY2Nlc3NpYmxlIG9yIGhhcyBhY2Nlc3NpYmxlIG9uZXMKICAgICAgICAkU2VsZi0+X1RyYXZlcnNlVHJlZSggJE5vZGUsIFxAUXVldWVUcmVlLCBcQFF1ZXVlQXJyICk7CiAgICB9CgogICAgJFJlc3VsdCA9IHsKICAgICAgICBSZXNwb25zZSAgPT4gIk9LIiwKICAgICAgICBRdWV1ZXMgICAgPT4gXEBRdWV1ZUFyciwKICAgICAgICBRdWV1ZVRyZWUgPT4gXEBRdWV1ZVRyZWUKICAgIH07CgogICAgcmV0dXJuICRSZXN1bHQ7Cn0KCnN1YiBfSGFzQWNjZXNzaWJsZUNoaWxkIHsKICAgIG15ICggJFNlbGYsICROb2RlICkgPSBAXzsKCiAgICBmb3IgbXkgJENoaWxkICggQHsgJE5vZGUtPntDaGlsZHN9IH0gKSB7CiAgICAgICAgcmV0dXJuICRDaGlsZC0+e0FjY2Vzc2libGV9ID8gMSA6ICRTZWxmLT5fSGFzQWNjZXNzaWJsZUNoaWxkKCRDaGlsZCk7CiAgICB9CgogICAgcmV0dXJuOwp9CgpzdWIgX1RyYXZlcnNlVHJlZSB7CiAgICBteSAoICRTZWxmLCAkTm9kZSwgJE5ld1RyZWUsICRRdWV1ZUFyciApID0gQF87CgogICAgbXkgJENoaWxkQ291bnQgPSBAeyAkTm9kZS0+e0NoaWxkc30gfTsKCiAgICBteSAkQXRMZWFzdE9uZSA9ICRTZWxmLT5fSGFzQWNjZXNzaWJsZUNoaWxkKCAkTm9kZSApOwoKICAgIGlmICggJE5vZGUtPntBY2Nlc3NpYmxlfSBvciAkQXRMZWFzdE9uZSApIHsKICAgICAgICBwdXNoIEB7JE5ld1RyZWV9LAogICAgICAgICAgewogICAgICAgICAgICBOYW1lICAgICAgID0+ICROb2RlLT57TmFtZX0sCiAgICAgICAgICAgIEZ1bGxOYW1lICAgPT4gJE5vZGUtPntGdWxsTmFtZX0sCiAgICAgICAgICAgIENoaWxkcyAgICAgPT4gW10sCiAgICAgICAgICAgIElEICAgICAgICAgPT4gJE5vZGUtPntJRH0sCiAgICAgICAgICAgIEFjY2Vzc2libGUgPT4gJE5vZGUtPntBY2Nlc3NpYmxlfQogICAgICAgICAgfTsKICAgICAgICAkTmV3VHJlZSA9ICROZXdUcmVlLT5bLTFde0NoaWxkc307CgogICAgICAgICMgRm9yIGNvbW1vbiBhcnJheSBvZiBuZWNlc3NhcnkgcXVldWVzCiAgICAgICAgcHVzaCBAeyRRdWV1ZUFycn0sCiAgICAgICAgICB7CiAgICAgICAgICAgIElEICAgICAgICAgPT4gJE5vZGUtPntJRH0sCiAgICAgICAgICAgIE5hbWUgICAgICAgPT4gJE5vZGUtPntOYW1lfSwKICAgICAgICAgICAgRnVsbE5hbWUgICA9PiAkTm9kZS0+e0Z1bGxOYW1lfSwKICAgICAgICAgICAgQWNjZXNzaWJsZSA9PiAkTm9kZS0+e0FjY2Vzc2libGV9CiAgICAgICAgICB9OwogICAgfQoKICAgIGZvciBteSAkQ2hpbGQgKCBAeyAkTm9kZS0+e0NoaWxkc30gfSApIHsKICAgICAgICAkU2VsZi0+X1RyYXZlcnNlVHJlZSggJENoaWxkLCAkTmV3VHJlZSwgJFF1ZXVlQXJyICk7CiAgICB9Cn0KCjE7CgpfX0VORF9fCgo9aGVhZDEgTUVUSE9EUwoKPW92ZXIKCj1pdGVtIEdldFF1ZXVlTGlzdAoKR2V0IHF1ZXVlIGxpc3QgZm9yIGEgZGVmaW5lZCB1c2VyLgoKICAgIG15ICRRdWV1ZXNJbmZvID0gQVBJUXVldWVPYmplY3QtPkdldFF1ZXVlTGlzdCgKICAgICAgICBGb3JDcmVhdGVUaWNrZXQgPT4gMXwwICAgIyBvcHRpb25hbAogICAgICAgIFVzZXJJRCAgICAgICAgICA9PiAkVXNlcklECiAgICApOwoKSXQgcmV0dXJucyBRdWV1ZXMgZm9yIEdyb3VwcyB3aXRoIFJPIG9yIFJXIHBlcm1pc3Npb25zLgoKSWYgQzxGb3JDcmVhdGVUaWNrZXQ+IGlzIHBhc3NlZCB0aGVuIFF1ZXVlcyBmcm9tIEdyb3VwcyB3aXRoIENSRUFURQpwZXJtaXNzaW9uIGFsc28gd2lsbCBiZSByZXR1cm5lZC4KClJldHVybnM6CgogICAgewogICAgICAgICJRdWV1ZXMiOiBbewogICAgICAgICAgICAiSUQiOiA1LAogICAgICAgICAgICAiTmFtZSI6ICJNYW5hZ2VtZW50IFF1ZXVlIgogICAgICAgICAgICAiRnVsbE5hbWUiOiAiTWFuYWdlbWVudCBRdWV1ZSIKICAgICAgICB9XSwKICAgICAgICAiUXVldWVUcmVlIjogW3sKICAgICAgICAgICAgIklEIjogNSwKICAgICAgICAgICAgIkNoaWxkcyI6IFtdLAogICAgICAgICAgICAiTmFtZSI6ICJNYW5hZ2VtZW50IFF1ZXVlIiwKICAgICAgICAgICAgIkZ1bGxOYW1lIjogIk1hbmFnZW1lbnQgUXVldWUiCiAgICAgICAgfV0sCiAgICAgICAgUmVzcG9uc2UgID0+ICRSZXNwb25zZSwKICAgIH0KCj1iYWNrCg==</File>
        <File Location="Custom/Kernel/System/API/Setting.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QVBJOjpTZXR0aW5nOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwpubyB3YXJuaW5ncyAncmVkZWZpbmUnOwoKdXNlIHV0Zjg7Cgp1c2UgdmFycyBxdyhASVNBKTsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKCk7CgpzdWIgbmV3IHsKICAgIG15ICggJFR5cGUsICVQYXJhbSApID0gQF87CgogICAgbXkgJFNlbGYgPSB7fTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICAkU2VsZi0+e0RCT2JqZWN0fSAgID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkRCJyk7CiAgICAkU2VsZi0+e1V0aWxPYmplY3R9ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6VXRpbCcpOwoKICAgIHJldHVybiAkU2VsZjsKfQoKc3ViIEdldExhbmd1YWdlTGlzdCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwogICAgCiAgICBteSAkUmVzdWx0OwoKICAgIG15ICRDb25maWdPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpOwoKICAgIG15ICVEZWZhdWx0VXNlZExhbmd1YWdlcyA9ICV7ICRDb25maWdPYmplY3QtPkdldCgnRGVmYXVsdFVzZWRMYW5ndWFnZXMnKSB8fCB7fSB9OwogICAgbXkgJURlZmF1bHRVc2VkTGFuZ3VhZ2VzTmF0aXZlID0gJXsgJENvbmZpZ09iamVjdC0+R2V0KCdEZWZhdWx0VXNlZExhbmd1YWdlc05hdGl2ZScpIHx8IHt9IH07CgogICAgbXkgJUxhbmd1YWdlczsKICAgIExBTkdVQUdFSUQ6CiAgICBmb3IgbXkgJExhbmd1YWdlSUQgKCBzb3J0IGtleXMgJURlZmF1bHRVc2VkTGFuZ3VhZ2VzICkgewoKICAgICAgICAjIG5leHQgbGFuZ3VhZ2UgaWYgdGhlcmUgaXMgbm90IHNldCBhbnkgbmFtZSBmb3IgY3VycmVudCBsYW5ndWFnZQogICAgICAgIGlmICggISREZWZhdWx0VXNlZExhbmd1YWdlc3skTGFuZ3VhZ2VJRH0gJiYgISREZWZhdWx0VXNlZExhbmd1YWdlc05hdGl2ZXskTGFuZ3VhZ2VJRH0gKSB7CiAgICAgICAgICAgIG5leHQgTEFOR1VBR0VJRDsKICAgICAgICB9CgogICAgICAgICMgZ2V0IHRleHRzIGluIG5hdGl2ZSBhbmQgZGVmYXVsdCBsYW5ndWFnZQogICAgICAgIG15ICRUZXh0ICAgICAgICA9ICREZWZhdWx0VXNlZExhbmd1YWdlc05hdGl2ZXskTGFuZ3VhZ2VJRH0gfHwgJyc7CiAgICAgICAgbXkgJFRleHRFbmdsaXNoID0gJERlZmF1bHRVc2VkTGFuZ3VhZ2VzeyRMYW5ndWFnZUlEfSAgICAgICB8fCAnJzsKCiAgICAgICAgIyB0cmFuc2xhdGUgdG8gY3VycmVudCB1c2VyJ3MgbGFuZ3VhZ2UKICAgICAgICBteSAkVGV4dFRyYW5zbGF0ZWQgPQogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0JyktPntMYW5ndWFnZU9iamVjdH0tPlRyYW5zbGF0ZSgkVGV4dEVuZ2xpc2gpOwoKICAgICAgICBpZiAoICRUZXh0VHJhbnNsYXRlZCAmJiAkVGV4dFRyYW5zbGF0ZWQgbmUgJFRleHQgKSB7CiAgICAgICAgICAgICRUZXh0IC49ICcgLSAnIC4gJFRleHRUcmFuc2xhdGVkOwogICAgICAgIH0KCiAgICAgICAgIyBuZXh0IGxhbmd1YWdlIGlmIHRoZXJlIGlzIG5vdCBzZXQgRW5nbGlzaCBub3IgbmF0aXZlIG5hbWUgb2YgbGFuZ3VhZ2UuCiAgICAgICAgbmV4dCBMQU5HVUFHRUlEIGlmICEkVGV4dDsKCiAgICAgICAgJExhbmd1YWdlc3skTGFuZ3VhZ2VJRH0gPSAkVGV4dDsKICAgIH0gICAgICAgIAoKICAgIG15IEBMYW5ndWFnZXMgPSBtYXAgeyB7IElEID0+ICRfLCBOYW1lID0+ICRMYW5ndWFnZXN7JF99IH0gfSBrZXlzICVMYW5ndWFnZXM7CgogICAgJFJlc3VsdCA9IHsKICAgICAgICBSZXNwb25zZSAgPT4gIk9LIiwKICAgICAgICBMYW5ndWFnZXMgPT4gXEBMYW5ndWFnZXMKICAgIH07CgogICAgcmV0dXJuICRSZXN1bHQ7Cn0KCnN1YiBVcGRhdGVGYWlsZWROb3RpZmljYXRpb25Db3VudCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIHJldHVybiBpZiAhJFNlbGYtPntVdGlsT2JqZWN0fS0+SXNNb2JpbGVQYWNrYWdlSW5zdGFsbGVkOwoKICAgIG15ICRSb3dzID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkRCJyktPlNlbGVjdEFsbCgKICAgICAgICBTUUwgICA9PiBxcXsKICAgICAgICAgICAgU0VMRUNUIGZhaWxlZF9jb3VudCwgdG9rZW4sIGFkZGVkX2RhdGUsIHVzZXJfaWQKICAgICAgICAgICAgRlJPTSBSU191c2VyX3B1c2hfdG9rZW4KICAgICAgICAgICAgV0hFUkUgdG9rZW4gPSA/CiAgICAgICAgfSwKICAgICAgICBCaW5kICA9PiBbIFwkUGFyYW17VG9rZW59IF0sCiAgICAgICAgTGltaXQgPT4gMQogICAgKSAvLyBbXTsKCiAgICByZXR1cm4gdW5sZXNzIEB7ICRSb3dzIH07CgogICAgbXkgJEZhaWxlZENvdW50ID0gJFJvd3MtPlswXVswXTsKICAgICRGYWlsZWRDb3VudCsrOwoKICAgICMg0KLQvtC60LXQvSDRg9C20LUg0L3QtSDRgtC+0YDRggogICAgaWYgKCAkRmFpbGVkQ291bnQgPj0gMyApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6REInKS0+RG8oCiAgICAgICAgICAgIFNRTCAgPT4gcXF7CiAgICAgICAgICAgICAgICBERUxFVEUgRlJPTSBSU191c2VyX3B1c2hfdG9rZW4KICAgICAgICAgICAgICAgIFdIRVJFIHRva2VuID0gPwogICAgICAgICAgICB9LAogICAgICAgICAgICBCaW5kID0+IFsgXCRQYXJhbXtUb2tlbn0gXQogICAgICAgICk7CgogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiUHVzaFRva2VuICckUm93cy0+WzBdWzFdJywgIgogICAgICAgICAgICAgICAgLiJhZGRlZCAnJFJvd3MtPlswXVsyXScgZm9yIFVzZXJJRCAiCiAgICAgICAgICAgICAgICAuIickUm93cy0+WzBdWzNdJyB3YXMgcmVtb3ZlZCBhcyBpbnZhbGlkISIKICAgICAgICApOwoKICAgIH0gZWxzZSB7CgogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5EbygKICAgICAgICAgICAgU1FMICA9PiBxcXsKICAgICAgICAgICAgICAgIFVQREFURSBSU191c2VyX3B1c2hfdG9rZW4KICAgICAgICAgICAgICAgIFNFVCBmYWlsZWRfY291bnQgPSA/CiAgICAgICAgICAgICAgICBXSEVSRSB0b2tlbiA9ID8KICAgICAgICAgICAgfSwKICAgICAgICAgICAgQmluZCA9PiBbIFwkRmFpbGVkQ291bnQsIFwkUGFyYW17VG9rZW59IF0KICAgICAgICApOwogICAgfQoKICAgIHJldHVybjsKfQoKc3ViIFNldFB1c2hOb3RpZmljYXRpb25Ub2tlbiB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIGlmICggISRTZWxmLT57VXRpbE9iamVjdH0tPklzTW9iaWxlUGFja2FnZUluc3RhbGxlZCApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiUlM0T1RSU19Nb2JpbGUgcGFja2FnZSBtdXN0IGJlIGluc3RhbGxlZCEiCiAgICAgICAgfTsKICAgIH0KCiAgICBpZiAoICEkUGFyYW17VG9rZW59ICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJUb2tlbiBjYW5ub3QgYmUgZW1wdHkiCiAgICAgICAgfTsKICAgIH0KICAgIAogICAgJFNlbGYtPntEQk9iamVjdH0tPkRvKAogICAgICAgIFNRTCAgPT4gJ0RFTEVURSBGUk9NIFJTX3VzZXJfcHVzaF90b2tlbiBXSEVSRSB1c2VyX2lkID0gPycsCiAgICAgICAgQmluZCA9PiBbIFwkUGFyYW17VXNlcklEfSBdCiAgICApOwoKICAgICRTZWxmLT57REJPYmplY3R9LT5EbygKICAgICAgICBTUUwgPT4gcXF7CiAgICAgICAgICAgIElOU0VSVCBJTlRPIFJTX3VzZXJfcHVzaF90b2tlbiAodXNlcl9pZCwgdG9rZW4sIGFkZGVkX2RhdGUsIGFkZGVkX2J5KQogICAgICAgICAgICBWQUxVRVMgKD8sID8sIGN1cnJlbnRfdGltZXN0YW1wLCAxKQogICAgICAgIH0sCiAgICAgICAgQmluZCA9PiBbIFwkUGFyYW17VXNlcklEfSwgXCRQYXJhbXtUb2tlbn0gXQogICAgKTsKCiAgICByZXR1cm4gewogICAgICAgIFJlc3BvbnNlID0+ICJPSyIKICAgIH07Cn0KCjE7Cg==</File>
        <File Location="Custom/Kernel/System/API/Util.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QVBJOjpVdGlsOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwpubyB3YXJuaW5ncyAncmVkZWZpbmUnOwoKdXNlIHV0Zjg7Cgp1c2UgRGF0ZTo6UGFyc2U7Cgp1c2UgdmFycyBxdyhASVNBKTsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKCk7CgpzdWIgbmV3IHsKICAgIG15ICggJFR5cGUsICVQYXJhbSApID0gQF87CgogICAgbXkgJFNlbGYgPSB7fTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICAkU2VsZi0+e0xheW91dE9iamVjdH0gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0Jyk7CiAgICAkU2VsZi0+e0NvbmZpZ09iamVjdH0gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpOwoKICAgIHJldHVybiAkU2VsZjsKfQoKc3ViIENsZWFuSlNPTiB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRKU09OID0gJFNlbGYtPntMYXlvdXRPYmplY3R9LT5KU09ORW5jb2RlKCBEYXRhID0+ICRQYXJhbXsgRGF0YSB9KTsKICAgIG15ICROdW1iZXJGaWVsZHMgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpCiAgICAgIC0+R2V0KCdSUzo6QVBJOjpPYmplY3RUeXBlJyktPntOdW1iZXJ9OwoKICAgIG15ICROdW1zU3RyID0gam9pbiAnfCcsIEB7ICROdW1iZXJGaWVsZHMgfTsKCiAgICAkSlNPTiA9fiBzLygiKCROdW1zU3RyKSJccyo6XHMqKSIoXC0/XGQrXC4/XGQqKSIvJDEkMy94ZzsKCiAgICByZXR1cm4gJEpTT047Cn0KCiMg0J/QvtC70YPRh9C40YLRjCDRgtC+0LrQtdC9INC00LvRjyDQvtGC0L/RgNCw0LLQutC4INGD0LLQtdC00L7QvNC70LXQvdC40Lkg0L3QsCDQvNC+0LHQuNC70YzQvdC+0LUg0L/RgNC40LvQvtC20LXQvdC40LUKc3ViIEdldFVzZXJUb2tlbiB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIHJldHVybiB1bmxlc3MgZGVmaW5lZCAkUGFyYW17VXNlcklEfTsKCiAgICByZXR1cm4gaWYgISRTZWxmLT5Jc01vYmlsZVBhY2thZ2VJbnN0YWxsZWQ7CgogICAgbXkgJFRva2VuUm93cyA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5TZWxlY3RBbGwoCiAgICAgICAgU1FMID0+IHFxewogICAgICAgICAgICBTRUxFQ1QgdG9rZW4KICAgICAgICAgICAgRlJPTSBSU191c2VyX3B1c2hfdG9rZW4KICAgICAgICAgICAgV0hFUkUgdXNlcl9pZCA9ID8KICAgICAgICB9LAogICAgICAgIEJpbmQgPT4gWyBcJFBhcmFte1VzZXJJRH0gXQogICAgKSAvLyBbXTsKCiAgICBpZiAoIEB7ICRUb2tlblJvd3MgfSApIHsKICAgICAgICByZXR1cm4gJFRva2VuUm93cy0+WzBdWzBdOwogICAgfQoKICAgIHJldHVybjsKfQoKc3ViIElzTW9iaWxlUGFja2FnZUluc3RhbGxlZCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRDYWNoZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpOwoKICAgIG15ICRDYWNoZVJlc3VsdCA9ICRDYWNoZU9iamVjdC0+R2V0KAogICAgICAgIFR5cGUgPT4gJ01vYmlsZScsCiAgICAgICAgS2V5ICAgPT4gJ0lzTW9iaWxlUGFja2FnZUluc3RhbGxlZCcKICAgICk7CgogICAgcmV0dXJuICRDYWNoZVJlc3VsdCBpZiAkQ2FjaGVSZXN1bHQ7CgogICAgbXkgJElzSW5zdGFsbGVkID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlBhY2thZ2UnKS0+UGFja2FnZUlzSW5zdGFsbGVkKAogICAgICAgIE5hbWUgICA9PiAnUlM0T1RSU19Nb2JpbGUnCiAgICApOwoKICAgICRDYWNoZU9iamVjdC0+U2V0KAogICAgICAgIFR5cGUgID0+ICdNb2JpbGUnLAogICAgICAgIEtleSAgID0+ICdJc01vYmlsZVBhY2thZ2VJbnN0YWxsZWQnLAogICAgICAgIFZhbHVlID0+ICRJc0luc3RhbGxlZCwKICAgICAgICBUVEwgICA9PiA2MCAqIDYwICogMjQgKiAzMCwgIyAzMCDQtNC90LXQuQogICAgKTsKCiAgICByZXR1cm4gJElzSW5zdGFsbGVkOwp9CgpzdWIgSXNBZHZhbmNlZFRpY2tldFNlYXJjaEluc3RhbGxlZCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRDYWNoZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpOwoKICAgIG15ICRDYWNoZVJlc3VsdCA9ICRDYWNoZU9iamVjdC0+R2V0KAogICAgICAgIFR5cGUgPT4gJ0FQSScsCiAgICAgICAgS2V5ICAgPT4gJ0lzQWR2YW5jZWRUaWNrZXRTZWFyY2hJbnN0YWxsZWQnCiAgICApOwoKICAgIHJldHVybiAkQ2FjaGVSZXN1bHQgaWYgJENhY2hlUmVzdWx0OwoKICAgIG15IEBQYWNrYWdlTGlzdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpQYWNrYWdlJykKICAgICAgLT5SZXBvc2l0b3J5TGlzdCggUmVzdWx0ID0+ICdzaG9ydCcgKTsKCiAgICBteSAkSXNJbnN0YWxsZWQgPSAwOwogICAgZm9yIG15ICRQYWNrYWdlIChAUGFja2FnZUxpc3QpIHsKICAgICAgICBpZiAoICAgICRQYWNrYWdlLT57TmFtZX0gZXEgJ1JTNE9UUlNfQWR2YW5jZWRUaWNrZXRTZWFyY2gnCiAgICAgICAgICAgIGFuZCAkUGFja2FnZS0+e1N0YXR1c30gZXEgJ2luc3RhbGxlZCcKICAgICAgICAgICAgYW5kIHZlcnNpb24tPnBhcnNlKCAkUGFja2FnZS0+e1ZlcnNpb259ICkgPj0gdmVyc2lvbi0+cGFyc2UoJzYuMS4yNCcpICkKICAgICAgICB7CiAgICAgICAgICAgICRJc0luc3RhbGxlZCA9IDE7CiAgICAgICAgfQogICAgfQoKICAgICRDYWNoZU9iamVjdC0+U2V0KAogICAgICAgIFR5cGUgID0+ICdBUEknLAogICAgICAgIEtleSAgID0+ICdJc0FkdmFuY2VkVGlja2V0U2VhcmNoSW5zdGFsbGVkJywKICAgICAgICBWYWx1ZSA9PiAkSXNJbnN0YWxsZWQsCiAgICAgICAgVFRMICAgPT4gNjAgKiA2MCAqIDI0ICogMzAsICMgMzAg0LTQvdC10LkKICAgICk7CgogICAgcmV0dXJuICRJc0luc3RhbGxlZDsKfQoKMTsK</File>
        <File Location="Custom/Kernel/System/API/Service.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QVBJOjpTZXJ2aWNlOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwpubyB3YXJuaW5ncyAncmVkZWZpbmUnOwoKdXNlIHV0Zjg7Cgp1c2UgdmFycyBxdyhASVNBKTsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKCk7CgpzdWIgbmV3IHsKICAgIG15ICggJFR5cGUsICVQYXJhbSApID0gQF87CgogICAgbXkgJFNlbGYgPSB7fTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICByZXR1cm4gJFNlbGY7Cn0KCnN1YiBHZXRTZXJ2aWNlTGlzdCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwogICAgCiAgICBteSAkUmVzdWx0OwoKICAgIG15ICVTZXJ2aWNlTGlzdDsKCiAgICBteSBAU2VydmljZUFyciAgPSAoKTsKICAgIG15IEBTZXJ2aWNlVHJlZSA9ICgpOwoKICAgIGlmICggJFBhcmFteyBDdXN0b21lclVzZXJMb2dpbiB9ICkgewogICAgICAgIG15ICRUcmVlICAgICAgICA9IFtdOwogICAgICAgIG15ICVTZXJ2aWNlQ2hpbGRzID0gKCk7CgogICAgICAgIG15ICVTZXJ2aWNlcyA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTZXJ2aWNlJyktPlNlcnZpY2VMaXN0KAogICAgICAgICAgICBVc2VySUQgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICApOwoKICAgICAgICAlU2VydmljZUxpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U2VydmljZScpLT5DdXN0b21lclVzZXJTZXJ2aWNlTWVtYmVyTGlzdCgKICAgICAgICAgICAgQ3VzdG9tZXJVc2VyTG9naW4gPT4gJFBhcmFteyBDdXN0b21lclVzZXJMb2dpbiB9LAogICAgICAgICAgICBSZXN1bHQgICAgICAgICAgICA9PiAnSEFTSCcsCiAgICAgICAgICAgIERlZmF1bHRTZXJ2aWNlcyAgID0+IDEKICAgICAgICApOwoKICAgICAgICBteSAlU2VydmljZXNSZXZlcnNlID0gcmV2ZXJzZSAlU2VydmljZXM7CgogICAgICAgIGZvciBteSAkU2VydmljZSAoIHNvcnQga2V5cyAlU2VydmljZXNSZXZlcnNlICkgewogICAgICAgICAgICBteSBAU3ViU2VydmljZXMgPSBzcGxpdCAnOjonLCAkU2VydmljZTsKCiAgICAgICAgICAgIGlmICggQFN1YlNlcnZpY2VzID09IDEgKSB7CiAgICAgICAgICAgICAgICBwdXNoIEB7JFRyZWV9LAogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgTmFtZSAgICAgICA9PiAkU3ViU2VydmljZXNbLTFdLAogICAgICAgICAgICAgICAgICAgIEZ1bGxOYW1lICAgPT4gJFNlcnZpY2UsCiAgICAgICAgICAgICAgICAgICAgQ2hpbGRzICAgICA9PiBbXSwKICAgICAgICAgICAgICAgICAgICBJRCAgICAgICAgID0+ICRTZXJ2aWNlc1JldmVyc2V7JFNlcnZpY2V9LAogICAgICAgICAgICAgICAgICAgIEFjY2Vzc2libGUgPT4gJFNlcnZpY2VMaXN0eyAkU2VydmljZXNSZXZlcnNleyRTZXJ2aWNlfSB9ID8gMSA6IDAKICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAkU2VydmljZUNoaWxkc3skU2VydmljZX0gPSAkVHJlZS0+Wy0xXXtDaGlsZHN9OwogICAgICAgICAgICAgICAgbmV4dDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbXkgJFBhcmVudCA9IGpvaW4gJzo6JywgQFN1YlNlcnZpY2VzWyAwIC4uICQjU3ViU2VydmljZXMgLSAxIF07CiAgICAgICAgICAgIHB1c2ggQHsgJFNlcnZpY2VDaGlsZHN7JFBhcmVudH0gfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBOYW1lICAgICAgID0+ICRTdWJTZXJ2aWNlc1stMV0sCiAgICAgICAgICAgICAgICBGdWxsTmFtZSAgID0+ICRTZXJ2aWNlLAogICAgICAgICAgICAgICAgQ2hpbGRzICAgICA9PiBbXSwKICAgICAgICAgICAgICAgIElEICAgICAgICAgPT4gJFNlcnZpY2VzUmV2ZXJzZXskU2VydmljZX0sCiAgICAgICAgICAgICAgICBBY2Nlc3NpYmxlID0+ICRTZXJ2aWNlTGlzdHsgJFNlcnZpY2VzUmV2ZXJzZXskU2VydmljZX0gfSA/IDEgOiAwCiAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICRTZXJ2aWNlQ2hpbGRzeyRTZXJ2aWNlfSA9ICRTZXJ2aWNlQ2hpbGRzeyRQYXJlbnR9LT5bLTFde0NoaWxkc307CiAgICAgICAgfQoKICAgICAgICBmb3IgbXkgJE5vZGUgKCBAeyRUcmVlfSApIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6UXVldWUnKQogICAgICAgICAgICAgIC0+X1RyYXZlcnNlVHJlZSggJE5vZGUsIFxAU2VydmljZVRyZWUsIFxAU2VydmljZUFyciApOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgID0+ICJPSyIsCiAgICAgICAgICAgIFNlcnZpY2VzICAgID0+IFxAU2VydmljZUFyciwKICAgICAgICAgICAgU2VydmljZVRyZWUgPT4gXEBTZXJ2aWNlVHJlZQogICAgICAgIH07CgogICAgfSBlbHNlIHsKCiAgICAgICAgJVNlcnZpY2VMaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlNlcnZpY2UnKS0+U2VydmljZUxpc3QoCiAgICAgICAgICAgIFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICk7CiAgICB9CgogICAgbXkgQFNlcnZpY2VzID0gbWFwIHsKICAgICAgICB7IElEID0+ICRfLCBUaXRsZSA9PiAkU2VydmljZUxpc3R7JF99ICB9CiAgICB9IGtleXMgJVNlcnZpY2VMaXN0OwoKICAgICRSZXN1bHQgPSB7CiAgICAgICAgUmVzcG9uc2UgPT4gIk9LIiwKICAgICAgICBTZXJ2aWNlcyA9PiBcQFNlcnZpY2VzCiAgICB9OwoKICAgIHJldHVybiAkUmVzdWx0Owp9CgoxOwo=</File>
        <File Location="Custom/Kernel/System/API/Filter.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QVBJOjpGaWx0ZXI7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cm5vIHdhcm5pbmdzICdyZWRlZmluZSc7Cgp1c2UgdXRmODsKCnVzZSB2YXJzIHF3KEBJU0EpOwoKb3VyIEBPYmplY3REZXBlbmRlbmNpZXMgPSAoKTsKCnN1YiBuZXcgewogICAgbXkgKCAkVHlwZSwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkU2VsZiA9IHt9OwogICAgYmxlc3MoICRTZWxmLCAkVHlwZSApOwoKICAgICRTZWxmLT57Q29uZmlnT2JqZWN0fSA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyk7CiAgICAkU2VsZi0+e1RpY2tldE9iamVjdH0gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VGlja2V0Jyk7CgogICAgcmV0dXJuICRTZWxmOwp9CgpzdWIgR2V0VGlja2V0Vmlld3MgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkQ29uZmlnT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpDb25maWcnKTsKICAgIAogICAgbXkgJFJlc3VsdDsKCiAgICBteSAkRGVmYXVsdFN0YXRlID0gJENvbmZpZ09iamVjdC0+R2V0KCdSUzo6QVBJOjpEZWZhdWx0U3RhdGUnKSB8fCAnbmV3JzsKICAgICREZWZhdWx0U3RhdGUgPSAnX25vc3RhdGVfJyB1bmxlc3MgJFBhcmFte1F1ZXVlSUR9OyAjINGD0LbQtSDQvdC10L/QvtGB0YDQtdC00YHRgtCy0LXQvdC90L4g0LTQu9GPINGE0LjQu9GM0YLRgNCw0YbQuNC4CgogICAgbXkgJVJlc3RyaWN0ZWRfQWdlbnRNb2JpbGVUaWNrZXROb3RlX1N0YXRlcyAgID0gKCk7CiAgICBteSAlUmVzdHJpY3RlZF9BZ2VudE1vYmlsZU5ld1RpY2tldF9TdGF0ZXMgICAgPSAoKTsKICAgIG15ICVSZXN0cmljdGVkX0FnZW50TW9iaWxlVGlja2V0U3RhdHVzX1N0YXRlcyA9ICgpOwogICAgbXkgJVJlc3RyaWN0ZWRfQWdlbnRNb2JpbGVUaWNrZXRDbG9zZV9TdGF0ZXMgID0gKCk7CiAgICBteSAlUmVzdHJpY3RlZF9BZ2VudE1vYmlsZUVkaXRUaWNrZXRfU3RhdGVzICAgPSAoKTsKCiAgICBpZiAoICRQYXJhbXtRdWV1ZUlEfSApIHsKICAgICAgICBpZiAoCiAgICAgICAgICAgIGRlZmluZWQgJENvbmZpZ09iamVjdC0+R2V0KCJUaWNrZXQ6OkZyb250ZW5kOjpBZ2VudE1vYmlsZVRpY2tldE5vdGUiKQogICAgICAgICAgICAgIGFuZCByZWYgJENvbmZpZ09iamVjdC0+R2V0KCJUaWNrZXQ6OkZyb250ZW5kOjpBZ2VudE1vYmlsZVRpY2tldE5vdGUiKSBlcSAnSEFTSCcKICAgICAgICAgICAgICBhbmQgcmVmICRDb25maWdPYmplY3QtPkdldCgiVGlja2V0OjpGcm9udGVuZDo6QWdlbnRNb2JpbGVUaWNrZXROb3RlIiktPntTdGF0ZVR5cGV9IGVxICdBUlJBWScKICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgJVJlc3RyaWN0ZWRfQWdlbnRNb2JpbGVUaWNrZXROb3RlX1N0YXRlcyA9ICRTZWxmLT57VGlja2V0T2JqZWN0fS0+VGlja2V0U3RhdGVMaXN0KAogICAgICAgICAgICAgICAgQWN0aW9uICA9PiAnQWdlbnRNb2JpbGVUaWNrZXROb3RlJywKICAgICAgICAgICAgICAgIFF1ZXVlSUQgPT4gJFBhcmFte1F1ZXVlSUR9LAogICAgICAgICAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICApOwogICAgICAgICAgICAlUmVzdHJpY3RlZF9BZ2VudE1vYmlsZVRpY2tldE5vdGVfU3RhdGVzID0gcmV2ZXJzZSAlUmVzdHJpY3RlZF9BZ2VudE1vYmlsZVRpY2tldE5vdGVfU3RhdGVzOwogICAgICAgIH0KCiAgICAgICAgaWYgKAogICAgICAgICAgICBkZWZpbmVkICRDb25maWdPYmplY3QtPkdldCgiVGlja2V0OjpGcm9udGVuZDo6QWdlbnRNb2JpbGVOZXdUaWNrZXQiKQogICAgICAgICAgICAgIGFuZCByZWYgJENvbmZpZ09iamVjdC0+R2V0KCJUaWNrZXQ6OkZyb250ZW5kOjpBZ2VudE1vYmlsZU5ld1RpY2tldCIpIGVxICdIQVNIJwogICAgICAgICAgICAgIGFuZCByZWYgJENvbmZpZ09iamVjdC0+R2V0KCJUaWNrZXQ6OkZyb250ZW5kOjpBZ2VudE1vYmlsZU5ld1RpY2tldCIpLT57U3RhdGVUeXBlfSBlcSAnQVJSQVknCiAgICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgICVSZXN0cmljdGVkX0FnZW50TW9iaWxlTmV3VGlja2V0X1N0YXRlcyA9ICRTZWxmLT57VGlja2V0T2JqZWN0fS0+VGlja2V0U3RhdGVMaXN0KAogICAgICAgICAgICAgICAgQWN0aW9uICA9PiAnQWdlbnRNb2JpbGVOZXdUaWNrZXQnLAogICAgICAgICAgICAgICAgUXVldWVJRCA9PiAkUGFyYW17UXVldWVJRH0sCiAgICAgICAgICAgICAgICBVc2VySUQgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICk7CiAgICAgICAgICAgICVSZXN0cmljdGVkX0FnZW50TW9iaWxlTmV3VGlja2V0X1N0YXRlcyA9IHJldmVyc2UgJVJlc3RyaWN0ZWRfQWdlbnRNb2JpbGVOZXdUaWNrZXRfU3RhdGVzOwogICAgICAgIH0KCiAgICAgICAgaWYgKAogICAgICAgICAgICBkZWZpbmVkICRDb25maWdPYmplY3QtPkdldCgiVGlja2V0OjpGcm9udGVuZDo6QWdlbnRNb2JpbGVUaWNrZXRTdGF0dXMiKQogICAgICAgICAgICAgIGFuZCByZWYgJENvbmZpZ09iamVjdC0+R2V0KCJUaWNrZXQ6OkZyb250ZW5kOjpBZ2VudE1vYmlsZVRpY2tldFN0YXR1cyIpIGVxICdIQVNIJwogICAgICAgICAgICAgIGFuZCByZWYgJENvbmZpZ09iamVjdC0+R2V0KCJUaWNrZXQ6OkZyb250ZW5kOjpBZ2VudE1vYmlsZVRpY2tldFN0YXR1cyIpLT57U3RhdGVUeXBlfSBlcSAnQVJSQVknCiAgICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgICVSZXN0cmljdGVkX0FnZW50TW9iaWxlVGlja2V0U3RhdHVzX1N0YXRlcyA9ICRTZWxmLT57VGlja2V0T2JqZWN0fS0+VGlja2V0U3RhdGVMaXN0KAogICAgICAgICAgICAgICAgQWN0aW9uICA9PiAnQWdlbnRNb2JpbGVUaWNrZXRTdGF0dXMnLAogICAgICAgICAgICAgICAgUXVldWVJRCA9PiAkUGFyYW17UXVldWVJRH0sCiAgICAgICAgICAgICAgICBVc2VySUQgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICk7CiAgICAgICAgICAgICVSZXN0cmljdGVkX0FnZW50TW9iaWxlVGlja2V0U3RhdHVzX1N0YXRlcyA9IHJldmVyc2UgJVJlc3RyaWN0ZWRfQWdlbnRNb2JpbGVUaWNrZXRTdGF0dXNfU3RhdGVzOwogICAgICAgIH0KCiAgICAgICAgaWYgKAogICAgICAgICAgICBkZWZpbmVkICRDb25maWdPYmplY3QtPkdldCgiVGlja2V0OjpGcm9udGVuZDo6QWdlbnRNb2JpbGVUaWNrZXRDbG9zZSIpCiAgICAgICAgICAgICAgYW5kIHJlZiAkQ29uZmlnT2JqZWN0LT5HZXQoIlRpY2tldDo6RnJvbnRlbmQ6OkFnZW50TW9iaWxlVGlja2V0Q2xvc2UiKSBlcSAnSEFTSCcKICAgICAgICAgICAgICBhbmQgcmVmICRDb25maWdPYmplY3QtPkdldCgiVGlja2V0OjpGcm9udGVuZDo6QWdlbnRNb2JpbGVUaWNrZXRDbG9zZSIpLT57U3RhdGVUeXBlfSBlcSAnQVJSQVknCiAgICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgICVSZXN0cmljdGVkX0FnZW50TW9iaWxlVGlja2V0Q2xvc2VfU3RhdGVzID0gJFNlbGYtPntUaWNrZXRPYmplY3R9LT5UaWNrZXRTdGF0ZUxpc3QoCiAgICAgICAgICAgICAgICBBY3Rpb24gID0+ICdBZ2VudE1vYmlsZVRpY2tldENsb3NlJywKICAgICAgICAgICAgICAgIFF1ZXVlSUQgPT4gJFBhcmFte1F1ZXVlSUR9LAogICAgICAgICAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICApOwogICAgICAgICAgICAlUmVzdHJpY3RlZF9BZ2VudE1vYmlsZVRpY2tldENsb3NlX1N0YXRlcyA9IHJldmVyc2UgJVJlc3RyaWN0ZWRfQWdlbnRNb2JpbGVUaWNrZXRDbG9zZV9TdGF0ZXM7CiAgICAgICAgfQoKICAgICAgICBpZiAoCiAgICAgICAgICAgIGRlZmluZWQgJENvbmZpZ09iamVjdC0+R2V0KCJUaWNrZXQ6OkZyb250ZW5kOjpBZ2VudE1vYmlsZUVkaXRUaWNrZXQiKQogICAgICAgICAgICAgIGFuZCByZWYgJENvbmZpZ09iamVjdC0+R2V0KCJUaWNrZXQ6OkZyb250ZW5kOjpBZ2VudE1vYmlsZUVkaXRUaWNrZXQiKSBlcSAnSEFTSCcKICAgICAgICAgICAgICBhbmQgcmVmICRDb25maWdPYmplY3QtPkdldCgiVGlja2V0OjpGcm9udGVuZDo6QWdlbnRNb2JpbGVFZGl0VGlja2V0IiktPntTdGF0ZVR5cGV9IGVxICdBUlJBWScKICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgJVJlc3RyaWN0ZWRfQWdlbnRNb2JpbGVFZGl0VGlja2V0X1N0YXRlcyA9ICRTZWxmLT57VGlja2V0T2JqZWN0fS0+VGlja2V0U3RhdGVMaXN0KAogICAgICAgICAgICAgICAgQWN0aW9uICA9PiAnQWdlbnRNb2JpbGVFZGl0VGlja2V0JywKICAgICAgICAgICAgICAgIFF1ZXVlSUQgPT4gJFBhcmFte1F1ZXVlSUR9LAogICAgICAgICAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICApOwogICAgICAgICAgICAlUmVzdHJpY3RlZF9BZ2VudE1vYmlsZUVkaXRUaWNrZXRfU3RhdGVzID0gcmV2ZXJzZSAlUmVzdHJpY3RlZF9BZ2VudE1vYmlsZUVkaXRUaWNrZXRfU3RhdGVzOwogICAgICAgIH0KICAgIH0KCiAgICBteSAlUHJpb3JpdGllcyA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpQcmlvcml0eScpLT5Qcmlvcml0eUxpc3QoKTsgCiAgICBteSAlVHlwZXMgICAgICA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUeXBlJyktPlR5cGVMaXN0KCk7IAoKICAgIG15ICRTdGF0ZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTdGF0ZScpOwogICAgbXkgJVN0YXRlcyAgICAgPSAkU3RhdGVPYmplY3QtPlN0YXRlTGlzdCggVXNlcklEID0+ICRQYXJhbXtVc2VySUR9ICk7CgogICAgbXkgJVZpZXdhYmxlU3RhdGVMaXN0ID0gJFN0YXRlT2JqZWN0LT5TdGF0ZUdldFN0YXRlc0J5VHlwZSgKICAgICAgICBUeXBlICAgPT4gJ1ZpZXdhYmxlJywKICAgICAgICBSZXN1bHQgPT4gJ0hBU0gnCiAgICApOwoKICAgIG15ICRTdGF0ZVR5cGVSb3dzID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkRCJyktPlNlbGVjdEFsbCgKICAgICAgICBTUUwgPT4gcXF7CiAgICAgICAgICAgIFNFTEVDVCB0cy5pZCwgdHMubmFtZSwgdHMuY29tbWVudHMsIHR0Lm5hbWUsIHR0LmNvbW1lbnRzCiAgICAgICAgICAgIEZST00gdGlja2V0X3N0YXRlIHRzCiAgICAgICAgICAgIEpPSU4gdGlja2V0X3N0YXRlX3R5cGUgdHQKICAgICAgICAgICAgICAgIE9OIHRzLnR5cGVfaWQgPSB0dC5pZAogICAgICAgIH0sCiAgICAgICAgQmluZCA9PiBbXQogICAgKSAvLyBbXTsKCiAgICBteSAkU3RhdGVJbmZvSGFzaCA9IHt9OwogICAgZm9yIG15ICRSb3cgKCBAeyAkU3RhdGVUeXBlUm93cyB9ICkgewogICAgICAgICRTdGF0ZUluZm9IYXNoLT57ICRSb3ctPlswXSB9ID0gewogICAgICAgICAgICBTdGF0ZU5hbWUgICAgID0+ICRSb3ctPlsxXSwKICAgICAgICAgICAgU3RhdGVUeXBlTmFtZSA9PiAkUm93LT5bM10KICAgICAgICB9CiAgICB9CgogICAgbXkgJFByaW9yaXR5Q29sb3JzID0gJENvbmZpZ09iamVjdC0+R2V0KCdSUzo6TW9iaWxlOjpQcmlvcml0eTo6Q29sb3InKQogICAgICAvLyB7IERFRkFVTFQgPT4gJyNmZmZmZmYnIH07CiAgICBteSAkU3RhdGVDb2xvcnMgPSAkQ29uZmlnT2JqZWN0LT5HZXQoJ1JTOjpNb2JpbGU6OlN0YXRlOjpDb2xvcicpCiAgICAgIC8vIHsgREVGQVVMVCA9PiAnI2ZmZmZmZicgfTsKICAgIG15ICRUeXBlQ29sb3JzID0gJENvbmZpZ09iamVjdC0+R2V0KCdSUzo6TW9iaWxlOjpUeXBlOjpDb2xvcicpCiAgICAgIC8vIHsgREVGQVVMVCA9PiAnI2ZmZmZmZicgfTsKCiAgICBteSAkU3RhdGVCYWNrZ3JvdW5kQ29sb3JzID0KICAgICAgJENvbmZpZ09iamVjdC0+R2V0KCdSUzo6TW9iaWxlOjpTdGF0ZTo6QmFja2dyb3VuZENvbG9yJykKICAgICAgLy8geyBERUZBVUxUID0+ICcjZmZmZmZmJyB9OwogICAgbXkgJFR5cGVCYWNrZ3JvdW5kQ29sb3JzID0KICAgICAgJENvbmZpZ09iamVjdC0+R2V0KCdSUzo6TW9iaWxlOjpUeXBlOjpCYWNrZ3JvdW5kQ29sb3InKQogICAgICAvLyB7IERFRkFVTFQgPT4gJyNmZmZmZmYnIH07CgogICAgbXkgJFR5cGVBYmJyID0gJENvbmZpZ09iamVjdC0+R2V0KCdSUzo6TW9iaWxlOjpUeXBlOjpBYmJyJykgLy8ge307CgogICAgbXkgJEFnZW50VGlja2V0UGhvbmVDb25maWcgPSAkQ29uZmlnT2JqZWN0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+R2V0KCdUaWNrZXQ6OkZyb250ZW5kOjpBZ2VudFRpY2tldFBob25lJyk7CgogICAgbXkgJVByaW9yaXR5UmV2ZXJzZSA9IHJldmVyc2UgJVByaW9yaXRpZXM7CiAgICBteSBAUHJpb3JpdGllcyA9IG1hcCB7CiAgICAgICAgewogICAgICAgICAgICBJRCAgICA9PiAkUHJpb3JpdHlSZXZlcnNleyRffSwKICAgICAgICAgICAgTmFtZSAgPT4gJF8sCiAgICAgICAgICAgIENvbG9yID0+ICggJFByaW9yaXR5Q29sb3JzLT57ICRfIH0KICAgICAgICAgICAgICAgID8gJFByaW9yaXR5Q29sb3JzLT57ICRfIH0KICAgICAgICAgICAgICAgIDogJFByaW9yaXR5Q29sb3JzLT57IERFRkFVTFQgfSApLAogICAgICAgICAgICBEZWZhdWx0ID0+ICggJEFnZW50VGlja2V0UGhvbmVDb25maWctPntQcmlvcml0eX0gZXEgJF8gPyAxIDogMCApCiAgICAgICAgfQogICAgfSBzb3J0IHZhbHVlcyAlUHJpb3JpdGllczsKCiAgICBteSBAVHlwZXMgPSBtYXAgewogICAgICAgIHsKICAgICAgICAgICAgSUQgICAgPT4gJF8sCiAgICAgICAgICAgIE5hbWUgID0+ICRUeXBlc3sgJF8gfSwKCiAgICAgICAgICAgIEFiYnIgID0+ICggJFR5cGVBYmJyLT57ICRUeXBlc3sgJF8gfSB9CiAgICAgICAgICAgICAgICA/ICRUeXBlQWJici0+eyAkVHlwZXN7ICRfIH0gfQogICAgICAgICAgICAgICAgOiB1YyBzdWJzdHIoICggJFR5cGVzeyAkXyB9ID1+IHMvXHMrLy9nciApLCAwLCAzICkgKSwKCiAgICAgICAgICAgIENvbG9yID0+ICggJFR5cGVDb2xvcnMtPnsgJFR5cGVzeyAkXyB9IH0KICAgICAgICAgICAgICAgID8gJFR5cGVDb2xvcnMtPnsgJFR5cGVzeyAkXyB9IH0KICAgICAgICAgICAgICAgIDogJFR5cGVDb2xvcnMtPnsgREVGQVVMVCB9ICksCgogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3IgPT4gKCAkVHlwZUJhY2tncm91bmRDb2xvcnMtPnsgJFR5cGVzeyAkXyB9IH0KICAgICAgICAgICAgICAgID8gJFR5cGVCYWNrZ3JvdW5kQ29sb3JzLT57ICRUeXBlc3sgJF8gfSB9CiAgICAgICAgICAgICAgICA6ICRUeXBlQmFja2dyb3VuZENvbG9ycy0+eyBERUZBVUxUIH0gKQogICAgICAgIH0KICAgIH0ga2V5cyAlVHlwZXM7CgogICAgbXkgJVN0YXRlUmV2ZXJzZSA9IHJldmVyc2UgJVN0YXRlczsKICAgIG15IEBTdGF0ZXMgPSAoKTsKCiAgICBmb3IgbXkgJFN0YXRlTmFtZSAoIHNvcnQgdmFsdWVzICVTdGF0ZXMgKSB7CgogICAgICAgIG15ICVTY3JlZW5zOwoKICAgICAgICBpZiAoICRSZXN0cmljdGVkX0FnZW50TW9iaWxlVGlja2V0Tm90ZV9TdGF0ZXN7ICRTdGF0ZU5hbWUgfSBvciAkU3RhdGVOYW1lIGVxICREZWZhdWx0U3RhdGUgKSB7CiAgICAgICAgICAgICRTY3JlZW5ze0FnZW50TW9iaWxlVGlja2V0Tm90ZX0gPSAxOwogICAgICAgIH0KICAgICAgICBpZiAoICRSZXN0cmljdGVkX0FnZW50TW9iaWxlTmV3VGlja2V0X1N0YXRlc3sgJFN0YXRlTmFtZSB9ICkgewogICAgICAgICAgICAkU2NyZWVuc3tBZ2VudE1vYmlsZU5ld1RpY2tldH0gPSAxOwogICAgICAgIH0KICAgICAgICBpZiAoICRSZXN0cmljdGVkX0FnZW50TW9iaWxlVGlja2V0Q2xvc2VfU3RhdGVzeyAkU3RhdGVOYW1lIH0gKSB7CiAgICAgICAgICAgICRTY3JlZW5ze0FnZW50TW9iaWxlVGlja2V0Q2xvc2V9ID0gMTsKICAgICAgICB9CiAgICAgICAgaWYgKCAkUmVzdHJpY3RlZF9BZ2VudE1vYmlsZVRpY2tldFN0YXR1c19TdGF0ZXN7ICRTdGF0ZU5hbWUgfSApIHsKICAgICAgICAgICAgJFNjcmVlbnN7QWdlbnRNb2JpbGVUaWNrZXRTdGF0dXN9ID0gMTsKICAgICAgICB9CiAgICAgICAgaWYgKCAkUmVzdHJpY3RlZF9BZ2VudE1vYmlsZUVkaXRUaWNrZXRfU3RhdGVzeyAkU3RhdGVOYW1lIH0gKSB7CiAgICAgICAgICAgICRTY3JlZW5ze0FnZW50TW9iaWxlRWRpdFRpY2tldH0gPSAxOwogICAgICAgIH0KCiAgICAgICAgcHVzaCBAU3RhdGVzLCB7CiAgICAgICAgICAgIElEICAgID0+ICRTdGF0ZVJldmVyc2V7ICRTdGF0ZU5hbWUgfSwKICAgICAgICAgICAgTmFtZSAgPT4gJFN0YXRlTmFtZSwKICAgICAgICAgICAgRGVmYXVsdCA9PiAkU3RhdGVOYW1lIGVxICREZWZhdWx0U3RhdGUgPyAxIDogMCwKICAgICAgICAgICAgSXNWaXNpYmxlID0+ICggJFZpZXdhYmxlU3RhdGVMaXN0eyAkU3RhdGVSZXZlcnNleyAkU3RhdGVOYW1lIH0gfSA/IDEgOiAwICksICMgU3RhdGVUeXBlOiBPcGVuLCBDbG9zZWQKICAgICAgICAgICAgU3RhdGVUeXBlID0+ICRTdGF0ZUluZm9IYXNoLT57ICRTdGF0ZVJldmVyc2V7ICRTdGF0ZU5hbWUgfSB9LT57U3RhdGVUeXBlTmFtZX0sCiAgICAgICAgICAgIE9uVGlja2V0Q3JlYXRlU2NyZWVuID0+ICgKICAgICAgICAgICAgICAgICggJFJlc3RyaWN0ZWRfQWdlbnRNb2JpbGVUaWNrZXRTdGF0dXNfU3RhdGVzeyAkU3RhdGVOYW1lIH0gb3IgJFN0YXRlTmFtZSBlcSAkRGVmYXVsdFN0YXRlICkgPyAxIDogMAogICAgICAgICAgICApLAogICAgICAgICAgICBDb2xvciA9PiAoICRTdGF0ZUNvbG9ycy0+eyRTdGF0ZU5hbWV9CiAgICAgICAgICAgICAgICA/ICRTdGF0ZUNvbG9ycy0+eyRTdGF0ZU5hbWV9CiAgICAgICAgICAgICAgICA6ICRTdGF0ZUNvbG9ycy0+eyBERUZBVUxUIH0gKSwKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yID0+ICggJFN0YXRlQmFja2dyb3VuZENvbG9ycy0+eyRTdGF0ZU5hbWV9CiAgICAgICAgICAgICAgICA/ICRTdGF0ZUJhY2tncm91bmRDb2xvcnMtPnskU3RhdGVOYW1lfQogICAgICAgICAgICAgICAgOiAkU3RhdGVCYWNrZ3JvdW5kQ29sb3JzLT57IERFRkFVTFQgfSApLAogICAgICAgICAgICBTY3JlZW5zID0+IFwlU2NyZWVucwogICAgICAgIH07CiAgICB9CgogICAgbXkgJFBvc3NpYmxlUGFyYW1zID0gWwogICAgICAgIHsKICAgICAgICAgICAgTmFtZSAgICAgID0+ICJWaWV3IiwKICAgICAgICAgICAgRXhjbHVzaXZlID0+IDEsCiAgICAgICAgICAgIEl0ZW1zICAgICA9PiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIElEICAgICAgPT4gLTEsCiAgICAgICAgICAgICAgICAgIE5hbWUgICAgPT4gIkFzc2lnbmVkIHRvIG1lIiwKICAgICAgICAgICAgICAgICAgRGVmYXVsdCA9PiAxCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBJRCAgID0+IC0yLAogICAgICAgICAgICAgICAgICBOYW1lID0+ICJNeSBRdWV1ZXMiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBJRCAgID0+IC0zLAogICAgICAgICAgICAgICAgICBOYW1lID0+ICJPcGVuIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgSUQgICA9PiAtNCwKICAgICAgICAgICAgICAgICAgTmFtZSA9PiAiQ2xvc2VkIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgSUQgICA9PiAtNSwKICAgICAgICAgICAgICAgICAgTmFtZSA9PiAiTmV3IG5vdGVzIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgSUQgICA9PiAtNiwKICAgICAgICAgICAgICAgICAgTmFtZSA9PiAiTXkgbG9ja2VkIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgSUQgICA9PiAtNywKICAgICAgICAgICAgICAgICAgTmFtZSA9PiAiTXkgd2F0Y2hlZCIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBOYW1lICA9PiAnUHJpb3JpdHknLAogICAgICAgICAgICBJdGVtcyA9PiBcQFByaW9yaXRpZXMKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgTmFtZSAgPT4gJ1R5cGUnLAogICAgICAgICAgICBJdGVtcyA9PiBcQFR5cGVzCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIE5hbWUgID0+ICdTdGF0ZScsCiAgICAgICAgICAgIEl0ZW1zID0+IFxAU3RhdGVzCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBOYW1lICAgICAgPT4gIlNvcnQiLAogICAgICAgICAgRXhjbHVzaXZlID0+IDEsCiAgICAgICAgICBJdGVtcyA9PiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBWYWx1ZSA9PiAiRXNjYWxhdGlvblNvbHV0aW9uVGltZSIsCiAgICAgICAgICAgICAgTmFtZSAgPT4gIkJ5IHRpbWUgdG8gZG9uZSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIFZhbHVlID0+ICJBZ2UiLAogICAgICAgICAgICAgIE5hbWUgID0+ICJCeSBjcmVhdGluZyBkYXRlIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgVmFsdWUgPT4gIlByaW9yaXR5IiwKICAgICAgICAgICAgICBOYW1lICA9PiAiQnkgcHJpb3JpdHkiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBWYWx1ZSA9PiAiQ2hhbmdlZCIsCiAgICAgICAgICAgICAgTmFtZSAgPT4gIkJ5IGxhc3QgdXBkYXRlIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfQogICAgXTsKCgogICAgaWYgKCAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TWFpbicpCiAgICAgICAgICAgLT5SZXF1aXJlKCJLZXJuZWw6OlN5c3RlbTo6VGlja2V0Vmlld3MiLCBTaWxlbnQgPT4gMSkgKSB7CgogICAgICAgIG15ICRUaWNrZXRWaWV3c0xpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VGlja2V0Vmlld3MnKS0+VGlja2V0Vmlld3NMaXN0KAogICAgICAgICAgICBVc2VySUQgID0+ICRQYXJhbXtVc2VySUR9LAogICAgICAgICAgICBWYWxpZElEID0+IDEKICAgICAgICApOwoKICAgICAgICBmb3IgKCBrZXlzICV7ICRUaWNrZXRWaWV3c0xpc3QgfSApIHsKICAgICAgICAgICAgcHVzaCBAeyAkUG9zc2libGVQYXJhbXMtPlswXXtJdGVtc30gfSwgewogICAgICAgICAgICAgICAgSUQgICA9PiAkVGlja2V0Vmlld3NMaXN0LT57JF99LT57SUR9LAogICAgICAgICAgICAgICAgTmFtZSA9PiAkVGlja2V0Vmlld3NMaXN0LT57JF99LT57VGl0bGV9CiAgICAgICAgICAgIH0gCiAgICAgICAgfQogICAgfQoKICAgICRSZXN1bHQgPSB7CiAgICAgICAgUmVzcG9uc2UgPT4gIk9LIiwKICAgICAgICBHcm91cHMgICA9PiAkUG9zc2libGVQYXJhbXMKICAgIH07CgogICAgcmV0dXJuICRSZXN1bHQ7Cn0KCjE7Cg==</File>
        <File Location="Custom/Kernel/System/API/SLA.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QVBJOjpTTEE7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cm5vIHdhcm5pbmdzICdyZWRlZmluZSc7Cgp1c2UgdXRmODsKCnVzZSB2YXJzIHF3KEBJU0EpOwoKb3VyIEBPYmplY3REZXBlbmRlbmNpZXMgPSAoKTsKCnN1YiBuZXcgewogICAgbXkgKCAkVHlwZSwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkU2VsZiA9IHt9OwogICAgYmxlc3MoICRTZWxmLCAkVHlwZSApOwoKICAgIHJldHVybiAkU2VsZjsKfQoKc3ViIEdldFNMQUxpc3QgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKICAgIAogICAgbXkgJFJlc3VsdDsKCiAgICBteSAlU0xBTGlzdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTTEEnKS0+U0xBTGlzdCgKICAgICAgICAoICRQYXJhbXsgU2VydmljZUlEIH0gPwogICAgICAgICAgICAoIFNlcnZpY2VJRCA9PiAkUGFyYW17IFNlcnZpY2VJRCB9ICkgOiAoKSApLAogICAgICAgIFVzZXJJRCAgICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBteSBAU0xBTGlzdCA9IG1hcCB7CiAgICAgICAgeyBJRCA9PiAkXywgVGl0bGUgPT4gJFNMQUxpc3R7JF99ICB9CiAgICB9IGtleXMgJVNMQUxpc3Q7CgogICAgJFJlc3VsdCA9IHsKICAgICAgICBSZXNwb25zZSA9PiAiT0siLAogICAgICAgIFNMQUxpc3QgID0+IFxAU0xBTGlzdAogICAgfTsKCiAgICByZXR1cm4gJFJlc3VsdDsKfQoKMTsK</File>
        <File Location="Custom/Kernel/System/API/System.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QVBJOjpTeXN0ZW07Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cm5vIHdhcm5pbmdzICdyZWRlZmluZSc7Cgp1c2UgdXRmODsKCnVzZSB2YXJzIHF3KEBJU0EpOwoKb3VyIEBPYmplY3REZXBlbmRlbmNpZXMgPSAoKTsKCnN1YiBuZXcgewogICAgbXkgKCAkVHlwZSwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkU2VsZiA9IHt9OwogICAgYmxlc3MoICRTZWxmLCAkVHlwZSApOwoKICAgICRTZWxmLT57REJPYmplY3R9ICAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6REInKTsKICAgICRTZWxmLT57REZPYmplY3R9ICAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6RHluYW1pY0ZpZWxkJyk7CiAgICAkU2VsZi0+e1V0aWxPYmplY3R9ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6VXRpbCcpOwoKICAgIHJldHVybiAkU2VsZjsKfQoKc3ViIEdldFBhY2thZ2VMaXN0IHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJENvbmZpZ09iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyk7CiAgICBteSBAUGFja2FnZXMgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6UGFja2FnZScpLT5SZXBvc2l0b3J5TGlzdCgKICAgICAgICBSZXN1bHQgPT4gJ1Nob3J0JwogICAgKTsKCiAgICBteSBAUmVzdWx0ID0gKCk7CiAgICBmb3IgbXkgJFBhY2thZ2UgKCBAUGFja2FnZXMgKSB7CiAgICAgICAgaWYgKCAkUGFja2FnZS0+e05hbWV9ID1+IC9eUlM0T1RSU18oQVBJfE1vYmlsZSkkL3ggKSB7CiAgICAgICAgICAgIGRlbGV0ZSAkUGFja2FnZS0+e01ENXN1bX07CiAgICAgICAgICAgIGRlbGV0ZSAkUGFja2FnZS0+e1N0YXR1c307CiAgICAgICAgICAgIGRlbGV0ZSAkUGFja2FnZS0+e1ZlbmRvcn07CgogICAgICAgICAgICBwdXNoIEBSZXN1bHQsICRQYWNrYWdlOwogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gewogICAgICAgIFJlc3BvbnNlID0+ICJPSyIsCiAgICAgICAgUGFja2FnZXMgPT4gXEBSZXN1bHQKICAgIH07Cn0KCnN1YiBHZXREeW5hbWljRmllbGRMaXN0IHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJFNjcmVlbkR5bmFtaWNGaWVsZHMgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpCiAgICAgICAgICAgICAgICAgICAgIC0+R2V0KCJSUzpBUEk6OlRpY2tldDo6TW9iaWxlU2NyZWVuOjpEeW5hbWljRmllbGRzIik7CgogICAgbXkgJExpc3QgPSAkU2VsZi0+e0RGT2JqZWN0fS0+RHluYW1pY0ZpZWxkTGlzdEdldCgpOwoKICAgIG15ICVSZXN1bHQgPSAoKTsKICAgIGZvciBteSAkRmllbGQgKCBAeyRMaXN0fSApIHsKCiAgICAgICAgbXkgJVNjcmVlbnMgPSAoKTsKICAgICAgICBmb3IgbXkgJFNjcmVlbiAoIHNvcnQga2V5cyAleyRTY3JlZW5EeW5hbWljRmllbGRzfSApIHsKICAgICAgICAgICAgaWYgKCBleGlzdHMgJFNjcmVlbkR5bmFtaWNGaWVsZHMtPnskU2NyZWVufXskRmllbGQtPntOYW1lfX0gKSB7CiAgICAgICAgICAgICAgICAkU2NyZWVuc3skU2NyZWVufSA9CiAgICAgICAgICAgICAgICAgICRTY3JlZW5EeW5hbWljRmllbGRzLT57JFNjcmVlbn17JEZpZWxkLT57TmFtZX19OwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwdXNoIEB7ICRSZXN1bHR7ICRGaWVsZC0+e09iamVjdFR5cGV9IH0gfSwKICAgICAgICAgIHsKICAgICAgICAgICAgSUQgICAgICAgICA9PiAkRmllbGQtPntJRH0sCiAgICAgICAgICAgIE5hbWUgICAgICAgPT4gJEZpZWxkLT57TmFtZX0sCiAgICAgICAgICAgIExhYmVsICAgICAgPT4gJEZpZWxkLT57TGFiZWx9LAogICAgICAgICAgICBGaWVsZFR5cGUgID0+ICRGaWVsZC0+e0ZpZWxkVHlwZX0sCiAgICAgICAgICAgIE9iamVjdFR5cGUgPT4gJEZpZWxkLT57T2JqZWN0VHlwZX0sCiAgICAgICAgICAgIFNjcmVlbnMgICAgPT4gXCVTY3JlZW5zLAogICAgICAgICAgICBDb25maWcgICAgID0+IHsKICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAkRmllbGQtPntDb25maWd9e1Bvc3NpYmxlVmFsdWVzfQogICAgICAgICAgICAgICAgICAgID8gKCBQb3NzaWJsZVZhbHVlcyA9PiAkRmllbGQtPntDb25maWd9e1Bvc3NpYmxlVmFsdWVzfSApCiAgICAgICAgICAgICAgICAgICAgOiAoKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgfQoKICAgIHJldHVybiB7CiAgICAgICAgUmVzcG9uc2UgICAgICA9PiAiT0siLAogICAgICAgIER5bmFtaWNGaWVsZHMgPT4gXCVSZXN1bHQKICAgIH07Cn0KCjE7Cg==</File>
        <File Location="Custom/Kernel/System/API/Customer.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QVBJOjpDdXN0b21lcjsKCnVzZSBzdHJpY3Q7CnVzZSB3YXJuaW5nczsKbm8gd2FybmluZ3MgJ3JlZGVmaW5lJzsKCnVzZSB1dGY4OwoKdXNlIERhdGU6OlBhcnNlOwoKdXNlIHZhcnMgcXcoQElTQSk7CgpvdXIgQE9iamVjdERlcGVuZGVuY2llcyA9ICgpOwoKc3ViIG5ldyB7CiAgICBteSAoICRUeXBlLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRTZWxmID0ge307CiAgICBibGVzcyggJFNlbGYsICRUeXBlICk7CgogICAgJFNlbGYtPntUaWNrZXRPYmplY3R9ICAgICAgICA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUaWNrZXQnKTsKICAgICRTZWxmLT57Q3VzdG9tZXJVc2VyT2JqZWN0fSAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q3VzdG9tZXJVc2VyJyk7CgogICAgcmV0dXJuICRTZWxmOwp9CgpzdWIgR2V0Q3VzdG9tZXJVc2VyTGlzdCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRTZWFyY2ggICAgICAgICAgID0gJFBhcmFte1NlYXJjaH07CiAgICBteSAkVXNlckxvZ2luICAgICAgICA9ICRQYXJhbXtMb2dpbn07CiAgICBteSAkUG9zdE1hc3RlclNlYXJjaCA9ICRQYXJhbXtFbWFpbH07CiAgICBteSAkQ3VzdG9tZXJJRCAgICAgICA9ICRQYXJhbXtDdXN0b21lcklEfTsKCiAgICBteSAlU2VhcmNoUGFyYW0gPSAoCiAgICAgICAgKCAkUGFyYW17U2VhcmNofSA/ICggU2VhcmNoICAgICAgICAgICA9PiAiKiRQYXJhbXtTZWFyY2h9KiIgKSA6ICgpICksCiAgICAgICAgKCAkUGFyYW17TG9naW59ICA/ICggVXNlckxvZ2luICAgICAgICA9PiAiKiRQYXJhbXtMb2dpbn0qIiApICA6ICgpICksCiAgICAgICAgKCAkUGFyYW17RW1haWx9ICA/ICggUG9zdE1hc3RlclNlYXJjaCA9PiAiJFBhcmFte0VtYWlsfSIgKSAgOiAoKSApLAogICAgICAgICggJFBhcmFte0N1c3RvbWVySUR9ID8gKCBDdXN0b21lcklEID0+ICIkUGFyYW17Q3VzdG9tZXJJRH0iICkgOiAoKSApLAogICAgICAgICggJFBhcmFte0xpbWl0fSA/ICggTGltaXQgICAgICAgICAgID0+ICRQYXJhbXtMaW1pdH0gKSA6ICgpICkKICAgICk7CgogICAgbXkgJFJlc3VsdDsKICAgIG15ICRDdXN0b21lclVzZXJPYmplY3QgPSAkU2VsZi0+e0N1c3RvbWVyVXNlck9iamVjdH07CgogICAgbXkgQEN1c3RvbWVyVXNlcnMgPSAoKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCiAgICBteSAlQ3VzdG9tZXJVc2VyTGlzdCA9ICRDdXN0b21lclVzZXJPYmplY3QtPkN1c3RvbWVyU2VhcmNoKAogICAgICAgICggJVNlYXJjaFBhcmFtID8gKCVTZWFyY2hQYXJhbSkgOiAoIFNlYXJjaCA9PiAnKicsIExpbWl0ID0+IDEwMCApICkgKTsKCiAgICBmb3IgbXkgJEN1c3RvbWVyVXNlckxvZ2luICgga2V5cyAlQ3VzdG9tZXJVc2VyTGlzdCApIHsKICAgICAgICBteSAlQ3VzdG9tZXJVc2VyID0gJEN1c3RvbWVyVXNlck9iamVjdC0+Q3VzdG9tZXJVc2VyRGF0YUdldCgKICAgICAgICAgICAgVXNlciA9PiAkQ3VzdG9tZXJVc2VyTG9naW4KICAgICAgICApOwoKICAgICAgICBwdXNoIEBDdXN0b21lclVzZXJzLAogICAgICAgICAgewogICAgICAgICAgICBDdXN0b21lcklEICAgPT4gJEN1c3RvbWVyVXNlcntVc2VyQ3VzdG9tZXJJRH0gfHwgdW5kZWYsCiAgICAgICAgICAgIEVtYWlsICAgICAgICA9PiAkQ3VzdG9tZXJVc2Vye1VzZXJFbWFpbH0gICAgICB8fCB1bmRlZiwKICAgICAgICAgICAgTG9naW4gICAgICAgID0+ICRDdXN0b21lclVzZXJ7VXNlckxvZ2lufSAgICAgIHx8IHVuZGVmLAogICAgICAgICAgICBGaXJzdG5hbWUgICAgPT4gJEN1c3RvbWVyVXNlcntVc2VyRmlyc3RuYW1lfSAgfHwgJ05vdCBkZWZpbmVkJywKICAgICAgICAgICAgTGFzdG5hbWUgICAgID0+ICRDdXN0b21lclVzZXJ7VXNlckxhc3RuYW1lfSAgIHx8ICdOb3QgZGVmaW5lZCcsCiAgICAgICAgICAgIEF2YXRhciA9PgoiaHR0cDovL3d3dy5zZy13ZWJzLmNvbS93cC1jb250ZW50L3VwbG9hZHMvMjAxNC8xMi9Sb2JlcnQtTW9ycmlzLUNpcmNsZS5wbmciCiAgICAgICAgICB9CiAgICB9CgogICAgJFJlc3VsdCA9IHsKICAgICAgICBSZXNwb25zZSAgICAgID0+ICJPSyIsCiAgICAgICAgQ3VzdG9tZXJVc2VycyA9PiBcQEN1c3RvbWVyVXNlcnMKICAgIH07CgogICAgcmV0dXJuICRSZXN1bHQ7Cn0KCnN1YiBHZXRDdXN0b21lckxpc3QgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkUmVzdWx0OwogICAgbXkgJUN1c3RvbWVyQ29tcGFueUxpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q3VzdG9tZXJDb21wYW55JykKICAgICAgICAgICAgICAgICAgICAgICAtPkN1c3RvbWVyQ29tcGFueUxpc3QoKTsKCiAgICBteSBAQ3VzdG9tZXJDb21wYW5pZXMgPSBtYXAgewogICAgICAgIHsKICAgICAgICAgICAgQ3VzdG9tZXJJRCA9PiAkXywKICAgICAgICAgICAgTmFtZSAgICAgICA9PiAkQ3VzdG9tZXJDb21wYW55TGlzdHskX30sCiAgICAgICAgfQogICAgfSBrZXlzICVDdXN0b21lckNvbXBhbnlMaXN0OwoKICAgICRSZXN1bHQgPSB7CiAgICAgICAgUmVzcG9uc2UgPT4gIk9LIiwKICAgICAgICBDdXN0b21lckNvbXBhbmllcyA9PiBcQEN1c3RvbWVyQ29tcGFuaWVzCiAgICB9OwoKICAgIHJldHVybiAkUmVzdWx0Owp9CgpzdWIgR2V0Q3VzdG9tZXJVc2VyIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJEN1c3RvbWVyVXNlck9iamVjdCA9ICRTZWxmLT57Q3VzdG9tZXJVc2VyT2JqZWN0fTsKCiAgICBpZiAoICEkUGFyYW17Q3VzdG9tZXJVc2VyfSApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiTm8gQ3VzdG9tZXJVc2VyIHBhcmFtZXRlciIKICAgICAgICB9OwogICAgfQoKICAgIG15ICVVc2VyID0gJEN1c3RvbWVyVXNlck9iamVjdC0+Q3VzdG9tZXJVc2VyRGF0YUdldCgKICAgICAgICBVc2VyID0+ICRQYXJhbXtDdXN0b21lclVzZXJ9LAogICAgKTsKCiAgICBpZiAoICElVXNlciApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiTm8gQ3VzdG9tZXJVc2VyIgogICAgICAgIH07CiAgICB9CgogICAgbXkgJVJlc3VsdFVzZXIgPSAoKTsKICAgIGZvciAocXcvCiAgICAgICAgVXNlckZpcnN0bmFtZQogICAgICAgIFVzZXJMYXN0bmFtZQogICAgICAgIFVzZXJDdXN0b21lcklECiAgICAgICAgVXNlckxvZ2luCiAgICAgICAgVXNlckVtYWlsCiAgICAgICAgVXNlckNvdW50cnkKICAgICAgICBVc2VyQ2l0eQogICAgICAgIFVzZXJTdHJlZXQKICAgICAgICBVc2VyWmlwCiAgICAgICAgVXNlclBob25lCiAgICAgICAgVXNlck1vYmlsZQogICAgICAgIFVzZXJGYXgKICAgICAgICBVc2VyVGl0bGUKICAgICAgICBVc2VyQ29tbWVudAogICAgICAgIFZhbGlkSUQKICAgICAgICAvKSB7CgogICAgICAgJFJlc3VsdFVzZXJ7JF99ID0gJFVzZXJ7JF99IHx8IHVuZGVmOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgICAgUmVzcG9uc2UgPT4gIk9LIiwKICAgICAgICAlUmVzdWx0VXNlcgogICAgfTsKfQoKc3ViIENyZWF0ZUN1c3RvbWVyVXNlciB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRSZXN1bHQ7CiAgICBteSAkQ3VzdG9tZXJVc2VyT2JqZWN0ID0gJFNlbGYtPntDdXN0b21lclVzZXJPYmplY3R9OwoKICAgICMg0J7QsdGP0LfQsNGC0LXQu9GM0L3Ri9C1CiAgICBteSBARmFpbGVkUmVxdWlyZWRQYXJhbXMgPSAoKTsKICAgIGZvciAoIHF3LyBGaXJzdG5hbWUgTGFzdG5hbWUgQ3VzdG9tZXJJRCBMb2dpbiBFbWFpbCAvICkgewogICAgICAgIGlmICggISRQYXJhbXskX30gKSB7CiAgICAgICAgICAgIHB1c2ggQEZhaWxlZFJlcXVpcmVkUGFyYW1zLCAkXzsgCiAgICAgICAgfSAgICAgICAgICAgIAogICAgfQoKICAgIGlmICggIUBGYWlsZWRSZXF1aXJlZFBhcmFtcyApIHsKCiAgICAgICAgbXkgJFVzZXJMb2dpbiA9ICRDdXN0b21lclVzZXJPYmplY3QtPkN1c3RvbWVyVXNlckFkZCgKICAgICAgICAgICAgU291cmNlICAgICAgICAgPT4gJ0N1c3RvbWVyVXNlcicsICMgQ3VzdG9tZXJVc2VyIHNvdXJjZSBjb25maWcKICAgICAgICAgICAgVXNlckZpcnN0bmFtZSAgPT4gJFBhcmFte0ZpcnN0bmFtZX0sCiAgICAgICAgICAgIFVzZXJMYXN0bmFtZSAgID0+ICRQYXJhbXtMYXN0bmFtZX0sCiAgICAgICAgICAgIFVzZXJDdXN0b21lcklEID0+ICRQYXJhbXtDdXN0b21lcklEfSwKICAgICAgICAgICAgVXNlckxvZ2luICAgICAgPT4gJFBhcmFte0xvZ2lufSwKICAgICAgICAgICAgKCAkUGFyYW17UGFzc3dvcmR9ID8KICAgICAgICAgICAgICAgICggVXNlclBhc3N3b3JkID0+ICRQYXJhbXtQYXNzd29yZH0gKSA6ICgpICksCiAgICAgICAgICAgIFVzZXJFbWFpbCAgICAgID0+ICRQYXJhbXtFbWFpbH0sCgogICAgICAgICAgICAoICRQYXJhbXtDb3VudHJ5fSA/CiAgICAgICAgICAgICAgICAoIFVzZXJDb3VudHJ5ID0+ICRQYXJhbXtDb3VudHJ5fSApIDogKCkgKSwKICAgICAgICAgICAgKCAkUGFyYW17Q2l0eX0gPwogICAgICAgICAgICAgICAgKCBVc2VyQ2l0eSA9PiAkUGFyYW17Q2l0eX0gKSA6ICgpICksCiAgICAgICAgICAgICggJFBhcmFte1N0cmVldH0gPwogICAgICAgICAgICAgICAgKCBVc2VyU3RyZWV0ID0+ICRQYXJhbXtTdHJlZXR9ICkgOiAoKSApLAogICAgICAgICAgICAoICRQYXJhbXtaaXB9ID8KICAgICAgICAgICAgICAgICggVXNlclppcCA9PiAkUGFyYW17WmlwfSApIDogKCkgKSwKICAgICAgICAgICAgKCAkUGFyYW17UGhvbmV9ID8KICAgICAgICAgICAgICAgICggVXNlclBob25lID0+ICRQYXJhbXtQaG9uZX0gKSA6ICgpICksCiAgICAgICAgICAgICggJFBhcmFte01vYmlsZX0gPwogICAgICAgICAgICAgICAgKCBVc2VyTW9iaWxlID0+ICRQYXJhbXtNb2JpbGV9ICkgOiAoKSApLAogICAgICAgICAgICAoICRQYXJhbXtGYXh9ID8KICAgICAgICAgICAgICAgICggVXNlckZheCA9PiAkUGFyYW17RmF4fSApIDogKCkgKSwKCiAgICAgICAgICAgICggJFBhcmFte1RpdGxlfSA/CiAgICAgICAgICAgICAgICAoIFVzZXJUaXRsZSA9PiAkUGFyYW17VGl0bGV9ICkgOiAoKSApLAogICAgICAgICAgICAoICRQYXJhbXtDb21tZW50fSA/CiAgICAgICAgICAgICAgICAoIFVzZXJDb21tZW50ID0+ICRQYXJhbXtDb21tZW50fSApIDogKCkgKSwKCiAgICAgICAgICAgIFZhbGlkSUQgPT4gMSwKICAgICAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICk7CgogICAgICAgIGlmICggJFVzZXJMb2dpbiApIHsKCiAgICAgICAgICAgIGlmICggJFBhcmFte0ludGVyZmFjZUxhbmd1YWdlfSApIHsKICAgICAgICAgICAgICAgICRDdXN0b21lclVzZXJPYmplY3QtPlNldFByZWZlcmVuY2VzKAogICAgICAgICAgICAgICAgICAgIEtleSAgICA9PiAnVXNlckxhbmd1YWdlJywKICAgICAgICAgICAgICAgICAgICBWYWx1ZSAgPT4gJFBhcmFte0ludGVyZmFjZUxhbmd1YWdlfSwKICAgICAgICAgICAgICAgICAgICBVc2VySUQgPT4gJFVzZXJMb2dpbgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJFJlc3VsdCA9IHsgUmVzcG9uc2UgPT4gIk9LIiB9OwoKICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiQ291bGRuJ3QgY3JlYXRlIGN1c3RvbWVyIHVzZXIiCiAgICAgICAgICAgIH07CiAgICAgICAgfQoKICAgIH0gZWxzZSB7CgogICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJSZXF1aXJlZCBmaWVsZHMgaXMgbm90IGRlZmluZWQ6ICIKICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oIiwgIiwgQEZhaWxlZFJlcXVpcmVkUGFyYW1zICkgCiAgICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gJFJlc3VsdDsKfQoKMTsK</File>
        <File Location="Custom/Kernel/System/API/Ticket.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QVBJOjpUaWNrZXQ7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cm5vIHdhcm5pbmdzICdyZWRlZmluZSc7Cgp1c2UgdXRmODsKCnVzZSBEYXRlOjpQYXJzZTsKdXNlIFBPU0lYIHF3L3N0cmZ0aW1lLzsKdXNlIE1JTUU6OkJhc2U2NCBxdy9kZWNvZGVfYmFzZTY0LzsKCnVzZSB2YXJzIHF3KEBJU0EpOwoKb3VyIEBPYmplY3REZXBlbmRlbmNpZXMgPSAoKTsKCnN1YiBuZXcgewogICAgbXkgKCAkVHlwZSwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkU2VsZiA9IHt9OwogICAgYmxlc3MoICRTZWxmLCAkVHlwZSApOwoKICAgICRTZWxmLT57VGlja2V0T2JqZWN0fSAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VGlja2V0Jyk7CiAgICAkU2VsZi0+e0dyb3VwT2JqZWN0fSAgID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06Okdyb3VwJyk7CiAgICAkU2VsZi0+e1V0aWxPYmplY3R9ICAgID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkFQSTo6VXRpbCcpOwogICAgJFNlbGYtPntBcnRpY2xlT2JqZWN0fSA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUaWNrZXQ6OkFydGljbGUnKTsKCiAgICByZXR1cm4gJFNlbGY7Cn0KCnN1YiBTZXREeW5hbWljRmllbGRWYWx1ZSB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICREeW5hbWljRmllbGROYW1lICA9ICRQYXJhbXtOYW1lfTsKICAgIG15ICREeW5hbWljRmllbGRWYWx1ZSA9ICRQYXJhbXtWYWx1ZX07CiAgICBteSAkVGlja2V0SUQgICAgICAgICAgPSAkUGFyYW17VGlja2V0SUR9OwoKICAgIGlmICggICBub3QgZGVmaW5lZCAkRHluYW1pY0ZpZWxkTmFtZQogICAgICAgIG9yIG5vdCBkZWZpbmVkICREeW5hbWljRmllbGRWYWx1ZSApCiAgICB7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIG15ICREeW5hbWljRmllbGRDb25maWcgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6RHluYW1pY0ZpZWxkJyktPkR5bmFtaWNGaWVsZEdldCgKICAgICAgICBOYW1lID0+ICREeW5hbWljRmllbGROYW1lCiAgICApOwogICAgbXkgJER5bmFtaWNGaWVsZEJhY2tlbmQgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6RHluYW1pY0ZpZWxkOjpCYWNrZW5kJyk7CgogICAgbXkgJFN1Y2Nlc3NEeW5hbWljRmllbGRTZXQgPSAkRHluYW1pY0ZpZWxkQmFja2VuZC0+VmFsdWVTZXQoCiAgICAgICAgRHluYW1pY0ZpZWxkQ29uZmlnID0+ICREeW5hbWljRmllbGRDb25maWcsCiAgICAgICAgT2JqZWN0SUQgICAgICAgICAgID0+ICRUaWNrZXRJRCwKICAgICAgICBWYWx1ZSAgICAgICAgICAgICAgPT4gJER5bmFtaWNGaWVsZFZhbHVlLAogICAgICAgIFVzZXJJRCAgICAgICAgICAgICA9PiAxLAoKICAgICAgICBOb0V2ZW50Tm90aWZ5ICAgICAgPT4gJFBhcmFte05vRXZlbnROb3RpZnl9CiAgICApOwoKICAgIGlmICggISRTdWNjZXNzRHluYW1pY0ZpZWxkU2V0ICkgewogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiQ2Fubm90IHNldCBkeW5hbWljIGZpZWxkICckRHluYW1pY0ZpZWxkTmFtZScgIgogICAgICAgICAgICAgICAgICAgICAgICAuImZvciBUaWNrZXRJRDogJFRpY2tldElEIgogICAgICAgICk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIHJldHVybiAxOwp9CgpzdWIgX0dldFZpZXdQYXJhbXMgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAlVmlld1BhcmFtcyA9ICgKICAgICAgICAtMSA9PiB7CiAgICAgICAgICAgIE93bmVySURzID0+IFsgJFBhcmFteyBVc2VySUQgfSBdLAogICAgICAgICAgICBTdGF0ZVR5cGUgPT4gJ09wZW4nCiAgICAgICAgfSwKCiAgICAgICAgLTIgPT4gewogICAgICAgICAgICBTdGF0ZVR5cGUgPT4gJ09wZW4nCiAgICAgICAgfSwKCiAgICAgICAgLTMgPT4gewogICAgICAgICAgICBTdGF0ZVR5cGUgPT4gJ09wZW4nCiAgICAgICAgfSwKCiAgICAgICAgLTQgPT4gewogICAgICAgICAgICBTdGF0ZVR5cGUgPT4gJ0Nsb3NlZCcKICAgICAgICB9LAoKICAgICAgICAtNSA9PiB7CiAgICAgICAgICAgIE5vdFRpY2tldEZsYWcgPT4gewogICAgICAgICAgICAgICAgU2VlbiA9PiAxCiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICAtNiA9PiB7CiAgICAgICAgICAgIE93bmVySURzID0+IFsgJFBhcmFteyBVc2VySUQgfSBdLAogICAgICAgICAgICBMb2NrcyAgICA9PiBbICdsb2NrJyBdCiAgICAgICAgfSwKCiAgICAgICAgLTcgPT4gewogICAgICAgICAgICBXYXRjaFVzZXJJRHMgPT4gWyAkUGFyYW17IFVzZXJJRCB9IF0KICAgICAgICB9CiAgICApOwoKICAgIGlmICggJFBhcmFteyBWaWV3SUQgfSA8IDAgKSB7CiAgICAgICAgaWYgKCBleGlzdHMgJFZpZXdQYXJhbXN7ICRQYXJhbXsgVmlld0lEIH0gfSApIHsKCiAgICAgICAgICAgICMgVE9ETzogY2hhbmdlIHRvIHZhcmlhYmxlIG5hbWUKICAgICAgICAgICAgaWYgKCAkUGFyYW17Vmlld0lEfSA9PSAtMiApIHsKICAgICAgICAgICAgICAgIG15ICRRdWV1ZVJvd3MgPQogICAgICAgICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6REInKS0+U2VsZWN0QWxsKAogICAgICAgICAgICAgICAgICAgIFNRTCA9PgogICAgICAgICAgICAgICAgICAgICAgcXtTRUxFQ1QgcXVldWVfaWQgRlJPTSBwZXJzb25hbF9xdWV1ZXMgV0hFUkUgdXNlcl9pZCA9ID99LAogICAgICAgICAgICAgICAgICAgIEJpbmQgPT4gWyBcJFBhcmFte1VzZXJJRH0gXQogICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgIG15IEBRdWV1ZXMgPSAoKTsKICAgICAgICAgICAgICAgIGZvciBteSAkUm93ICggQHsgJFF1ZXVlUm93cyB9ICkgewogICAgICAgICAgICAgICAgICAgIHB1c2ggQFF1ZXVlcywgJFJvdy0+WzBdOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICggQFF1ZXVlcyApIHsKICAgICAgICAgICAgICAgICAgICAkVmlld1BhcmFtc3sgJFBhcmFteyBWaWV3SUQgfSB9e1F1ZXVlSURzfSA9IFxAUXVldWVzOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gWyAkVmlld1BhcmFtc3sgJFBhcmFteyBWaWV3SUQgfSB9IF07CiAgICAgICAgfQoKICAgIH0gZWxzZSB7CgogICAgICAgIGlmICggJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06Ok1haW4nKQogICAgICAgICAgICAgICAtPlJlcXVpcmUoIktlcm5lbDo6U3lzdGVtOjpUaWNrZXRWaWV3cyIsIFNpbGVudCA9PiAxKSApIHsKCiAgICAgICAgICAgIG15ICRUaWNrZXRWaWV3ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlRpY2tldFZpZXdzJyktPlRpY2tldFZpZXdzR2V0KAogICAgICAgICAgICAgICAgSUQgPT4gJFBhcmFteyBWaWV3SUQgfQogICAgICAgICAgICApOwoKICAgICAgICAgICAgbXkgJENvbmZpZyA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPkdldCgiVGlja2V0OjpGcm9udGVuZDo6QWdlbnRUaWNrZXRWaWV3cyIpOwoKICAgICAgICAgICAgbXkgJFNvcnRCeSA9ICRQYXJhbXtTb3J0Qnl9CiAgICAgICAgICAgICAgICB8fCAkVGlja2V0Vmlldy0+e1NvcnRCeX0KICAgICAgICAgICAgICAgIHx8ICRDb25maWctPnsnU29ydEJ5OjpEZWZhdWx0J30KICAgICAgICAgICAgICAgIHx8ICdBZ2UnOwoKICAgICAgICAgICAgbXkgJE9yZGVyQnkgPSAkUGFyYW17T3JkZXJCeX0KICAgICAgICAgICAgICAgICB8fCAkVGlja2V0Vmlldy0+e09yZGVyQnl9CiAgICAgICAgICAgICAgICAgfHwgJENvbmZpZy0+eydPcmRlcjo6RGVmYXVsdCd9CiAgICAgICAgICAgICAgICAgfHwgJ1VwJzsKCiAgICAgICAgICAgIG15IEBGaWx0ZXJzID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlRpY2tldFZpZXdzJyktPkZpbHRlckZvclRpY2tldFNlYXJjaCgKICAgICAgICAgICAgICAgIElEICAgICAgICAgPT4gJFRpY2tldFZpZXctPntJRH0sCiAgICAgICAgICAgICAgICBVc2VySUQgICAgID0+ICRQYXJhbXsgVXNlcklEIH0sCiAgICAgICAgICAgICAgICBPcmRlckJ5ICAgID0+ICRPcmRlckJ5LAogICAgICAgICAgICAgICAgU29ydEJ5ICAgICA9PiAkU29ydEJ5LAogICAgICAgICAgICAgICAgUGVybWlzc2lvbiA9PiAncm8nLAogICAgICAgICAgICApOwoKICAgICAgICAgICAgcmV0dXJuIFxARmlsdGVyczsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIFtdOwp9CgpzdWIgX0dldFRpY2tldFJlcXVlc3RQYXJhbXMgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkVmlld1BhcmFtcyA9IFtdOwoKICAgICMg0J/QvtC70YPRh9Cw0LXQvCDQv9Cw0YDQsNC80LXRgtGA0Ysg0LTQu9GPIFRpY2tldFNlYXJjaCDQuNC3INCS0LjQtNC+0LIgKNGE0LjQu9GM0YLRgNC+0LIpCiAgICBpZiAoICRQYXJhbXsgVmlld0lEIH0gKSB7CiAgICAgICAgJFZpZXdQYXJhbXMgPSAkU2VsZi0+X0dldFZpZXdQYXJhbXMoCiAgICAgICAgICAgIFZpZXdJRCA9PiAkUGFyYW17IFZpZXdJRCB9LAogICAgICAgICAgICBVc2VySUQgPT4gJFBhcmFteyBVc2VySUQgfSwKCiAgICAgICAgICAgIFNvcnRCeSAgPT4gJFBhcmFte1NvcnRCeX0sCiAgICAgICAgICAgIE9yZGVyQnkgPT4gJFBhcmFte09yZGVyQnl9CiAgICAgICAgKTsKCiAgICAgICAgZm9yIG15ICRWaWV3ICggQHsgJFZpZXdQYXJhbXMgfSApIHsKCiAgICAgICAgICAgIGlmICggJFBhcmFte1NvcnRCeX0gYW5kICRWaWV3LT57U29ydEJ5fSApIHsKICAgICAgICAgICAgICAgICRQYXJhbXtTb3J0Qnl9ICAuPSAnLCcuJFZpZXctPntTb3J0Qnl9OwogICAgICAgICAgICB9IGVsc2lmICggJFZpZXctPntTb3J0Qnl9ICkgewogICAgICAgICAgICAgICAgJFBhcmFte1NvcnRCeX0gID0gJFZpZXctPntTb3J0Qnl9OwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoICRQYXJhbXtPcmRlckJ5fSBhbmQgJFZpZXctPntPcmRlckJ5fSApIHsKICAgICAgICAgICAgICAgICRQYXJhbXtPcmRlckJ5fSAgLj0gJywnLiRWaWV3LT57T3JkZXJCeX07CiAgICAgICAgICAgIH0gZWxzaWYgKCAkVmlldy0+e09yZGVyQnl9ICkgewogICAgICAgICAgICAgICAgJFBhcmFte09yZGVyQnl9ICA9ICRWaWV3LT57T3JkZXJCeX07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgbXkgJEFnZW50VGlja2V0U2VhcmNoQ29uZmlnID0gJEtlcm5lbDo6T00KICAgICAgICAtPkdldCgnS2VybmVsOjpDb25maWcnKQogICAgICAgIC0+R2V0KCdUaWNrZXQ6OkZyb250ZW5kOjpBZ2VudFRpY2tldFNlYXJjaCcpOwoKICAgICRQYXJhbXtTb3J0Qnl9ICAvLz0gJEFnZW50VGlja2V0U2VhcmNoQ29uZmlnLT57J1NvcnRCeTo6RGVmYXVsdCd9IC8vICcnOwogICAgJFBhcmFte09yZGVyQnl9IC8vPSAkQWdlbnRUaWNrZXRTZWFyY2hDb25maWctPnsnT3JkZXI6OkRlZmF1bHQnfSAgLy8gJyc7CgogICAgbXkgJFNvcnRCeSAgPSAgWyBzcGxpdCggJywnLCAkUGFyYW17U29ydEJ5fSAgKSBdOwogICAgbXkgJE9yZGVyQnkgPSAgWyBzcGxpdCggJywnLCAkUGFyYW17T3JkZXJCeX0gKSBdOwoKICAgICMg0JXRgdC70Lgg0Y/QstC90L4g0L3QtSDRg9C60LDQt9Cw0L3Qviwg0YLQviDQvdC+0LLRi9C1INCy0LLQtdGA0YXRgwogICAgaWYgKCAoICRQYXJhbXtTb3J0Qnl9IC8vICcnICkgIX4gL0FnZS8gKSB7CiAgICAgICAgcHVzaCBAeyAkU29ydEJ5IH0sICAnQWdlJzsKICAgICAgICBwdXNoIEB7ICRPcmRlckJ5IH0sICdEb3duJzsKICAgIH0KCiAgICAjINCg0LDRgdGB0LzQsNGC0YDQuNCy0LDQtdC8INGH0LjRgdC70LAg0LIgRnVsbFRleHRTZWFyY2gsINC60LDQuiDQstC+0LfQvNC+0LbQvdGL0LUg0LfQvdCw0YfQtdC90LjRjyDQtNC70Y8KICAgICMgVGlja2V0TnVtYmVyCiAgICAjIC0tLQogICAgbXkgJEZ1bGxUZXh0U2VhcmNoQ29weSA9ICRQYXJhbXtGdWxsVGV4dFNlYXJjaH0gLy8gJyc7CiAgICAkRnVsbFRleHRTZWFyY2hDb3B5ID1+IHMvJS8vZzsKCiAgICBteSAkVGlja2V0TnVtYmVyRnJvbUZ1bGxUZXh0U2VhcmNoID0gMDsKICAgIGlmICggJEZ1bGxUZXh0U2VhcmNoQ29weSA9fiAvXlxkKyQvICkgewogICAgICAgICRUaWNrZXROdW1iZXJGcm9tRnVsbFRleHRTZWFyY2ggPSAkRnVsbFRleHRTZWFyY2hDb3B5OwogICAgfQogICAgIyAtLS0KCiAgICBteSAlVGlja2V0UGFyYW0gPSAoCiAgICAgICAgKCAkUGFyYW17RnVsbFRleHRTZWFyY2h9CiAgICAgICAgICAgID8gKCBNSU1FQmFzZV9TdWJqZWN0ID0+ICRQYXJhbXtGdWxsVGV4dFNlYXJjaH0sCiAgICAgICAgICAgICAgICBNSU1FQmFzZV9Cb2R5ICAgID0+ICRQYXJhbXtGdWxsVGV4dFNlYXJjaH0sCiAgICAgICAgICAgICAgICBNSU1FQmFzZV9Gcm9tICAgID0+ICRQYXJhbXtGdWxsVGV4dFNlYXJjaH0sCiAgICAgICAgICAgICAgICBNSU1FQmFzZV9UbyAgICAgID0+ICRQYXJhbXtGdWxsVGV4dFNlYXJjaH0sCiAgICAgICAgICAgICAgICBNSU1FQmFzZV9DYyAgICAgID0+ICRQYXJhbXtGdWxsVGV4dFNlYXJjaH0sCiAgICAgICAgICAgICAgICBDb250ZW50U2VhcmNoID0+ICdPUicgKQogICAgICAgICAgICA6ICgpICksCgogICAgICAgICgKICAgICAgICAgICAgJFRpY2tldE51bWJlckZyb21GdWxsVGV4dFNlYXJjaAogICAgICAgICAgICA/ICggVGlja2V0TnVtYmVyRnJvbUZ1bGxUZXh0U2VhcmNoID0+CiAgICAgICAgICAgICAgICAgICRUaWNrZXROdW1iZXJGcm9tRnVsbFRleHRTZWFyY2ggKQogICAgICAgICAgICA6ICgpCiAgICAgICAgICApLAoKICAgICAgICBTb3J0QnkgID0+ICRTb3J0QnksCiAgICAgICAgT3JkZXJCeSA9PiAkT3JkZXJCeSwKCiAgICAgICAgUmVzdWx0ID0+ICRQYXJhbXsgUmVzdWx0VHlwZSB9LAoKICAgICAgICAoICRQYXJhbXtUaWNrZXRJRH0gPwogICAgICAgICAgICAoIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0gKSA6ICgpICksCgogICAgICAgICggJFBhcmFte1RpY2tldE51bWJlcn0gPwogICAgICAgICAgICAoIFRpY2tldE51bWJlciA9PiAkUGFyYW17VGlja2V0TnVtYmVyfSApIDogKCkgKSwKCiAgICAgICAgKCAkUGFyYW17VGl0bGV9ID8KICAgICAgICAgICAgKCBUaXRsZSA9PiAkUGFyYW17VGl0bGV9ICkgOiAoKSApLAoKICAgICAgICAoICRQYXJhbXtRdWV1ZXN9ID8KICAgICAgICAgICAgKCBRdWV1ZXMgPT4gWyBzcGxpdCAnLCcsICRQYXJhbXtRdWV1ZXN9IF0gKSA6ICgpICksCgogICAgICAgICggJFBhcmFte1F1ZXVlSURzfSA/CiAgICAgICAgICAgICggUXVldWVJRHMgPT4gWyBzcGxpdCAnLCcsICRQYXJhbXtRdWV1ZUlEc30gXSApIDogKCkgKSwKCiAgICAgICAgKCAkUGFyYW17VHlwZXN9ID8KICAgICAgICAgICAgKCBUeXBlcyA9PiBbIHNwbGl0ICcsJywgJFBhcmFte1R5cGVzfSBdICkgOiAoKSApLAoKICAgICAgICAoICRQYXJhbXtUeXBlSURzfSA/CiAgICAgICAgICAgICggVHlwZUlEcyA9PiBbIHNwbGl0ICcsJywgJFBhcmFte1R5cGVJRHN9IF0gKSA6ICgpICksCgogICAgICAgICggJFBhcmFte1N0YXRlc30gPwogICAgICAgICAgICAoIFN0YXRlcyA9PiBbIHNwbGl0ICcsJywgJFBhcmFte1N0YXRlc30gXSApIDogKCkgKSwKCiAgICAgICAgIyBUT0RPOgogICAgICAgICggJFBhcmFte1N0YXRlSURzfSA/CiAgICAgICAgICAgICggU3RhdGVJRHMgPT4gWyBzcGxpdCAnLCcsICRQYXJhbXtTdGF0ZUlEc30gXSApIDogKCkgKSwKCiAgICAgICAgKCAkUGFyYW17U3RhdGVUeXBlfSA/CiAgICAgICAgICAgICggU3RhdGVUeXBlID0+ICRQYXJhbXtTdGF0ZVR5cGV9ICkgOiAoKSApLAoKICAgICAgICAoICRQYXJhbXtQcmlvcml0aWVzfSA/CiAgICAgICAgICAgICggUHJpb3JpdGllcyA9PiBbIHNwbGl0ICcsJywgJFBhcmFte1ByaW9yaXRpZXN9IF0gKSA6ICgpICksCgogICAgICAgICggJFBhcmFte1ByaW9yaXR5SURzfSAgICA/ICggUHJpb3JpdHlJRHMgPT4gWyBzcGxpdCAnLCcsICRQYXJhbXtQcmlvcml0eUlEc30gXSApIDogKCkgKSwKICAgICAgICAoICRQYXJhbXtTZXJ2aWNlc30gPwogICAgICAgICAgICAoIFNlcnZpY2VzID0+IFsgc3BsaXQgJywnLCAkUGFyYW17U2VydmljZXN9IF0gKSA6ICgpICksCgogICAgICAgICggJFBhcmFte1NlcnZpY2VJRHN9ID8KICAgICAgICAgICAgKCBTZXJ2aWNlSURzID0+IFsgc3BsaXQgJywnLCAkUGFyYW17U2VydmljZUlEc30gXSApIDogKCkgKSwKCiAgICAgICAgKCAkUGFyYW17U0xBc30gPwogICAgICAgICAgICAoIFNMQXMgPT4gWyBzcGxpdCAnLCcsICRQYXJhbXtTTEFzfSBdICkgOiAoKSApLAoKICAgICAgICAoICRQYXJhbXtTTEFJRHN9ID8KICAgICAgICAgICAgKCBTTEFJRHMgPT4gWyBzcGxpdCAnLCcsICRQYXJhbXtTTEFJRHN9IF0gKSA6ICgpICksCgogICAgICAgICggJFBhcmFte0xvY2tzfSA/CiAgICAgICAgICAgICggTG9ja3MgPT4gWyBzcGxpdCAnLCcsICRQYXJhbXtMb2Nrc30gXSApIDogKCkgKSwKCiAgICAgICAgKCAkUGFyYW17TG9ja0lEc30gPwogICAgICAgICAgICAoIExvY2tJRHMgPT4gWyBzcGxpdCAnLCcsICRQYXJhbXtMb2NrSURzfSBdICkgOiAoKSApLAoKICAgICAgICAoICRQYXJhbXtPd25lcklEc30gPwogICAgICAgICAgICAoIE93bmVySURzID0+IFsgc3BsaXQgJywnLCAkUGFyYW17T3duZXJJRHN9IF0gKSA6ICgpICksCgogICAgICAgICggJFBhcmFte1Jlc3BvbnNpYmxlSURzfSA/CiAgICAgICAgICAgICggUmVzcG9uc2libGVJRHMgPT4gWyBzcGxpdCAnLCcsICRQYXJhbXtSZXNwb25zaWJsZUlEc30gXSApIDogKCkgKSwKCiAgICAgICAgKCAkUGFyYW17V2F0Y2hVc2VySURzfSA/CiAgICAgICAgICAgICggV2F0Y2hVc2VySURzID0+IFsgc3BsaXQgJywnLCAkUGFyYW17V2F0Y2hVc2VySURzfSBdICkgOiAoKSApLAoKICAgICAgICAoICRQYXJhbXtDdXN0b21lcklEfSA/CiAgICAgICAgICAgICggQ3VzdG9tZXJJRCA9PiAkUGFyYW17Q3VzdG9tZXJJRH0gKSA6ICgpICksCgogICAgICAgICggJFBhcmFte0N1c3RvbWVyVXNlckxvZ2lufSA/CiAgICAgICAgICAgICggQ3VzdG9tZXJVc2VyTG9naW4gPT4gJFBhcmFte0N1c3RvbWVyVXNlckxvZ2lufSApIDogKCkgKSwKCiAgICAgICAgKCAkUGFyYW17RnJvbX0gPwogICAgICAgICAgICAoIEZyb20gPT4gJFBhcmFte0Zyb219ICkgOiAoKSApLAoKICAgICAgICAoICRQYXJhbXtUb30gPwogICAgICAgICAgICAoIFRvID0+ICRQYXJhbXtUb30gKSA6ICgpICksCgogICAgICAgICggJFBhcmFte0NjfSA/CiAgICAgICAgICAgICggQ2MgPT4gJFBhcmFte0NjfSApIDogKCkgKSwKCiAgICAgICAgKCAkUGFyYW17U3ViamVjdH0gPwogICAgICAgICAgICAoIFN1YmplY3QgPT4gJFBhcmFte1N1YmplY3R9ICkgOiAoKSApLAoKICAgICAgICAoICRQYXJhbXtCb2R5fSA/CiAgICAgICAgICAgICggQm9keSA9PiAkUGFyYW17Qm9keX0gKSA6ICgpICksCgogICAgICAgIFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICByZXR1cm4gewogICAgICAgIFZpZXdQYXJhbXMgID0+ICRWaWV3UGFyYW1zLAogICAgICAgIFRpY2tldFBhcmFtID0+IFwlVGlja2V0UGFyYW0KICAgIH07Cn0KCnN1YiBVcGRhdGVQZW5kaW5nVGltZSB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkU2VsZi0+e1RpY2tldE9iamVjdH07CgogICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISVUaWNrZXQgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHRpY2tldCcKICAgICAgICB9OwogICAgfQoKICAgIG15ICRIYXNQZXJtaXNzaW9uID0gJFNlbGYtPl9DaGVja0dyb3VwUGVybWlzc2lvbigKICAgICAgICBRdWV1ZUlEID0+ICRUaWNrZXR7UXVldWVJRH0sCiAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICEkSGFzUGVybWlzc2lvbiApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gcGVybWlzc2lvbicKICAgICAgICB9OwogICAgfQoKICAgIG15ICVVc2VyID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlVzZXInKS0+R2V0VXNlckRhdGEoCiAgICAgICAgVXNlcklEID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIG15ICREYXRlVGltZU9iamVjdDsKICAgIGlmICggJFBhcmFte1VudGlsVGltZURhdGVVbml4fSApIHsKICAgICAgICAkRGF0ZVRpbWVPYmplY3QgPSAkS2VybmVsOjpPTS0+Q3JlYXRlKAogICAgICAgICAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICAgICAgICAgT2JqZWN0UGFyYW1zID0+IHsKICAgICAgICAgICAgICAgIEVwb2NoID0+ICRQYXJhbXsgVW50aWxUaW1lRGF0ZVVuaXggfQogICAgICAgICAgICB9CiAgICAgICAgKTsKICAgIH0KICAgIGVsc2lmICggJFBhcmFte1llYXJ9ICkgewogICAgICAgICREYXRlVGltZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5DcmVhdGUoCiAgICAgICAgICAgICdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnLAogICAgICAgICAgICBPYmplY3RQYXJhbXMgPT4gewogICAgICAgICAgICAgICAgWWVhciAgICAgPT4gJFBhcmFte1llYXJ9LAogICAgICAgICAgICAgICAgTW9udGggICAgPT4gJFBhcmFte01vbnRofSwKICAgICAgICAgICAgICAgIERheSAgICAgID0+ICRQYXJhbXtEYXl9LAogICAgICAgICAgICAgICAgSG91ciAgICAgPT4gJFBhcmFte0hvdXJ9LAogICAgICAgICAgICAgICAgTWludXRlICAgPT4gJFBhcmFte01pbnV0ZX0sCiAgICAgICAgICAgICAgICBUaW1lWm9uZSA9PiAkVXNlcntVc2VyVGltZVpvbmV9CiAgICAgICAgICAgIH0KICAgICAgICApOwogICAgfQoKICAgIGlmICggJERhdGVUaW1lT2JqZWN0ICkgewogICAgICAgICREYXRlVGltZU9iamVjdC0+VG9PVFJTVGltZVpvbmUoKTsKCiAgICAgICAgbXkgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRQZW5kaW5nVGltZVNldCgKICAgICAgICAgICAgU3RyaW5nICAgPT4gJERhdGVUaW1lT2JqZWN0LT5Ub1N0cmluZywKICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICApOwoKICAgICAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnQ2Fubm90IHVwZGF0ZSBQZW5kaW5nVGltZScKICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIHsgUmVzcG9uc2UgPT4gJ09LJyB9Owp9CgpzdWIgX1VwZGF0ZVRpY2tldCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICRQYXJhbXtSdWxlfSAvLz0gJyc7CiAgICAjVE9ETzogYWRkIGRldGFpbGVkIGluZm9ybWF0aW9uIGFib3V0IGVycm9ycyBmcm9tIFVwZGF0ZS4uIG1ldGhvZHMKCiAgICBteSBARmFpbGVkVXBkYXRlZEl0ZW1zID0gKCk7CgogICAgbXkgJFRpY2tldE9iamVjdCA9ICRTZWxmLT57VGlja2V0T2JqZWN0fTsKCiAgICBteSAkSGFzUldQZXJtaXNzaW9uID0gJFNlbGYtPl9DaGVja0dyb3VwUGVybWlzc2lvbigKICAgICAgICBRdWV1ZUlEID0+ICRQYXJhbXtUaWNrZXR9e1F1ZXVlSUR9LAogICAgICAgIFVzZXJJRCAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAkUGFyYW17VGl0bGV9IGFuZCAkUGFyYW17VGl0bGV9IG5lICRQYXJhbXtUaWNrZXR9e1RpdGxlfSApIHsKICAgICAgICBpZiAoICRIYXNSV1Blcm1pc3Npb24gKSB7CiAgICAgICAgICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0VGl0bGVVcGRhdGUoCiAgICAgICAgICAgICAgICBUaXRsZSAgICA9PiAkUGFyYW17VGl0bGV9LAogICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICAgICAgICAgIHB1c2ggQEZhaWxlZFVwZGF0ZWRJdGVtcywgJ1RpdGxlJzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcHVzaCBARmFpbGVkVXBkYXRlZEl0ZW1zLCAnVGl0bGUnOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAoICAgKCAkUGFyYW17UXVldWV9IGFuZCAkUGFyYW17UXVldWV9IG5lICRQYXJhbXtUaWNrZXR9e1F1ZXVlfSApCiAgICAgICAgb3IgKCAkUGFyYW17UXVldWVJRH0gYW5kICRQYXJhbXtRdWV1ZUlEfSAhPSAkUGFyYW17VGlja2V0fXtRdWV1ZUlEfSApICkKICAgIHsKCiAgICAgICAgaWYgKCAkUGFyYW17UXVldWV9IGFuZCAhJFBhcmFte1F1ZXVlSUR9ICkgewogICAgICAgICAgICAkUGFyYW17UXVldWVJRH0gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6UXVldWUnKQogICAgICAgICAgICAgIC0+UXVldWVMb29rdXAoIFF1ZXVlID0+ICRQYXJhbXtRdWV1ZX0gKTsKICAgICAgICB9CgogICAgICAgIG15ICRIYXNNb3ZlSW50b1Blcm1pc3Npb24gPSAkU2VsZi0+X0NoZWNrR3JvdXBQZXJtaXNzaW9uKAogICAgICAgICAgICBRdWV1ZUlEID0+ICRQYXJhbXtRdWV1ZUlEfSwKICAgICAgICAgICAgVHlwZSAgICA9PiBbJ21vdmVfaW50byddLAogICAgICAgICAgICBVc2VySUQgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKCiAgICAgICAgbXkgJFN1Y2Nlc3M7CgogICAgICAgIGlmICggISRIYXNSV1Blcm1pc3Npb24gYW5kICEkSGFzTW92ZUludG9QZXJtaXNzaW9uICkgewogICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdRdWV1ZSc7CiAgICAgICAgfQogICAgICAgIGVsc2lmICggJFBhcmFte1RpY2tldH17TG9ja30gZXEgJ3VubG9jaycgKSB7CiAgICAgICAgICAgICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0UXVldWVTZXQoCiAgICAgICAgICAgICAgICBRdWV1ZUlEICA9PiAkUGFyYW17UXVldWVJRH0sCiAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmICggISRTdWNjZXNzICkgewogICAgICAgICAgICAgICAgcHVzaCBARmFpbGVkVXBkYXRlZEl0ZW1zLCAnUXVldWUnOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2lmICggJFBhcmFte1RpY2tldH17TG9ja30gZXEgJ2xvY2snICkgewoKICAgICAgICAgICAgaWYgKCAkUGFyYW17VGlja2V0fXtPd25lcklEfSA9PSAkUGFyYW17VXNlcklEfSApIHsKCiAgICAgICAgICAgICAgICAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFF1ZXVlU2V0KAogICAgICAgICAgICAgICAgICAgIFF1ZXVlSUQgID0+ICRQYXJhbXtRdWV1ZUlEfSwKICAgICAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICAgICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgIGlmICggISRTdWNjZXNzICkgewogICAgICAgICAgICAgICAgICAgIHB1c2ggQEZhaWxlZFVwZGF0ZWRJdGVtcywgJ1F1ZXVlJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHB1c2ggQEZhaWxlZFVwZGF0ZWRJdGVtcywgJ1F1ZXVlJzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBpZiAoICAgKCAkUGFyYW17VHlwZX0gYW5kICRQYXJhbXtUeXBlfSBuZSAkUGFyYW17VGlja2V0fXtUeXBlfSApCiAgICAgICAgb3IgKCAkUGFyYW17VHlwZUlEfSBhbmQgJFBhcmFte1R5cGVJRH0gIT0gJFBhcmFte1RpY2tldH17VHlwZUlEfSApICkKICAgIHsKICAgICAgICBpZiAoICRIYXNSV1Blcm1pc3Npb24gKSB7CiAgICAgICAgICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0VHlwZVNldCgKICAgICAgICAgICAgICAgIFR5cGUgICAgID0+ICRQYXJhbXtUeXBlfSwKICAgICAgICAgICAgICAgIFR5cGVJRCAgID0+ICRQYXJhbXtUeXBlSUR9LAogICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICAgICAgICAgIHB1c2ggQEZhaWxlZFVwZGF0ZWRJdGVtcywgJ1R5cGUnOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdUeXBlJzsKICAgICAgICB9CiAgICB9CgogICAgaWYgKCAgICggJFBhcmFte1NlcnZpY2V9IGFuZCAkUGFyYW17U2VydmljZX0gbmUgJFBhcmFte1RpY2tldH17U2VydmljZX0gKQogICAgICAgIG9yICggJFBhcmFte1NlcnZpY2VJRH0gYW5kICRQYXJhbXtTZXJ2aWNlSUR9ICE9ICRQYXJhbXtUaWNrZXR9e1NlcnZpY2VJRH0gKSApCiAgICB7CiAgICAgICAgaWYgKCAkSGFzUldQZXJtaXNzaW9uICkgewogICAgICAgICAgICBteSAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFNlcnZpY2VTZXQoCiAgICAgICAgICAgICAgICBTZXJ2aWNlICAgPT4gJFBhcmFte1NlcnZpY2V9LAogICAgICAgICAgICAgICAgU2VydmljZUlEID0+ICRQYXJhbXtTZXJ2aWNlSUR9LAogICAgICAgICAgICAgICAgVGlja2V0SUQgID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgICAgICBVc2VySUQgICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmICggISRTdWNjZXNzICkgewogICAgICAgICAgICAgICAgcHVzaCBARmFpbGVkVXBkYXRlZEl0ZW1zLCAnU2VydmljZSc7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHB1c2ggQEZhaWxlZFVwZGF0ZWRJdGVtcywgJ1NlcnZpY2UnOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAoICAgKCAkUGFyYW17U0xBfSBhbmQgJFBhcmFte1NMQX0gbmUgJFBhcmFte1RpY2tldH17U0xBfSApCiAgICAgICAgb3IgKCAkUGFyYW17U0xBSUR9IGFuZCAkUGFyYW17U0xBSUR9ICE9ICRQYXJhbXtUaWNrZXR9e1NMQUlEfSApICkKICAgIHsKICAgICAgICBpZiAoICRIYXNSV1Blcm1pc3Npb24gKSB7CiAgICAgICAgICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0U0xBU2V0KAogICAgICAgICAgICAgICAgU0xBICAgICAgID0+ICRQYXJhbXtTTEF9LAogICAgICAgICAgICAgICAgU0xBSUQgICAgID0+ICRQYXJhbXtTTEFJRH0sCiAgICAgICAgICAgICAgICBUaWNrZXRJRCAgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgIFVzZXJJRCAgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdTTEEnOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdTTEEnOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAoICAgKCAkUGFyYW17Q3VzdG9tZXJJRH0gYW5kICRQYXJhbXtDdXN0b21lcklEfSBuZSAkUGFyYW17VGlja2V0fXtDdXN0b21lcklEfSApCiAgICAgICAgb3IgKCAkUGFyYW17Q3VzdG9tZXJVc2VySUR9IGFuZCAkUGFyYW17Q3VzdG9tZXJVc2VySUR9IG5lICRQYXJhbXtUaWNrZXR9e0N1c3RvbWVyVXNlcklEfSApICkKICAgIHsKICAgICAgICBpZiAoICRIYXNSV1Blcm1pc3Npb24gKSB7CiAgICAgICAgICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0Q3VzdG9tZXJTZXQoCiAgICAgICAgICAgICAgICBObyAgICAgICA9PiAkUGFyYW17Q3VzdG9tZXJJRH0sCiAgICAgICAgICAgICAgICBVc2VyICAgICA9PiAkUGFyYW17Q3VzdG9tZXJVc2VySUR9LAogICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICAgICAgICAgIHB1c2ggQEZhaWxlZFVwZGF0ZWRJdGVtcywgJ0N1c3RvbWVyJzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcHVzaCBARmFpbGVkVXBkYXRlZEl0ZW1zLCAnQ3VzdG9tZXInOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAoICAgKCAkUGFyYW17TG9ja30gYW5kICRQYXJhbXtMb2NrfSBuZSAkUGFyYW17VGlja2V0fXtMb2NrfSApCiAgICAgICAgb3IgKCAkUGFyYW17TG9ja0lEfSBhbmQgJFBhcmFte0xvY2tJRH0gIT0gJFBhcmFte1RpY2tldH17TG9ja0lEfSApICkKICAgIHsKICAgICAgICBteSAkSGFzUGVybWlzc2lvbiA9ICRTZWxmLT5fQ2hlY2tHcm91cFBlcm1pc3Npb24oCiAgICAgICAgICAgIFF1ZXVlSUQgPT4gJFBhcmFte1RpY2tldH17UXVldWVJRH0sCiAgICAgICAgICAgIFR5cGUgICAgPT4gWyAncm8nLCAnbW92ZV9pbnRvJywgJ25vdGUnLCAnb3duZXInLCAncHJpb3JpdHknIF0sCiAgICAgICAgICAgIE9wICAgICAgPT4gJ09SJywKICAgICAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICk7CgogICAgICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0TG9ja1NldCgKICAgICAgICAgICAgTG9jayAgICAgPT4gJFBhcmFte0xvY2t9LAogICAgICAgICAgICBMb2NrSUQgICA9PiAkUGFyYW17TG9ja0lEfSwKICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICApOwoKICAgICAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICAgICAgcHVzaCBARmFpbGVkVXBkYXRlZEl0ZW1zLCAnTG9jayc7CiAgICAgICAgfQogICAgfQoKICAgIGlmICggJFBhcmFte0FyY2hpdmVGbGFnfSBhbmQgJFBhcmFte0FyY2hpdmVGbGFnfSBuZSAkUGFyYW17VGlja2V0fXtBcmNoaXZlRmxhZ30gKSB7CgogICAgICAgIGlmICggJEhhc1JXUGVybWlzc2lvbiApIHsKICAgICAgICAgICAgbXkgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRBcmNoaXZlRmxhZ1NldCgKICAgICAgICAgICAgICAgIEFyY2hpdmVGbGFnID0+ICRQYXJhbXtBcmNoaXZlRmxhZ30sCiAgICAgICAgICAgICAgICBUaWNrZXRJRCAgICA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICAgICAgVXNlcklEICAgICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmICggISRTdWNjZXNzICkgewogICAgICAgICAgICAgICAgcHVzaCBARmFpbGVkVXBkYXRlZEl0ZW1zLCAnQXJjaGl2ZUZsYWcnOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdBcmNoaXZlRmxhZyc7CiAgICAgICAgfQogICAgfQoKICAgIGlmICggICAoICRQYXJhbXtTdGF0ZX0gYW5kICRQYXJhbXtTdGF0ZX0gbmUgJFBhcmFte1RpY2tldH17U3RhdGV9ICkKICAgICAgICBvciAoICRQYXJhbXtTdGF0ZUlEfSBhbmQgJFBhcmFte1N0YXRlSUR9ICE9ICRQYXJhbXtUaWNrZXR9e1N0YXRlSUR9ICkgKQogICAgewogICAgICAgIGlmICggJEhhc1JXUGVybWlzc2lvbiApIHsKCiAgICAgICAgICAgIG15ICRTdWNjZXNzOwoKICAgICAgICAgICAgaWYgKCAkUGFyYW17VGlja2V0fXtMb2NrfSBlcSAndW5sb2NrJyApIHsKICAgICAgICAgICAgICAgICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0U3RhdGVTZXQoCiAgICAgICAgICAgICAgICAgICAgU3RhdGUgICAgPT4gJFBhcmFte1N0YXRlfSwKICAgICAgICAgICAgICAgICAgICBTdGF0ZUlEICA9PiAkUGFyYW17U3RhdGVJRH0sCiAgICAgICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICAgICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdTdGF0ZSc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzaWYgKCAkUGFyYW17VGlja2V0fXtMb2NrfSBlcSAnbG9jaycgKSB7CiAgICAgICAgICAgICAgICBpZiAoICRQYXJhbXtUaWNrZXR9e093bmVySUR9ID09ICRQYXJhbXtVc2VySUR9ICkgewogICAgICAgICAgICAgICAgICAgICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0U3RhdGVTZXQoCiAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRlICAgID0+ICRQYXJhbXtTdGF0ZX0sCiAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRlSUQgID0+ICRQYXJhbXtTdGF0ZUlEfSwKICAgICAgICAgICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgICAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkVGlja2V0e1N0YXRlVHlwZX0gZXEgJ2Nsb3NlZCcgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIE9uZSBTdWNjZXNzIHZhciBmb3IgYWN0aW9ucwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRMb2NrU2V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvY2sgICAgID0+ICd1bmxvY2snLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdTdGF0ZSc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHB1c2ggQEZhaWxlZFVwZGF0ZWRJdGVtcywgJ1N0YXRlJzsKICAgICAgICB9CiAgICB9CgogICAgaWYgKCAgICggJFBhcmFte05ld093bmVyfSBhbmQgJFBhcmFte05ld093bmVyfSBuZSAkUGFyYW17VGlja2V0fXtOZXdPd25lcn0gKQogICAgICAgIG9yICggJFBhcmFte05ld093bmVySUR9IGFuZCAkUGFyYW17TmV3T3duZXJJRH0gIT0gJFBhcmFte1RpY2tldH17TmV3T3duZXJJRH0gKSApCiAgICB7CiAgICAgICAgbXkgJEhhc093bmVyUGVybWlzc2lvbiA9ICRTZWxmLT5fQ2hlY2tHcm91cFBlcm1pc3Npb24oCiAgICAgICAgICAgIFF1ZXVlSUQgPT4gJFBhcmFte1RpY2tldH17UXVldWVJRH0sCiAgICAgICAgICAgIFR5cGUgICAgPT4gWydvd25lciddLAogICAgICAgICAgICBVc2VySUQgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKCiAgICAgICAgaWYgKCRIYXNPd25lclBlcm1pc3Npb24pIHsKICAgICAgICAgICAgaWYgKCBkZWZpbmVkICRQYXJhbXtOZXdPd25lcklEfQogICAgICAgICAgICAgICAgYW5kICRQYXJhbXtOZXdPd25lcklEfSA9PSAwICkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJFBhcmFte05ld093bmVySUR9ID0gJFBhcmFte1VzZXJJRH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG15ICRTdWNjZXNzOwogICAgICAgICAgICBpZiAoICRQYXJhbXtUaWNrZXR9e0xvY2t9IGVxICd1bmxvY2snICkgewogICAgICAgICAgICAgICAgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRPd25lclNldCgKICAgICAgICAgICAgICAgICAgICBOZXdVc2VyICAgPT4gJFBhcmFte05ld093bmVyfSwKICAgICAgICAgICAgICAgICAgICBOZXdVc2VySUQgPT4gJFBhcmFte05ld093bmVySUR9LAogICAgICAgICAgICAgICAgICAgIFRpY2tldElEICA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICAgICAgICAgIFVzZXJJRCAgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNpZiAoICRQYXJhbXtUaWNrZXR9e0xvY2t9IGVxICdsb2NrJyApIHsKICAgICAgICAgICAgICAgIGlmICggICAkUGFyYW17VGlja2V0fXtPd25lcklEfSA9PSAkUGFyYW17VXNlcklEfQogICAgICAgICAgICAgICAgICAgIG9yICRQYXJhbXtSdWxlfSBlcSAnVGlja2V0RWRpdCcgKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0T3duZXJTZXQoCiAgICAgICAgICAgICAgICAgICAgICAgIE5ld1VzZXIgICA9PiAkUGFyYW17TmV3T3duZXJ9LAogICAgICAgICAgICAgICAgICAgICAgICBOZXdVc2VySUQgPT4gJFBhcmFte05ld093bmVySUR9LAogICAgICAgICAgICAgICAgICAgICAgICBUaWNrZXRJRCAgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgICAgICAgICAgVXNlcklEICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIHB1c2ggQEZhaWxlZFVwZGF0ZWRJdGVtcywgJ093bmVyJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdPd25lcic7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CgogICAgICAgICAgICAgICAgIyBUT0RPOiBtb3ZlIHRvIG9uZSBmdW5jdGlvbiBhcyB1cGRhdGVPd25lcgogICAgICAgICAgICAgICAgbXkgJE93bmVySUQgPSAkUGFyYW17TmV3T3duZXJJRH07CiAgICAgICAgICAgICAgICBpZiAoICEkT3duZXJJRCApIHsKICAgICAgICAgICAgICAgICAgICBteSAlVGlja2V0ID0gJFRpY2tldE9iamVjdC0+VGlja2V0R2V0KAogICAgICAgICAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICAgICAgICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgJE93bmVySUQgPSAkVGlja2V0e093bmVySUR9OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0TG9ja1NldCgKICAgICAgICAgICAgICAgICAgICBMb2NrICAgICA9PiAnbG9jaycsCiAgICAgICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgICAgICBVc2VySUQgICA9PiAkT3duZXJJRAogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICAgICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdPd25lcic7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHB1c2ggQEZhaWxlZFVwZGF0ZWRJdGVtcywgJ093bmVyJzsKICAgICAgICB9CiAgICB9CgogICAgaWYgKAogICAgICAgICgKICAgICAgICAgICAgICAgICRQYXJhbXtOZXdSZXNwb25zaWJsZVVzZXJ9CiAgICAgICAgICAgIGFuZCAkUGFyYW17TmV3UmVzcG9uc2libGVVc2VyfSBuZSAkUGFyYW17VGlja2V0fXtOZXdSZXNwb25zaWJsZVVzZXJ9CiAgICAgICAgKQogICAgICAgIG9yICggICAgJFBhcmFte05ld1Jlc3BvbnNpYmxlVXNlcklEfQogICAgICAgICAgICBhbmQgJFBhcmFte05ld1Jlc3BvbnNpYmxlVXNlcklEfSAhPQogICAgICAgICAgICAkUGFyYW17VGlja2V0fXtOZXdSZXNwb25zaWJsZVVzZXJJRH0gKQogICAgICApCiAgICB7CiAgICAgICAgaWYgKCRIYXNSV1Blcm1pc3Npb24pIHsKICAgICAgICAgICAgbXkgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRSZXNwb25zaWJsZVNldCgKICAgICAgICAgICAgICAgIE5ld1VzZXIgICA9PiAkUGFyYW17TmV3UmVzcG9uc2libGVVc2VyfSwKICAgICAgICAgICAgICAgIE5ld1VzZXJJRCA9PiAkUGFyYW17TmV3UmVzcG9uc2libGVVc2VySUR9LAogICAgICAgICAgICAgICAgVGlja2V0SUQgID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgICAgICBVc2VySUQgICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmICggISRTdWNjZXNzICkgewogICAgICAgICAgICAgICAgcHVzaCBARmFpbGVkVXBkYXRlZEl0ZW1zLCAnUmVzcG9uc2libGUnOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdSZXNwb25zaWJsZSc7CiAgICAgICAgfQogICAgfQoKICAgIGlmICggICAoICRQYXJhbXtQcmlvcml0eX0gYW5kICRQYXJhbXtQcmlvcml0eX0gbmUgJFBhcmFte1RpY2tldH17UHJpb3JpdHl9ICkKICAgICAgICBvciAoICRQYXJhbXtQcmlvcml0eUlEfSBhbmQgJFBhcmFte1ByaW9yaXR5SUR9ICE9ICRQYXJhbXtUaWNrZXR9e1ByaW9yaXR5SUR9ICkgKQogICAgewogICAgICAgIG15ICRIYXNQcmlvcml0eVBlcm1pc3Npb24gPSAkU2VsZi0+X0NoZWNrR3JvdXBQZXJtaXNzaW9uKAogICAgICAgICAgICBRdWV1ZUlEID0+ICRQYXJhbXtUaWNrZXR9e1F1ZXVlSUR9LAogICAgICAgICAgICBUeXBlICAgID0+IFsncHJpb3JpdHknXSwKICAgICAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICk7CgogICAgICAgIGlmICggJEhhc1ByaW9yaXR5UGVybWlzc2lvbiApIHsKICAgICAgICAgICAgbXkgJFN1Y2Nlc3M7CgogICAgICAgICAgICBpZiAoICRQYXJhbXtUaWNrZXR9e0xvY2t9IGVxICd1bmxvY2snICkgewoKICAgICAgICAgICAgICAgICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0UHJpb3JpdHlTZXQoCiAgICAgICAgICAgICAgICAgICAgUHJpb3JpdHkgICA9PiAkUGFyYW17UHJpb3JpdHl9LAogICAgICAgICAgICAgICAgICAgIFByaW9yaXR5SUQgPT4gJFBhcmFte1ByaW9yaXR5SUR9LAogICAgICAgICAgICAgICAgICAgIFRpY2tldElEICAgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgICAgICBVc2VySUQgICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2lmICggJFBhcmFte1RpY2tldH17TG9ja30gZXEgJ2xvY2snICkgewogICAgICAgICAgICAgICAgaWYgKCAkUGFyYW17VGlja2V0fXtPd25lcklEfSA9PSAkUGFyYW17VXNlcklEfSApIHsKCiAgICAgICAgICAgICAgICAgICAgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRQcmlvcml0eVNldCgKICAgICAgICAgICAgICAgICAgICAgICAgUHJpb3JpdHkgICA9PiAkUGFyYW17UHJpb3JpdHl9LAogICAgICAgICAgICAgICAgICAgICAgICBQcmlvcml0eUlEID0+ICRQYXJhbXtQcmlvcml0eUlEfSwKICAgICAgICAgICAgICAgICAgICAgICAgVGlja2V0SUQgICA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICAgICAgICAgICAgICBVc2VySUQgICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIHB1c2ggQEZhaWxlZFVwZGF0ZWRJdGVtcywgJ1ByaW9yaXR5JzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdQcmlvcml0eSc7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHB1c2ggQEZhaWxlZFVwZGF0ZWRJdGVtcywgJ1ByaW9yaXR5JzsKICAgICAgICB9CiAgICB9CgogICAgaWYgKCAkUGFyYW17WWVhcn0gb3IgJFBhcmFteyBVbnRpbFRpbWVEYXRlVW5peCB9ICkgewoKICAgICAgICBpZiAoICRIYXNSV1Blcm1pc3Npb24gKSB7CiAgICAgICAgICAgIG15ICVVc2VyID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlVzZXInKS0+R2V0VXNlckRhdGEoCiAgICAgICAgICAgICAgICBVc2VySUQgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIG15ICREYXRlVGltZU9iamVjdDsKICAgICAgICAgICAgaWYgKCAkUGFyYW17VW50aWxUaW1lRGF0ZVVuaXh9ICkgewogICAgICAgICAgICAgICAgJERhdGVUaW1lT2JqZWN0ID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgKICAgICAgICAgICAgICAgICAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICAgICAgICAgICAgICAgICBPYmplY3RQYXJhbXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBFcG9jaCA9PiAkUGFyYW17IFVudGlsVGltZURhdGVVbml4IH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJERhdGVUaW1lT2JqZWN0ID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgKICAgICAgICAgICAgICAgICAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICAgICAgICAgICAgICAgICBPYmplY3RQYXJhbXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBZZWFyICAgICA9PiAkUGFyYW17WWVhcn0sCiAgICAgICAgICAgICAgICAgICAgICAgIE1vbnRoICAgID0+ICRQYXJhbXtNb250aH0sCiAgICAgICAgICAgICAgICAgICAgICAgIERheSAgICAgID0+ICRQYXJhbXtEYXl9LAogICAgICAgICAgICAgICAgICAgICAgICBIb3VyICAgICA9PiAkUGFyYW17SG91cn0sCiAgICAgICAgICAgICAgICAgICAgICAgIE1pbnV0ZSAgID0+ICRQYXJhbXtNaW51dGV9LAogICAgICAgICAgICAgICAgICAgICAgICBUaW1lWm9uZSA9PiAkVXNlcntVc2VyVGltZVpvbmV9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCAkRGF0ZVRpbWVPYmplY3QgKSB7CiAgICAgICAgICAgICAgICAkRGF0ZVRpbWVPYmplY3QtPlRvT1RSU1RpbWVab25lKCk7CgogICAgICAgICAgICAgICAgbXkgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRQZW5kaW5nVGltZVNldCgKICAgICAgICAgICAgICAgICAgICBTdHJpbmcgICA9PiAkRGF0ZVRpbWVPYmplY3QtPlRvU3RyaW5nLAogICAgICAgICAgICAgICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgICAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgICAgICAgICAgICAgcHVzaCBARmFpbGVkVXBkYXRlZEl0ZW1zLCAnUGVuZGluZ1RpbWUnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgcHVzaCBARmFpbGVkVXBkYXRlZEl0ZW1zLCAnUGVuZGluZ1RpbWUnOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdQZW5kaW5nVGltZSc7CiAgICAgICAgfQogICAgfQoKICAgIGlmICggJFBhcmFte0R5bmFtaWNGaWVsZHN9ICkgewoKICAgICAgICBmb3IgbXkgJER5bmFtaWNGaWVsZE5hbWUgKCBzb3J0IGtleXMgJXsgJFBhcmFte0R5bmFtaWNGaWVsZHN9IH0gKSB7CiAgICAgICAgICAgIG15ICRTdWNjZXNzID0gJFNlbGYtPlNldER5bmFtaWNGaWVsZFZhbHVlKAogICAgICAgICAgICAgICAgTmFtZSAgICAgPT4gJER5bmFtaWNGaWVsZE5hbWUsCiAgICAgICAgICAgICAgICBWYWx1ZSAgICA9PiAkUGFyYW17RHluYW1pY0ZpZWxkc317JER5bmFtaWNGaWVsZE5hbWV9LAogICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldH17VGlja2V0SUR9CiAgICAgICAgICAgICk7CgogICAgICAgICAgICBwdXNoIEBGYWlsZWRVcGRhdGVkSXRlbXMsICdEeW5hbWljRmllbGRfJy4kRHluYW1pY0ZpZWxkTmFtZSBpZiAhJFN1Y2Nlc3M7CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiBARmFpbGVkVXBkYXRlZEl0ZW1zOwp9CgpzdWIgQ3JlYXRlVGlja2V0IHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJFJlc3VsdDsKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkU2VsZi0+e1RpY2tldE9iamVjdH07CgogICAgbXkgQEZhaWxlZFJlcXVpcmVkUGFyYW1zID0gKCk7CgogICAgIyDQntCx0Y/Qt9Cw0YLQtdC70YzQvdGL0LUKICAgIGZvciAoIHF3LyBUaXRsZSBRdWV1ZUlEIFByaW9yaXR5SUQgQm9keSAvICkgewogICAgICAgIGlmICggISRQYXJhbXskX30gKSB7CiAgICAgICAgICAgIHB1c2ggQEZhaWxlZFJlcXVpcmVkUGFyYW1zLCAkXzsKICAgICAgICB9CiAgICB9CgogICAgaWYgKCBARmFpbGVkUmVxdWlyZWRQYXJhbXMgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIlJlcXVpcmVkIGZpZWxkcyBpcyBub3QgZGVmaW5lZDogIgogICAgICAgICAgICAgICAgICAgICAgICAuam9pbigiLCAiLCBARmFpbGVkUmVxdWlyZWRQYXJhbXMgKQogICAgICAgIH07CiAgICB9CgogICAgbXkgJEdyb3VwSUQgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6UXVldWUnKQogICAgICAgIC0+R2V0UXVldWVHcm91cElEKCBRdWV1ZUlEID0+ICRQYXJhbXsgUXVldWVJRCB9ICk7CgogICAgaWYgKCAhJEdyb3VwSUQgKSB7CiAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIlF1ZXVlIGlzIGluY29ycmVjdCIKICAgICAgICB9OwogICAgICAgIHJldHVybiAkUmVzdWx0OwogICAgfQogICAgZWxzZSB7CiAgICAgICAgbXkgJEdyb3VwID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06Okdyb3VwJyktPkdyb3VwTG9va3VwKAogICAgICAgICAgICBHcm91cElEID0+ICRHcm91cElELAogICAgICAgICk7CgogICAgICAgIG15ICRDYW5DcmVhdGVUaWNrZXQgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6R3JvdXAnKS0+UGVybWlzc2lvbkNoZWNrKAogICAgICAgICAgICBVc2VySUQgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICAgICAgICAgIEdyb3VwTmFtZSA9PiAkR3JvdXAsCiAgICAgICAgICAgIFR5cGUgICAgICA9PiAnY3JlYXRlJwogICAgICAgICk7CgogICAgICAgIGlmICggISRDYW5DcmVhdGVUaWNrZXQgKSB7CiAgICAgICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIHBlcm1pc3Npb24iCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHJldHVybiAkUmVzdWx0OwogICAgICAgIH0KICAgIH0KCiAgICAjINCf0L4g0LLRi9Cx0L7RgNGDCiAgICAjIEFydGljbGVUeXBlIFNlbmRlclR5cGUgT3duZXJJRCBMb2NrIFRvIENjIFJlcGx5VG8gQ29udGVudFR5cGUgQ3VzdG9tZXJJRAogICAgIyBDdXN0b21lclVzZXIgU3RhdGVJRAoKICAgIG15ICREZWZhdWx0U3RhdGUgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpCiAgICAgICAgICAgICAgICAgICAgICAgLT5HZXQoJ1JTOjpBUEk6OkRlZmF1bHRTdGF0ZScpIHx8ICduZXcnOwoKICAgIG15ICRPd25lcklEID0gJFBhcmFte093bmVySUR9IHx8ICRQYXJhbXtVc2VySUR9OwoKICAgIG15ICRMb2NrID0gJFBhcmFte0xvY2t9OwogICAgaWYgKCAhJExvY2sgKSB7CiAgICAgICAgJExvY2sgPSAkUGFyYW17T3duZXJJRH0gPyAnbG9jaycgOiAndW5sb2NrJzsKICAgIH0KCiAgICBteSAkVGlja2V0SUQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRDcmVhdGUoCiAgICAgICAgVGl0bGUgICAgICAgID0+ICRQYXJhbXtUaXRsZX0sCiAgICAgICAgUXVldWVJRCAgICAgID0+ICRQYXJhbXtRdWV1ZUlEfSwKICAgICAgICBMb2NrICAgICAgICAgPT4gJExvY2ssCgogICAgICAgICggJFBhcmFte1R5cGVJRH0gPwogICAgICAgICAgICAoIFR5cGVJRCA9PiAkUGFyYW17VHlwZUlEfSApIDogKCkgKSwKICAgICAgICAoICRQYXJhbXtTZXJ2aWNlSUR9ID8KICAgICAgICAgICAgKCBTZXJ2aWNlSUQgPT4gJFBhcmFte1NlcnZpY2VJRH0gKSA6ICgpICksCiAgICAgICAgKCAkUGFyYW17U0xBSUR9ID8KICAgICAgICAgICAgKCBTTEFJRCA9PiAkUGFyYW17U0xBSUR9ICkgOiAoKSApLAoKICAgICAgICAoICRQYXJhbXtTdGF0ZUlEfSA/CiAgICAgICAgICAgICggU3RhdGVJRCA9PiAkUGFyYW17U3RhdGVJRH0gKSA6ICggU3RhdGUgPT4gJERlZmF1bHRTdGF0ZSApICksCiAgICAgICAgUHJpb3JpdHlJRCAgID0+ICRQYXJhbXtQcmlvcml0eUlEfSwKICAgICAgICAoICRQYXJhbXtDdXN0b21lcklEfSA/CiAgICAgICAgICAgICggQ3VzdG9tZXJJRCA9PiAkUGFyYW17Q3VzdG9tZXJJRH0gKSA6ICgpICksCgogICAgICAgICggJFBhcmFte0N1c3RvbWVyVXNlcklEfSA/CiAgICAgICAgICAgICggQ3VzdG9tZXJVc2VyID0+ICRQYXJhbXtDdXN0b21lclVzZXJJRH0gKSA6ICgpICksCgogICAgICAgIE93bmVySUQgICAgICA9PiAkT3duZXJJRCwKICAgICAgICBVc2VySUQgICAgICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJFRpY2tldElEICkgewoKICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiQ291bGRuJ3QgY3JlYXRlIHRpY2tldCIKICAgICAgICB9OwoKICAgIH0gZWxzZSB7CiAgICAgICAgbXkgJVVzZXIgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VXNlcicpLT5HZXRVc2VyRGF0YSgKICAgICAgICAgICAgVXNlcklEID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKCiAgICAgICAgIyDQldGB0LvQuCDRg9C60LDQt9Cw0L0g0LrQu9C40LXQvdGCLCDRgtC+INC40YHQv9C+0LvRjNC30YPQtdC8INC10LPQvgogICAgICAgIG15ICRGcm9tID0gJyc7CiAgICAgICAgaWYgKCAkUGFyYW17IEN1c3RvbWVyVXNlcklEIH0gKSB7CiAgICAgICAgICAgIG15ICVDdXN0b21lclVzZXIgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q3VzdG9tZXJVc2VyJyktPkN1c3RvbWVyVXNlckRhdGFHZXQoCiAgICAgICAgICAgICAgICBVc2VyID0+ICRQYXJhbXsgQ3VzdG9tZXJVc2VySUQgfQogICAgICAgICAgICApOwoKICAgICAgICAgICAgbXkgJFVzZXJGaXJzdG5hbWUgPSAkQ3VzdG9tZXJVc2VyeyBVc2VyRmlyc3RuYW1lIH0gLy8gJyc7CiAgICAgICAgICAgIG15ICRVc2VyTGFzdG5hbWUgID0gJEN1c3RvbWVyVXNlcnsgVXNlckxhc3RuYW1lIH0gIC8vICcnOwoKICAgICAgICAgICAgJEZyb20gPSAiJFVzZXJGaXJzdG5hbWUgJFVzZXJMYXN0bmFtZSI7CiAgICAgICAgICAgICRGcm9tID1+IHMvXlxzKy8vOwogICAgICAgICAgICAkRnJvbSA9fiBzL1xzKyQvLzsKCiAgICAgICAgICAgIGlmICggJEZyb20gKSB7CiAgICAgICAgICAgICAgICAkRnJvbSA9ICciJy4kRnJvbS4nIic7CgogICAgICAgICAgICAgICAgaWYgKCAkQ3VzdG9tZXJVc2VyeyBVc2VyRW1haWwgfSApIHsKICAgICAgICAgICAgICAgICAgICAkRnJvbSAuPSAnIDwnLiAkQ3VzdG9tZXJVc2VyeyBVc2VyRW1haWwgfSAuJz4nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJEZyb20gPSAkVXNlcntVc2VyRnVsbG5hbWV9OwogICAgICAgIH0KCiAgICAgICAgbXkgJEFydGljbGVPYmplY3QgICAgICAgID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlRpY2tldDo6QXJ0aWNsZScpOwogICAgICAgIG15ICRBcnRpY2xlQmFja2VuZE9iamVjdCA9ICRBcnRpY2xlT2JqZWN0LT5CYWNrZW5kRm9yQ2hhbm5lbCgKICAgICAgICAgICAgQ2hhbm5lbE5hbWUgPT4gdWNmaXJzdCgkUGFyYW17QXJ0aWNsZVR5cGV9IHx8ICdQaG9uZScpIyBwaG9uZSwgZW1haWwsIGNoYXQsIGludGVybmFsCiAgICAgICAgKTsKCiAgICAgICAgbXkgJEFydGljbGVJRCA9ICRBcnRpY2xlQmFja2VuZE9iamVjdC0+QXJ0aWNsZUNyZWF0ZSgKICAgICAgICAgICAgVGlja2V0SUQgICAgICAgPT4gJFRpY2tldElELAoKICAgICAgICAgICAgU2VuZGVyVHlwZSAgICAgPT4gJFBhcmFte1NlbmRlclR5cGV9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8ICdjdXN0b21lcicsICMgYWdlbnR8c3lzdGVtfGN1c3RvbWVyCgogICAgICAgICAgICBJc1Zpc2libGVGb3JDdXN0b21lciA9PiAxLAoKICAgICAgICAgICAgIyAnU29tZSBBZ2VudCA8ZW1haWxAZXhhbXBsZS5jb20+JwogICAgICAgICAgICBGcm9tID0+ICRGcm9tLAoKICAgICAgICAgICAgKCAkUGFyYW17VG99ID8KICAgICAgICAgICAgICAgICggVG8gPT4gJFBhcmFte1RvfSApIDogKCkgKSwKCiAgICAgICAgICAgICggJFBhcmFte0NjfSA/CiAgICAgICAgICAgICAgICAoIENjID0+ICRQYXJhbXtDY30gKSA6ICgpICksCgogICAgICAgICAgICAoICRQYXJhbXtSZXBseVRvfSA/CiAgICAgICAgICAgICAgICAoIFJlcGx5VG8gPT4gJFBhcmFte1JlcGx5VG99ICkgOiAoKSApLAoKICAgICAgICAgICAgU3ViamVjdCAgICAgICAgPT4gJFBhcmFte1RpdGxlfSwKICAgICAgICAgICAgQm9keSAgICAgICAgICAgPT4gJFBhcmFte0JvZHl9LAogICAgICAgICAgICBDb250ZW50VHlwZSAgICA9PiAkUGFyYW17Q29udGVudFR5cGV9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8ICd0ZXh0L3BsYWluOyBjaGFyc2V0PXV0Zi04JywgIyBvciBvcHRpb25hbCBDaGFyc2V0ICYgTWltZVR5cGUKICAgICAgICAgICAgSGlzdG9yeVR5cGUgICAgPT4gJ0FkZE5vdGUnLCAjIEVtYWlsQ3VzdG9tZXJ8TW92ZXxBZGROb3RlfFByaW9yaXR5VXBkYXRlfFdlYlJlcXVlc3RDdXN0b21lcnwuLi4KICAgICAgICAgICAgSGlzdG9yeUNvbW1lbnQgPT4gJ1RpY2tldCBjcmVhdGVkIScsCiAgICAgICAgICAgIFVzZXJJRCAgICAgICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKCiAgICAgICAgaWYgKCAkQXJ0aWNsZUlEICkgewogICAgICAgICAgICBteSBARmFpbGVkT3BlcmF0aW9ucyA9ICgpOwoKICAgICAgICAgICAgaWYgKCAkUGFyYW17RXN0aW1hdGVkfSApIHsKCiAgICAgICAgICAgICAgICAkUGFyYW17RXN0aW1hdGVkfSA9fiBzL1teMC05Ll0vL2c7CgogICAgICAgICAgICAgICAgbXkgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRBY2NvdW50VGltZSgKICAgICAgICAgICAgICAgICAgICBUaWNrZXRJRCAgPT4gJFRpY2tldElELAogICAgICAgICAgICAgICAgICAgIEFydGljbGVJRCA9PiAkQXJ0aWNsZUlELAogICAgICAgICAgICAgICAgICAgIFRpbWVVbml0ICA9PiAkUGFyYW17RXN0aW1hdGVkfSwKICAgICAgICAgICAgICAgICAgICBVc2VySUQgICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgICAgICAgICAgICAgcHVzaCBARmFpbGVkT3BlcmF0aW9ucywgJ1NldEVzdGltYXRlZFRpbWUnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBteSAkRGF0ZVRpbWVPYmplY3Q7CiAgICAgICAgICAgIGlmICggJFBhcmFte1VudGlsVGltZURhdGVVbml4fSApIHsKICAgICAgICAgICAgICAgICREYXRlVGltZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5DcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgJ0tlcm5lbDo6U3lzdGVtOjpEYXRlVGltZScsCiAgICAgICAgICAgICAgICAgICAgT2JqZWN0UGFyYW1zID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgRXBvY2ggPT4gJFBhcmFteyBVbnRpbFRpbWVEYXRlVW5peCB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNpZiAoICRQYXJhbXtZZWFyfSApIHsKICAgICAgICAgICAgICAgICREYXRlVGltZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5DcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgJ0tlcm5lbDo6U3lzdGVtOjpEYXRlVGltZScsCiAgICAgICAgICAgICAgICAgICAgT2JqZWN0UGFyYW1zID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgWWVhciAgICAgPT4gJFBhcmFte1llYXJ9LAogICAgICAgICAgICAgICAgICAgICAgICBNb250aCAgICA9PiAkUGFyYW17TW9udGh9LAogICAgICAgICAgICAgICAgICAgICAgICBEYXkgICAgICA9PiAkUGFyYW17RGF5fSwKICAgICAgICAgICAgICAgICAgICAgICAgSG91ciAgICAgPT4gJFBhcmFte0hvdXJ9LAogICAgICAgICAgICAgICAgICAgICAgICBNaW51dGUgICA9PiAkUGFyYW17TWludXRlfSwKICAgICAgICAgICAgICAgICAgICAgICAgVGltZVpvbmUgPT4gJFVzZXJ7VXNlclRpbWVab25lfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICggJERhdGVUaW1lT2JqZWN0ICkgewogICAgICAgICAgICAgICAgJERhdGVUaW1lT2JqZWN0LT5Ub09UUlNUaW1lWm9uZSgpOwoKICAgICAgICAgICAgICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0UGVuZGluZ1RpbWVTZXQoCiAgICAgICAgICAgICAgICAgICAgU3RyaW5nICAgPT4gJERhdGVUaW1lT2JqZWN0LT5Ub1N0cmluZywKICAgICAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkVGlja2V0SUQsCiAgICAgICAgICAgICAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgICAgICAgICAgICAgcHVzaCBARmFpbGVkT3BlcmF0aW9ucywgJ1BlbmRpbmdUaW1lJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCAkUGFyYW17RHluYW1pY0ZpZWxkc30gKSB7CgogICAgICAgICAgICAgICAgZm9yIG15ICREeW5hbWljRmllbGROYW1lICggc29ydCBrZXlzICV7ICRQYXJhbXtEeW5hbWljRmllbGRzfSB9ICkgewogICAgICAgICAgICAgICAgICAgIG15ICRTdWNjZXNzID0gJFNlbGYtPlNldER5bmFtaWNGaWVsZFZhbHVlKAogICAgICAgICAgICAgICAgICAgICAgICBOYW1lICAgICA9PiAkRHluYW1pY0ZpZWxkTmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWUgICAgPT4gJFBhcmFte0R5bmFtaWNGaWVsZHN9eyREeW5hbWljRmllbGROYW1lfSwKICAgICAgICAgICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFRpY2tldElECiAgICAgICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAgICAgcHVzaCBARmFpbGVkT3BlcmF0aW9ucywgJ0R5bmFtaWNGaWVsZF8nLiREeW5hbWljRmllbGROYW1lIGlmICEkU3VjY2VzczsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCBARmFpbGVkT3BlcmF0aW9ucyApIHsKCiAgICAgICAgICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlICA9PiAiRVJST1IiLAogICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgICA9PiAnVGlja2V0IHdhcyBjcmVhdGVkIGJ1dCB0aGVzZSBvcGVyYXRpb25zIGFyZSBmYWlsZWQ6ICcuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpvaW4oJywgJywgQEZhaWxlZE9wZXJhdGlvbnMgKSwKICAgICAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkVGlja2V0SUQKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gIk9LIiwKICAgICAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkVGlja2V0SUQKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkNhbm5vdCBhZGQgdGlja2V0IGFydGljbGUiCiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiAkUmVzdWx0Owp9CgpzdWIgQ3JlYXRlQXJ0aWNsZSB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRSZXN1bHQ7CiAgICBteSAkVGlja2V0T2JqZWN0ID0gJFNlbGYtPntUaWNrZXRPYmplY3R9OwoKICAgIG15IEBGYWlsZWRSZXF1aXJlZFBhcmFtcyA9ICgpOwoKICAgICMgUmVxdWlyZWQKICAgIGZvciAoIHF3LyBUaWNrZXRJRCBTdWJqZWN0IEJvZHkgLyApIHsKICAgICAgICBpZiAoICEkUGFyYW17JF99ICkgewogICAgICAgICAgICBwdXNoIEBGYWlsZWRSZXF1aXJlZFBhcmFtcywgJF87CiAgICAgICAgfQogICAgfQoKICAgIGlmICggQEZhaWxlZFJlcXVpcmVkUGFyYW1zICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJSZXF1aXJlZCBmaWVsZHMgaXMgbm90IGRlZmluZWQ6ICIKICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oIiwgIiwgQEZhaWxlZFJlcXVpcmVkUGFyYW1zICkKICAgICAgICB9OwogICAgfQoKICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoCiAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICElVGlja2V0ICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdObyB0aWNrZXQnCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkSGFzUGVybWlzc2lvbiA9ICRTZWxmLT5fQ2hlY2tHcm91cFBlcm1pc3Npb24oCiAgICAgICAgUXVldWVJRCA9PiAkVGlja2V0e1F1ZXVlSUR9LAogICAgICAgIFR5cGUgICAgPT4gWydub3RlJywgJ293bmVyJ10sCiAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICEkSGFzUGVybWlzc2lvbiApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gcGVybWlzc2lvbicKICAgICAgICB9OwogICAgfQoKICAgICMg0J/QviDQstGL0LHQvtGA0YMKICAgICMgQXJ0aWNsZVR5cGUgU2VuZGVyVHlwZSBGcm9tIFRvIENjIFJlcGx5VG8gQ29udGVudFR5cGUKCiAgICBteSAlVXNlciA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpVc2VyJyktPkdldFVzZXJEYXRhKAogICAgICAgIFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICAkUGFyYW17QXJ0aWNsZVR5cGV9IC8vPSAnJzsKCiAgICBteSAkQXJ0aWNsZVR5cGUgPSAnSW50ZXJuYWwnOwogICAgbXkgJElzVmlzaWJsZUZvckN1c3RvbWVyID0gJFBhcmFte0FydGljbGVUeXBlfSA9fiAvZXh0ZXJuYWwvaTsKICAgIGlmICggJFBhcmFte0FydGljbGVUeXBlfSA9fiAvXmNoYXQvaSApIHsKICAgICAgICAkQXJ0aWNsZVR5cGUgPSAnQ2hhdCc7CgogICAgfSBlbHNpZiAoICRQYXJhbXtBcnRpY2xlVHlwZX0gPX4gL15waG9uZS9pICkgewogICAgICAgICRBcnRpY2xlVHlwZSA9ICdQaG9uZSc7CgogICAgfSBlbHNpZiAoICRQYXJhbXtBcnRpY2xlVHlwZX0gPX4gL15lbWFpbC9pICkgewogICAgICAgICRBcnRpY2xlVHlwZSA9ICdFbWFpbCc7CiAgICB9CgogICAgbXkgJEFydGljbGVPYmplY3QgICAgICAgID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlRpY2tldDo6QXJ0aWNsZScpOwogICAgbXkgJEFydGljbGVCYWNrZW5kT2JqZWN0ID0gJEFydGljbGVPYmplY3QtPkJhY2tlbmRGb3JDaGFubmVsKAogICAgICAgIENoYW5uZWxOYW1lID0+ICRBcnRpY2xlVHlwZSAjIHBob25lLCBlbWFpbCwgY2hhdCwgaW50ZXJuYWwKICAgICk7CgogICAgbXkgJUFydGljbGVQYXJhbSA9ICgKICAgICAgICAlUGFyYW0sCiAgICAgICAgVGlja2V0SUQgICAgICAgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBJc1Zpc2libGVGb3JDdXN0b21lciA9PiAkSXNWaXNpYmxlRm9yQ3VzdG9tZXIsCiMgICAgICAgICAgICBBcnRpY2xlVHlwZSAgICA9PiAkUGFyYW17QXJ0aWNsZVR5cGV9CiMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAncGhvbmUnLCAjIGVtYWlsLWV4dGVybmFsfGVtYWlsLWludGVybmFsfHBob25lfGZheHwuLi4KCiAgICAgICAgU2VuZGVyVHlwZSAgICAgPT4gJFBhcmFte1NlbmRlclR5cGV9IHx8ICdhZ2VudCcsICAjIGFnZW50fHN5c3RlbXxjdXN0b21lcgoKICAgICAgICAjICdTb21lIEFnZW50IDxlbWFpbEBleGFtcGxlLmNvbT4nCiAgICAgICAgRnJvbSA9PiAkVXNlcntVc2VyRnVsbG5hbWV9LicgJy4nPCcuJFVzZXJ7VXNlckVtYWlsfS4nPicsCgogICAgICAgICggJFBhcmFte1RvfSA/CiAgICAgICAgICAgICggVG8gPT4gJFBhcmFte1RvfSApIDogKCkgKSwKCiAgICAgICAgKCAkUGFyYW17Q2N9ID8KICAgICAgICAgICAgKCBDYyA9PiAkUGFyYW17Q2N9ICkgOiAoKSApLAoKICAgICAgICAoICRQYXJhbXtSZXBseVRvfSA/CiAgICAgICAgICAgICggUmVwbHlUbyA9PiAkUGFyYW17UmVwbHlUb30gKSA6ICgpICksCgogICAgICAgIFN1YmplY3QgICAgICAgID0+ICRQYXJhbXtTdWJqZWN0fSwKICAgICAgICBCb2R5ICAgICAgICAgICA9PiAkUGFyYW17Qm9keX0sCiAgICAgICAgQ29udGVudFR5cGUgICAgPT4gJFBhcmFte0NvbnRlbnRUeXBlfQogICAgICAgICAgICAgICAgICAgICAgICAgIHx8ICd0ZXh0L3BsYWluOyBjaGFyc2V0PXV0Zi04JywgIyBvciBvcHRpb25hbCBDaGFyc2V0ICYgTWltZVR5cGUKICAgICAgICBDaGFyc2V0ICAgICAgICA9PiAkUGFyYW17Q2hhcnNldH0gIHx8ICd1dGYtOCcsCiAgICAgICAgTWltZVR5cGUgICAgICAgPT4gJFBhcmFte01pbWVUeXBlfSB8fCAndGV4dC9wbGFpbicsCiAgICAgICAgSGlzdG9yeVR5cGUgICAgPT4gJ0FkZE5vdGUnLCAjIEVtYWlsQ3VzdG9tZXJ8TW92ZXxBZGROb3RlfFByaW9yaXR5VXBkYXRlfFdlYlJlcXVlc3RDdXN0b21lcnwuLi4KICAgICAgICBIaXN0b3J5Q29tbWVudCA9PiAnJSVOb3RlJywKCiAgICAgICAgVXNlcklEICAgICAgICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgbXkgJEFydGljbGVJRDsKCiAgICBpZiAoICRBcnRpY2xlVHlwZSBlcSAnRW1haWwnICkgewogICAgICAgIG15ICRUZW1wbGF0ZUdlbmVyYXRvciA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUZW1wbGF0ZUdlbmVyYXRvcicpOwogICAgICAgIG15ICVEYXRhID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlRlbXBsYXRlR2VuZXJhdG9yJyktPkF0dHJpYnV0ZXMoCiAgICAgICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgIERhdGEgICAgID0+IHt9LAogICAgICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICk7CgogICAgICAgICRBcnRpY2xlSUQgPSAkQXJ0aWNsZUJhY2tlbmRPYmplY3QtPkFydGljbGVTZW5kKCAlQXJ0aWNsZVBhcmFtLCBGcm9tID0+ICREYXRhe0Zyb219ICk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICAkQXJ0aWNsZUlEID0gJEFydGljbGVCYWNrZW5kT2JqZWN0LT5BcnRpY2xlQ3JlYXRlKCAlQXJ0aWNsZVBhcmFtICk7CiAgICB9CgogICAgaWYgKCAkQXJ0aWNsZUlEICkgewogICAgICAgIG15IEBGYWlsZWRPcGVyYXRpb25zID0gKCk7CgogICAgICAgIGlmICggJFBhcmFte0VzdGltYXRlZH0gKSB7CgogICAgICAgICAgICAkUGFyYW17RXN0aW1hdGVkfSA9fiBzL1teMC05Ll0vL2c7CgogICAgICAgICAgICBteSAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEFjY291bnRUaW1lKAogICAgICAgICAgICAgICAgVGlja2V0SUQgID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgICAgICBBcnRpY2xlSUQgPT4gJEFydGljbGVJRCwKICAgICAgICAgICAgICAgIFRpbWVVbml0ICA9PiAkUGFyYW17RXN0aW1hdGVkfSwKICAgICAgICAgICAgICAgIFVzZXJJRCAgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgICAgICAgICBwdXNoIEBGYWlsZWRPcGVyYXRpb25zLCAnU2V0RXN0aW1hdGVkVGltZSc7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICggJFBhcmFte1N0YXRlfSBvciAkUGFyYW17U3RhdGVJRH0gKSB7CgogICAgICAgICAgICBteSAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFN0YXRlU2V0KAogICAgICAgICAgICAgICAgU3RhdGUgICAgPT4gJFBhcmFte1N0YXRlfSwKICAgICAgICAgICAgICAgIFN0YXRlSUQgID0+ICRQYXJhbXtTdGF0ZUlEfSwKICAgICAgICAgICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgICAgICAgICBwdXNoIEBGYWlsZWRPcGVyYXRpb25zLCAnVXBkYXRlU3RhdGUnOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBteSAkRGF0ZVRpbWVPYmplY3Q7CiAgICAgICAgaWYgKCAkUGFyYW17VW50aWxUaW1lRGF0ZVVuaXh9ICkgewogICAgICAgICAgICAkRGF0ZVRpbWVPYmplY3QgPSAkS2VybmVsOjpPTS0+Q3JlYXRlKAogICAgICAgICAgICAgICAgJ0tlcm5lbDo6U3lzdGVtOjpEYXRlVGltZScsCiAgICAgICAgICAgICAgICBPYmplY3RQYXJhbXMgPT4gewogICAgICAgICAgICAgICAgICAgIEVwb2NoID0+ICRQYXJhbXsgVW50aWxUaW1lRGF0ZVVuaXggfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBlbHNpZiAoICRQYXJhbXtZZWFyfSApIHsKICAgICAgICAgICAgJERhdGVUaW1lT2JqZWN0ID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgKICAgICAgICAgICAgICAgICdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnLAogICAgICAgICAgICAgICAgT2JqZWN0UGFyYW1zID0+IHsKICAgICAgICAgICAgICAgICAgICBZZWFyICAgICA9PiAkUGFyYW17WWVhcn0sCiAgICAgICAgICAgICAgICAgICAgTW9udGggICAgPT4gJFBhcmFte01vbnRofSwKICAgICAgICAgICAgICAgICAgICBEYXkgICAgICA9PiAkUGFyYW17RGF5fSwKICAgICAgICAgICAgICAgICAgICBIb3VyICAgICA9PiAkUGFyYW17SG91cn0sCiAgICAgICAgICAgICAgICAgICAgTWludXRlICAgPT4gJFBhcmFte01pbnV0ZX0sCiAgICAgICAgICAgICAgICAgICAgVGltZVpvbmUgPT4gJFVzZXJ7VXNlclRpbWVab25lfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgaWYgKCAkRGF0ZVRpbWVPYmplY3QgKSB7CiAgICAgICAgICAgICREYXRlVGltZU9iamVjdC0+VG9PVFJTVGltZVpvbmUoKTsKCiAgICAgICAgICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0UGVuZGluZ1RpbWVTZXQoCiAgICAgICAgICAgICAgICBTdHJpbmcgICA9PiAkRGF0ZVRpbWVPYmplY3QtPlRvU3RyaW5nLAogICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICAgICAgICAgIHB1c2ggQEZhaWxlZE9wZXJhdGlvbnMsICdQZW5kaW5nVGltZSc7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICggJFBhcmFte0R5bmFtaWNGaWVsZHN9ICkgewoKICAgICAgICAgICAgZm9yIG15ICREeW5hbWljRmllbGROYW1lICggc29ydCBrZXlzICV7ICRQYXJhbXtEeW5hbWljRmllbGRzfSB9ICkgewogICAgICAgICAgICAgICAgbXkgJFN1Y2Nlc3MgPSAkU2VsZi0+U2V0RHluYW1pY0ZpZWxkVmFsdWUoCiAgICAgICAgICAgICAgICAgICAgTmFtZSAgICAgPT4gJER5bmFtaWNGaWVsZE5hbWUsCiAgICAgICAgICAgICAgICAgICAgVmFsdWUgICAgPT4gJFBhcmFte0R5bmFtaWNGaWVsZHN9eyREeW5hbWljRmllbGROYW1lfSwKICAgICAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9CiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgIHB1c2ggQEZhaWxlZE9wZXJhdGlvbnMsICdEeW5hbWljRmllbGRfJy4kRHluYW1pY0ZpZWxkTmFtZSBpZiAhJFN1Y2Nlc3M7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICggQEZhaWxlZE9wZXJhdGlvbnMgKSB7CgogICAgICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICAgICAgUmVzcG9uc2UgID0+ICJFUlJPUiIsCiAgICAgICAgICAgICAgICBNZXNzYWdlICAgPT4gJ0FydGljbGUgd2FzIGNyZWF0ZWQgYnV0IHRoZXNlIG9wZXJhdGlvbnMgYXJlIGZhaWxlZDogJy4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqb2luKCcsICcsIEBGYWlsZWRPcGVyYXRpb25zICksCiAgICAgICAgICAgICAgICBBcnRpY2xlSUQgPT4gJEFydGljbGVJRAogICAgICAgICAgICB9OwoKICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgICAgIFJlc3BvbnNlICA9PiAiT0siLAogICAgICAgICAgICAgICAgQXJ0aWNsZUlEID0+ICRBcnRpY2xlSUQKICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgfSBlbHNlIHsKCiAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkNhbm5vdCBhZGQgYXJ0aWNsZSIKICAgICAgICB9OwogICAgfQoKICAgIHJldHVybiAkUmVzdWx0Owp9CgpzdWIgR2V0VGlja2V0TGlzdCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICREeW5hbWljRmllbGRzTW9kZSA9ICRQYXJhbXtEeW5hbWljRmllbGRzTW9kZX0gLy8gJ25vbmUnOwoKICAgIG15ICRBcnRpY2xlT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlRpY2tldDo6QXJ0aWNsZScpOwoKICAgIG15ICRSZXN1bHQ7CiAgICBteSAkVGlja2V0T2JqZWN0ID0gJFNlbGYtPntUaWNrZXRPYmplY3R9OwoKICAgIG15ICRVc2VyVG9rZW4gPSAkU2VsZi0+e1V0aWxPYmplY3R9LT5HZXRVc2VyVG9rZW4oIFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfSApOwogICAgbXkgJE5lZWRUb2tlblVwZGF0ZSA9ICRVc2VyVG9rZW4gPyAwIDogMTsKCiAgICBteSAkU21hcnRTb3J0ID0gJFBhcmFte1NtYXJ0U29ydH0gfHwgMDsKICAgIG15ICRSZXN1bHRUeXBlID0gJFBhcmFte0NvdW50fSA/ICdDT1VOVCcgOiAnQVJSQVknOwoKICAgIG15ICRUaWNrZXRSZXF1ZXN0UGFyYW1zID0gJFNlbGYtPl9HZXRUaWNrZXRSZXF1ZXN0UGFyYW1zKAogICAgICAgICVQYXJhbSwKICAgICAgICBSZXN1bHRUeXBlID0+ICRSZXN1bHRUeXBlLAogICAgICAgIFVzZXJJRCAgICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgbXkgJFZpZXdQYXJhbXMgID0gJFRpY2tldFJlcXVlc3RQYXJhbXMtPnsgVmlld1BhcmFtcyB9OwogICAgbXkgJVRpY2tldFBhcmFtID0gJXsgJFRpY2tldFJlcXVlc3RQYXJhbXMtPnsgVGlja2V0UGFyYW0gfSB9OwoKICAgICMg0J7Qv9GA0LXQtNC10LvRj9C10Lwg0YHRg9GJ0LXRgdGC0LLRg9C10YIg0LvQuCDQtNC+0YHRgtGD0L/QvdCw0Y8g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GOINC30LDRj9Cy0LrQsCDRgSDQv9GA0LXQtNC/0L7Qu9Cw0LPQsNC10LzRi9C8CiAgICAjIFRpY2tldE51bWJlciDQsiDQstC40LTQtSDRh9C40YHQu9CwINC40LcgRnVsbFRleHRTZWFyY2gKICAgICMgLS0tCiAgICBteSAkVGlja2V0SURJbmRpcmVjdCA9IDA7CiAgICBteSAkVGlja2V0SW5kaXJlY3Q7CiAgICBpZiAoICRUaWNrZXRQYXJhbXsgVGlja2V0TnVtYmVyRnJvbUZ1bGxUZXh0U2VhcmNoIH0gKSB7CiAgICAgICAgbXkgJFRpY2tldElEID0gJFRpY2tldE9iamVjdC0+VGlja2V0Q2hlY2tOdW1iZXIoCiAgICAgICAgICAgIFRuID0+ICRUaWNrZXRQYXJhbXsgVGlja2V0TnVtYmVyRnJvbUZ1bGxUZXh0U2VhcmNoIH0KICAgICAgICApOwoKICAgICAgICBpZiAoICRUaWNrZXRJRCApIHsKICAgICAgICAgICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICAgICAgICAgIFRpY2tldElEID0+ICRUaWNrZXRJRCwKICAgICAgICAgICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoICVUaWNrZXQgKSB7CiAgICAgICAgICAgICAgICAkVGlja2V0SW5kaXJlY3QgPSAkU2VsZi0+X0NsZWFyT2JqZWN0RmllbGRzKAogICAgICAgICAgICAgICAgICAgIE9iamVjdCA9PiBcJVRpY2tldCwKICAgICAgICAgICAgICAgICAgICBUeXBlICAgPT4gJ1RpY2tldCcKICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgJFRpY2tldElESW5kaXJlY3QgPSAkVGlja2V0SUQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAjIC0tLQoKICAgIGlmICggJFJlc3VsdFR5cGUgZXEgJ0NPVU5UJykgewoKICAgICAgICBteSAkQ291bnQgPSAwOwoKICAgICAgICAjIC0+VGlja2V0U2VhcmNoOiBQZXJtaXNzaW9uIFJPIChSVykgYnkgZGVmYXVsdAogICAgICAgICNteSBAVGlja2V0SURzID0gKCk7CgogICAgICAgIG15ICRGb3VuZENvdW50ID0gMDsKICAgICAgICBpZiAoIEB7ICRWaWV3UGFyYW1zIH0gKSB7CgogICAgICAgICAgICBmb3IgKCBAeyAkVmlld1BhcmFtcyB9ICkgewogICAgICAgICAgICAgICAgJEZvdW5kQ291bnQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRTZWFyY2goICUkXywgJVRpY2tldFBhcmFtICk7CiAgICAgICAgICAgICAgICAkQ291bnQgKz0gJEZvdW5kQ291bnQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJEZvdW5kQ291bnQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRTZWFyY2goICVUaWNrZXRQYXJhbSApOwogICAgICAgICAgICAkQ291bnQgKz0gJEZvdW5kQ291bnQ7CiAgICAgICAgfQoKICAgICAgICAjINCj0YfQuNGC0YvQstCw0LXQvCDQvdCw0LnQtNC10L3QvdGD0Y4g0LfQsNGP0LLQutGDINC/0L4gVGlja2V0TnVtYmVyINC40LcgRnVsbFRleHRTZWFyY2gg0LLQvNC10YHRgtC1INGBCiAgICAgICAgIyDQvtGB0YLQsNC70YzQvdGL0LzQuCwg0LrQvtGC0L7RgNGL0LUg0LLRi9C00LDQuyBUaWNrZXRTZWFyY2gKICAgICAgICAjIC0tLQogICAgICAgICMgVE9ETzoKPXBvZAogICAgICAgIG15ICRBbHJlYWR5Rm91bmQgPSAwOwogICAgICAgIGZvciBteSAkVGlja2V0SUQgKCBAVGlja2V0SURzICkgewogICAgICAgICAgICBpZiAoICRUaWNrZXRJRCA9ICRUaWNrZXRJREluZGlyZWN0ICkgewogICAgICAgICAgICAgICAgJEFscmVhZHlGb3VuZCA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICggISRBbHJlYWR5Rm91bmQgYW5kICRUaWNrZXRJREluZGlyZWN0ICkgewogICAgICAgICAgICAkQ291bnQrKzsKICAgICAgICB9Cj1jdXQKICAgICAgICAjIC0tLQoKICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICBSZXNwb25zZSAgICAgICAgPT4gJ09LJywKICAgICAgICAgICAgQ291bnQgICAgICAgICAgID0+ICRDb3VudCwKICAgICAgICAgICAgTmVlZFRva2VuVXBkYXRlID0+ICROZWVkVG9rZW5VcGRhdGUKICAgICAgICB9OwoKICAgIH0gZWxzZSB7CgogICAgICAgIG15IEBUaWNrZXRMaXN0ID0gKCk7CiAgICAgICAgbXkgQFRpY2tldElEcyAgPSAoKTsKCiAgICAgICAgaWYgKCBAeyRWaWV3UGFyYW1zfSApIHsKCiAgICAgICAgICAgIGZvciAoIEB7JFZpZXdQYXJhbXN9ICkgewoKICAgICAgICAgICAgICAgIGlmICgkU21hcnRTb3J0KSB7CiAgICAgICAgICAgICAgICAgICAgQFRpY2tldElEcyA9ICRTZWxmLT5fU21hcnRUaWNrZXRTZWFyY2goICUkXywgJVRpY2tldFBhcmFtICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBteSBAUGFydFRpY2tldElEcyA9CiAgICAgICAgICAgICAgICAgICAgICAkVGlja2V0T2JqZWN0LT5UaWNrZXRTZWFyY2goICUkXywgJVRpY2tldFBhcmFtICk7CiAgICAgICAgICAgICAgICAgICAgcHVzaCBAVGlja2V0SURzLCBAUGFydFRpY2tldElEczsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmICgkU21hcnRTb3J0KSB7CiAgICAgICAgICAgICAgICBAVGlja2V0SURzID0gJFNlbGYtPl9TbWFydFRpY2tldFNlYXJjaCggJVRpY2tldFBhcmFtICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBAVGlja2V0SURzID0gJFRpY2tldE9iamVjdC0+VGlja2V0U2VhcmNoKCVUaWNrZXRQYXJhbSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRQYXJhbXtPZmZzZXR9IC8vPSAwOwogICAgICAgIEBUaWNrZXRJRHMgPSBzcGxpY2UoIEBUaWNrZXRJRHMsICRQYXJhbXtPZmZzZXR9LCAkUGFyYW17TGltaXR9IC8vIDUgKTsKCiAgICAgICAgbXkgJVVzZXIgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VXNlcicpLT5HZXRVc2VyRGF0YSgKICAgICAgICAgICAgVXNlcklEID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKCiAgICAgICAgbXkgJExhbmd1YWdlT2JqZWN0ID0gS2VybmVsOjpMYW5ndWFnZS0+bmV3KAogICAgICAgICAgICBVc2VyTGFuZ3VhZ2UgPT4gJ3B0JywgIyBwdCAtINC/0YDQvtGB0YLQviDQv9C+0YLQvtC80YMg0YfRgtC+INGC0LDQvCDQvdGD0LbQvdGL0LkgRGF0ZUZvcm1hdCBZLU0tRCBIOk06UwogICAgICAgICAgICBVc2VyVGltZVpvbmUgPT4gJFVzZXJ7VXNlclRpbWVab25lfQogICAgICAgICk7CgogICAgICAgIG15ICRpID0gMDsKCiAgICAgICAgd2hpbGUgKCAkaSA8IEBUaWNrZXRJRHMgKSB7CiAgICAgICAgICAgIG15ICRTaG93RHluYW1pY0ZpZWxkcyA9CiAgICAgICAgICAgICAgICAoICREeW5hbWljRmllbGRzTW9kZSBlcSAnYWxsJyBvcgogICAgICAgICAgICAgICAgICAkRHluYW1pY0ZpZWxkc01vZGUgZXEgJ21vYmlsZScgKSA/IDEgOiAwOwoKICAgICAgICAgICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICAgICAgICAgIFRpY2tldElEID0+ICRUaWNrZXRJRHNbJGldLAogICAgICAgICAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICAgICAgICAgICAgICAoICRTaG93RHluYW1pY0ZpZWxkcyA/ICggRHluYW1pY0ZpZWxkcyA9PiAxICkgOiAoKSApCiAgICAgICAgICAgICk7CgogICAgICAgICAgICBteSAkRHluYW1pY0ZpZWxkcyA9IHt9OwogICAgICAgICAgICBpZiAoICRTaG93RHluYW1pY0ZpZWxkcyApIHsKCiAgICAgICAgICAgICAgICBteSAkTGlzdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEeW5hbWljRmllbGQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAtPkR5bmFtaWNGaWVsZExpc3RHZXQoKTsKCiAgICAgICAgICAgICAgICBteSAlUmVzdWx0ID0gKCk7CiAgICAgICAgICAgICAgICBmb3IgbXkgJEZpZWxkICggQHskTGlzdH0gKSB7CgogICAgICAgICAgICAgICAgICAgICREeW5hbWljRmllbGRzLT57ICRGaWVsZC0+e05hbWV9IH0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIElEICAgICAgICAgPT4gJEZpZWxkLT57SUR9LAogICAgICAgICAgICAgICAgICAgICAgICBOYW1lICAgICAgID0+ICRGaWVsZC0+e05hbWV9LAogICAgICAgICAgICAgICAgICAgICAgICBMYWJlbCAgICAgID0+ICRGaWVsZC0+e0xhYmVsfSwKICAgICAgICAgICAgICAgICAgICAgICAgRmllbGRUeXBlICA9PiAkRmllbGQtPntGaWVsZFR5cGV9LAogICAgICAgICAgICAgICAgICAgICAgICBPYmplY3RUeXBlID0+ICRGaWVsZC0+e09iamVjdFR5cGV9LAogICAgICAgICAgICAgICAgICAgICAgICBDb25maWcgICAgID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRmllbGQtPntDb25maWd9e1Bvc3NpYmxlVmFsdWVzfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gKCBQb3NzaWJsZVZhbHVlcyA9PiAkRmllbGQtPntDb25maWd9e1Bvc3NpYmxlVmFsdWVzfSApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgbXkgJFNjcmVlbkR5bmFtaWNGaWVsZHMgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5HZXQoIlJTOkFQSTo6VGlja2V0OjpNb2JpbGVTY3JlZW46OkR5bmFtaWNGaWVsZHMiKTsKICAgICAgICAgICAgbXkgJER5bmFtaWNGaWVsZFNldCA9IHt9OwogICAgICAgICAgICBteSAkQWxsRHluYW1pY0ZpZWxkcyA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEeW5hbWljRmllbGQnKS0+RHluYW1pY0ZpZWxkTGlzdEdldCgKICAgICAgICAgICAgICAgIE9iamVjdFR5cGUgPT4gJ1RpY2tldCcKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICMgVHJhbnNmb3JtIHRoZSBkYXRlIHZhbHVlcyBmcm9tIHRoZSB0aWNrZXQgZGF0YSAoYnV0IG5vdCB0aGUgZHluYW1pYyBmaWVsZCB2YWx1ZXMpLgogICAgICAgICAgICBBVFRSSUJVVEU6CiAgICAgICAgICAgIGZvciBteSAkQXR0cmlidXRlICggc29ydCBrZXlzICVUaWNrZXQgKSB7CiAgICAgICAgICAgICAgICBpZiAoICRBdHRyaWJ1dGUgPX4gbXsgXEEgRHluYW1pY0ZpZWxkXyhcdyspIH14bXMgKSB7CiAgICAgICAgICAgICAgICAgICAgbXkgJFRpY2tldERGVmFsdWUgPSBkZWxldGUgJFRpY2tldHskQXR0cmlidXRlfTsKCiAgICAgICAgICAgICAgICAgICAgbmV4dCBBVFRSSUJVVEUgaWYgJER5bmFtaWNGaWVsZHNNb2RlIGVxICdub25lJzsKCiAgICAgICAgICAgICAgICAgICAgbXkgJER5bmFtaWNGaWVsZE5hbWUgPSAkMTsKICAgICAgICAgICAgICAgICAgICBteSAkRHluYW1pY0ZpZWxkVHlwZTsKICAgICAgICAgICAgICAgICAgICBmb3IgbXkgJER5bmFtaWNGaWVsZCAoIEB7JEFsbER5bmFtaWNGaWVsZHN9ICkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoICREeW5hbWljRmllbGQtPntOYW1lfSBlcSAkRHluYW1pY0ZpZWxkTmFtZSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICREeW5hbWljRmllbGRUeXBlID0gJER5bmFtaWNGaWVsZC0+e0ZpZWxkVHlwZX07CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICggJER5bmFtaWNGaWVsZHNNb2RlIGVxICdtb2JpbGUnICkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgbXkgJFNjcmVlbiAoIHNvcnQga2V5cyAleyRTY3JlZW5EeW5hbWljRmllbGRzfSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IGV4aXN0cyAkU2NyZWVuRHluYW1pY0ZpZWxkcy0+eyRTY3JlZW59CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHskRHluYW1pY0ZpZWxkTmFtZX07CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBleGlzdHMgJER5bmFtaWNGaWVsZFNldC0+eyREeW5hbWljRmllbGROYW1lfSApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJER5bmFtaWNGaWVsZFNldC0+eyREeW5hbWljRmllbGROYW1lfXtTY3JlZW5zfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyRTY3JlZW59ID0gJFNjcmVlbkR5bmFtaWNGaWVsZHMtPnskU2NyZWVufQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyREeW5hbWljRmllbGROYW1lfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICREeW5hbWljRmllbGRTZXQtPnskRHluYW1pY0ZpZWxkTmFtZX17TmFtZX0gPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJER5bmFtaWNGaWVsZE5hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJER5bmFtaWNGaWVsZFNldC0+eyREeW5hbWljRmllbGROYW1lfXtUeXBlfSA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRHluYW1pY0ZpZWxkVHlwZTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkRHluYW1pY0ZpZWxkVHlwZSBlcSAnRHJvcGRvd24nICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRHluYW1pY0ZpZWxkU2V0LT57JER5bmFtaWNGaWVsZE5hbWV9e1ZhbHVlfSA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRHluYW1pY0ZpZWxkcy0+eyAkRHluYW1pY0ZpZWxkTmFtZSB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgQ29uZmlnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBQb3NzaWJsZVZhbHVlcyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgJFRpY2tldERGVmFsdWUgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICREeW5hbWljRmllbGRTZXQtPnskRHluYW1pY0ZpZWxkTmFtZX17VmFsdWV9ID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVGlja2V0REZWYWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICREeW5hbWljRmllbGRTZXQtPnskRHluYW1pY0ZpZWxkTmFtZX17U2NyZWVuc30KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHskU2NyZWVufSA9ICRTY3JlZW5EeW5hbWljRmllbGRzLT57JFNjcmVlbn0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHskRHluYW1pY0ZpZWxkTmFtZX07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzaWYgKCAkRHluYW1pY0ZpZWxkc01vZGUgZXEgJ2FsbCcgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBteSAkU2NyZWVuICggc29ydCBrZXlzICV7JFNjcmVlbkR5bmFtaWNGaWVsZHN9ICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBleGlzdHMgJER5bmFtaWNGaWVsZFNldC0+eyREeW5hbWljRmllbGROYW1lfSApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGlzdHMgJFNjcmVlbkR5bmFtaWNGaWVsZHMtPnskU2NyZWVufQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7JER5bmFtaWNGaWVsZE5hbWV9ICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICREeW5hbWljRmllbGRTZXQtPnskRHluYW1pY0ZpZWxkTmFtZX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7U2NyZWVuc317JFNjcmVlbn0gPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRTY3JlZW5EeW5hbWljRmllbGRzLT57JFNjcmVlbn0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7JER5bmFtaWNGaWVsZE5hbWV9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICREeW5hbWljRmllbGRTZXQtPnskRHluYW1pY0ZpZWxkTmFtZX17TmFtZX0gPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJER5bmFtaWNGaWVsZE5hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJER5bmFtaWNGaWVsZFNldC0+eyREeW5hbWljRmllbGROYW1lfXtUeXBlfSA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRHluYW1pY0ZpZWxkVHlwZTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkRHluYW1pY0ZpZWxkVHlwZSBlcSAnRHJvcGRvd24nICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRHluYW1pY0ZpZWxkU2V0LT57JER5bmFtaWNGaWVsZE5hbWV9e1ZhbHVlfSA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRHluYW1pY0ZpZWxkcy0+eyAkRHluYW1pY0ZpZWxkTmFtZSB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgQ29uZmlnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBQb3NzaWJsZVZhbHVlcyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgJFRpY2tldERGVmFsdWUgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICREeW5hbWljRmllbGRTZXQtPnskRHluYW1pY0ZpZWxkTmFtZX17VmFsdWV9ID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVGlja2V0REZWYWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RzICRTY3JlZW5EeW5hbWljRmllbGRzLT57JFNjcmVlbn0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyREeW5hbWljRmllbGROYW1lfSApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkRHluYW1pY0ZpZWxkU2V0LT57JER5bmFtaWNGaWVsZE5hbWV9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1NjcmVlbnN9eyRTY3JlZW59ID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkU2NyZWVuRHluYW1pY0ZpZWxkcy0+eyRTY3JlZW59CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyREeW5hbWljRmllbGROYW1lfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIG5leHQgQVRUUklCVVRFOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIG5leHQgQVRUUklCVVRFIGlmICEkVGlja2V0eyRBdHRyaWJ1dGV9OwoKICAgICAgICAgICAgICAgIGlmICggJFRpY2tldHskQXR0cmlidXRlfSA9fiBte1xBKFxkXGRcZFxkKS0oXGRcZCktKFxkXGQpXHMoXGRcZCk6KFxkXGQpOihcZFxkKVx6fXhpICkgewogICAgICAgICAgICAgICAgICAgIG15ICRPcmlnaW5WYWx1ZSA9ICRUaWNrZXR7JEF0dHJpYnV0ZX07CiAgICAgICAgICAgICAgICAgICAgJFRpY2tldHskQXR0cmlidXRlLiJTZXJ2ZXIifSA9ICRUaWNrZXR7JEF0dHJpYnV0ZX07CgogICAgICAgICAgICAgICAgICAgICRUaWNrZXR7JEF0dHJpYnV0ZX0gPSAkTGFuZ3VhZ2VPYmplY3QtPkZvcm1hdFRpbWVTdHJpbmcoCiAgICAgICAgICAgICAgICAgICAgICAgICRPcmlnaW5WYWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgJ0RhdGVGb3JtYXQnLAogICAgICAgICAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgICAgICAgICAxICMg0L3QtSDQtNC+0LHQsNCy0LvRj9C10LwgKFRaKSDQsiDQv9GA0LXQvtCx0YDQsNC30L7QstCw0L3QvdGD0Y4g0LTQsNGC0YMKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkVGlja2V0e0R5bmFtaWNGaWVsZHN9ID0gJER5bmFtaWNGaWVsZFNldDsKCiAgICAgICAgICAgICRUaWNrZXR7U2VydmljZUlEfSB8fD0gdW5kZWY7CiAgICAgICAgICAgICRUaWNrZXR7U0xBSUR9ICAgICB8fD0gdW5kZWY7CgogICAgICAgICAgICAjINCd0LDQsdC70Y7QtNCw0YLQtdC70LgKICAgICAgICAgICAgbXkgQFdhdGNoZXJzID0gJFRpY2tldE9iamVjdC0+VGlja2V0V2F0Y2hHZXQoCiAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkVGlja2V0eyBUaWNrZXRJRCB9LAogICAgICAgICAgICAgICAgUmVzdWx0ICAgPT4gJ0FSUkFZJwogICAgICAgICAgICApOwoKICAgICAgICAgICAgJFRpY2tldHsgV2F0Y2hlckNvdW50IH0gPSBAV2F0Y2hlcnM7CiAgICAgICAgICAgICRUaWNrZXR7IEhhc1dhdGNoIH0gPSAwOwoKICAgICAgICAgICAgZm9yIChAV2F0Y2hlcnMpIHsKICAgICAgICAgICAgICAgIGlmICggJFBhcmFte1VzZXJJRH0gPT0gJF8gKSB7CiAgICAgICAgICAgICAgICAgICAgJFRpY2tldHsgSGFzV2F0Y2ggfSA9IDE7CiAgICAgICAgICAgICAgICAgICAgbGFzdDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgbXkgJUZsYWdzID0gJFRpY2tldE9iamVjdC0+VGlja2V0RmxhZ0dldCgKICAgICAgICAgICAgICAgIFRpY2tldElEID0+ICRUaWNrZXRJRHNbJGldLAogICAgICAgICAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmICggJEZsYWdzeyBTZWVuIH0gKSB7CiAgICAgICAgICAgICAgICAkVGlja2V0e1NlZW59ID0gMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICRUaWNrZXR7U2Vlbn0gPSAwOwogICAgICAgICAgICB9CgogICAgICAgICAgICBteSAlQ3VzdG9tZXJVc2VyID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkN1c3RvbWVyVXNlcicpLT5DdXN0b21lclVzZXJEYXRhR2V0KAogICAgICAgICAgICAgICAgVXNlciA9PiAkVGlja2V0eyBDdXN0b21lclVzZXJJRCB9CiAgICAgICAgICAgICk7CgogICAgICAgICAgICAkVGlja2V0eyBDdXN0b21lclVzZXJGaXJzdG5hbWUgfSA9ICRDdXN0b21lclVzZXJ7IFVzZXJGaXJzdG5hbWUgfTsKICAgICAgICAgICAgJFRpY2tldHsgQ3VzdG9tZXJVc2VyTGFzdG5hbWUgfSAgPSAkQ3VzdG9tZXJVc2VyeyBVc2VyTGFzdG5hbWUgfTsKCiAgICAgICAgICAgICMg0JrQvtC70LjRh9C10YHRgtCy0L4g0YHRgtCw0YLQtdC5INC/0YDQuCDQv9C+0LTRgNC+0LHQvdC+0Lwg0L/RgNC+0YHQvNC+0YLRgNC1CiAgICAgICAgICAgIGlmICggJFRpY2tldFBhcmFte1RpY2tldElEfSApIHsKICAgICAgICAgICAgICAgICRBcnRpY2xlT2JqZWN0LT5fQXJ0aWNsZUNhY2hlQ2xlYXIoCiAgICAgICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFRpY2tldFBhcmFte1RpY2tldElEfQogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICBteSBAQWxsQXJ0aWNsZXMgPSAkQXJ0aWNsZU9iamVjdC0+QXJ0aWNsZUxpc3QoCiAgICAgICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFRpY2tldFBhcmFte1RpY2tldElEfQogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAkVGlja2V0eyBBcnRpY2xlQ291bnQgfSA9IEBBbGxBcnRpY2xlczsKCiAgICAgICAgICAgICAgICAkVGlja2V0eyBDb25zdW1lZFRpbWUgfSA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEFjY291bnRlZFRpbWVHZXQoCiAgICAgICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFRpY2tldFBhcmFte1RpY2tldElEfQogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICBteSAkTGlua3M9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMaW5rT2JqZWN0JyktPkxpbmtMaXN0V2l0aERhdGEoCiAgICAgICAgICAgICAgICAgICAgT2JqZWN0ICAgPT4gJ1RpY2tldCcsCiAgICAgICAgICAgICAgICAgICAgS2V5ICAgICAgPT4gJFRpY2tldFBhcmFteyBUaWNrZXRJRCB9LAogICAgICAgICAgICAgICAgICAgIE9iamVjdDIgICA9PiAnVGlja2V0JywKICAgICAgICAgICAgICAgICAgICBTdGF0ZSAgICAgPT4gJ1ZhbGlkJywKICAgICAgICAgICAgICAgICAgICBVc2VySUQgICAgPT4gMSwKICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgbXkgJVR5cGVMaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxpbmtPYmplY3QnKS0+VHlwZUxpc3QoCiAgICAgICAgICAgICAgICAgICAgVXNlcklEID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgIG15IEBMaW5rcyA9ICgpOwogICAgICAgICAgICAgICAgZm9yIG15ICRMaW5rVHlwZSAoIGtleXMgJXsgJExpbmtzLT57VGlja2V0fSB9ICkgewogICAgICAgICAgICAgICAgICAgIGZvciBteSAkTGlua0Rlc3QgKHF3L1NvdXJjZSBUYXJnZXQvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBteSAkVGlja2V0SUQgKCBrZXlzICV7ICRMaW5rcy0+e1RpY2tldH17ICRMaW5rVHlwZSB9eyAkTGlua0Rlc3QgfSB9ICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbXkgJFRpY2tldCA9ICRMaW5rcy0+e1RpY2tldH17ICRMaW5rVHlwZSB9eyAkTGlua0Rlc3QgfXsgJFRpY2tldElEIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdXNoIEBMaW5rcywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpY2tldElEICAgICA9PiAkVGlja2V0SUQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGlja2V0TnVtYmVyID0+ICRUaWNrZXQtPntUaWNrZXROdW1iZXJ9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpdGxlICAgICAgPT4gJFRpY2tldC0+e1RpdGxlfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQcmlvcml0eUlEID0+ICRUaWNrZXQtPntQcmlvcml0eUlEfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUeXBlSUQgICAgID0+ICRUaWNrZXQtPntUeXBlSUR9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExpbmtUeXBlICAgPT4gJExpbmtUeXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExpbmtEZXN0ICAgPT4gJExpbmtEZXN0LAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaW5rVHlwZVRpdGxlID0+ICRUeXBlTGlzdHsgJExpbmtUeXBlIH17ICRMaW5rRGVzdC4nTmFtZScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJFRpY2tldHsgTGlua3MgfSA9IFxATGlua3M7CiAgICAgICAgICAgICAgICAkVGlja2V0eyBMaW5rQ291bnQgfSA9IHNjYWxhciBATGlua3M7CgogICAgICAgICAgICAgICAgIyDQktC70L7QttC10L3QuNGPCiAgICAgICAgICAgICAgICBteSAkRmlyc3RBcnRpY2xlSUQgPSAkQWxsQXJ0aWNsZXNbMF17IEFydGljbGVJRCB9OwogICAgICAgICAgICAgICAgbXkgJEFydGljbGVCYWNrZW5kT2JqZWN0ID0gJEFydGljbGVPYmplY3QtPkJhY2tlbmRGb3JBcnRpY2xlKAogICAgICAgICAgICAgICAgICAgIFRpY2tldElEICA9PiAkVGlja2V0UGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICAgICAgICAgIEFydGljbGVJRCA9PiAkRmlyc3RBcnRpY2xlSUQKICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgbXkgJUF0dGFjaG1lbnRzID0gJEFydGljbGVCYWNrZW5kT2JqZWN0LT5BcnRpY2xlQXR0YWNobWVudEluZGV4KAogICAgICAgICAgICAgICAgICAgIEFydGljbGVJRCA9PiAkRmlyc3RBcnRpY2xlSUQsCiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgIG15IEBBdHRzID0gKCk7CiAgICAgICAgICAgICAgICBteSAkSFRNTEJvZHk7CiAgICAgICAgICAgICAgICBmb3IgbXkgJEZpbGVJRCAoIGtleXMgJUF0dGFjaG1lbnRzICkgewogICAgICAgICAgICAgICAgICAgIGZvciBteSAkRmllbGQgKCBrZXlzICV7ICRBdHRhY2htZW50c3skRmlsZUlEfSB9ICkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGRlZmluZWQgJEF0dGFjaG1lbnRzeyRGaWxlSUR9LT57JEZpZWxkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kICRBdHRhY2htZW50c3skRmlsZUlEfS0+eyRGaWVsZH0gZXEgJycgKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQXR0YWNobWVudHN7JEZpbGVJRH0tPnskRmllbGR9ID0gdW5kZWY7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICggJEF0dGFjaG1lbnRzeyRGaWxlSUR9LT57RGlzcG9zaXRpb259IGVxICdhdHRhY2htZW50JyApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwdXNoIEBBdHRzLAogICAgICAgICAgICAgICAgICAgICAgICAgIHsgRmlsZUlEID0+ICRGaWxlSUQsICV7ICRBdHRhY2htZW50c3skRmlsZUlEfSB9IH07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkSFRNTEJvZHkgPSAkQXR0YWNobWVudHN7JEZpbGVJRH07CgogICAgICAgICAgICAgICAgICAgICAgICAkSFRNTEJvZHktPntGaWxlSUR9ID0gJEZpbGVJRDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJFRpY2tldHsgQXR0YWNobWVudHMgfSA9IFxAQXR0czsKICAgICAgICAgICAgICAgICRUaWNrZXR7SFRNTEJvZHl9ICAgICAgPSAkSFRNTEJvZHk7CgogICAgICAgICAgICAgICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgICAgICBteSBAQXR0YWNobWVudEFsbCA9ICgpOwogICAgICAgICAgICAgICAgZm9yIG15ICRBcnRpY2xlICggQEFsbEFydGljbGVzICkgewogICAgICAgICAgICAgICAgICAgIG15ICRBcnRpY2xlSUQgPSAkQXJ0aWNsZS0+e0FydGljbGVJRH07CgogICAgICAgICAgICAgICAgICAgIG15ICVBdHRhY2htZW50cyA9ICRBcnRpY2xlQmFja2VuZE9iamVjdC0+QXJ0aWNsZUF0dGFjaG1lbnRJbmRleCgKICAgICAgICAgICAgICAgICAgICAgICAgQXJ0aWNsZUlEID0+ICRBcnRpY2xlSUQKICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICBmb3IgbXkgJEZpbGVJRCAoIGtleXMgJUF0dGFjaG1lbnRzICkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgbXkgJEZpZWxkICgga2V5cyAleyAkQXR0YWNobWVudHN7JEZpbGVJRH0gfSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggZGVmaW5lZCAkQXR0YWNobWVudHN7JEZpbGVJRH0tPnskRmllbGR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kICRBdHRhY2htZW50c3skRmlsZUlEfS0+eyRGaWVsZH0gZXEgJycgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRBdHRhY2htZW50c3skRmlsZUlEfS0+eyRGaWVsZH0gPSB1bmRlZjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkQXR0YWNobWVudHN7JEZpbGVJRH0tPntEaXNwb3NpdGlvbn0gZXEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdhdHRhY2htZW50JyApCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1c2ggQEF0dGFjaG1lbnRBbGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGaWxlSUQgPT4gJEZpbGVJRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAleyAkQXR0YWNobWVudHN7JEZpbGVJRH0gfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBcnRpY2xlSUQgPT4gJEFydGljbGVJRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkVGlja2V0eyBBdHRhY2htZW50QWxsIH0gPSBcQEF0dGFjaG1lbnRBbGw7CiAgICAgICAgICAgICAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAgICAgICAgICAgICAjINCd0LDQsdC70Y7QtNCw0YLQtdC70LgKICAgICAgICAgICAgICAgIG15IEBXYXRjaGVycyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFdhdGNoR2V0KAogICAgICAgICAgICAgICAgICAgIFRpY2tldElEID0+ICRUaWNrZXRQYXJhbXsgVGlja2V0SUQgfSwKICAgICAgICAgICAgICAgICAgICBSZXN1bHQgICA9PiAnQVJSQVknCiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICRUaWNrZXR7IFdhdGNoZXJzIH0gPSBbXTsKCiAgICAgICAgICAgICAgICBmb3IgbXkgJFdhdGNoZXJVc2VySUQgKCBAV2F0Y2hlcnMgKSB7CiAgICAgICAgICAgICAgICAgICAgbXkgJVVzZXIgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VXNlcicpLT5HZXRVc2VyRGF0YSgKICAgICAgICAgICAgICAgICAgICAgICAgVXNlcklEID0+ICRXYXRjaGVyVXNlcklECiAgICAgICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAgICAgcHVzaCBAeyAkVGlja2V0eyBXYXRjaGVycyB9IH0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgRmlyc3ROYW1lID0+ICRVc2VyeyBVc2VyRmlyc3RuYW1lIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIExhc3ROYW1lICA9PiAkVXNlcnsgVXNlckxhc3RuYW1lIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJJRCAgICA9PiAkV2F0Y2hlclVzZXJJRCwKICAgICAgICAgICAgICAgICAgICAgICAgTG9naW4gICAgID0+ICRVc2VyeyBVc2VyTG9naW4gfQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CgoKICAgICAgICAgICAgICAgIGlmICggJFRpY2tldHsgT3duZXJJRCB9ICkgewogICAgICAgICAgICAgICAgICAgIG15ICVVc2VyID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlVzZXInKS0+R2V0VXNlckRhdGEoCiAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJJRCA9PiAkVGlja2V0eyBPd25lcklEIH0KICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICAkVGlja2V0e093bmVyRmlyc3RuYW1lfSA9ICRVc2VyeyBVc2VyRmlyc3RuYW1lIH07CiAgICAgICAgICAgICAgICAgICAgJFRpY2tldHtPd25lckxhc3RuYW1lfSAgPSAkVXNlcnsgVXNlckxhc3RuYW1lIH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICggIWV4aXN0cyAkVGlja2V0eyBMaW5rQ291bnQgfSApIHsKICAgICAgICAgICAgICAgIG15ICVMaW5rS2V5TGlzdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMaW5rT2JqZWN0JyktPkxpbmtLZXlMaXN0KAogICAgICAgICAgICAgICAgICAgIE9iamVjdDEgICA9PiAnVGlja2V0JywKICAgICAgICAgICAgICAgICAgICBLZXkxICAgICAgPT4gJFRpY2tldElEc1skaV0sCiAgICAgICAgICAgICAgICAgICAgT2JqZWN0MiAgID0+ICdUaWNrZXQnLAogICAgICAgICAgICAgICAgICAgIFN0YXRlICAgICA9PiAnVmFsaWQnLAogICAgICAgICAgICAgICAgICAgIFVzZXJJRCAgICA9PiAxLAogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAkVGlja2V0eyBMaW5rQ291bnQgfSA9IHNjYWxhciBrZXlzICVMaW5rS2V5TGlzdDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJFRpY2tldHsgVW50aWxUaW1lRGF0ZSB9ICAgICA9IDA7CiAgICAgICAgICAgICRUaWNrZXR7IFVudGlsVGltZURhdGVVbml4IH0gPSAwOwoKICAgICAgICAgICAgaWYgKCAkVGlja2V0eyBVbnRpbFRpbWUgfSApIHsKICAgICAgICAgICAgICAgICRUaWNrZXR7IFVudGlsVGltZURhdGVVbml4IH0gPSAkVGlja2V0eyBVbnRpbFRpbWUgfSArIHRpbWU7CgogICAgICAgICAgICAgICAgbXkgJERhdGVUaW1lT2JqZWN0ID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgKICAgICAgICAgICAgICAgICAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICAgICAgICAgICAgICAgICBPYmplY3RQYXJhbXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBFcG9jaCA9PiAkVGlja2V0eyBVbnRpbFRpbWVEYXRlVW5peCB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICBteSAkU3VjY2VzcyA9ICREYXRlVGltZU9iamVjdC0+VG9UaW1lWm9uZSgKICAgICAgICAgICAgICAgICAgICBUaW1lWm9uZSA9PiAkVXNlcntVc2VyVGltZVpvbmV9CiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgIGlmICggJFN1Y2Nlc3MgKSB7CiAgICAgICAgICAgICAgICAgICAgJFRpY2tldHsgVW50aWxUaW1lRGF0ZSB9ID0gJERhdGVUaW1lT2JqZWN0LT5Ub1N0cmluZzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiQ2Fubm90IGNvbnZlcnQgIiAuICRUaWNrZXR7IFVudGlsVGltZURhdGVVbml4IH0KICAgICAgICAgICAgICAgICAgICAgICAgICAuICIgdG8gVXNlclRpbWVab25lICgnJFVzZXJ7VXNlclRpbWVab25lfScpIHZhbHVlIgogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRUaWNrZXR7IENyZWF0ZVRpbWVVbml4IH0gPSBzdHIydGltZSggJFRpY2tldHtDcmVhdGVkU2VydmVyfS4gJyswMDAwJyApOwoKICAgICAgICAgICAgIyBUYWtlIGludG8gYWNjb3VudCB0eXBlIG9mIGZpZWxkcyB3aGVuIHRoZXkgYXJlIGVtcHR5CiAgICAgICAgICAgICMgVE9ETzogcmVtb3ZlZCBldmVyeXRoaW5nIG5vdCBmb3IgdGlja2V0CiAgICAgICAgICAgIG15ICRUaWNrZXQgPSAkU2VsZi0+X0NsZWFyT2JqZWN0RmllbGRzKAogICAgICAgICAgICAgICAgT2JqZWN0ID0+IFwlVGlja2V0LAogICAgICAgICAgICAgICAgVHlwZSAgID0+ICdUaWNrZXQnCiAgICAgICAgICAgICk7CgogICAgICAgICAgICBwdXNoIEBUaWNrZXRMaXN0LCAkVGlja2V0OwoKICAgICAgICAgICAgJGkrKwogICAgICAgIH0KCiAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ09LJywKICAgICAgICAgICAgVGlja2V0cyAgPT4gXEBUaWNrZXRMaXN0LAogICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAkVGlja2V0SURJbmRpcmVjdAogICAgICAgICAgICAgICAgPyAoCiAgICAgICAgICAgICAgICAgICAgVGlja2V0SURGcm9tRnVsbFRleHRTZWFyY2ggPT4gJFRpY2tldElESW5kaXJlY3QsCiAgICAgICAgICAgICAgICAgICAgVGlja2V0RnJvbUZ1bGxUZXh0U2VhcmNoICAgPT4gJFRpY2tldEluZGlyZWN0CiAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIDogKCkKICAgICAgICAgICAgKSwKICAgICAgICAgICAgTmVlZFRva2VuVXBkYXRlID0+ICROZWVkVG9rZW5VcGRhdGUKICAgICAgICB9OwogICAgfQoKICAgIHJldHVybiAkUmVzdWx0Owp9CgpzdWIgVXBkYXRlTG9jayB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRSZXN1bHQ7CiAgICBteSAkVGlja2V0T2JqZWN0ID0gJFNlbGYtPntUaWNrZXRPYmplY3R9OwoKICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoCiAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICElVGlja2V0ICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdObyB0aWNrZXQnCiAgICAgICAgfTsKICAgIH0KCiAgICBpZiAoICRUaWNrZXR7T3duZXJJRH0gIT0gJFBhcmFte1VzZXJJRH0gKSB7CiAgICAgICAgbXkgJEhhc1Blcm1pc3Npb24gPSAkU2VsZi0+X0NoZWNrR3JvdXBQZXJtaXNzaW9uKAogICAgICAgICAgICBRdWV1ZUlEID0+ICRUaWNrZXR7UXVldWVJRH0sCiAgICAgICAgICAgIFVzZXJJRCAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICApOwoKICAgICAgICBpZiAoICEkSGFzUGVybWlzc2lvbiApIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gcGVybWlzc2lvbicKICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICB9CgogICAgbXkgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRMb2NrU2V0KAogICAgICAgIExvY2sgICAgID0+ICRQYXJhbXtMb2NrfSwKICAgICAgICBMb2NrSUQgICA9PiAkUGFyYW17TG9ja0lEfSwKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggJFN1Y2Nlc3MgKSB7CgogICAgICAgIGlmICggJFRpY2tldE9iamVjdC0+VGlja2V0TG9ja0dldCgKICAgICAgICAgICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0KICAgICAgICAgICAgICkgKSB7CgogICAgICAgICAgICBteSAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldE93bmVyU2V0KAogICAgICAgICAgICAgICAgTmV3VXNlcklEID0+ICRQYXJhbXtVc2VySUR9LAogICAgICAgICAgICAgICAgVGlja2V0SUQgID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgICAgICBVc2VySUQgICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmICggJFN1Y2Nlc3MgKSB7CiAgICAgICAgICAgICAgICAkUmVzdWx0ID0geyBSZXNwb25zZSA9PiAiT0siIH07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIlRpY2tldCB3YXMgbG9ja2VkIGJ1dCBPd25lciBjb3VsZG4ndCBiZSBjaGFuZ2VkIiwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJFJlc3VsdCA9IHsgUmVzcG9uc2UgPT4gIk9LIiB9OwogICAgICAgIH0KCiAgICB9IGVsc2UgewogICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJDb3VsZG4ndCB1cGRhdGUgbG9jayBzdGF0ZSIsCiAgICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gJFJlc3VsdDsKfQoKc3ViIE1hcmtUaWNrZXRBc1NlZW4gewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkUmVzdWx0OwoKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkU2VsZi0+e1RpY2tldE9iamVjdH07CgogICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISVUaWNrZXQgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHRpY2tldCcKICAgICAgICB9OwogICAgfQoKICAgIG15ICRIYXNQZXJtaXNzaW9uID0gJFNlbGYtPl9DaGVja0dyb3VwUGVybWlzc2lvbigKICAgICAgICBRdWV1ZUlEID0+ICRUaWNrZXR7UXVldWVJRH0sCiAgICAgICAgVHlwZSAgICA9PiBbJ3JvJ10sCiAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICEkSGFzUGVybWlzc2lvbiApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gcGVybWlzc2lvbicKICAgICAgICB9OwogICAgfQoKICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0RmxhZ1NldCgKICAgICAgICBLZXkgICAgICA9PiAnU2VlbicsCiAgICAgICAgVmFsdWUgICAgPT4gJFBhcmFte1NlZW59LAogICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAkU3VjY2VzcyApIHsKCiAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gIk9LIgogICAgICAgIH07CgogICAgfSBlbHNlIHsKCiAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkNvdWxkbid0IG1hcmsgdGlja2V0IGFzIHNlZW4iLAogICAgICAgIH07CiAgICB9CgogICAgcmV0dXJuICRSZXN1bHQ7Cn0KCnN1YiBNYXJrQXJ0aWNsZUFzU2VlbiB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkU2VsZi0+e1RpY2tldE9iamVjdH07CgogICAgbXkgJEFydGljbGVPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VGlja2V0OjpBcnRpY2xlJyk7CgogICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISVUaWNrZXQgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHRpY2tldCcKICAgICAgICB9OwogICAgfQoKICAgICMgVE9ETzogY2hlY2sgVGlja2V0R2V0IHBlcm1pc3Npb25zIGNoZWNrIHdpdGggdGhpcyBvbmUKICAgIG15ICRIYXNQZXJtaXNzaW9uID0gJFNlbGYtPl9DaGVja0dyb3VwUGVybWlzc2lvbigKICAgICAgICBRdWV1ZUlEID0+ICRUaWNrZXR7UXVldWVJRH0sCiAgICAgICAgVHlwZSAgICA9PiBbJ3JvJ10sCiAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICEkSGFzUGVybWlzc2lvbiApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gcGVybWlzc2lvbicKICAgICAgICB9OwogICAgfQoKICAgICMgVE9ETzog0L/QtdGA0LXQtNC10LvQsNGC0YwKICAgIG15ICRBcnRpY2xlUm93ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkRCJyktPlNlbGVjdEFsbCgKICAgICAgICBTUUwgPT4gcXsKICAgICAgICAgICAgU0VMRUNUIHRpY2tldF9pZCBGUk9NIGFydGljbGUgV0hFUkUgaWQgPSA/CiAgICAgICAgfSwKICAgICAgICBCaW5kID0+IFsgXCRQYXJhbXtBcnRpY2xlSUR9IF0KICAgICkgLy8gW107CgogICAgbXkgJFRpY2tldElEID0gJFBhcmFte1RpY2tldElEfSB8fCAwOwoKICAgIGlmICggISRUaWNrZXRJRCBhbmQgQHsgJEFydGljbGVSb3cgfSApIHsKICAgICAgICAkVGlja2V0SUQgPSAkQXJ0aWNsZVJvdy0+WzBdWzBdOwogICAgfQoKICAgIG15ICRSZXN1bHQ7CiAgICBpZiAoICEkVGlja2V0SUQgKSB7CiAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIFRpY2tldElEIgogICAgICAgIH07CiAgICB9CgogICAgbXkgJFN1Y2Nlc3M7CgogICAgaWYgKCAkVGlja2V0SUQgKSB7CiAgICAgICAgJFN1Y2Nlc3MgPSAkQXJ0aWNsZU9iamVjdC0+QXJ0aWNsZUZsYWdTZXQoCiAgICAgICAgICAgIEtleSAgICAgICA9PiAnU2VlbicsCiAgICAgICAgICAgIFZhbHVlICAgICA9PiAkUGFyYW17U2Vlbn0sCiAgICAgICAgICAgIFRpY2tldElEICA9PiAkVGlja2V0SUQsCiAgICAgICAgICAgIEFydGljbGVJRCA9PiAkUGFyYW17QXJ0aWNsZUlEfSwKICAgICAgICAgICAgVXNlcklEICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKICAgIH0KCiAgICBpZiAoICRTdWNjZXNzICkgewoKICAgICAgICBteSAkQXJ0aWNsZUJhY2tlbmRPYmplY3QgPSAkQXJ0aWNsZU9iamVjdC0+QmFja2VuZEZvckFydGljbGUoCiAgICAgICAgICAgIFRpY2tldElEICA9PiAkVGlja2V0SUQsCiAgICAgICAgICAgIEFydGljbGVJRCA9PiAkUGFyYW17QXJ0aWNsZUlEfSwKICAgICAgICApOwoKICAgICAgICBteSAlQXJ0aWNsZSA9ICRBcnRpY2xlQmFja2VuZE9iamVjdC0+QXJ0aWNsZUdldCgKICAgICAgICAgICAgVGlja2V0SUQgID0+ICRUaWNrZXRJRCwKICAgICAgICAgICAgQXJ0aWNsZUlEICAgICA9PiAkUGFyYW17QXJ0aWNsZUlEfSwKICAgICAgICAgICAgRHluYW1pY0ZpZWxkcyA9PiAwLAogICAgICAgICAgICBVc2VySUQgICAgICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKCiAgICAgICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICAgICAgVGlja2V0SUQgPT4gJEFydGljbGV7VGlja2V0SUR9LAogICAgICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICk7CgogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5EZWxldGUoCiAgICAgICAgICAgIFR5cGUgPT4gJ1RpY2tldCcsCiAgICAgICAgICAgIEtleSAgPT4gJ1RpY2tldEZsYWc6OicuJEFydGljbGV7VGlja2V0SUR9CiAgICAgICAgKTsKCiAgICAgICAgbXkgJUZsYWdzID0gJFRpY2tldE9iamVjdC0+VGlja2V0RmxhZ0dldCgKICAgICAgICAgICAgVGlja2V0SUQgPT4gJEFydGljbGV7VGlja2V0SUR9LAogICAgICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICk7CgogICAgICAgIGlmICggJEZsYWdzeyBTZWVuIH0gKSB7CiAgICAgICAgICAgICRUaWNrZXR7U2Vlbn0gPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRUaWNrZXR7U2Vlbn0gPSAwOwogICAgICAgIH0KCiAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgUmVzcG9uc2UgICA9PiAiT0siLAogICAgICAgICAgICBUaWNrZXRJRCAgID0+ICRUaWNrZXRJRCwKICAgICAgICAgICAgVGlja2V0U2VlbiA9PiAkVGlja2V0e1NlZW59CiAgICAgICAgfTsKCiAgICB9IGVsc2UgewoKICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiQ291bGRuJ3QgbWFyayBhcnRpY2xlIGFzIHNlZW4iLAogICAgICAgIH07CiAgICB9CgogICAgcmV0dXJuICRSZXN1bHQ7Cn0KCnN1YiBVcGRhdGVUaWNrZXQgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkUmVzdWx0OwoKICAgIG15ICVUaWNrZXQgPSAkU2VsZi0+e1RpY2tldE9iamVjdH0tPlRpY2tldEdldCgKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9LAogICAgICAgIFNpbGVudCAgID0+IDEKICAgICk7CgogICAgaWYgKCAhJVRpY2tldCApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gdGlja2V0JwogICAgICAgIH07CiAgICB9CgogICAgbXkgQEZpZWxkc0ZvclVwZGF0ZSA9IHF3LwogICAgICBUaXRsZQogICAgICBRdWV1ZQogICAgICBRdWV1ZUlECiAgICAgIFR5cGUKICAgICAgVHlwZUlECiAgICAgIFNlcnZpY2UKICAgICAgU2VydmljZUlECiAgICAgIFNMQQogICAgICBTTEFJRAogICAgICBDdXN0b21lcklECiAgICAgIEN1c3RvbWVyVXNlcklECiAgICAgIExvY2sKICAgICAgTG9ja0lECiAgICAgIEFyY2hpdmVGbGFnCiAgICAgIFN0YXRlCiAgICAgIFN0YXRlSUQKICAgICAgTmV3T3duZXIKICAgICAgTmV3T3duZXJJRAogICAgICBOZXdSZXNwb25zaWJsZVVzZXIKICAgICAgTmV3UmVzcG9uc2libGVVc2VySUQKICAgICAgUHJpb3JpdHkKICAgICAgUHJpb3JpdHlJRAogICAgICBVbnRpbFRpbWVEYXRlVW5peAogICAgICBZZWFyCiAgICAgIE1vbnRoCiAgICAgIERheQogICAgICBIb3VyCiAgICAgIE1pbnV0ZQogICAgICBEeW5hbWljRmllbGRzCiAgICAgIC87CgogICAgbXkgJEhhc1BhcmFtRm9yVXBkYXRlID0gMDsKICAgIGZvciBteSAkRmllbGROYW1lICggQEZpZWxkc0ZvclVwZGF0ZSApIHsKICAgICAgICBpZiAoIGV4aXN0cyAkUGFyYW17ICRGaWVsZE5hbWUgfSBhbmQgJFBhcmFteyAkRmllbGROYW1lIH0gKSB7CiAgICAgICAgICAgICRIYXNQYXJhbUZvclVwZGF0ZSA9IDE7CiAgICAgICAgICAgIGxhc3Q7CiAgICAgICAgfQogICAgfQoKICAgIGlmICggISRIYXNQYXJhbUZvclVwZGF0ZSApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnUGFzcyBzb21lIGZpZWxkcyBmb3IgdGlja2V0IHVwZGF0ZTogJwogICAgICAgICAgICAgIC4gam9pbiggJywgJywgQEZpZWxkc0ZvclVwZGF0ZSApCiAgICAgICAgfTsKICAgIH0KCiAgICBteSBARmFpbGVkVXBkYXRlZEl0ZW1zID0gJFNlbGYtPl9VcGRhdGVUaWNrZXQoCiAgICAgICAgJVBhcmFtLAogICAgICAgIFRpY2tldCA9PiBcJVRpY2tldAogICAgKTsKCiAgICBpZiAoIEBGYWlsZWRVcGRhdGVkSXRlbXMgKSB7CgogICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJUaGUgZm9sbG93IHBhcmFtZXRlcnMgd2Fzbid0IHVwZGF0ZWQ6ICIuCiAgICAgICAgICAgICAgICAgICAgICAgICBqb2luKCcsICcsIEBGYWlsZWRVcGRhdGVkSXRlbXMgKQogICAgICAgIH07CgogICAgfSBlbHNlIHsKICAgICAgICAkUmVzdWx0ID0geyBSZXNwb25zZSA9PiAiT0siIH07CiAgICB9CgogICAgcmV0dXJuICRSZXN1bHQ7Cn0KCnN1YiBHZXRBcnRpY2xlcyB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRUaWNrZXRPYmplY3QgID0gJFNlbGYtPntUaWNrZXRPYmplY3R9OwogICAgbXkgJEFydGljbGVPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VGlja2V0OjpBcnRpY2xlJyk7CgogICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9LAogICAgICAgIFNpbGVudCAgID0+IDEKICAgICk7CgogICAgaWYgKCAhJVRpY2tldCApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gdGlja2V0JwogICAgICAgIH07CiAgICB9CgogICAgbXkgJEhhc1Blcm1pc3Npb24gPSAkU2VsZi0+X0NoZWNrR3JvdXBQZXJtaXNzaW9uKAogICAgICAgIFF1ZXVlSUQgPT4gJFRpY2tldHtRdWV1ZUlEfSwKICAgICAgICBUeXBlICAgID0+IFsncm8nXSwKICAgICAgICBVc2VySUQgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISRIYXNQZXJtaXNzaW9uICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdObyBwZXJtaXNzaW9uJwogICAgICAgIH07CiAgICB9CgogICAgaWYgKCAkUGFyYW17Q291bnR9ICkgewoKICAgICAgICBteSBAQXJ0aWNsZUJveEFsbCA9ICRBcnRpY2xlT2JqZWN0LT5BcnRpY2xlTGlzdCgKICAgICAgICAgICAgVGlja2V0SUQgICAgICAgICAgICAgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgSXNWaXNpYmxlRm9yQ3VzdG9tZXIgPT4gJFBhcmFte0lzVmlzaWJsZUZvckN1c3RvbWVyfSAvLyAxCiAgICAgICAgKTsKCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gIk9LIiwKICAgICAgICAgICAgQ291bnQgICAgPT4gc2NhbGFyIEBBcnRpY2xlQm94QWxsCiAgICAgICAgfTsKICAgIH0KCiAgICBteSBAQ29tbXVuaWNhdGlvbkNoYW5uZWxzID0gJEtlcm5lbDo6T00KICAgICAgICAtPkdldCgnS2VybmVsOjpTeXN0ZW06OkNvbW11bmljYXRpb25DaGFubmVsJyktPkNoYW5uZWxMaXN0KCk7CgogICAgbXkgJUNoYW5uZWxzID0gbWFwIHsgJF8tPntDaGFubmVsSUR9ID0+ICRfLT57Q2hhbm5lbE5hbWV9IH0gQENvbW11bmljYXRpb25DaGFubmVsczsKCiAgICBpZiAoICElQ2hhbm5lbHMgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gIk9LIiwKICAgICAgICAgICAgQXJ0aWNsZXMgPT4gW10KICAgICAgICB9OwogICAgfQoKICAgIG15IEBNZXRhQXJ0aWNsZXMgPSAkQXJ0aWNsZU9iamVjdC0+QXJ0aWNsZUxpc3QoCiAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICk7CgogICAgJFBhcmFte09yZGVyfSAvLz0gJ0RFU0MnOwoKICAgIGlmICggJFBhcmFte09yZGVyfSBlcSAnREVTQycgKSB7CiAgICAgICAgQE1ldGFBcnRpY2xlcyA9IHJldmVyc2UgQE1ldGFBcnRpY2xlczsKICAgIH0KCiAgICBteSAkTGltaXQgID0gJFBhcmFte0xpbWl0fSAvLyAwOwogICAgbXkgJE9mZnNldDsKCiAgICBpZiAoICRMaW1pdCBhbmQgJFBhcmFte1BhZ2V9IGFuZCAkUGFyYW17UGFnZX0gPiAxICkgewogICAgICAgICRPZmZzZXQgICAgICAgPSAkUGFyYW17UGFnZX0gKiAkTGltaXQ7CiAgICAgICAgQE1ldGFBcnRpY2xlcyA9IHNwbGljZSggQE1ldGFBcnRpY2xlcywgJE9mZnNldCwgJExpbWl0ICk7CiAgICB9IGVsc2lmICggJExpbWl0ICkgewogICAgICAgIEBNZXRhQXJ0aWNsZXMgPSBzcGxpY2UoIEBNZXRhQXJ0aWNsZXMsIDAsICRMaW1pdCApOwogICAgfQoKICAgIG15ICVVc2VyID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlVzZXInKS0+R2V0VXNlckRhdGEoCiAgICAgICAgVXNlcklEID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIG15ICRMYW5ndWFnZU9iamVjdCA9IEtlcm5lbDo6TGFuZ3VhZ2UtPm5ldygKICAgICAgICBVc2VyTGFuZ3VhZ2UgPT4gJ3B0JywgIyBwdCAtINC/0YDQvtGB0YLQviDQv9C+0YLQvtC80YMg0YfRgtC+INGC0LDQvCDQvdGD0LbQvdGL0LkgRGF0ZUZvcm1hdCBZLU0tRCBIOk06UwogICAgICAgIFVzZXJUaW1lWm9uZSA9PiAkVXNlcntVc2VyVGltZVpvbmV9CiAgICApOwoKICAgIG15IEBBcnRpY2xlcyA9ICgpOwogICAgZm9yIG15ICRNZXRhQXJ0aWNsZSAoIEBNZXRhQXJ0aWNsZXMgKSB7CiAgICAgICAgbXkgJUFydGljbGUgPSAkQXJ0aWNsZU9iamVjdAogICAgICAgICAgICAgICAgICAgICAgLT5CYWNrZW5kRm9yQXJ0aWNsZSggJXsgJE1ldGFBcnRpY2xlIH0gKQogICAgICAgICAgICAgICAgICAgICAgLT5BcnRpY2xlR2V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICV7ICRNZXRhQXJ0aWNsZSB9LAogICAgICAgICAgICAgICAgICAgICAgICAgIER5bmFtaWNGaWVsZHMgPT4gMSwKICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFsTmFtZXMgICAgID0+IDEKICAgICAgICAgICAgICAgICAgICAgICk7CgogICAgICAgICMgVHJhbnNmb3JtIHRoZSBkYXRlIHZhbHVlcyBmcm9tIHRoZSB0aWNrZXQgZGF0YSAoYnV0IG5vdCB0aGUgZHluYW1pYyBmaWVsZCB2YWx1ZXMpLgogICAgICAgIEFUVFJJQlVURToKICAgICAgICBmb3IgbXkgJEF0dHJpYnV0ZSAoIHNvcnQga2V5cyAlQXJ0aWNsZSApIHsKICAgICAgICAgICAgbmV4dCBBVFRSSUJVVEUgaWYgJEF0dHJpYnV0ZSA9fiBteyBcQSBEeW5hbWljRmllbGRfIH14bXM7CiAgICAgICAgICAgIG5leHQgQVRUUklCVVRFIGlmICEkQXJ0aWNsZXskQXR0cmlidXRlfTsKCiAgICAgICAgICAgIGlmICggJEFydGljbGV7JEF0dHJpYnV0ZX0gPX4gbXtcQShcZFxkXGRcZCktKFxkXGQpLShcZFxkKVxzKFxkXGQpOihcZFxkKTooXGRcZClcen14aSApIHsKICAgICAgICAgICAgICAgIG15ICRPcmlnaW5WYWx1ZSA9ICRBcnRpY2xleyRBdHRyaWJ1dGV9OwogICAgICAgICAgICAgICAgJEFydGljbGV7JEF0dHJpYnV0ZS4iU2VydmVyIn0gPSAkQXJ0aWNsZXskQXR0cmlidXRlfTsKCiAgICAgICAgICAgICAgICAkQXJ0aWNsZXskQXR0cmlidXRlfSA9ICRMYW5ndWFnZU9iamVjdC0+Rm9ybWF0VGltZVN0cmluZygKICAgICAgICAgICAgICAgICAgICAkT3JpZ2luVmFsdWUsCiAgICAgICAgICAgICAgICAgICAgJ0RhdGVGb3JtYXQnLAogICAgICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAgICAgMSAjINC90LUg0LTQvtCx0LDQstC70Y/QtdC8IChUWikg0LIg0L/RgNC10L7QsdGA0LDQt9C+0LLQsNC90L3Rg9GOINC00LDRgtGDCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwdXNoIEBBcnRpY2xlcywgXCVBcnRpY2xlOwogICAgfQoKICAgIG15ICVGbGFncyA9ICRBcnRpY2xlT2JqZWN0LT5BcnRpY2xlRmxhZ3NPZlRpY2tldEdldCgKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIG15ICVBcnRpY2xlU2VuZGVyVHlwZUxpc3QgPSAkQXJ0aWNsZU9iamVjdC0+QXJ0aWNsZVNlbmRlclR5cGVMaXN0KCk7CgogICAgZm9yIG15ICRBcnRpY2xlICggQEFydGljbGVzICkgewoKICAgICAgICAleyAkQXJ0aWNsZSB9ID0gKCAleyAkQXJ0aWNsZSB9LCAlVGlja2V0ICk7CgogICAgICAgIG15ICRBcnRpY2xlQmFja2VuZE9iamVjdCA9ICRBcnRpY2xlT2JqZWN0LT5CYWNrZW5kRm9yQXJ0aWNsZSggJXsgJEFydGljbGUgfSApOwoKICAgICAgICBteSAkU3RyaXBUaWNrZXROdW1iZXJGcm9tQXJ0aWNsZVN1YmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpCiAgICAgICAgICAgIC0+R2V0KCJSUzo6QVBJOjpTdHJpcFRpY2tldE51bWJlckZyb21BcnRpY2xlU3ViamVjdCIpIC8vICcnOwoKICAgICAgICBpZiAoICRTdHJpcFRpY2tldE51bWJlckZyb21BcnRpY2xlU3ViamVjdCApIHsKICAgICAgICAgICAgbXkgJFRpY2tldEhvb2sgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoIlRpY2tldDo6SG9vayIpOwoKICAgICAgICAgICAgIyBUT0RPOiDRg9GC0L7Rh9C90LjRgtGMLCDQv9C+0YfQtdC80YMg0LXQs9C+INC90LXRggogICAgICAgICAgICBpZiAoICRUaWNrZXRIb29rICkgewogICAgICAgICAgICAgICAgJEFydGljbGUtPntTdWJqZWN0fSA9fiBzL15cWyRUaWNrZXRIb29rXGQrXF1ccyovLzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJEFydGljbGUtPntBdmF0YXJ9ID0gJ2h0dHBzOi8vd3d3LnNoYXJlaWNvbi5uZXQvZGF0YS8xMjh4MTI4LzIwMTUvMDkvMTgvMTAzMTYwX21hbl81MTJ4NTEyLnBuZyc7CgogICAgICAgIG15ICVBdHRhY2htZW50cyA9ICRBcnRpY2xlQmFja2VuZE9iamVjdC0+QXJ0aWNsZUF0dGFjaG1lbnRJbmRleCgKICAgICAgICAgICAgQXJ0aWNsZUlEID0+ICRBcnRpY2xlLT57IEFydGljbGVJRCB9LAogICAgICAgICk7CgogICAgICAgIG15IEBBdHRzID0gKCk7CiAgICAgICAgbXkgJEhUTUxCb2R5OwogICAgICAgIGZvciBteSAkRmlsZUlEICgga2V5cyAlQXR0YWNobWVudHMgKSB7CiAgICAgICAgICAgIGZvciBteSAkRmllbGQgKCBrZXlzICV7ICRBdHRhY2htZW50c3skRmlsZUlEfSB9ICkgewogICAgICAgICAgICAgICAgaWYgKCBkZWZpbmVkICRBdHRhY2htZW50c3skRmlsZUlEfS0+eyRGaWVsZH0KICAgICAgICAgICAgICAgICAgICBhbmQgJEF0dGFjaG1lbnRzeyRGaWxlSUR9LT57JEZpZWxkfSBlcSAnJyApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJEF0dGFjaG1lbnRzeyRGaWxlSUR9LT57JEZpZWxkfSA9IHVuZGVmOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoICRBdHRhY2htZW50c3skRmlsZUlEfS0+e0Rpc3Bvc2l0aW9ufSBlcSAnYXR0YWNobWVudCcgKSB7CiAgICAgICAgICAgICAgICBwdXNoIEBBdHRzLCB7IEZpbGVJRCA9PiAkRmlsZUlELCAleyAkQXR0YWNobWVudHN7JEZpbGVJRH0gfSB9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJEhUTUxCb2R5ID0gJEF0dGFjaG1lbnRzeyRGaWxlSUR9OwogICAgICAgICAgICAgICAgJEhUTUxCb2R5LT57RmlsZUlEfSA9ICRGaWxlSUQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRBcnRpY2xlLT57IEF0dGFjaG1lbnRzIH0gPSBcQEF0dHM7CiAgICAgICAgJEFydGljbGUtPntIVE1MQm9keX0gICAgICA9ICRIVE1MQm9keTsKCiAgICAgICAgaWYgKCBleGlzdHMgJEZsYWdzeyAkQXJ0aWNsZS0+eyBBcnRpY2xlSUQgfSB9IGFuZAogICAgICAgICAgICAgICAgICAgICRGbGFnc3sgJEFydGljbGUtPnsgQXJ0aWNsZUlEIH0gfXsgU2VlbiB9ICkgewogICAgICAgICAgICAkQXJ0aWNsZS0+e1NlZW59ID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkQXJ0aWNsZS0+e1NlZW59ID0gMDsKICAgICAgICB9CgogICAgICAgICRBcnRpY2xlLT57IENyZWF0ZWQgfSA9ICRBcnRpY2xlLT57IENyZWF0ZVRpbWUgfTsgIyAhV0FSTiDQtNC70Y8g0YHQvtCy0LzQtdGB0YLQuNC80L7RgdGC0Lgg0YEgb3RyczUKICAgICAgICAjIFRPRE86INC/0LXRgNC10LjQvNC10L3QvtCy0LDRgtGMCiAgICAgICAgJEFydGljbGUtPnsgQ3JlYXRlZFRpbWVVbml4IH0gPSBzdHIydGltZSggJEFydGljbGUtPnsgQ3JlYXRlVGltZVNlcnZlciB9IC4nKzAwMDAnICk7CgogICAgICAgICMgQXJ0aWNsZVR5cGUg0YHQvtC30LTQsNGR0Lwg0LLRgNGD0YfQvdGD0Y4g0LTQu9GPICLRjdC80YPQu9GP0YbQuNC4IiDQvdC10LrQvtGC0L7RgNGL0YUg0YLQuNC/0L7QsiDQuNC3IG90cnM1CiAgICAgICAgIyBzZWxlY3QgbmFtZSBmcm9tIGFydGljbGVfdHlwZTsKICAgICAgICAjICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCiAgICAgICAgIyB8IG5hbWUgICAgICAgICAgICAgICAgICAgfAogICAgICAgICMgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKICAgICAgICAjIHwgZW1haWwtZXh0ZXJuYWwgICAgICAgICB8CiAgICAgICAgIyB8IGVtYWlsLWludGVybmFsICAgICAgICAgfAogICAgICAgICMgfCBub3RlLWV4dGVybmFsICAgICAgICAgIHwKICAgICAgICAjIHwgbm90ZS1pbnRlcm5hbCAgICAgICAgICB8CiAgICAgICAgIyB8IHBob25lICAgICAgICAgICAgICAgICAgfAogICAgICAgICMgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKICAgICAgICBteSAkQXJ0aWNsZVR5cGUgPSAnJzsKICAgICAgICBteSAkQXJ0aWNsZUNoYW5uZWwgPSAkQ2hhbm5lbHN7ICRBcnRpY2xlLT57Q29tbXVuaWNhdGlvbkNoYW5uZWxJRH0gfSAvLyAnJzsKICAgICAgICBpZiAoICRBcnRpY2xlQ2hhbm5lbCBlcSAnRW1haWwnICkgewogICAgICAgICAgICAkQXJ0aWNsZVR5cGUgPSAnZW1haWwnOwogICAgICAgICAgICBpZiAoICRBcnRpY2xlLT57SXNWaXNpYmxlRm9yQ3VzdG9tZXJ9ICkgewogICAgICAgICAgICAgICAgJEFydGljbGVUeXBlIC49ICctZXh0ZXJuYWwnOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgJEFydGljbGVUeXBlIC49ICctaW50ZXJuYWwnOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2lmICggJEFydGljbGVDaGFubmVsIGVxICdQaG9uZScgKSB7CiAgICAgICAgICAgICRBcnRpY2xlVHlwZSA9ICdwaG9uZSc7CiAgICAgICAgfQogICAgICAgIGVsc2lmICggJEFydGljbGVDaGFubmVsIGVxICdJbnRlcm5hbCcgKSB7CiAgICAgICAgICAgICRBcnRpY2xlVHlwZSA9ICdub3RlJzsKICAgICAgICAgICAgaWYgKCAkQXJ0aWNsZS0+e0lzVmlzaWJsZUZvckN1c3RvbWVyfSApIHsKICAgICAgICAgICAgICAgICRBcnRpY2xlVHlwZSAuPSAnLWV4dGVybmFsJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICRBcnRpY2xlVHlwZSAuPSAnLWludGVybmFsJzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJEFydGljbGUtPntBcnRpY2xlVHlwZX0gPSAkQXJ0aWNsZVR5cGU7CgogICAgICAgIGlmICggJEFydGljbGVDaGFubmVsIGVxICdJbnRlcm5hbCcgKSB7CiAgICAgICAgICAgICRBcnRpY2xlLT57RGlyZWN0aW9ufSA9ICdJbnRlcm5hbCc7CiAgICAgICAgfQogICAgICAgIGVsc2lmICggJEFydGljbGVTZW5kZXJUeXBlTGlzdHsgJEFydGljbGUtPntTZW5kZXJUeXBlSUR9IH0gZXEgJ2N1c3RvbWVyJyApIHsKICAgICAgICAgICAgJEFydGljbGUtPntEaXJlY3Rpb259ID0gJ0luY29taW5nJzsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRBcnRpY2xlLT57RGlyZWN0aW9ufSA9ICdPdXRnb2luZyc7CiAgICAgICAgfQoKICAgICAgICAkQXJ0aWNsZSA9ICRTZWxmLT5fQ2xlYXJPYmplY3RGaWVsZHMoCiAgICAgICAgICAgIE9iamVjdCA9PiAkQXJ0aWNsZSwKICAgICAgICAgICAgVHlwZSAgID0+ICdBcnRpY2xlJwogICAgICAgICk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgICBSZXNwb25zZSA9PiAiT0siLAogICAgICAgIEFydGljbGVzID0+IFxAQXJ0aWNsZXMKICAgIH07Cn0KCnN1YiBVcGRhdGVRdWV1ZSB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkU2VsZi0+e1RpY2tldE9iamVjdH07CgogICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISVUaWNrZXQgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHRpY2tldCcKICAgICAgICB9OwogICAgfQoKICAgIGlmICggJFBhcmFte1F1ZXVlfSBhbmQgISRQYXJhbXtRdWV1ZUlEfSApIHsKICAgICAgICAkUGFyYW17UXVldWVJRH0gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6UXVldWUnKQogICAgICAgICAgLT5RdWV1ZUxvb2t1cCggUXVldWUgPT4gJFBhcmFte1F1ZXVlfSApOwogICAgfQoKICAgIG15ICRIYXNNb3ZlSW50b1Blcm1pc3Npb24gPSAkU2VsZi0+X0NoZWNrR3JvdXBQZXJtaXNzaW9uKAogICAgICAgIFF1ZXVlSUQgPT4gJFBhcmFte1F1ZXVlSUR9LAogICAgICAgIFR5cGUgICAgPT4gWydtb3ZlX2ludG8nXSwKICAgICAgICBVc2VySUQgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISRIYXNNb3ZlSW50b1Blcm1pc3Npb24gKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHBlcm1pc3Npb24nCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkU3VjY2VzczsKICAgIGlmICggJFRpY2tldHtMb2NrfSBlcSAndW5sb2NrJyApIHsKICAgICAgICAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFF1ZXVlU2V0KAogICAgICAgICAgICBRdWV1ZUlEICA9PiAkUGFyYW17UXVldWVJRH0sCiAgICAgICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKICAgIH0KICAgIGVsc2lmICggJFRpY2tldHtMb2NrfSBlcSAnbG9jaycgKSB7CiAgICAgICAgaWYgKCAkVGlja2V0e093bmVySUR9ID09ICRQYXJhbXtVc2VySUR9ICkgewogICAgICAgICAgICAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFF1ZXVlU2V0KAogICAgICAgICAgICAgICAgUXVldWVJRCAgPT4gJFBhcmFte1F1ZXVlSUR9LAogICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJZb3UgbXVzdCBiZSBhbiBvd25lciBvZiB0aGUgdGlja2V0IgogICAgICAgICAgICB9OwogICAgICAgIH0KICAgIH0KCiAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnQ2Fubm90IHVwZGF0ZSBRdWV1ZScKICAgICAgICB9OwogICAgfQoKICAgIHJldHVybiB7IFJlc3BvbnNlID0+ICJPSyIgfTsKfQoKc3ViIFVwZGF0ZVRpdGxlIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJFRpY2tldE9iamVjdCA9ICRTZWxmLT57VGlja2V0T2JqZWN0fTsKCiAgICAjIEdldCBUaWNrZXQKICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoCiAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICElVGlja2V0ICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdObyB0aWNrZXQnCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkSGFzUGVybWlzc2lvbiA9ICRTZWxmLT5fQ2hlY2tHcm91cFBlcm1pc3Npb24oCiAgICAgICAgUXVldWVJRCA9PiAkVGlja2V0e1F1ZXVlSUR9LAogICAgICAgIFVzZXJJRCAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJEhhc1Blcm1pc3Npb24gKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHBlcm1pc3Npb24nCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFRpdGxlVXBkYXRlKAogICAgICAgIFRpdGxlICAgID0+ICRQYXJhbXtUaXRsZX0sCiAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnQ2Fubm90IHVwZGF0ZSBUaXRsZScKICAgICAgICB9OwogICAgfQoKICAgIHJldHVybiB7IFJlc3BvbnNlID0+ICJPSyIgfTsKfQoKc3ViIFdhdGNoVGlja2V0IHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJFJlc3VsdDsKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkU2VsZi0+e1RpY2tldE9iamVjdH07CgogICAgaWYgKCAhJFBhcmFte1RpY2tldElEfSApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gVGlja2V0SUQnCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAlVGlja2V0ID0gJFRpY2tldE9iamVjdC0+VGlja2V0R2V0KAogICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJVRpY2tldCApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gdGlja2V0JwogICAgICAgIH07CiAgICB9CgogICAgbXkgJEhhc1Blcm1pc3Npb24gPSAkU2VsZi0+X0NoZWNrR3JvdXBQZXJtaXNzaW9uKAogICAgICAgIFF1ZXVlSUQgPT4gJFRpY2tldHtRdWV1ZUlEfSwKICAgICAgICBUeXBlICAgID0+IFsncm8nXSwKICAgICAgICBVc2VySUQgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISRIYXNQZXJtaXNzaW9uICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdObyBwZXJtaXNzaW9uJwogICAgICAgIH07CiAgICB9CgogICAgaWYgKCAkUGFyYW17U3Vic2NyaWJlfSApIHsKCiAgICAgICAgbXkgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRXYXRjaFN1YnNjcmliZSgKICAgICAgICAgICAgVGlja2V0SUQgICAgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgV2F0Y2hVc2VySUQgPT4gJFBhcmFte1VzZXJJRH0sCiAgICAgICAgICAgIFVzZXJJRCAgICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKCiAgICAgICAgaWYgKCAkU3VjY2VzcyApIHsKCiAgICAgICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgICAgICBSZXNwb25zZSA9PiAnT0snCiAgICAgICAgICAgIH07CgogICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdDb3VsZCBub3Qgc3Vic2NyaWJlIHRvIHRpY2tldCcKICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgfSBlbHNlIHsKCiAgICAgICAgbXkgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRXYXRjaFVuc3Vic2NyaWJlKAogICAgICAgICAgICBUaWNrZXRJRCAgICA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICBXYXRjaFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICAgICAgVXNlcklEICAgICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICApOwoKICAgICAgICBpZiAoICRTdWNjZXNzICkgewoKICAgICAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICdPSycKICAgICAgICAgICAgfTsKCiAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ0NvdWxkIG5vdCB1bnN1YnNjcmliZSBmcm9tIHRpY2tldCcKICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuICRSZXN1bHQ7Cn0KCnN1YiBHZXRBdHRhY2htZW50IHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJFJlc3VsdDsKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkU2VsZi0+e1RpY2tldE9iamVjdH07CiAgICBteSAkQXJ0aWNsZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUaWNrZXQ6OkFydGljbGUnKTsKCiAgICBpZiAoICRQYXJhbXsgVGlja2V0SUQgfSBhbmQgISRQYXJhbXsgQXJ0aWNsZUlEIH0gKSB7CgogICAgICAgIG15IEBBcnRpY2xlQm94QWxsID0gJEFydGljbGVPYmplY3QtPkFydGljbGVMaXN0KAogICAgICAgICAgICBUaWNrZXRJRCAgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgT25seUZpcnN0ID0+IDEKICAgICAgICApOwoKICAgICAgICBpZiAoIEBBcnRpY2xlQm94QWxsICkgewogICAgICAgICAgICAkUGFyYW17IEFydGljbGVJRCB9ID0gJEFydGljbGVCb3hBbGxbMF17IEFydGljbGVJRCB9OwogICAgICAgIH0KIyAgICAgICAgbXkgJUFydGljbGUgPSAkVGlja2V0T2JqZWN0LT5BcnRpY2xlRmlyc3RBcnRpY2xlKAojICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFteyBUaWNrZXRJRCB9CiMgICAgICAgICk7CiMKIyAgICAgICAgaWYgKCAkQXJ0aWNsZXsgQXJ0aWNsZUlEIH0gKSB7CiMgICAgICAgICAgICAkUGFyYW17IEFydGljbGVJRCB9ID0gJEFydGljbGV7IEFydGljbGVJRCB9OwojICAgICAgICB9CiAgICB9CgogICAgIyBnZXQgQXJ0aWNsZUlECiAgICBteSAkQXJ0aWNsZUlEID0gJFBhcmFte0FydGljbGVJRH0gLy8gMDsKICAgIG15ICRGaWxlSUQgICAgPSAkUGFyYW17RmlsZUlEfSAgICAvLyAwOwoKICAgIG15ICRMYXlvdXRPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0Jyk7CiAgICBteSAkTG9nT2JqZWN0ICAgID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpOwoKICAgICMgY2hlY2sgcGVybWlzc2lvbnMKIyAgICBteSAlQXJ0aWNsZSA9ICRUaWNrZXRPYmplY3QtPkFydGljbGVHZXQoCiMgICAgICAgIEFydGljbGVJRCAgICAgPT4gJEFydGljbGVJRCwKIyAgICAgICAgRHluYW1pY0ZpZWxkcyA9PiAwLAojICAgICAgICBVc2VySUQgICAgICAgID0+ICRQYXJhbXtVc2VySUR9LAojICAgICk7CgogICAgbXkgJFRpY2tldElEID0gJEFydGljbGVPYmplY3QtPlRpY2tldElETG9va3VwKAogICAgICAgIEFydGljbGVJRCA9PiAkQXJ0aWNsZUlECiAgICApOwoKICAgICNpZiAoICEkQXJ0aWNsZXtUaWNrZXRJRH0gKSB7CiAgICBpZiAoICEkVGlja2V0SUQgKSB7CgogICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJObyBhcnRpY2xlISIsCiAgICAgICAgfTsKCiAgICB9IGVsc2UgewoKICAgICAgICAjIGNoZWNrIHBlcm1pc3Npb25zCiAgICAgICAgbXkgJEFjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFBlcm1pc3Npb24oCiAgICAgICAgICAgIFR5cGUgICAgID0+ICdybycsCiAgICAgICAgICAgIFRpY2tldElEID0+ICRUaWNrZXRJRCwKICAgICAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICApOwoKICAgICAgICBpZiAoICEkQWNjZXNzICkgewogICAgICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJObyBhdHRhY2htZW50ISIsCiAgICAgICAgICAgIH07CgogICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICBteSAkQXJ0aWNsZUJhY2tlbmRPYmplY3QgPSAkQXJ0aWNsZU9iamVjdC0+QmFja2VuZEZvckFydGljbGUoCiAgICAgICAgICAgICAgICBUaWNrZXRJRCAgPT4gJFRpY2tldElELAogICAgICAgICAgICAgICAgQXJ0aWNsZUlEID0+ICRBcnRpY2xlSUQKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIG15ICVEYXRhID0gJEFydGljbGVCYWNrZW5kT2JqZWN0LT5BcnRpY2xlQXR0YWNobWVudCgKICAgICAgICAgICAgICAgIEFydGljbGVJRCA9PiAkQXJ0aWNsZUlELAogICAgICAgICAgICAgICAgRmlsZUlEICAgID0+ICRGaWxlSUQKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmICggISVEYXRhICkgewoKICAgICAgICAgICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiTm8gYXR0YWNobWVudCEiLAogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgIyDQlNC70Y8gaHRtbCDQstC40LTQsCDRgdGC0YDQsNC90LjRhtGLCiAgICAgICAgICAgICAgICBpZiAoICREYXRhe0NvbnRlbnRUeXBlfSA9fiBte3RleHQvaHRtbH0gKSB7CiAgICAgICAgICAgICAgICAgICAgbXkgJFRpY2tldE51bWJlciA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUaWNrZXQnKS0+VGlja2V0TnVtYmVyTG9va3VwKAogICAgICAgICAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkVGlja2V0SUQsCiAgICAgICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAgICAgIyBSZW5kZXIgYXJ0aWNsZSBjb250ZW50LgogICAgICAgICAgICAgICAgICAgIG15ICRBcnRpY2xlQ29udGVudCA9ICRMYXlvdXRPYmplY3QtPkFydGljbGVQcmV2aWV3KAogICAgICAgICAgICAgICAgICAgICAgICBUaWNrZXRJRCAgPT4gJFRpY2tldElELAogICAgICAgICAgICAgICAgICAgICAgICBBcnRpY2xlSUQgPT4gJEFydGljbGVJRCwKICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICBpZiAoICEkQXJ0aWNsZUNvbnRlbnQgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIGFydGljbGUhIiwKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIG15ICRDb250ZW50ID0gJExheW91dE9iamVjdC0+T3V0cHV0KAogICAgICAgICAgICAgICAgICAgICAgICBUZW1wbGF0ZSA9PiAnWyUgRGF0YS5IVE1MICVdJywKICAgICAgICAgICAgICAgICAgICAgICAgRGF0YSAgICAgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgSFRNTCA9PiAkQXJ0aWNsZUNvbnRlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAgICAgbXkgJURhdGEgPSAoCiAgICAgICAgICAgICAgICAgICAgICAgIENvbnRlbnQgICAgICAgICAgICA9PiAkQ29udGVudCwKICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudEFsdGVybmF0aXZlID0+ICcnLAogICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50SUQgICAgICAgICAgPT4gJycsCiAgICAgICAgICAgICAgICAgICAgICAgIENvbnRlbnRUeXBlICAgICAgICA9PiAndGV4dC9odG1sOyBjaGFyc2V0PSJ1dGYtOCInLAogICAgICAgICAgICAgICAgICAgICAgICBEaXNwb3NpdGlvbiAgICAgICAgPT4gJ2lubGluZScsCiAgICAgICAgICAgICAgICAgICAgICAgIEZpbGVzaXplUmF3ICAgICAgICA9PiBieXRlczo6bGVuZ3RoKCRDb250ZW50KSwKICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICAjIGdldCBjb25maWcgb2JqZWN0CiAgICAgICAgICAgICAgICAgICAgbXkgJENvbmZpZ09iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyk7CgogICAgICAgICAgICAgICAgICAgICMgc2V0IGRvd25sb2FkIHR5cGUgdG8gaW5saW5lCiAgICAgICAgICAgICAgICAgICAgJENvbmZpZ09iamVjdC0+U2V0KAogICAgICAgICAgICAgICAgICAgICAgICBLZXkgICA9PiAnQXR0YWNobWVudERvd25sb2FkVHlwZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlID0+ICdpbmxpbmUnCiAgICAgICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAgICAgIyBzZXQgZmlsZW5hbWUgZm9yIGlubGluZSB2aWV3aW5nCiAgICAgICAgICAgICAgICAgICAgJERhdGF7RmlsZW5hbWV9ID0gIlRpY2tldC0kVGlja2V0TnVtYmVyLUFydGljbGVJRC0kQXJ0aWNsZUlELmh0bWwiOwoKICAgICAgICAgICAgICAgICAgICBteSAlQXJ0aWNsZSA9ICRBcnRpY2xlQmFja2VuZE9iamVjdC0+QXJ0aWNsZUdldCgKICAgICAgICAgICAgICAgICAgICAgICAgVGlja2V0SUQgICAgICA9PiAkVGlja2V0SUQsCiAgICAgICAgICAgICAgICAgICAgICAgIEFydGljbGVJRCAgICAgPT4gJEFydGljbGVJRCwKICAgICAgICAgICAgICAgICAgICAgICAgRHluYW1pY0ZpZWxkcyA9PiAwLAogICAgICAgICAgICAgICAgICAgICAgICBVc2VySUQgICAgICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAgICAgbXkgJExvYWRFeHRlcm5hbEltYWdlcyA9IDA7CgogICAgICAgICAgICAgICAgICAgICMgc2FmZXR5IGNoZWNrIG9ubHkgb24gY3VzdG9tZXIgYXJ0aWNsZQogICAgICAgICAgICAgICAgICAgIGlmICggISRMb2FkRXh0ZXJuYWxJbWFnZXMgJiYgJEFydGljbGV7U2VuZGVyVHlwZX0gbmUgJ2N1c3RvbWVyJyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJExvYWRFeHRlcm5hbEltYWdlcyA9IDE7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAjIGdlbmVyYXRlIGJhc2UgdXJsCiMgICAgICAgICAgICAgICAgICAgIG15ICRVUkwgPSAnQWN0aW9uPUFnZW50VGlja2V0QXR0YWNobWVudDtTdWJhY3Rpb249SFRNTFZpZXcnCiMgICAgICAgICAgICAgICAgICAgICAgICAuICI7VGlja2V0SUQ9JFRpY2tldElEO0FydGljbGVJRD0kQXJ0aWNsZUlEO0ZpbGVJRD0iOwogICAgICAgICAgICAgICAgICAgIG15ICRVUkwgPSAnQWN0aW9uPXRpY2tldHM7U3ViYWN0aW9uPWdldEF0dGFjaG1lbnQnCiAgICAgICAgICAgICAgICAgICAgICAgIC4gIjtBcnRpY2xlSUQ9JEFydGljbGVJRDtGaWxlSUQ9IjsKCiAgICAgICAgICAgICAgICAgICAgIyByZXBsYWNlIGxpbmtzIHRvIGlubGluZSBpbWFnZXMgaW4gaHRtbCBjb250ZW50CiAgICAgICAgICAgICAgICAgICAgbXkgJUF0bUJveCA9ICRBcnRpY2xlQmFja2VuZE9iamVjdC0+QXJ0aWNsZUF0dGFjaG1lbnRJbmRleCgKICAgICAgICAgICAgICAgICAgICAgICAgQXJ0aWNsZUlEID0+ICRBcnRpY2xlSUQsCiAgICAgICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAgICAgIyByZWZvcm1hdCByaWNoIHRleHQgZG9jdW1lbnQgdG8gaGF2ZSBjb3JyZWN0IGNoYXJzZXQgYW5kIGxpbmtzIHRvCiAgICAgICAgICAgICAgICAgICAgIyBpbmxpbmUgZG9jdW1lbnRzCiAgICAgICAgICAgICAgICAgICAgJURhdGEgPSAkTGF5b3V0T2JqZWN0LT5SaWNoVGV4dERvY3VtZW50U2VydmUoCiAgICAgICAgICAgICAgICAgICAgICAgIERhdGEgICAgICAgICAgICAgICA9PiBcJURhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgIFVSTCAgICAgICAgICAgICAgICA9PiAkVVJMLAogICAgICAgICAgICAgICAgICAgICAgICBBdHRhY2htZW50cyAgICAgICAgPT4gXCVBdG1Cb3gsCiAgICAgICAgICAgICAgICAgICAgICAgIExvYWRFeHRlcm5hbEltYWdlcyA9PiAkTG9hZEV4dGVybmFsSW1hZ2VzLAogICAgICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgICAgICMgaWYgdGhlcmUgaXMgdW5leHBlY3RlZGx5IHBncCBkZWNyeXB0ZWQgY29udGVudCBpbiB0aGUgaHRtbCBlbWFpbCAoT0UpLAogICAgICAgICAgICAgICAgICAgICMgd2Ugd2lsbCB1c2UgdGhlIGFydGljbGUgYm9keSAocGxhaW4gdGV4dCkgZnJvbSB0aGUgZGF0YWJhc2UgYXMgZmFsbCBiYWNrCiAgICAgICAgICAgICAgICAgICAgIyBzZWUgYnVnIzk2NzIKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICREYXRhe0NvbnRlbnR9ID1+IG17CiAgICAgICAgICAgICAgICAgICAgICAgIF4gLiogLS0tLS1CRUdJTiBbIF0gUEdQIFsgXSBNRVNTQUdFLS0tLS0gIC4qICQgICAgICAjIGdyZXAgUEdQIGJlZ2luIHRhZwogICAgICAgICAgICAgICAgICAgICAgICAuKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBQR1AgcGFydHMgbWF5IGJlIG5lc3RlZCBpbiBodG1sCiAgICAgICAgICAgICAgICAgICAgICAgIF4gLiogLS0tLS1FTkQgWyBdIFBHUCBbIF0gTUVTU0FHRS0tLS0tICAuKiAkICAgICAgICAjIGdyZXAgUEdQIGVuZCB0YWcKICAgICAgICAgICAgICAgICAgICB9eG1zCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICB7CgogICAgICAgICAgICAgICAgICAgICAgICAjIGh0bWwgcXVvdGluZwogICAgICAgICAgICAgICAgICAgICAgICAkQXJ0aWNsZXtCb2R5fSA9ICRMYXlvdXRPYmplY3QtPkFzY2lpMkh0bWwoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBOZXdMaW5lICAgICAgICA9PiAkQ29uZmlnT2JqZWN0LT5HZXQoJ0RlZmF1bHRWaWV3TmV3TGluZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dCAgICAgICAgICAgPT4gJEFydGljbGV7Qm9keX0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWTWF4ICAgICAgICAgICA9PiAkQ29uZmlnT2JqZWN0LT5HZXQoJ0RlZmF1bHRWaWV3TGluZXMnKSB8fCA1MDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgSFRNTFJlc3VsdE1vZGUgPT4gMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIExpbmtGZWF0dXJlICAgID0+IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgICAgICAgICAjIHVzZSB0aGUgYXJ0aWNsZSBib2R5IGFzIGNvbnRlbnQsIGJlY2F1c2UgcGdwIHdhcyBkZWZpbml0bHkgZGVzY3J5cHRlZCBpZiBwb3NzaWJsZQogICAgICAgICAgICAgICAgICAgICAgICAkRGF0YXtDb250ZW50fSA9ICRBcnRpY2xle0JvZHl9OwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgIyByZXR1cm4gaHRtbCBhdHRhY2htZW50CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRMYXlvdXRPYmplY3QtPkF0dGFjaG1lbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICVEYXRhLAogICAgICAgICAgICAgICAgICAgICAgICBTYW5kYm94ID0+IDEsCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KCj1hClRPRE86INC/0L7QtNGD0LzQsNGC0Ywg0L3QsNC0INCy0L7Qt9Cy0YDQsNGJ0LXQvdC40LXQvArQuNC3LdC30LAg0LLRgdGC0YDQvtC10L3QvdGL0YUg0LrQsNGA0YLQuNC90L7QuiDQvdC1INGA0LDQsdC+0YLQsNC10YIKICAgICAgICAgICAgICAgIGlmICggJERhdGF7IERpc3Bvc2l0aW9uIH0gZXEgJ2lubGluZScgKSB7CiAgICAgICAgICAgICAgICAgICAgbXkgKCRFbmNvZGluZykgPSAkRGF0YXtDb250ZW50VHlwZX0gPX4gbXtjaGFyc2V0PVsnIl0oW2EtejAtOS1dKylbJyJdfWk7CiAgICAgICAgICAgICAgICAgICAgJEVuY29kaW5nIC8vPSAnVVRGLTgnOwogICAgICAgICAgICAgICAgICAgICREYXRhe0NvbnRlbnR9ID0gRW5jb2RlOjpkZWNvZGUodWMgJEVuY29kaW5nLCAkRGF0YXtDb250ZW50fSk7CiAgICAgICAgICAgICAgICB9Cj1jdXQKCiAgICAgICAgICAgICAgICByZXR1cm4gJExheW91dE9iamVjdC0+QXR0YWNobWVudCglRGF0YSwgVHlwZSA9PiAkRGF0YXsgRGlzcG9zaXRpb24gfSApOwogICAgICAgICAgICB9CiAgICAgICB9CiAgICB9CgogICAgcmV0dXJuICRSZXN1bHQ7Cn0KCnN1YiBDcmVhdGVBdHRhY2htZW50IHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJFJlc3VsdDsKICAgIG15ICRUaWNrZXRPYmplY3QgID0gJFNlbGYtPntUaWNrZXRPYmplY3R9OwogICAgbXkgJEFydGljbGVPYmplY3QgPSAkU2VsZi0+e0FydGljbGVPYmplY3R9OwoKICAgIG15ICRQYXJhbU9iamVjdCAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6V2ViOjpSZXF1ZXN0Jyk7CgogICAgbXkgJUZpbGUgPSAkUGFyYW1PYmplY3QtPkdldFVwbG9hZEFsbCggUGFyYW0gPT4gJ0ZpbGUnICk7CiAgICBteSAkRnJvbUZvcm0gPSAwOwogICAgaWYgKCAhJUZpbGUgKSB7CiAgICAgICAgJFBhcmFte0ZpbGV9IC8vPSB7fTsKCiAgICAgICAgJUZpbGUgPSAleyAkUGFyYW17RmlsZX0gfTsKICAgIH0KICAgIGVsc2UgewogICAgICAgICRGcm9tRm9ybSA9IDE7CiAgICB9CgogICAgaWYgKCAhJEZpbGV7Q29udGVudH0gb3IgISRGaWxle0NvbnRlbnRUeXBlfSBvciAhJEZpbGV7RmlsZW5hbWV9ICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdObyBDb250ZW50LCBDb250ZW50VHlwZSBvciBGaWxlbmFtZSBwYXJhbWV0ZXJzJwogICAgICAgIH07CiAgICB9CgogICAgaWYgKCAkUGFyYW17IFRpY2tldElEIH0gYW5kCiAgICAgICAgISRQYXJhbXsgQXJ0aWNsZUlEIH0gKSB7CgogICAgICAgIG15ICRBcnRpY2xlT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlRpY2tldDo6QXJ0aWNsZScpOwogICAgICAgIG15IEBBcnRpY2xlQm94QWxsID0gJEFydGljbGVPYmplY3QtPkFydGljbGVMaXN0KAogICAgICAgICAgICBUaWNrZXRJRCAgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgT25seUZpcnN0ID0+IDEKICAgICAgICApOwoKICAgICAgICBpZiAoIEBBcnRpY2xlQm94QWxsICkgewogICAgICAgICAgICAkUGFyYW17IEFydGljbGVJRCB9ID0gJEFydGljbGVCb3hBbGxbMF17IEFydGljbGVJRCB9OwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiVGlja2V0IGlzIGluY29ycmVjdCIKICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICB9CgogICAgaWYgKCAhJFBhcmFte1RpY2tldElEfSBhbmQgJFBhcmFte0FydGljbGVJRH0gKSB7CiAgICAgICAgJFBhcmFte1RpY2tldElEfSA9ICRBcnRpY2xlT2JqZWN0LT5UaWNrZXRJRExvb2t1cCgKICAgICAgICAgICAgQXJ0aWNsZUlEID0+ICRQYXJhbXsgQXJ0aWNsZUlEIH0KICAgICAgICApOwoKICAgICAgICBpZiAoICEkUGFyYW17VGlja2V0SUR9ICkgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJBcnRpY2xlIGlzIGluY29ycmVjdCIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBteSAlVGlja2V0ID0gJFRpY2tldE9iamVjdC0+VGlja2V0R2V0KAogICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJVRpY2tldCApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gdGlja2V0JwogICAgICAgIH07CiAgICB9CgogICAgbXkgJEhhc1Blcm1pc3Npb24gPSAkU2VsZi0+X0NoZWNrR3JvdXBQZXJtaXNzaW9uKAogICAgICAgIFF1ZXVlSUQgPT4gJFRpY2tldHtRdWV1ZUlEfSwKICAgICAgICBUeXBlICAgID0+IFsnY3JlYXRlJywgJ25vdGUnXSwKICAgICAgICBPcCAgICAgID0+ICdPUicsCiAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICEkSGFzUGVybWlzc2lvbiApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gcGVybWlzc2lvbicKICAgICAgICB9OwogICAgfQoKICAgIG15ICRBcnRpY2xlQmFja2VuZE9iamVjdCA9ICRBcnRpY2xlT2JqZWN0LT5CYWNrZW5kRm9yQXJ0aWNsZSgKICAgICAgICBUaWNrZXRJRCAgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBBcnRpY2xlSUQgPT4gJFBhcmFte0FydGljbGVJRH0KICAgICk7CgogICAgaWYgKCAhJEFydGljbGVCYWNrZW5kT2JqZWN0ICkgewogICAgICAgICRSZXN1bHQgPSB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJJbnRlcm5hbCBlcnJvci4gUGxlYXNlIGNvbnRhY3QgYWRtaW5pc3RyYXRvciEiCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkU3VjY2VzcyA9ICRBcnRpY2xlQmFja2VuZE9iamVjdC0+QXJ0aWNsZVdyaXRlQXR0YWNobWVudCgKICAgICAgICBDb250ZW50ID0+ICRGcm9tRm9ybSA/ICRGaWxle0NvbnRlbnR9IDogZGVjb2RlX2Jhc2U2NCggJEZpbGV7Q29udGVudH0gKSwKICAgICAgICBDb250ZW50VHlwZSA9PiAkRmlsZXtDb250ZW50VHlwZX0sCiAgICAgICAgRmlsZW5hbWUgICAgPT4gJEZpbGV7RmlsZW5hbWV9LAogICAgICAgIERpc3Bvc2l0aW9uID0+ICdhdHRhY2htZW50JywKICAgICAgICBBcnRpY2xlSUQgICA9PiAkUGFyYW17QXJ0aWNsZUlEfSwKICAgICAgICBVc2VySUQgICAgICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICRTdWNjZXNzICkgewoKICAgICAgICBteSAlSW5kZXggPSAkQXJ0aWNsZUJhY2tlbmRPYmplY3QtPkFydGljbGVBdHRhY2htZW50SW5kZXgoCiAgICAgICAgICAgIEFydGljbGVJRCA9PiAkUGFyYW17QXJ0aWNsZUlEfQogICAgICAgICk7CgogICAgICAgIG15ICRMYXN0RmlsZUlEID0gKCBzb3J0IHsgJGEgPD0+ICRiIH0ga2V5cyAlSW5kZXggKVstMV07CgogICAgICAgIG15ICVBdHRhY2htZW50ID0gJXsgJEluZGV4eyAkTGFzdEZpbGVJRCB9IH07CgogICAgICAgICRBdHRhY2htZW50e0NvbnRlbnRBbHRlcm5hdGl2ZX0gfHw9IHVuZGVmOwogICAgICAgICRBdHRhY2htZW50e0NvbnRlbnRJRH0gICAgICAgICAgfHw9IHVuZGVmOwoKICAgICAgICAkUmVzdWx0ID0gewogICAgICAgICAgICBSZXNwb25zZSAgID0+ICJPSyIsCiAgICAgICAgICAgIEF0dGFjaG1lbnQgPT4gewogICAgICAgICAgICAgICAgJUF0dGFjaG1lbnQsCiAgICAgICAgICAgICAgICBGaWxlSUQgPT4gJExhc3RGaWxlSUQKICAgICAgICAgICAgfQogICAgICAgIH07CgogICAgfSBlbHNlIHsKCiAgICAgICAgJFJlc3VsdCA9IHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkNhbm5vdCBhZGQgYXR0YWNobWVudCIKICAgICAgICB9OwogICAgfQoKICAgIHJldHVybiAkUmVzdWx0Owp9CgpzdWIgVXBkYXRlQ3VzdG9tZXIgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkVGlja2V0T2JqZWN0ID0gJFNlbGYtPntUaWNrZXRPYmplY3R9OwoKICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoCiAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICElVGlja2V0ICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdObyB0aWNrZXQnCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkSGFzUGVybWlzc2lvbiA9ICRTZWxmLT5fQ2hlY2tHcm91cFBlcm1pc3Npb24oCiAgICAgICAgUXVldWVJRCA9PiAkVGlja2V0e1F1ZXVlSUR9LAogICAgICAgIFVzZXJJRCAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJEhhc1Blcm1pc3Npb24gKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHBlcm1pc3Npb24nCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEN1c3RvbWVyU2V0KAogICAgICAgIE5vICAgICAgID0+ICRQYXJhbXtDdXN0b21lcklEfSwKICAgICAgICBVc2VyICAgICA9PiAkUGFyYW17Q3VzdG9tZXJVc2VySUR9LAogICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ0Nhbm5vdCB1cGRhdGUgQ3VzdG9tZXInCiAgICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4geyBSZXNwb25zZSA9PiAnT0snIH07Cn0KCnN1YiBVcGRhdGVBcmNoaXZlRmxhZyB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkU2VsZi0+e1RpY2tldE9iamVjdH07CgogICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISVUaWNrZXQgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHRpY2tldCcKICAgICAgICB9OwogICAgfQoKICAgIG15ICRIYXNQZXJtaXNzaW9uID0gJFNlbGYtPl9DaGVja0dyb3VwUGVybWlzc2lvbigKICAgICAgICBRdWV1ZUlEID0+ICRUaWNrZXR7UXVldWVJRH0sCiAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICEkSGFzUGVybWlzc2lvbiApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gcGVybWlzc2lvbicKICAgICAgICB9OwogICAgfQoKICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0QXJjaGl2ZUZsYWdTZXQoCiAgICAgICAgQXJjaGl2ZUZsYWcgPT4gJFBhcmFte0FyY2hpdmVGbGFnfSwKICAgICAgICBUaWNrZXRJRCAgICA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISRTdWNjZXNzICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdDYW5ub3QgdXBkYXRlIEFyY2hpdmVGbGFnJwogICAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIHsgUmVzcG9uc2UgPT4gIk9LIiB9Owp9CgpzdWIgVXBkYXRlU3RhdGUgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkVGlja2V0T2JqZWN0ID0gJFNlbGYtPntUaWNrZXRPYmplY3R9OwoKICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoCiAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICElVGlja2V0ICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdObyB0aWNrZXQnCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkSGFzUGVybWlzc2lvbiA9ICRTZWxmLT5fQ2hlY2tHcm91cFBlcm1pc3Npb24oCiAgICAgICAgUXVldWVJRCA9PiAkVGlja2V0e1F1ZXVlSUR9LAogICAgICAgIFVzZXJJRCAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJEhhc1Blcm1pc3Npb24gKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHBlcm1pc3Npb24nCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkU3VjY2VzczsKICAgIGlmICggJFRpY2tldHtMb2NrfSBlcSAndW5sb2NrJyApIHsKICAgICAgICAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFN0YXRlU2V0KAogICAgICAgICAgICBTdGF0ZSAgICA9PiAkUGFyYW17U3RhdGV9LAogICAgICAgICAgICBTdGF0ZUlEICA9PiAkUGFyYW17U3RhdGVJRH0sCiAgICAgICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKICAgIH0KICAgIGVsc2lmICggJFRpY2tldHtMb2NrfSBlcSAnbG9jaycgKSB7CiAgICAgICAgaWYgKCAkVGlja2V0e093bmVySUR9ID09ICRQYXJhbXtVc2VySUR9ICkgewogICAgICAgICAgICAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFN0YXRlU2V0KAogICAgICAgICAgICAgICAgU3RhdGUgICAgPT4gJFBhcmFte1N0YXRlfSwKICAgICAgICAgICAgICAgIFN0YXRlSUQgID0+ICRQYXJhbXtTdGF0ZUlEfSwKICAgICAgICAgICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiWW91IG11c3QgYmUgYW4gb3duZXIgb2YgdGhlIHRpY2tldCIKICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICB9CgogICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ0Nhbm5vdCB1cGRhdGUgU3RhdGUnCiAgICAgICAgfTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoCiAgICAgICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKCiAgICAgICAgaWYgKCAkVGlja2V0e1N0YXRlVHlwZX0gZXEgJ2Nsb3NlZCcgKSB7CiAgICAgICAgICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0TG9ja1NldCgKICAgICAgICAgICAgICAgIExvY2sgICAgID0+ICd1bmxvY2snLAogICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiU3RhdGUgaGFzIGJlZW4gY2hhbmdlZCBidXQgY291bGRuJ3QgdW5sb2NrIFRpY2tldCIKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIHsgUmVzcG9uc2UgPT4gIk9LIiB9Owp9CgpzdWIgVXBkYXRlT3duZXIgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICAkUGFyYW17UnVsZX0gLy89ICcnOwoKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkU2VsZi0+e1RpY2tldE9iamVjdH07CgogICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISVUaWNrZXQgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHRpY2tldCcKICAgICAgICB9OwogICAgfQoKICAgIGlmICggICAoICRQYXJhbXtOZXdVc2VySUR9IGFuZCAkVGlja2V0e093bmVySUR9ID09ICRQYXJhbXtOZXdVc2VySUR9ICkKICAgICAgICBvciAoICRQYXJhbXtOZXdVc2VyfSBhbmQgJFRpY2tldHtPd25lcn0gZXEgJFBhcmFte05ld1VzZXJ9ICkgKQogICAgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdBbHJlYWR5IHlvdSBhcmUgYW4gb3duZXInCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkSGFzUGVybWlzc2lvbiA9ICRTZWxmLT5fQ2hlY2tHcm91cFBlcm1pc3Npb24oCiAgICAgICAgUXVldWVJRCA9PiAkVGlja2V0e1F1ZXVlSUR9LAogICAgICAgIFR5cGUgICAgPT4gWydvd25lciddLAogICAgICAgIFVzZXJJRCAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJEhhc1Blcm1pc3Npb24gKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHBlcm1pc3Npb24nCiAgICAgICAgfTsKICAgIH0KCiAgICBpZiAoIGRlZmluZWQgJFBhcmFte05ld1VzZXJJRH0gYW5kCiAgICAgICAgICRQYXJhbXtOZXdVc2VySUR9ID09IDAgKSB7CgogICAgICAgICRQYXJhbXtOZXdVc2VySUR9ID0gJFBhcmFte1VzZXJJRH07CiAgICB9CgogICAgbXkgJFN1Y2Nlc3M7CiAgICBpZiAoICRUaWNrZXR7TG9ja30gZXEgJ3VubG9jaycgKSB7CiAgICAgICAgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRPd25lclNldCgKICAgICAgICAgICAgTmV3VXNlciAgID0+ICRQYXJhbXtOZXdVc2VyfSwKICAgICAgICAgICAgTmV3VXNlcklEID0+ICRQYXJhbXtOZXdVc2VySUR9LAogICAgICAgICAgICBUaWNrZXRJRCAgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICAgICAgVXNlcklEICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKICAgIH0KICAgIGVsc2lmICggJFRpY2tldHtMb2NrfSBlcSAnbG9jaycgKSB7CiAgICAgICAgaWYgKCAgICRUaWNrZXR7T3duZXJJRH0gPT0gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgb3IgJFBhcmFte1J1bGV9IGVxICdUaWNrZXRFZGl0JyApCiAgICAgICAgewogICAgICAgICAgICAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldE93bmVyU2V0KAogICAgICAgICAgICAgICAgTmV3VXNlciAgID0+ICRQYXJhbXtOZXdVc2VyfSwKICAgICAgICAgICAgICAgIE5ld1VzZXJJRCA9PiAkUGFyYW17TmV3VXNlcklEfSwKICAgICAgICAgICAgICAgIFRpY2tldElEICA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICAgICAgVXNlcklEICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJZb3UgbXVzdCBiZSBhbiBvd25lciBvZiB0aGUgdGlja2V0IgogICAgICAgICAgICB9OwogICAgICAgIH0KICAgIH0KCiAgICBpZiAoICEkU3VjY2VzcyApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnQ2Fubm90IHVwZGF0ZSBPd25lcicKICAgICAgICB9OwogICAgfQogICAgZWxzZSB7CgogICAgICAgIG15ICRPd25lcklEID0gJFBhcmFte05ld1VzZXJJRH07CiAgICAgICAgaWYgKCAhJE93bmVySUQgKSB7CiAgICAgICAgICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoCiAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICAgICAgICAgKTsKICAgICAgICAgICAgJE93bmVySUQgPSAkVGlja2V0e093bmVySUR9OwogICAgICAgIH0KCiAgICAgICAgbXkgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRMb2NrU2V0KAogICAgICAgICAgICBMb2NrICAgICA9PiAnbG9jaycsCiAgICAgICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgICAgIFVzZXJJRCAgID0+ICRPd25lcklECiAgICAgICAgKTsKCiAgICAgICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ0Nhbm5vdCBsb2NrIGJ5IGEgbmV3IG93bmVyJwogICAgICAgICAgICB9OwogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4geyBSZXNwb25zZSA9PiAiT0siIH07Cn0KCnN1YiBVcGRhdGVSZXNwb25zaWJsZSB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkU2VsZi0+e1RpY2tldE9iamVjdH07CgogICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISVUaWNrZXQgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHRpY2tldCcKICAgICAgICB9OwogICAgfQoKICAgIG15ICRIYXNQZXJtaXNzaW9uID0gJFNlbGYtPl9DaGVja0dyb3VwUGVybWlzc2lvbigKICAgICAgICBRdWV1ZUlEID0+ICRUaWNrZXR7UXVldWVJRH0sCiAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICEkSGFzUGVybWlzc2lvbiApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gcGVybWlzc2lvbicKICAgICAgICB9OwogICAgfQoKICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0UmVzcG9uc2libGVTZXQoCiAgICAgICAgTmV3VXNlciAgID0+ICRQYXJhbXtOZXdVc2VyfSwKICAgICAgICBOZXdVc2VySUQgPT4gJFBhcmFte05ld1VzZXJJRH0sCiAgICAgICAgVGlja2V0SUQgID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgVXNlcklEICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISRTdWNjZXNzICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdDYW5ub3QgdXBkYXRlIFJlc3BvbnNpYmxlJwogICAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIHsgUmVzcG9uc2UgPT4gIk9LIiB9Owp9CgpzdWIgVXBkYXRlUHJpb3JpdHkgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkVGlja2V0T2JqZWN0ID0gJFNlbGYtPntUaWNrZXRPYmplY3R9OwoKICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoCiAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICElVGlja2V0ICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdObyB0aWNrZXQnCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkSGFzUGVybWlzc2lvbiA9ICRTZWxmLT5fQ2hlY2tHcm91cFBlcm1pc3Npb24oCiAgICAgICAgUXVldWVJRCA9PiAkVGlja2V0e1F1ZXVlSUR9LAogICAgICAgIFR5cGUgICAgPT4gWydwcmlvcml0eSddLAogICAgICAgIFVzZXJJRCAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJEhhc1Blcm1pc3Npb24gKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHBlcm1pc3Npb24nCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkU3VjY2VzczsKICAgIGlmICggJFRpY2tldHtMb2NrfSBlcSAndW5sb2NrJyApIHsKCiAgICAgICAgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRQcmlvcml0eVNldCgKICAgICAgICAgICAgUHJpb3JpdHkgICA9PiAkUGFyYW17UHJpb3JpdHl9LAogICAgICAgICAgICBQcmlvcml0eUlEID0+ICRQYXJhbXtQcmlvcml0eUlEfSwKICAgICAgICAgICAgVGlja2V0SUQgICA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICBVc2VySUQgICAgID0+ICRQYXJhbXtVc2VySUR9CiAgICAgICAgKTsKICAgIH0KICAgIGVsc2lmICggJFRpY2tldHtMb2NrfSBlcSAnbG9jaycgKSB7CiAgICAgICAgaWYgKCAkVGlja2V0e093bmVySUR9ID09ICRQYXJhbXtVc2VySUR9ICkgewoKICAgICAgICAgICAgJFN1Y2Nlc3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRQcmlvcml0eVNldCgKICAgICAgICAgICAgICAgIFByaW9yaXR5ICAgPT4gJFBhcmFte1ByaW9yaXR5fSwKICAgICAgICAgICAgICAgIFByaW9yaXR5SUQgPT4gJFBhcmFte1ByaW9yaXR5SUR9LAogICAgICAgICAgICAgICAgVGlja2V0SUQgICA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgICAgICAgICAgVXNlcklEICAgICA9PiAkUGFyYW17VXNlcklEfQogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiWW91IG11c3QgYmUgYW4gb3duZXIgb2YgdGhlIHRpY2tldCIKICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICB9CgogICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ0Nhbm5vdCB1cGRhdGUgUHJpb3JpdHknCiAgICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4geyBSZXNwb25zZSA9PiAiT0siIH07Cn0KCnN1YiBVcGRhdGVTTEEgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkVGlja2V0T2JqZWN0ID0gJFNlbGYtPntUaWNrZXRPYmplY3R9OwoKICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoCiAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICElVGlja2V0ICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdObyB0aWNrZXQnCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkSGFzUGVybWlzc2lvbiA9ICRTZWxmLT5fQ2hlY2tHcm91cFBlcm1pc3Npb24oCiAgICAgICAgUXVldWVJRCA9PiAkVGlja2V0e1F1ZXVlSUR9LAogICAgICAgIFVzZXJJRCAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJEhhc1Blcm1pc3Npb24gKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHBlcm1pc3Npb24nCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFNMQVNldCgKICAgICAgICBTTEEgICAgICA9PiAkUGFyYW17U0xBfSwKICAgICAgICBTTEFJRCAgICA9PiAkUGFyYW17U0xBSUR9LAogICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ0Nhbm5vdCB1cGRhdGUgU0xBJwogICAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIHsgUmVzcG9uc2UgPT4gIk9LIiB9Owp9CgpzdWIgVXBkYXRlU2VydmljZSB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRUaWNrZXRPYmplY3QgPSAkU2VsZi0+e1RpY2tldE9iamVjdH07CgogICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCgKICAgICAgICBUaWNrZXRJRCA9PiAkUGFyYW17VGlja2V0SUR9LAogICAgICAgIFVzZXJJRCAgID0+ICRQYXJhbXtVc2VySUR9CiAgICApOwoKICAgIGlmICggISVUaWNrZXQgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHRpY2tldCcKICAgICAgICB9OwogICAgfQoKICAgIG15ICRIYXNQZXJtaXNzaW9uID0gJFNlbGYtPl9DaGVja0dyb3VwUGVybWlzc2lvbigKICAgICAgICBRdWV1ZUlEID0+ICRUaWNrZXR7UXVldWVJRH0sCiAgICAgICAgVXNlcklEICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICEkSGFzUGVybWlzc2lvbiApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gcGVybWlzc2lvbicKICAgICAgICB9OwogICAgfQoKICAgIG15ICRTdWNjZXNzID0gJFRpY2tldE9iamVjdC0+VGlja2V0U2VydmljZVNldCgKICAgICAgICBTZXJ2aWNlICAgPT4gJFBhcmFte1NlcnZpY2V9LAogICAgICAgIFNlcnZpY2VJRCA9PiAkUGFyYW17U2VydmljZUlEfSwKICAgICAgICBUaWNrZXRJRCAgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBVc2VySUQgICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ0Nhbm5vdCB1cGRhdGUgU2VydmljZScKICAgICAgICB9OwogICAgfQoKICAgIHJldHVybiB7IFJlc3BvbnNlID0+ICJPSyIgfTsKfQoKc3ViIFVwZGF0ZVR5cGUgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkVGlja2V0T2JqZWN0ID0gJFNlbGYtPntUaWNrZXRPYmplY3R9OwoKICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoCiAgICAgICAgVGlja2V0SUQgPT4gJFBhcmFte1RpY2tldElEfSwKICAgICAgICBVc2VySUQgICA9PiAkUGFyYW17VXNlcklEfQogICAgKTsKCiAgICBpZiAoICElVGlja2V0ICkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdObyB0aWNrZXQnCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkSGFzUGVybWlzc2lvbiA9ICRTZWxmLT5fQ2hlY2tHcm91cFBlcm1pc3Npb24oCiAgICAgICAgUXVldWVJRCA9PiAkVGlja2V0e1F1ZXVlSUR9LAogICAgICAgIFVzZXJJRCAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJEhhc1Blcm1pc3Npb24gKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ05vIHBlcm1pc3Npb24nCiAgICAgICAgfTsKICAgIH0KCiAgICBteSAkU3VjY2VzcyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldFR5cGVTZXQoCiAgICAgICAgVHlwZSAgICAgPT4gJFBhcmFte1R5cGV9LAogICAgICAgIFR5cGVJRCAgID0+ICRQYXJhbXtUeXBlSUR9LAogICAgICAgIFRpY2tldElEID0+ICRQYXJhbXtUaWNrZXRJRH0sCiAgICAgICAgVXNlcklEICAgPT4gJFBhcmFte1VzZXJJRH0KICAgICk7CgogICAgaWYgKCAhJFN1Y2Nlc3MgKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ0Nhbm5vdCB1cGRhdGUgVHlwZScKICAgICAgICB9OwogICAgfQoKICAgIHJldHVybiB7IFJlc3BvbnNlID0+ICJPSyIgfTsKfQoKc3ViIF9DaGVja0dyb3VwUGVybWlzc2lvbiB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICRQYXJhbXtPcH0gLy89ICdBTkQnOwoKICAgIG15ICRHcm91cE9iamVjdCA9ICRTZWxmLT57R3JvdXBPYmplY3R9OwoKICAgICMgR2V0IFF1ZXVlSUQKICAgIG15ICRRdWV1ZUlEID0gJFBhcmFte1F1ZXVlSUR9OwoKICAgICMgR2V0IEdyb3VwSUQgZnJvbSBRdWV1ZUlECiAgICBteSAkR3JvdXBJRCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpRdWV1ZScpCiAgICAgICAgLT5HZXRRdWV1ZUdyb3VwSUQoIFF1ZXVlSUQgPT4gJFBhcmFteyBRdWV1ZUlEIH0gKTsKCiAgICAjIEdldCBHcm91cE5hbWUKICAgIG15ICRHcm91cE5hbWUgPSAkR3JvdXBPYmplY3QtPkdyb3VwTG9va3VwKCBHcm91cElEID0+ICRHcm91cElEICk7CgogICAgIyBDaGVjayBVc2VyIHBlcm1pc3Npb25zIGZvciBhIFF1ZXVlIG9mIGEgdGlja2V0CiAgICBteSAkSGFzUGVybWlzc2lvbiA9ICRHcm91cE9iamVjdC0+UGVybWlzc2lvbkNoZWNrKAogICAgICAgIFVzZXJJRCAgICA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICBHcm91cE5hbWUgPT4gJEdyb3VwTmFtZSwKICAgICAgICBUeXBlICAgICAgPT4gJ3J3JwogICAgKTsKCiAgICAjIElmIG5vIFJXLCBjaGVjayBUeXBlIGFycmF5CiAgICBpZiAoICEkSGFzUGVybWlzc2lvbiApIHsKICAgICAgICBpZiAoICRQYXJhbXtUeXBlfSBhbmQgcmVmICRQYXJhbXtUeXBlfSBlcSAnQVJSQVknICkgewoKICAgICAgICAgICAgZm9yIG15ICRQZXJtaXNzaW9uICggQHsgJFBhcmFte1R5cGV9IH0gKSB7CiAgICAgICAgICAgICAgICBteSAkSGFzUGVybWlzc2lvbkl0ZW0gPSAkR3JvdXBPYmplY3QtPlBlcm1pc3Npb25DaGVjaygKICAgICAgICAgICAgICAgICAgICBVc2VySUQgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICAgICAgICAgICAgICAgICAgR3JvdXBOYW1lID0+ICRHcm91cE5hbWUsCiAgICAgICAgICAgICAgICAgICAgVHlwZSAgICAgID0+ICRQZXJtaXNzaW9uCiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgIGlmICggJFBhcmFte09wfSBlcSAnT1InICkgewogICAgICAgICAgICAgICAgICAgIG5leHQgaWYgISRIYXNQZXJtaXNzaW9uSXRlbTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpZiAhJEhhc1Blcm1pc3Npb25JdGVtOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoICRQYXJhbXtPcH0gZXEgJ09SJyApIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gMTsKfQoKc3ViIF9DbGVhck9iamVjdEZpZWxkcyB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRPYmplY3QgPSAkUGFyYW17T2JqZWN0fTsKICAgIG15ICRUeXBlICAgPSAkUGFyYW17VHlwZX0gLy8gJ1RpY2tldCc7CgogICAgbXkgJFR5cGVPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpCiAgICAgIC0+R2V0KCdSUzo6QVBJOjpPYmplY3RUeXBlJyk7CgogICAgbXkgJE51bWJlckZpZWxkcyA9ICRUeXBlT2JqZWN0LT57TnVtYmVyfTsKCiAgICBmb3IgbXkgJEZpZWxkTmFtZSAoIEB7ICROdW1iZXJGaWVsZHMgfSApIHsKCiAgICAgICAgaWYgKCBkZWZpbmVkICRPYmplY3QtPnskRmllbGROYW1lfSBhbmQgJE9iamVjdC0+eyRGaWVsZE5hbWV9IGVxICcnICkKICAgICAgICB7CiAgICAgICAgICAgICRPYmplY3QtPnskRmllbGROYW1lfSA9IHVuZGVmOwogICAgICAgIH0KICAgIH0KCiAgICBteSAkRGF0ZUZpZWxkcyA9ICRUeXBlT2JqZWN0LT57RGF0ZX07CgogICAgZm9yIG15ICRGaWVsZE5hbWUgKCBAeyREYXRlRmllbGRzfSApIHsKCiAgICAgICAgaWYgKCBkZWZpbmVkICRPYmplY3QtPnskRmllbGROYW1lfQogICAgICAgICAgICBhbmQKICAgICAgICAgICAgKCAkT2JqZWN0LT57JEZpZWxkTmFtZX0gZXEgJycgb3IgJE9iamVjdC0+eyRGaWVsZE5hbWV9IGVxICcwJyApICkKICAgICAgICB7CiAgICAgICAgICAgICRPYmplY3QtPnskRmllbGROYW1lfSA9IHVuZGVmOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAoICRUeXBlIGVxICdUaWNrZXQnICkgewoKICAgICAgICBmb3IgbXkgJEZpZWxkTmFtZSAocXcvQ3VzdG9tZXJJRC8pIHsKICAgICAgICAgICAgaWYgKCBkZWZpbmVkICRPYmplY3QtPnskRmllbGROYW1lfSBhbmQgJE9iamVjdC0+eyRGaWVsZE5hbWV9IGVxICcnICkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJE9iamVjdC0+eyRGaWVsZE5hbWV9ID0gdW5kZWY7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBlbHNpZiAoICRUeXBlIGVxICdBcnRpY2xlJyApIHsKCiAgICAgICAgZm9yIG15ICRGaWVsZE5hbWUgKAogICAgICAgICAgICBxdy8KICAgICAgICAgICAgQmNjCiAgICAgICAgICAgIENjCiAgICAgICAgICAgIENvbnRlbnRBbHRlcm5hdGl2ZQogICAgICAgICAgICBDb250ZW50SUQKICAgICAgICAgICAgQ3VzdG9tZXJJRAogICAgICAgICAgICBJblJlcGx5VG8KICAgICAgICAgICAgTWVzc2FnZUlECiAgICAgICAgICAgIFJlZmVyZW5jZXMKICAgICAgICAgICAgUmVwbHlUbwogICAgICAgICAgICBUbwogICAgICAgICAgICBDdXN0b21lcklECiAgICAgICAgICAgIC8KICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgIGlmICggZGVmaW5lZCAkT2JqZWN0LT57JEZpZWxkTmFtZX0gYW5kICRPYmplY3QtPnskRmllbGROYW1lfSBlcSAnJyApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRPYmplY3QtPnskRmllbGROYW1lfSA9IHVuZGVmOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiAkT2JqZWN0Owp9CgpzdWIgX1NtYXJ0VGlja2V0U2VhcmNoIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJE9yZGVyQnkgPSAnVXAnOwogICAgaWYgKCByZWYgJFBhcmFte09yZGVyQnl9IGVxICdBUlJBWScgKSB7CiAgICAgICAgJE9yZGVyQnkgPSAkUGFyYW17T3JkZXJCeX1bMF07CiAgICB9CiAgICBlbHNlIHsKICAgICAgICAkT3JkZXJCeSA9ICRQYXJhbXtPcmRlckJ5fTsKICAgIH0KCiAgICBteSBAVGlja2V0SURzID0gKCk7CgogICAgbXkgJFRpY2tldE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUaWNrZXQnKTsKCiAgICBteSAkQ3VycmVudERhdGUgPSBzdHJmdGltZSAiJVktJW0tJWQgJUg6JU06JVMiLCBnbXRpbWU7CgogICAgbXkgQFBhcnRUaWNrZXRJRHMgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRTZWFyY2goCiAgICAgICAgJVBhcmFtLAogICAgICAgIFNvcnRCeSA9PiAnRXNjYWxhdGlvblNvbHV0aW9uVGltZScsCiAgICAgICAgKAogICAgICAgICAgICAkT3JkZXJCeSBlcSAnVXAnCiAgICAgICAgICAgID8gKCBUaWNrZXRFc2NhbGF0aW9uU29sdXRpb25UaW1lT2xkZXJEYXRlID0+ICRDdXJyZW50RGF0ZSApCiAgICAgICAgICAgIDogKCBUaWNrZXRFc2NhbGF0aW9uU29sdXRpb25UaW1lTmV3ZXJEYXRlID0+ICRDdXJyZW50RGF0ZSApCiAgICAgICAgKSwKICAgICAgICBTbWFydFNvcnQgPT4gMQogICAgKTsKICAgIHB1c2ggQFRpY2tldElEcywgQFBhcnRUaWNrZXRJRHM7CgogICAgQFBhcnRUaWNrZXRJRHMgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRTZWFyY2goCiAgICAgICAgJVBhcmFtLAogICAgICAgIFNvcnRCeSA9PiAnRXNjYWxhdGlvblNvbHV0aW9uVGltZScsCiAgICAgICAgKAogICAgICAgICAgICAkT3JkZXJCeSBlcSAnVXAnCiAgICAgICAgICAgID8gKCBUaWNrZXRFc2NhbGF0aW9uU29sdXRpb25UaW1lTmV3ZXJEYXRlID0+ICRDdXJyZW50RGF0ZSApCiAgICAgICAgICAgIDogKCBUaWNrZXRFc2NhbGF0aW9uU29sdXRpb25UaW1lT2xkZXJEYXRlID0+ICRDdXJyZW50RGF0ZSApCiAgICAgICAgKSwKICAgICAgICBTbWFydFNvcnQgPT4gMQogICAgKTsKICAgIHB1c2ggQFRpY2tldElEcywgQFBhcnRUaWNrZXRJRHM7CgogICAgQFBhcnRUaWNrZXRJRHMgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRTZWFyY2goCiAgICAgICAgJVBhcmFtLAogICAgICAgIFRpY2tldEVzY2FsYXRpb25Tb2x1dGlvblRpbWUgPT4gMCwKICAgICAgICBTb3J0QnkgICAgICAgICAgICAgICAgICAgICAgID0+ICdBZ2UnCiAgICApOwogICAgcHVzaCBAVGlja2V0SURzLCBAUGFydFRpY2tldElEczsKCiAgICByZXR1cm4gQFRpY2tldElEczsKfQoKMTsKCl9fRU5EX18KCj1lbmNvZGluZyB1dGY4Cgo9aGVhZDEgTkFNRQoKS2VybmVsOjpTeXN0ZW06OkFQSTo6VGlja2V0Cgo9aGVhZDEgREVTQ1JJUFRJT04KCj1oZWFkMSBNRVRIT0RTCgo9b3ZlcgoKPWl0ZW0gVXBkYXRlUXVldWUKClBlcm1pc3Npb246Cgo9aXRlbSBHZXRUaWNrZXRMaXN0CgpHZXQgdGlja2V0IGxpc3Qgb2YgdGlja2V0IGNvdW50LgoKICAgICRBUElUaWNrZXRPYmplY3QtPkdldFRpY2tldExpc3QoCiAgICAgICAgVXNlcklEID0+ICRVc2VySUQsCiAgICAgICAgQ291bnQgID0+IDF8MCAgICAgICMgb3B0aW9uYWwsIGRlZmF1bHQgMQogICAgICAgICVQYXJhbXMgICAgICAgICAgICAjIHRoZSBzYW1lIGFzIGZvciBfR2V0VGlja2V0UmVxdWVzdFBhcmFtcygpCiAgICApOwoKUmV0dXJucyB0aWNrZXRzIGZyb20gUXVldWVzIHdpdGggR3JvdXAgcGVybWlzc2lvbnMgUk8gb3IgUlcuCgpSZXR1cm5zOgoKICAgIHsKICAgICAgICBOZWVkVG9rZW5VcGRhdGU6IDEgfCAwLAogICAgICAgIFJlc3BvbnNlOiAgICAgICAgJFJlc3BvbnNlLAogICAgICAgIFRpY2tldHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgVGlja2V0UGFyYW0xID0+IC4uLiwKICAgICAgICAgICAgICAgIC4uLgogICAgICAgICAgICB9LAogICAgICAgICAgICAuLi4KICAgICAgICBdCiAgICB9CgpTb3J0aW5nLiBJZiBzb3J0IGJ5IEVzY2FsYXRpb24uCgpUaGUgb3JkZXIgb2YgdGlja2V0cyB3aXRoIHN0cmFpZ2h0IGRpcmVjdGlvbjoKCjEuIEV4cGlyZWQuIEZyb20gdGhlIG1vc3QgdG8gdGhlIGxlYXN0IG9uZXMuCjIuIE5vdCBleHBpcmVkLiBGcm9tIHRoZSBhcHByb2FjaGluZyB0byBleHBpcmVkIHRvIHRoZSBsZWFzdCBvbmVzLgozLiBXaXRob3V0IGV4cGlyZS4gQnkgYWdlLCBmcm9tIG9sZCB0byBuZXcgb25lcy4KCldpdGggcmV2ZXJzZSBkaXJlY3Rpb246CgoxLiBOb3QgZXhwaXJlZC4gRnJvbSB0aGUgbGVhc3QgdG8gdGhlIGFwcHJvYWNoaW5nIHRvIGV4cGlyZWQuCjIuIEV4cGlyZWQuIEZyb20gdGhlIG1vc3QgdG8gdGhlIGxlYXN0IG9uZXMuCjMuIFdpdGhvdXQgZXhwaXJlLiBCeSBhZ2UsIGZyb20gbmV3IHRvIG9sZCBvbmVzLgoKPWJhY2sKCj1oZWFkMiBJTlRFUk5BTCBNRVRIT0RTCgo9b3ZlcgoKPWl0ZW0gX0dldFRpY2tldFJlcXVlc3RQYXJhbXMoKQoKR2V0IHBhcmFtZXRlcnMgZnJvbSBWaWV3cyBmb3IgVGlja2V0U2VhcmNoLgoKICAgIG15ICRQYXJhbXMgPSAkU2VsZi0+X0dldFRpY2tldFJlcXVlc3RQYXJhbXMoCiAgICAgICAgVmlld0lEID0+ICRWaWV3SUQsCgogICAgICAgIEZ1bGxUZXh0U2VhcmNoID0+ICRGdWxsVGV4dFNlYXJjaCwKICAgICAgICBUaWNrZXRJRCAgICAgICA9PiAkVGlja2V0SUQsCiAgICAgICAgVGlja2V0TnVtYmVyICAgPT4gJFRpY2tldE51bWJlciwKCiAgICAgICAgVGl0bGUgICAgICAgPT4gJFRpdGxlLAogICAgICAgIFF1ZXVlcyAgICAgID0+ICRRdWV1ZXMsCiAgICAgICAgUXVldWVJRHMgICAgPT4gJFF1ZXVlSURzLAogICAgICAgIFR5cGVzICAgICAgID0+ICRUeXBlcywKICAgICAgICBUeXBlSURzICAgICA9PiAkVHlwZUlEcywKICAgICAgICBTdGF0ZXMgICAgICA9PiAkU3RhdGVzLAogICAgICAgIFN0YXRlSURzICAgID0+ICRTdGF0ZUlEcywKICAgICAgICBTdGF0ZVR5cGUgICA9PiAkU3RhdGVUeXBlLAogICAgICAgIFByaW9yaXRpZXMgID0+ICRQcmlvcml0aWVzLAogICAgICAgIFByaW9yaXR5SURzID0+ICRQcmlvcml0eUlEcywKICAgICAgICBTZXJ2aWNlcyAgICA9PiAkU2VydmljZXMsCiAgICAgICAgU2VydmljZUlEcyAgPT4gJFNlcnZpY2VJRHMsCiAgICAgICAgU0xBcyAgICAgICAgPT4gJFNMQXMsCiAgICAgICAgU0xBSURzICAgICAgPT4gJFNMQUlEcywKCiAgICAgICAgT3duZXJJRHMgICAgICAgICAgPT4gJE93bmVySURzLAogICAgICAgIFJlc3BvbnNpYmxlSURzICAgID0+ICRSZXNwb25zaWJsZUlEcywKICAgICAgICBXYXRjaFVzZXJJRHMgICAgICA9PiAkV2F0Y2hVc2VySURzLAogICAgICAgIEN1c3RvbWVySUQgICAgICAgID0+ICRDdXN0b21lcklELAogICAgICAgIEN1c3RvbWVyVXNlckxvZ2luID0+ICRDdXN0b21lclVzZXJMb2dpbiwKCiAgICAgICAgTG9ja3MgICA9PiAkTG9ja3MsCiAgICAgICAgTG9ja0lEcyA9PiAkTG9ja0lEcywKCiAgICAgICAgRnJvbSAgICA9PiAkRnJvbSwKICAgICAgICBUbyAgICAgID0+ICRUbywKICAgICAgICBDYyAgICAgID0+ICRDYywKICAgICAgICBTdWJqZWN0ID0+ICRTdWJqZWN0LAogICAgICAgIEJvZHkgICAgPT4gJEJvZHksCgogICAgICAgIFNvcnRCeSAgPT4gJFNvcnRCeSwKICAgICAgICBPcmRlckJ5ID0+ICRPcmRlckJ5LAoKICAgICAgICBSZXN1bHQgPT4gJFJlc3VsdCwKCiAgICAgICAgVXNlcklEID0+ICRVc2VySUQKICAgICk7CgpSZXR1cm5zOgoKewogICAgVmlld1BhcmFtcyAgPT4gLi4uLAogICAgVGlja2V0UGFyYW0gPT4gLi4uCn0KCj1pdGVtIF9HZXRWaWV3UGFyYW1zKCkKCkdldCBwYXJhbWV0ZXJzIGZvciBGaWx0ZXJzIGZyb20gVmlld3MgKGFuZCBWaWV3cyBwYWNrYWdlIGlmIGl0IGlzIGluc3RhbGxlZCkuCgogICAgbXkgJFZpZXdzQXJyID0gJFNlbGYtPl9HZXRWaWV3UGFyYW1zKAogICAgICAgIFNvcnRCeSAgPT4gJFNvcnRCeSwKICAgICAgICBPcmRlckJ5ID0+ICRPcmRlckJ5LAogICAgICAgIFZpZXdJRCAgPT4gJFZpZXdJRCwKICAgICAgICBVc2VySUQgID0+ICRVc2VySUQKICAgICk7CgpSZXR1cm5zOgoKWwogICAgewogICAgICAgIHRoZSBzYW1lIGFzIHBhcmFtZXRlcnMgZnJvbSBfR2V0VGlja2V0UmVxdWVzdFBhcmFtcygpCiAgICB9LAogICAgLi4uCl0KCj1iYWNrCg==</File>
        <File Location="Custom/Kernel/System/API/User.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QVBJOjpVc2VyOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwpubyB3YXJuaW5ncyAncmVkZWZpbmUnOwoKdXNlIHV0Zjg7Cgp1c2UgdmFycyBxdyhASVNBKTsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKCk7CgpzdWIgbmV3IHsKICAgIG15ICggJFR5cGUsICVQYXJhbSApID0gQF87CgogICAgbXkgJFNlbGYgPSB7fTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICAkU2VsZi0+e1VzZXJPYmplY3R9ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlVzZXInKTsKCiAgICByZXR1cm4gJFNlbGY7Cn0KCnN1YiBHZXRVc2VyTGlzdCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwogICAgCiAgICBteSAkUmVzdWx0OwoKICAgIG15ICVVc2VycyA9ICRTZWxmLT57VXNlck9iamVjdH0tPlVzZXJMaXN0KAogICAgICAgIFR5cGUgID0+ICdTaG9ydCcsCiAgICAgICAgVmFsaWQgPT4gMSwKICAgICk7CgogICAgbXkgQFVzZXJJRHMgPSAoKTsKCiAgICBpZiAoICRQYXJhbXtRdWV1ZUlEfSApIHsKCiAgICAgICAgbXkgJEdJRCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpRdWV1ZScpCiAgICAgICAgICAgICAgICAgICAgLT5HZXRRdWV1ZUdyb3VwSUQoIFF1ZXVlSUQgPT4gJFBhcmFte1F1ZXVlSUR9ICk7CgogICAgICAgIG15ICVNZW1iZXJMaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06Okdyb3VwJyktPlBlcm1pc3Npb25Hcm91cEdldCgKICAgICAgICAgICAgR3JvdXBJRCA9PiAkR0lELAogICAgICAgICAgICBUeXBlICAgID0+ICdvd25lcicKICAgICAgICApOwoKICAgICAgICBAVXNlcklEcyA9IGtleXMgJU1lbWJlckxpc3Q7CgogICAgfSBlbHNpZiAoICRQYXJhbXtTZXJ2aWNlSUR9ICkgewoKICAgIH0gZWxzZSB7CgogICAgICAgIEBVc2VySURzID0ga2V5cyAlVXNlcnM7CiAgICB9CgogICAgbXkgQFVzZXJzID0gKCk7CiAgICBmb3IgbXkgJFVzZXJJRCAoQFVzZXJJRHMpIHsKICAgICAgICBteSAlVXNlciA9ICRTZWxmLT57VXNlck9iamVjdH0tPkdldFVzZXJEYXRhKCBVc2VySUQgPT4gJFVzZXJJRCApOyAgICAgICAgICAgIAogICAgICAgIGlmICggJVVzZXIgKSB7CiAgICAgICAgICAgIGZvciBteSAkRmllbGQgKAogICAgICAgICAgICAgICAgcXcvVXNlckF1dGhCYWNrZW5kIFVzZXJDcmVhdGVOZXh0TWFzawogICAgICAgICAgICAgICAgVXNlclN5c3RlbUNvbmZpZ3VyYXRpb25DYXRlZ29yeSBVc2VyVGl0bGUgVXNlck1vYmlsZS8KICAgICAgICAgICAgICApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICggZGVmaW5lZCAkVXNlcnskRmllbGR9IGFuZCAkVXNlcnskRmllbGR9IGVxICcnICkgewogICAgICAgICAgICAgICAgICAgICRVc2VyeyRGaWVsZH0gPSB1bmRlZjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVzaCBAVXNlcnMsIFwlVXNlcjsKICAgICAgICB9CiAgICB9CgogICAgJFJlc3VsdCA9IHsKICAgICAgICBSZXNwb25zZSA9PiAiT0siLAogICAgICAgIFVzZXJzICAgID0+IFxAVXNlcnMsCiAgICAgICAgQ291bnQgICAgPT4gc2NhbGFyIEBVc2VycwogICAgfTsKCiAgICByZXR1cm4gJFJlc3VsdDsKfQoKc3ViIEdldFVzZXJQZXJtaXNzaW9ucyB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRSZXN1bHQ7CgogICAgbXkgJEdyb3Vwc0luZm9Sb3dzID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkRCJyktPlNlbGVjdEFsbCgKICAgICAgICBTUUwgID0+IHFxewogICAgICAgICAgICBTRUxFQ1QgZ3UuZ3JvdXBfaWQsIGcubmFtZSBncm91cF9uYW1lLAogICAgICAgICAgICAgICAgICAgZ3UucGVybWlzc2lvbl9rZXksIHEuaWQgcXVldWVfaWQsCiAgICAgICAgICAgICAgICAgICBxLm5hbWUgcXVldWVfbmFtZQogICAgICAgICAgICBGUk9NIGdyb3VwX3VzZXIgZ3UKICAgICAgICAgICAgSk9JTiBncm91cHMgZwogICAgICAgICAgICAgICAgT04gZ3UuZ3JvdXBfaWQgPSBnLmlkIEFORCBndS51c2VyX2lkID0gPwogICAgICAgICAgICBMRUZUIEpPSU4gcXVldWUgcSBPTiBndS5ncm91cF9pZCA9IHEuZ3JvdXBfaWQKCiAgICAgICAgICAgIFVOSU9OCgogICAgICAgICAgICBTRUxFQ1QgZ3IuZ3JvdXBfaWQsIGcubmFtZSBncm91cF9uYW1lLAogICAgICAgICAgICAgICAgICAgZ3IucGVybWlzc2lvbl9rZXksIHEuaWQgcXVldWVfaWQsCiAgICAgICAgICAgICAgICAgICBxLm5hbWUgcXVldWVfbmFtZQogICAgICAgICAgICBGUk9NIGdyb3VwX3JvbGUgZ3IKICAgICAgICAgICAgSk9JTiByb2xlX3VzZXIgcnUgT04gZ3Iucm9sZV9pZCA9IHJ1LnJvbGVfaWQgQU5EIHJ1LnVzZXJfaWQgPSA/CiAgICAgICAgICAgIEpPSU4gZ3JvdXBzIGcKICAgICAgICAgICAgICAgIE9OIGdyLmdyb3VwX2lkID0gZy5pZAogICAgICAgICAgICBMRUZUIEpPSU4gcXVldWUgcSBPTiBnci5ncm91cF9pZCA9IHEuZ3JvdXBfaWQKICAgICAgICB9LAogICAgICAgIEJpbmQgPT4gWyBcJFBhcmFte1VzZXJJRH0sIFwkUGFyYW17VXNlcklEfSBdCiAgICApIC8vIFtdOwoKICAgIG15ICRHcm91cEluZGV4ID0gMDsKICAgIG15ICRHcm91cElER3JvdXBzSW5kZXhNYXAgPSB7fTsKCiAgICBteSAkR3JvdXBzID0gW107CiAgICBmb3IgbXkgJEdyb3VwUm93ICggQHsgJEdyb3Vwc0luZm9Sb3dzIH0gKSB7CiAgICAgICAgbXkgJEdyb3VwSUQgICAgICAgICAgPSAkR3JvdXBSb3ctPlswXTsKICAgICAgICBteSAkR3JvdXBOYW1lICAgICAgICA9ICRHcm91cFJvdy0+WzFdOwogICAgICAgIG15ICRHcm91cFBlcm1pc3Npb24gID0gJEdyb3VwUm93LT5bMl07CiAgICAgICAgbXkgJFF1ZXVlSUQgICAgICAgICAgPSAkR3JvdXBSb3ctPlszXTsKICAgICAgICBteSAkUXVldWVOYW1lICAgICAgICA9ICRHcm91cFJvdy0+WzRdOwoKICAgICAgICBteSAkR3JvdXAgPSB7CiAgICAgICAgICAgIElEICAgICA9PiAkR3JvdXBJRCwKICAgICAgICAgICAgTmFtZSAgID0+ICRHcm91cE5hbWUsCiAgICAgICAgICAgIFF1ZXVlcyA9PiBbXQogICAgICAgIH07CgogICAgICAgIG15ICRHcm91cEluZGV4SW5Hcm91cHNBcnIgPSAkR3JvdXBJREdyb3Vwc0luZGV4TWFwLT57ICRHcm91cElEIH07CiAgICAgICAgaWYgKCBkZWZpbmVkICRHcm91cEluZGV4SW5Hcm91cHNBcnIgKSB7CgogICAgICAgICAgICBteSAkRm91bmQgPSAwOwogICAgICAgICAgICBmb3IgbXkgJFBlcm0gKCBAeyAkR3JvdXBzLT5bICRHcm91cEluZGV4SW5Hcm91cHNBcnIgXS0+e1Blcm1pc3Npb25zfSB9ICkgewogICAgICAgICAgICAgICAgaWYgKCAkUGVybSBlcSAkR3JvdXBQZXJtaXNzaW9uICkgewogICAgICAgICAgICAgICAgICAgICRGb3VuZCA9IDE7CiAgICAgICAgICAgICAgICAgICAgbGFzdDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCAhJEZvdW5kICkgewogICAgICAgICAgICAgICAgcHVzaCBAeyAkR3JvdXBzLT5bICRHcm91cEluZGV4SW5Hcm91cHNBcnIgXS0+e1Blcm1pc3Npb25zfSB9LAogICAgICAgICAgICAgICAgICAgICAkR3JvdXBQZXJtaXNzaW9uOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoICRRdWV1ZUlEICkgewogICAgICAgICAgICAgICAgbXkgJElzUXVldWVGb3VuZCA9IDA7CiAgICAgICAgICAgICAgICBmb3IgbXkgJFF1ZXVlICggQHsgJEdyb3Vwcy0+WyAkR3JvdXBJbmRleEluR3JvdXBzQXJyIF0tPntRdWV1ZXN9IH0gKSB7CiAgICAgICAgICAgICAgICAgICAgJElzUXVldWVGb3VuZCA9IDEgaWYgJFF1ZXVlLT57SUR9ID09ICRRdWV1ZUlEOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICggISRJc1F1ZXVlRm91bmQgKSB7CiAgICAgICAgICAgICAgICAgICAgcHVzaCBAeyAkR3JvdXBzLT5bICRHcm91cEluZGV4SW5Hcm91cHNBcnIgXS0+e1F1ZXVlc30gfSwgewogICAgICAgICAgICAgICAgICAgICAgICBJRCAgID0+ICRRdWV1ZUlELAogICAgICAgICAgICAgICAgICAgICAgICBOYW1lID0+ICRRdWV1ZU5hbWUKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewoKICAgICAgICAgICAgaWYgKCAkUXVldWVJRCApIHsKICAgICAgICAgICAgICAgIHB1c2ggQHsgJEdyb3VwLT57UXVldWVzfSB9LCB7CiAgICAgICAgICAgICAgICAgICAgSUQgICA9PiAkUXVldWVJRCwKICAgICAgICAgICAgICAgICAgICBOYW1lID0+ICRRdWV1ZU5hbWUKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRHcm91cC0+e1Blcm1pc3Npb25zfSA9IFsgJEdyb3VwUGVybWlzc2lvbiBdOwoKICAgICAgICAgICAgcHVzaCBAeyAkR3JvdXBzIH0sICRHcm91cDsKCiAgICAgICAgICAgICRHcm91cElER3JvdXBzSW5kZXhNYXAtPnsgJEdyb3VwSUQgfSA9ICRHcm91cEluZGV4Kys7CiAgICAgICAgfQogICAgfQoKICAgICRSZXN1bHQgPSB7CiAgICAgICAgUmVzcG9uc2UgPT4gIk9LIiwKICAgICAgICBHcm91cHMgICA9PiAkR3JvdXBzCiAgICB9OwoKICAgIHJldHVybiAkUmVzdWx0Owp9CgoxOwo=</File>
        <File Location="Custom/Kernel/System/Web/InterfaceAgentJSON.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6V2ViOjpJbnRlcmZhY2VBZ2VudEpTT04gMC4wMzsKCnVzZSBzdHJpY3Q7CnVzZSB3YXJuaW5nczsKbm8gd2FybmluZ3MgJ3JlZGVmaW5lJzsKCnVzZSBLZXJuZWw6Okxhbmd1YWdlIHF3KFRyYW5zbGF0YWJsZSk7CnVzZSBLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWU7Cgp1c2UgSlNPTjo6WFM7CnVzZSBVUkk6OkVzY2FwZTsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKAogICAgJ0tlcm5lbDo6Q29uZmlnJywKICAgICdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0JywKICAgICdLZXJuZWw6OlN5c3RlbTo6QXV0aCcsCiAgICAnS2VybmVsOjpTeXN0ZW06OkF1dGhTZXNzaW9uJywKICAgICdLZXJuZWw6OlN5c3RlbTo6REInLAogICAgJ0tlcm5lbDo6U3lzdGVtOjpFbWFpbCcsCiAgICAnS2VybmVsOjpTeXN0ZW06Okdyb3VwJywKICAgICdLZXJuZWw6OlN5c3RlbTo6TG9nJywKICAgICdLZXJuZWw6OlN5c3RlbTo6TWFpbicsCiAgICAnS2VybmVsOjpTeXN0ZW06OlNjaGVkdWxlcicsCiAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICdLZXJuZWw6OlN5c3RlbTo6VXNlcicsCiAgICAnS2VybmVsOjpTeXN0ZW06OldlYjo6UmVxdWVzdCcsCiAgICAnS2VybmVsOjpTeXN0ZW06OlZhbGlkJywKKTsKCj1oZWFkMSBOQU1FCgpLZXJuZWw6OlN5c3RlbTo6V2ViOjpJbnRlcmZhY2VBZ2VudCAtIHRoZSBhZ2VudCB3ZWIgaW50ZXJmYWNlCgo9aGVhZDEgREVTQ1JJUFRJT04KCnRoZSBnbG9iYWwgYWdlbnQgd2ViIGludGVyZmFjZSAoYXV0aGVudGljYXRpb24sIHNlc3Npb24gaGFuZGxpbmcsIC4uLikKCj1oZWFkMSBQVUJMSUMgSU5URVJGQUNFCgo9aGVhZDIgbmV3KCkKCmNyZWF0ZSBhZ2VudCB3ZWIgaW50ZXJmYWNlIG9iamVjdC4gRG8gbm90IHVzZSBpdCBkaXJlY3RseSwgaW5zdGVhZCB1c2U6CgogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpPYmplY3RNYW5hZ2VyOwogICAgbXkgJERlYnVnID0gMCwKICAgIGxvY2FsICRLZXJuZWw6Ok9NID0gS2VybmVsOjpTeXN0ZW06Ok9iamVjdE1hbmFnZXItPm5ldygKICAgICAgICAnS2VybmVsOjpTeXN0ZW06OldlYjo6SW50ZXJmYWNlQWdlbnQnID0+IHsKICAgICAgICAgICAgRGVidWcgICA9PiAwLAogICAgICAgICAgICBXZWJSZXF1ZXN0ID0+IENHSTo6RmFzdC0+bmV3KCksICMgb3B0aW9uYWwsIGUuIGcuIGlmIGZhc3QgY2dpIGlzIHVzZWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB0aGUgQ0dJIG9iamVjdCBpcyBhbHJlYWR5IHByb3ZpZGVkCiAgICAgICAgfQogICAgKTsKICAgIG15ICRJbnRlcmZhY2VBZ2VudCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpXZWI6OkludGVyZmFjZUFnZW50Jyk7Cgo9Y3V0CgpzdWIgbmV3IHsKICAgIG15ICggJFR5cGUsICVQYXJhbSApID0gQF87CiAgICBteSAkU2VsZiA9IHt9OwogICAgYmxlc3MoICRTZWxmLCAkVHlwZSApOwoKICAgICMgUGVyZm9ybWFuY2UgbG9nCiAgICAkU2VsZi0+e1BlcmZvcm1hbmNlTG9nU3RhcnR9ID0gdGltZSgpOwoKICAgICMgZ2V0IGRlYnVnIGxldmVsCiAgICAkU2VsZi0+e0RlYnVnfSA9ICRQYXJhbXtEZWJ1Z30gfHwgMDsKCiAgICAkS2VybmVsOjpPTS0+T2JqZWN0UGFyYW1BZGQoCiAgICAgICAgJ0tlcm5lbDo6U3lzdGVtOjpMb2cnID0+IHsKICAgICAgICAgICAgTG9nUHJlZml4ID0+ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyktPkdldCgnQ0dJTG9nUHJlZml4JyksCiAgICAgICAgfSwKICAgICAgICAnS2VybmVsOjpTeXN0ZW06OldlYjo6UmVxdWVzdCcgPT4gewogICAgICAgICAgICBXZWJSZXF1ZXN0ID0+ICRQYXJhbXtXZWJSZXF1ZXN0fSB8fCAwLAogICAgICAgIH0sCiAgICApOwoKICAgICMgZGVidWcgaW5mbwogICAgaWYgKCAkU2VsZi0+e0RlYnVnfSApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2RlYnVnJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ0dsb2JhbCBoYW5kbGUgc3RhcnRlZC4uLicsCiAgICAgICAgKTsKICAgIH0KCiAgICByZXR1cm4gJFNlbGY7Cn0KCj1oZWFkMiBSdW4oKQoKZXhlY3V0ZSB0aGUgb2JqZWN0CgogICAgJEludGVyZmFjZUFnZW50LT5SdW4oKTsKCj1jdXQKCnN1YiBSdW4gewogICAgbXkgJFNlbGYgPSBzaGlmdDsKCiAgICBteSAkQ29uZmlnT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpDb25maWcnKTsKCiAgICBteSAkUXVlcnlTdHJpbmcgPSAkRU5We1FVRVJZX1NUUklOR30gfHwgJyc7CgogICAgIyBDaGVjayBpZiBodHRwcyBmb3JjaW5nIGlzIGFjdGl2ZSwgYW5kIHJlZGlyZWN0IGlmIG5lZWRlZC4KICAgIGlmICggJENvbmZpZ09iamVjdC0+R2V0KCdIVFRQU0ZvcmNlUmVkaXJlY3QnKSApIHsKCiAgICAgICAgIyBTb21lIHdlYiBzZXJ2ZXJzIGRvIG5vdCBzZXQgSFRUUFMgZW52aXJvbm1lbnQgdmFyaWFibGUsIHNvIGl0J3Mgbm90IHBvc3NpYmxlIHRvIGVhc2lseSBrbm93IGlmIHdlIGFyZSB1c2luZwogICAgICAgICMgICBodHRwcyBwcm90b2NvbC4gTG9vayBhbHNvIGZvciBzaW1pbGFybHkgbmFtZWQga2V5cyBpbiBlbnZpcm9ubWVudCBoYXNoLCBzaW5jZSB0aGlzIHNob3VsZCBwcmV2ZW50IGxvb3BzIGluCiAgICAgICAgIyAgIGNlcnRhaW4gY2FzZXMuCiAgICAgICAgaWYgKAogICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAhZGVmaW5lZCAkRU5We0hUVFBTfQogICAgICAgICAgICAgICAgJiYgIWdyZXAgey9eSFRUUFMoPzpffCQpL30ga2V5cyAlRU5WCiAgICAgICAgICAgICkKICAgICAgICAgICAgfHwgJEVOVntIVFRQU30gbmUgJ29uJwogICAgICAgICAgICApCiAgICAgICAgewogICAgICAgICAgICBteSAkSG9zdCA9ICRFTlZ7SFRUUF9IT1NUfSB8fCAkQ29uZmlnT2JqZWN0LT5HZXQoJ0ZRRE4nKTsKCiAgICAgICAgICAgICMgUmVkaXJlY3Qgd2l0aCAzMDEgY29kZS4gQWRkIHR3byBuZXcgbGluZXMgYXQgdGhlIGVuZCwgc28gSFRUUCBoZWFkZXJzIGFyZSB2YWxpZGF0ZWQgY29ycmVjdGx5LgogICAgICAgICAgICBwcmludCAiU3RhdHVzOiAzMDEgTW92ZWQgUGVybWFuZW50bHlcbkxvY2F0aW9uOiBodHRwczovLyRIb3N0JEVOVntSRVFVRVNUX1VSSX1cblxuIjsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KCiAgICBteSAkUGFyYW1PYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6V2ViOjpSZXF1ZXN0Jyk7CgogICAgbXkgJVBhcmFtOwoKICAgICMgZ2V0IHNlc3Npb24gaWQKICAgICRQYXJhbXtTZXNzaW9uTmFtZX0gPSAkQ29uZmlnT2JqZWN0LT5HZXQoJ1Nlc3Npb25OYW1lJykgfHwgJ1Nlc3Npb25JRCc7CiAgICAkUGFyYW17U2Vzc2lvbklEfSA9ICRQYXJhbU9iamVjdC0+R2V0UGFyYW0oIFBhcmFtID0+ICRQYXJhbXtTZXNzaW9uTmFtZX0gKSB8fCAnJzsKCiAgICAjIFJTIGpzb24g0L/QvtC00LTQtdGA0LbQutCwCiAgICBteSAlSlNPTlBhcmFtID0gKCk7CiAgICBpZiAoICggJEVOVnsnQ09OVEVOVF9UWVBFJ30gLy8gJycgKSA9fiBte15hcHBsaWNhdGlvbi9qc29uOz99ICkgewoKICAgICAgICBteSAkUE9TVERhdGEgPSB7fTsKICAgICAgICBteSAkUE9TVERhdGFSYXcgPSAkUGFyYW1PYmplY3QtPntRdWVyeX0tPnBhcmFtKCdQT1NUREFUQScpOwoKICAgICAgICBpZiAoICRQT1NURGF0YVJhdyApIHsKCiAgICAgICAgICAgICRQT1NURGF0YSA9IGV2YWwgeyBkZWNvZGVfanNvbigkUE9TVERhdGFSYXcpIH0gLy8ge307CgogICAgICAgICAgICBpZiAoJEApIHsKICAgICAgICAgICAgICAgIHByaW50ICRTZWxmLT5QcmludEpTT05SZXNwb25zZSgKICAgICAgICAgICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdCYWQgcGFyYW0gcmVxdWVzdCEnCiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJUpTT05QYXJhbSA9ICV7ICRQT1NURGF0YSB9OwogICAgICAgICRQYXJhbXtTZXNzaW9uSUR9IHx8PSAkUE9TVERhdGEtPnsgJFBhcmFte1Nlc3Npb25OYW1lfSB9IHx8ICcnOwogICAgfQoKICAgICMgZHJvcCBvbGQgc2Vzc2lvbiBpZCAoaWYgZXhpc3RzKQogICAgJFF1ZXJ5U3RyaW5nID1+IHMvKFw/fCZ8O3wpJFBhcmFte1Nlc3Npb25OYW1lfSg9Jnw9O3w9Lis/WyY7XXw9Lis/JCkvOy9nOwoKICAgICMgUlMKICAgIG15IEBRdWVyeVN0cmluZyA9IHNwbGl0IC9bOyZdKy8sICRRdWVyeVN0cmluZzsKICAgIG15ICVBbGxQYXJhbXM7CiAgICBmb3IgKCBAUXVlcnlTdHJpbmcgKSB7CiAgICAgICAgbXkgKCRQYXJhbSwgJFZhbHVlKSA9IHNwbGl0IC89LywgJF87CgogICAgICAgICRQYXJhbSA9IEVuY29kZTo6ZGVjb2RlKCAnVVRGLTgnLCB1cmlfdW5lc2NhcGUoICRQYXJhbSApICk7CiAgICAgICAgJFZhbHVlID0gRW5jb2RlOjpkZWNvZGUoICdVVEYtOCcsIHVyaV91bmVzY2FwZSggJFZhbHVlICkgKTsKCiAgICAgICAgJEFsbFBhcmFtc3sgJFBhcmFtIH0gPSAkVmFsdWU7CiAgICB9CiAgICBkZWxldGUgJEFsbFBhcmFtc3sgUmVxdWVzdGVkVVJMIH07CgogICAgIyBkZWZpbmUgZnJhbWV3b3JrIHBhcmFtcwogICAgbXkgJEZyYW1ld29ya1BhcmFtcyA9IHsKICAgICAgICBMYW5nICAgICAgICAgPT4gJycsCiAgICAgICAgQWN0aW9uICAgICAgID0+ICcnLAogICAgICAgIFN1YmFjdGlvbiAgICA9PiAnJywKICAgICAgICBSZXF1ZXN0ZWRVUkwgPT4gJFF1ZXJ5U3RyaW5nLAoKICAgICAgICAjIFJTCiAgICAgICAgJUFsbFBhcmFtcwogICAgfTsKCiAgICAjIFJTCiAgICAlUGFyYW0gPSAoICVQYXJhbSwgJXsgJEZyYW1ld29ya1BhcmFtcyB9ICk7CgogICAgIyB2YWxpZGF0ZSBsYW5ndWFnZQogICAgaWYgKCAkUGFyYW17TGFuZ30gJiYgJFBhcmFte0xhbmd9ICF+IG17XEFbYS16XXsyfSg/Ol9bQS1aXXsyfSk/XHp9eG1zICkgewogICAgICAgIGRlbGV0ZSAkUGFyYW17TGFuZ307CiAgICB9CgogICAgIyBjaGVjayBpZiB0aGUgYnJvd3NlciBzZW5kcyB0aGUgU2Vzc2lvbklEIGNvb2tpZSBhbmQgc2V0IHRoZSBTZXNzaW9uSUQtY29va2llCiAgICAjIGFzIFNlc3Npb25JRCEgR0VUIG9yIFBPU1QgU2Vzc2lvbklEIGhhdmUgdGhlIGxvd2VzdCBwcmlvcml0eS4KICAgIG15ICRCcm93c2VySGFzQ29va2llID0gMDsKICAgIGlmICggJENvbmZpZ09iamVjdC0+R2V0KCdTZXNzaW9uVXNlQ29va2llJykgKSB7CiAgICAgICAgJFBhcmFte1Nlc3Npb25JRENvb2tpZX0gPSAkUGFyYW1PYmplY3QtPkdldENvb2tpZSggS2V5ID0+ICRQYXJhbXtTZXNzaW9uTmFtZX0gKTsKICAgICAgICBpZiAoICRQYXJhbXtTZXNzaW9uSURDb29raWV9ICkgewogICAgICAgICAgICAkUGFyYW17U2Vzc2lvbklEfSA9ICRQYXJhbXtTZXNzaW9uSURDb29raWV9OwogICAgICAgIH0KICAgIH0KCiAgICAkS2VybmVsOjpPTS0+T2JqZWN0UGFyYW1BZGQoCiAgICAgICAgJ0tlcm5lbDo6T3V0cHV0OjpIVE1MOjpMYXlvdXQnID0+IHsKICAgICAgICAgICAgTGFuZyAgICAgICAgID0+ICRQYXJhbXtMYW5nfSwKICAgICAgICAgICAgVXNlckxhbmd1YWdlID0+ICRQYXJhbXtMYW5nfSwKICAgICAgICB9LAogICAgICAgICdLZXJuZWw6Okxhbmd1YWdlJyA9PiB7CiAgICAgICAgICAgIFVzZXJMYW5ndWFnZSA9PiAkUGFyYW17TGFuZ30KICAgICAgICB9LAogICAgKTsKCiAgICBteSAkQ29va2llU2VjdXJlQXR0cmlidXRlOwogICAgaWYgKCAkQ29uZmlnT2JqZWN0LT5HZXQoJ0h0dHBUeXBlJykgZXEgJ2h0dHBzJyApIHsKCiAgICAgICAgIyBSZXN0cmljdCBDb29raWUgdG8gSFRUUFMgaWYgaXQgaXMgdXNlZC4KICAgICAgICAkQ29va2llU2VjdXJlQXR0cmlidXRlID0gMTsKICAgIH0KCiAgICBteSAkREJDYW5Db25uZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkRCJyktPkNvbm5lY3QoKTsKCiAgICBpZiAoICEkREJDYW5Db25uZWN0IHx8ICRQYXJhbU9iamVjdC0+RXJyb3IoKSApIHsKICAgICAgICBteSAkTGF5b3V0T2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpPdXRwdXQ6OkhUTUw6OkxheW91dCcpOwogICAgICAgIGlmICggISREQkNhbkNvbm5lY3QgKSB7CiAgICAgICAgICAgICRMYXlvdXRPYmplY3QtPkZhdGFsRXJyb3IoCiAgICAgICAgICAgICAgICBDb21tZW50ID0+IFRyYW5zbGF0YWJsZSgnUGxlYXNlIGNvbnRhY3QgdGhlIGFkbWluaXN0cmF0b3IuJyksCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCAkUGFyYW1PYmplY3QtPkVycm9yKCkgKSB7CiAgICAgICAgICAgICRMYXlvdXRPYmplY3QtPkZhdGFsRXJyb3IoCiAgICAgICAgICAgICAgICBNZXNzYWdlID0+ICRQYXJhbU9iamVjdC0+RXJyb3IoKSwKICAgICAgICAgICAgICAgIENvbW1lbnQgPT4gVHJhbnNsYXRhYmxlKCdQbGVhc2UgY29udGFjdCB0aGUgYWRtaW5pc3RyYXRvci4nKSwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KCiAgICAjIGdldCBjb21tb24gYXBwbGljYXRpb24gYW5kIGFkZC1vbiBhcHBsaWNhdGlvbiBwYXJhbXMKICAgIG15ICVDb21tb25PYmplY3RQYXJhbSA9ICV7ICRDb25maWdPYmplY3QtPkdldCgnRnJvbnRlbmQ6OkNvbW1vblBhcmFtJykgfTsKICAgIGZvciBteSAkS2V5ICggc29ydCBrZXlzICVDb21tb25PYmplY3RQYXJhbSApIHsKICAgICAgICAkUGFyYW17JEtleX0gPSAkUGFyYW1PYmplY3QtPkdldFBhcmFtKCBQYXJhbSA9PiAkS2V5ICkgfHwgJENvbW1vbk9iamVjdFBhcmFteyRLZXl9OwogICAgfQoKICAgICMgc2VjdXJpdHkgY2hlY2sgQWN0aW9uIFBhcmFtIChyZXBsYWNlIG5vbiB3b3JkIGNoYXJzKQogICAgJFBhcmFte0FjdGlvbn0gPX4gcy9cVy8vZzsKCiAgICBteSAkU2Vzc2lvbk9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpBdXRoU2Vzc2lvbicpOwogICAgbXkgJFVzZXJPYmplY3QgICAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VXNlcicpOwoKICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAjIFJTINGB0LvQuNGP0L3QuNC1IEpTT04KICAgICVQYXJhbSA9ICggJVBhcmFtLCAlSlNPTlBhcmFtICk7CgogICAgIyBSUyBtYXAgICAgCiAgICAkUGFyYW17QWN0aW9ufSAgICA9IHVjZmlyc3QgJFBhcmFte0FjdGlvbn07CiAgICAkUGFyYW17U3ViYWN0aW9ufSA9IHVjZmlyc3QgJFBhcmFte1N1YmFjdGlvbn07CgogICAgIyBSUyBMb2dpbiwgTG9nb3V0CgogICAgbXkgJElzTW9iaWxlID0gMDsKICAgIGlmICggJFBhcmFte0FjdGlvbn0gZXEgJ0F1dGgnICkgewogICAgICAgICRQYXJhbXtBY3Rpb259ID0gJFBhcmFte1N1YmFjdGlvbn07CiAgICAgICAgJElzTW9iaWxlID0gMTsKICAgIH0gZWxzZSB7CiAgICAgICAgJFBhcmFte0FjdGlvbn0gICAgPSAnQVBJOjonLiAkUGFyYW17QWN0aW9ufTsKICAgIH0KICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBpZiAoICRQYXJhbXtBY3Rpb259IGVxICdMb2dpbicgKSB7CgogICAgICAgICMgZ2V0IHBhcmFtcwogICAgICAgICMgUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBteSAkUG9zdFVzZXIgPSAkUGFyYW1PYmplY3QtPkdldFBhcmFtKCBQYXJhbSA9PiAnVXNlcicgKSB8fCAkUGFyYW17VXNlcn0gfHwgJyc7CiAgICAgICAgbXkgJFBvc3RQdyA9ICRQYXJhbU9iamVjdC0+R2V0UGFyYW0oCiAgICAgICAgICAgIFBhcmFtID0+ICdQYXNzd29yZCcsCiAgICAgICAgICAgIFJhdyAgID0+IDEKICAgICAgICApIHx8ICRQYXJhbXtQYXNzd29yZH0gfHwgJyc7CiAgICAgICAgbXkgJFBvc3RUd29GYWN0b3JUb2tlbiA9ICRQYXJhbU9iamVjdC0+R2V0UGFyYW0oCiAgICAgICAgICAgIFBhcmFtID0+ICdUd29GYWN0b3JUb2tlbicsCiAgICAgICAgICAgIFJhdyAgID0+IDEKICAgICAgICApIHx8ICRQYXJhbXtUd29GYWN0b3JUb2tlbn0gfHwgJyc7CiAgICAgICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgICAgICAjIGNyZWF0ZSBBdXRoT2JqZWN0CiAgICAgICAgbXkgJEF1dGhPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6QXV0aCcpOwoKICAgICAgICAjIGNoZWNrIHN1Ym1pdHRlZCBkYXRhCiAgICAgICAgbXkgJFVzZXIgPSAkQXV0aE9iamVjdC0+QXV0aCgKICAgICAgICAgICAgVXNlciAgICAgICAgICAgPT4gJFBvc3RVc2VyLAogICAgICAgICAgICBQdyAgICAgICAgICAgICA9PiAkUG9zdFB3LAogICAgICAgICAgICBUd29GYWN0b3JUb2tlbiA9PiAkUG9zdFR3b0ZhY3RvclRva2VuLAogICAgICAgICk7CgogICAgICAgICMgbG9naW4gaXMgaW52YWxpZAogICAgICAgIGlmICggISRVc2VyICkgewoKICAgICAgICAgICAgbXkgJEV4cGlyZXMgPSAnKycgLiAkQ29uZmlnT2JqZWN0LT5HZXQoJ1Nlc3Npb25NYXhUaW1lJykgLiAncyc7CiAgICAgICAgICAgIGlmICggISRDb25maWdPYmplY3QtPkdldCgnU2Vzc2lvblVzZUNvb2tpZUFmdGVyQnJvd3NlckNsb3NlJykgKSB7CiAgICAgICAgICAgICAgICAkRXhwaXJlcyA9ICcnOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkS2VybmVsOjpPTS0+T2JqZWN0UGFyYW1BZGQoCiAgICAgICAgICAgICAgICAnS2VybmVsOjpPdXRwdXQ6OkhUTUw6OkxheW91dCcgPT4gewogICAgICAgICAgICAgICAgICAgIFNldENvb2tpZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBPVFJTQnJvd3Nlckhhc0Nvb2tpZSA9PiAkUGFyYW1PYmplY3QtPlNldENvb2tpZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEtleSAgICAgID0+ICdPVFJTQnJvd3Nlckhhc0Nvb2tpZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZSAgICA9PiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgRXhwaXJlcyAgPT4gJEV4cGlyZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYXRoICAgICA9PiAkQ29uZmlnT2JqZWN0LT5HZXQoJ1NjcmlwdEFsaWFzJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZWN1cmUgICA9PiAkQ29va2llU2VjdXJlQXR0cmlidXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgSFRUUE9ubHkgPT4gMSwKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKICAgICAgICAgICAgbXkgJExheW91dE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6T3V0cHV0OjpIVE1MOjpMYXlvdXQnKTsKCiAgICAgICAgICAgICMgc2VuZCBKU09OIHJlc3BvbnNlCiAgICAgICAgICAgICMgUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgIHByaW50ICRTZWxmLT5QcmludEpTT05SZXNwb25zZSgKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgICAgICBNZXNzYWdlID0+ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+R2V0TG9nRW50cnkoCiAgICAgICAgICAgICAgICAgICAgVHlwZSA9PiAnSW5mbycsCiAgICAgICAgICAgICAgICAgICAgV2hhdCA9PiAnTWVzc2FnZScsCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHx8ICRMYXlvdXRPYmplY3QtPntMYW5ndWFnZU9iamVjdH0tPlRyYW5zbGF0ZSggJEF1dGhPYmplY3QtPkdldExhc3RFcnJvck1lc3NhZ2UoKSApCiAgICAgICAgICAgICAgICAgICAgfHwgVHJhbnNsYXRhYmxlKCdMb2dpbiBmYWlsZWQhIFlvdXIgdXNlciBuYW1lIG9yIHBhc3N3b3JkIHdhcyBlbnRlcmVkIGluY29ycmVjdGx5LicpCiAgICAgICAgICAgICk7CgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgfQoKICAgICAgICAjIGxvZ2luIGlzIHN1Y2Nlc3NmdWwKICAgICAgICBteSAlVXNlckRhdGEgPSAkVXNlck9iamVjdC0+R2V0VXNlckRhdGEoCiAgICAgICAgICAgIFVzZXIgICAgICAgICAgPT4gJFVzZXIsCiAgICAgICAgICAgIFZhbGlkICAgICAgICAgPT4gMSwKICAgICAgICAgICAgTm9PdXRPZk9mZmljZSA9PiAxLAogICAgICAgICk7CgogICAgICAgICMgY2hlY2sgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgY29va2llcwogICAgICAgIGlmICggJFBhcmFtT2JqZWN0LT5HZXRDb29raWUoIEtleSA9PiAnT1RSU0Jyb3dzZXJIYXNDb29raWUnICkgKSB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5PYmplY3RQYXJhbUFkZCgKICAgICAgICAgICAgICAgICdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0JyA9PiB7CiAgICAgICAgICAgICAgICAgICAgQnJvd3Nlckhhc0Nvb2tpZSA9PiAxLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgKTsKICAgICAgICB9CgogICAgICAgICMgY2hlY2sgbmVlZGVkIGRhdGEKICAgICAgICBpZiAoICEkVXNlckRhdGF7VXNlcklEfSB8fCAhJFVzZXJEYXRhe1VzZXJMb2dpbn0gKSB7CgogICAgICAgICAgICBteSAkTGF5b3V0T2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpPdXRwdXQ6OkhUTUw6OkxheW91dCcpOwoKICAgICAgICAgICAgIyBSUyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgcHJpbnQgJFNlbGYtPlByaW50SlNPTlJlc3BvbnNlKAogICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgPT4gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5HZXRMb2dFbnRyeSgKICAgICAgICAgICAgICAgICAgICBUeXBlID0+ICdJbmZvJywKICAgICAgICAgICAgICAgICAgICBXaGF0ID0+ICdNZXNzYWdlJywKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgfHwgJExheW91dE9iamVjdC0+e0xhbmd1YWdlT2JqZWN0fS0+VHJhbnNsYXRlKCAkQXV0aE9iamVjdC0+R2V0TGFzdEVycm9yTWVzc2FnZSgpICkKICAgICAgICAgICAgICAgICAgICB8fCBUcmFuc2xhdGFibGUoJ0xvZ2luIGZhaWxlZCEgWW91ciB1c2VyIG5hbWUgb3IgcGFzc3dvcmQgd2FzIGVudGVyZWQgaW5jb3JyZWN0bHkuJykKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICAgICAgfQoKICAgICAgICBteSAkRGF0ZVRpbWVPYmogPSAkS2VybmVsOjpPTS0+Q3JlYXRlKCdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnKTsKCiAgICAgICAgIyBjcmVhdGUgbmV3IHNlc3Npb24gaWQKICAgICAgICBteSAkTmV3U2Vzc2lvbklEID0gJFNlc3Npb25PYmplY3QtPkNyZWF0ZVNlc3Npb25JRCgKICAgICAgICAgICAgJVVzZXJEYXRhLAogICAgICAgICAgICBVc2VyTGFzdFJlcXVlc3QgPT4gJERhdGVUaW1lT2JqLT5Ub0Vwb2NoKCksCiAgICAgICAgICAgIFVzZXJUeXBlICAgICAgICA9PiAnVXNlcicsCiAgICAgICAgICAgIFNlc3Npb25Tb3VyY2UgICA9PiAnQWdlbnRJbnRlcmZhY2UnLAogICAgICAgICk7CgogICAgICAgICMgVE9ETzogYWRkIGFkZGl0aW9uYWwgbG9nIGVudHJpZXMgZm9yIGludGVybmFsIHB1cnBvc2Ugb25seQoKICAgICAgICAjIHNob3cgZXJyb3IgbWVzc2FnZSBpZiBubyBzZXNzaW9uIGlkIGhhcyBiZWVuIGNyZWF0ZWQKICAgICAgICBpZiAoICEkTmV3U2Vzc2lvbklEICkgewoKICAgICAgICAgICAgIyBnZXQgZXJyb3IgbWVzc2FnZQogICAgICAgICAgICBteSAkRXJyb3IgPSAkU2Vzc2lvbk9iamVjdC0+U2Vzc2lvbklERXJyb3JNZXNzYWdlKCkgfHwgJyc7CgogICAgICAgICAgICAjIG91dHB1dCBlcnJvciBtZXNzYWdlCiAgICAgICAgICAgIG15ICRMYXlvdXRPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0Jyk7CgogICAgICAgICAgICAjIFJTIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICAgICBwcmludCAkU2VsZi0+UHJpbnRKU09OUmVzcG9uc2UoCiAgICAgICAgICAgICAgICBSZXNwb25zZSA9PiAnRVJST1InLAogICAgICAgICAgICAgICAgTWVzc2FnZSA9PiAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkdldExvZ0VudHJ5KAogICAgICAgICAgICAgICAgICAgIFR5cGUgPT4gJ0luZm8nLAogICAgICAgICAgICAgICAgICAgIFdoYXQgPT4gJ01lc3NhZ2UnLAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICB8fCAkTGF5b3V0T2JqZWN0LT57TGFuZ3VhZ2VPYmplY3R9LT5UcmFuc2xhdGUoICRBdXRoT2JqZWN0LT5HZXRMYXN0RXJyb3JNZXNzYWdlKCkgKQogICAgICAgICAgICAgICAgICAgIHx8IFRyYW5zbGF0YWJsZSgnTG9naW4gZmFpbGVkISBZb3VyIHVzZXIgbmFtZSBvciBwYXNzd29yZCB3YXMgZW50ZXJlZCBpbmNvcnJlY3RseS4nKQogICAgICAgICAgICApOwoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIH0KCiAgICAgICAgIyBleGVjdXRpb24gaW4gMjAgc2Vjb25kcwogICAgICAgIG15ICRFeGVjdXRpb25UaW1lT2JqID0gJERhdGVUaW1lT2JqLT5DbG9uZSgpOwogICAgICAgICRFeGVjdXRpb25UaW1lT2JqLT5BZGQoIFNlY29uZHMgPT4gMjAgKTsKICAgICAgICBteSAkRXhlY3V0aW9uVGltZSA9ICRFeGVjdXRpb25UaW1lT2JqLT5Ub1N0cmluZygpOwoKICAgICAgICAjIGFkZCBhIGFzeWNocm9ub3VzIGV4ZWN1dG9yIHNjaGVkdWxlciB0YXNrIHRvIGNvdW50IHRoZSBjb25jdXJyZW50IHVzZXIKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U2NoZWR1bGVyJyktPlRhc2tBZGQoCiAgICAgICAgICAgIEV4ZWN1dGlvblRpbWUgICAgICAgICAgICA9PiAkRXhlY3V0aW9uVGltZSwKICAgICAgICAgICAgVHlwZSAgICAgICAgICAgICAgICAgICAgID0+ICdBc3luY2hyb25vdXNFeGVjdXRvcicsCiAgICAgICAgICAgIE5hbWUgICAgICAgICAgICAgICAgICAgICA9PiAnUGx1Z2luQXN5bmNocm9ub3VzOjpDb25jdXJyZW50VXNlcicsCiAgICAgICAgICAgIE1heGltdW1QYXJhbGxlbEluc3RhbmNlcyA9PiAxLAogICAgICAgICAgICBEYXRhICAgICAgICAgICAgICAgICAgICAgPT4gewogICAgICAgICAgICAgICAgT2JqZWN0ICAgPT4gJ0tlcm5lbDo6U3lzdGVtOjpTdXBwb3J0RGF0YUNvbGxlY3Rvcjo6UGx1Z2luQXN5bmNocm9ub3VzOjpPVFJTOjpDb25jdXJyZW50VXNlcnMnLAogICAgICAgICAgICAgICAgRnVuY3Rpb24gPT4gJ1J1bkFzeW5jaHJvbm91cycsCiAgICAgICAgICAgIH0sCiAgICAgICAgKTsKCiAgICAgICAgbXkgJFVzZXJUaW1lWm9uZSA9ICRTZWxmLT5fVXNlclRpbWVab25lR2V0KCVVc2VyRGF0YSk7CgogICAgICAgICRTZXNzaW9uT2JqZWN0LT5VcGRhdGVTZXNzaW9uSUQoCiAgICAgICAgICAgIFNlc3Npb25JRCA9PiAkTmV3U2Vzc2lvbklELAogICAgICAgICAgICBLZXkgICAgICAgPT4gJ1VzZXJUaW1lWm9uZScsCiAgICAgICAgICAgIFZhbHVlICAgICA9PiAkVXNlclRpbWVab25lLAogICAgICAgICk7CgogICAgICAgICMgY2hlY2sgaWYgdGhlIHRpbWUgem9uZSBvZmZzZXQgcmVwb3J0ZWQgYnkgdGhlIHVzZXIncyBicm93c2VyIGRpZmZlcnMgZnJvbSB0aGF0CiAgICAgICAgIyBvZiB0aGUgT1RSUyB1c2VyJ3MgdGltZSB6b25lIG9mZnNldAogICAgICAgIG15ICREYXRlVGltZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5DcmVhdGUoCiAgICAgICAgICAgICdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnLAogICAgICAgICAgICBPYmplY3RQYXJhbXMgPT4gewogICAgICAgICAgICAgICAgVGltZVpvbmUgPT4gJFVzZXJUaW1lWm9uZSwKICAgICAgICAgICAgfSwKICAgICAgICApOwogICAgICAgIG15ICRPVFJTVXNlclRpbWVab25lT2Zmc2V0ID0gJERhdGVUaW1lT2JqZWN0LT5Gb3JtYXQoIEZvcm1hdCA9PiAnJXtvZmZzZXR9JyApIC8gNjA7CiAgICAgICAgbXkgJEJyb3dzZXJUaW1lWm9uZU9mZnNldCA9ICggJFBhcmFtT2JqZWN0LT5HZXRQYXJhbSggUGFyYW0gPT4gJ1RpbWVab25lT2Zmc2V0JyApIHx8IDAgKSAqIC0xOwoKICAgICAgICAjIFRpbWVab25lT2Zmc2V0RGlmZmVyZW5jZSBjb250YWlucyB0aGUgZGlmZmVyZW5jZSBvZiB0aGUgdGltZSB6b25lIG9mZnNldCBiZXR3ZWVuCiAgICAgICAgIyB0aGUgdXNlcidzIE9UUlMgdGltZSB6b25lIHNldHRpbmcgYW5kIHRoZSBvbmUgcmVwb3J0ZWQgYnkgdGhlIHVzZXIncyBicm93c2VyLgogICAgICAgICMgSWYgdGhlcmUgaXMgYSBkaWZmZXJlbmNlIGl0IGNhbiBiZSBldmFsdWF0ZWQgbGF0ZXIgdG8gZS4gZy4gc2hvdyBhIG1lc3NhZ2UKICAgICAgICAjIGZvciB0aGUgdXNlciB0byBjaGVjayBoaXMgT1RSUyB0aW1lIHpvbmUgc2V0dGluZy4KICAgICAgICBteSAkVXNlclRpbWVab25lT2Zmc2V0RGlmZmVyZW5jZSA9IGFicyggJE9UUlNVc2VyVGltZVpvbmVPZmZzZXQgLSAkQnJvd3NlclRpbWVab25lT2Zmc2V0ICk7CiAgICAgICAgJFNlc3Npb25PYmplY3QtPlVwZGF0ZVNlc3Npb25JRCgKICAgICAgICAgICAgU2Vzc2lvbklEID0+ICROZXdTZXNzaW9uSUQsCiAgICAgICAgICAgIEtleSAgICAgICA9PiAnVXNlclRpbWVab25lT2Zmc2V0RGlmZmVyZW5jZScsCiAgICAgICAgICAgIFZhbHVlICAgICA9PiAkVXNlclRpbWVab25lT2Zmc2V0RGlmZmVyZW5jZSwKICAgICAgICApOwoKICAgICAgICAjIGNyZWF0ZSBhIG5ldyBMYXlvdXRPYmplY3Qgd2l0aCBTZXNzaW9uSURDb29raWUKICAgICAgICBteSAkRXhwaXJlcyA9ICcrJyAuICRDb25maWdPYmplY3QtPkdldCgnU2Vzc2lvbk1heFRpbWUnKSAuICdzJzsKICAgICAgICBpZiAoICEkQ29uZmlnT2JqZWN0LT5HZXQoJ1Nlc3Npb25Vc2VDb29raWVBZnRlckJyb3dzZXJDbG9zZScpICkgewogICAgICAgICAgICAkRXhwaXJlcyA9ICcnOwogICAgICAgIH0KCiAgICAgICAgbXkgJFNlY3VyZUF0dHJpYnV0ZTsKICAgICAgICBpZiAoICRDb25maWdPYmplY3QtPkdldCgnSHR0cFR5cGUnKSBlcSAnaHR0cHMnICkgewoKICAgICAgICAgICAgIyBSZXN0cmljdCBDb29raWUgdG8gSFRUUFMgaWYgaXQgaXMgdXNlZC4KICAgICAgICAgICAgJFNlY3VyZUF0dHJpYnV0ZSA9IDE7CiAgICAgICAgfQoKICAgICAgICAkS2VybmVsOjpPTS0+T2JqZWN0UGFyYW1BZGQoCiAgICAgICAgICAgICdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0JyA9PiB7CiAgICAgICAgICAgICAgICBTZXRDb29raWVzID0+IHsKICAgICAgICAgICAgICAgICAgICBTZXNzaW9uSURDb29raWUgPT4gJFBhcmFtT2JqZWN0LT5TZXRDb29raWUoCiAgICAgICAgICAgICAgICAgICAgICAgIEtleSAgICAgID0+ICRQYXJhbXtTZXNzaW9uTmFtZX0sCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlICAgID0+ICROZXdTZXNzaW9uSUQsCiAgICAgICAgICAgICAgICAgICAgICAgIEV4cGlyZXMgID0+ICRFeHBpcmVzLAogICAgICAgICAgICAgICAgICAgICAgICBQYXRoICAgICA9PiAkQ29uZmlnT2JqZWN0LT5HZXQoJ1NjcmlwdEFsaWFzJyksCiAgICAgICAgICAgICAgICAgICAgICAgIFNlY3VyZSAgID0+IHNjYWxhciAkQ29va2llU2VjdXJlQXR0cmlidXRlLAogICAgICAgICAgICAgICAgICAgICAgICBIVFRQT25seSA9PiAxLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgT1RSU0Jyb3dzZXJIYXNDb29raWUgPT4gJFBhcmFtT2JqZWN0LT5TZXRDb29raWUoCiAgICAgICAgICAgICAgICAgICAgICAgIEtleSAgICAgID0+ICdPVFJTQnJvd3Nlckhhc0Nvb2tpZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlICAgID0+ICcnLAogICAgICAgICAgICAgICAgICAgICAgICBFeHBpcmVzICA9PiAnLTF5JywKICAgICAgICAgICAgICAgICAgICAgICAgUGF0aCAgICAgPT4gJENvbmZpZ09iamVjdC0+R2V0KCdTY3JpcHRBbGlhcycpLAogICAgICAgICAgICAgICAgICAgICAgICBTZWN1cmUgICA9PiAkQ29va2llU2VjdXJlQXR0cmlidXRlLAogICAgICAgICAgICAgICAgICAgICAgICBIVFRQT25seSA9PiAxLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgU2Vzc2lvbklEICAgPT4gJE5ld1Nlc3Npb25JRCwKICAgICAgICAgICAgICAgIFNlc3Npb25OYW1lID0+ICRQYXJhbXtTZXNzaW9uTmFtZX0sCiAgICAgICAgICAgIH0sCiAgICAgICAgKTsKCiAgICAgICAgIyBDaGVjayBpZiBDaGF0IGlzIGFjdGl2ZQogICAgICAgIGlmICggJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpDb25maWcnKS0+R2V0KCdDaGF0RW5naW5lOjpBY3RpdmUnKSApIHsKICAgICAgICAgICAgbXkgJENoYXRSZWNlaXZpbmdBZ2VudHNHcm91cAogICAgICAgICAgICAgICAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ0NoYXRFbmdpbmU6OlBlcm1pc3Npb25Hcm91cDo6Q2hhdFJlY2VpdmluZ0FnZW50cycpOwoKICAgICAgICAgICAgbXkgJENoYXRSZWNlaXZpbmdBZ2VudHNHcm91cFBlcm1pc3Npb24gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6R3JvdXAnKS0+UGVybWlzc2lvbkNoZWNrKAogICAgICAgICAgICAgICAgVXNlcklEICAgID0+ICRVc2VyRGF0YXtVc2VySUR9LAogICAgICAgICAgICAgICAgR3JvdXBOYW1lID0+ICRDaGF0UmVjZWl2aW5nQWdlbnRzR3JvdXAsCiAgICAgICAgICAgICAgICBUeXBlICAgICAgPT4gJ3J3JywKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICRVc2VyRGF0YXtVc2VySUR9ICE9IC0xCiAgICAgICAgICAgICAgICAmJiAkQ2hhdFJlY2VpdmluZ0FnZW50c0dyb3VwCiAgICAgICAgICAgICAgICAmJiAkQ2hhdFJlY2VpdmluZ0FnZW50c0dyb3VwUGVybWlzc2lvbgogICAgICAgICAgICAgICAgJiYgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpDb25maWcnKS0+R2V0KCdUaWNrZXQ6OkFnZW50OjpVbmF2YWlsYWJsZUZvckV4dGVybmFsQ2hhdHNPbkxvZ2luJykKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIyBHZXQgdXNlciBwcmVmZXJlbmNlcwogICAgICAgICAgICAgICAgbXkgJVByZWZlcmVuY2VzID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlVzZXInKS0+R2V0UHJlZmVyZW5jZXMoCiAgICAgICAgICAgICAgICAgICAgVXNlcklEID0+ICRVc2VyRGF0YXtVc2VySUR9LAogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICBpZiAoICRQcmVmZXJlbmNlc3tDaGF0QXZhaWxhYmlsaXR5fSAmJiAkUHJlZmVyZW5jZXN7Q2hhdEF2YWlsYWJpbGl0eX0gPT0gMiApIHsKCiAgICAgICAgICAgICAgICAgICAgIyBVc2VyIGlzIGF2YWlsYWJsZSBmb3IgZXh0ZXJuYWwgY2hhdHMuIFNldCBoaXMgYXZhaWxhYmlsaXR5IHRvIGludGVybmFsIG9ubHkuCiAgICAgICAgICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlVzZXInKS0+U2V0UHJlZmVyZW5jZXMoCiAgICAgICAgICAgICAgICAgICAgICAgIEtleSAgICA9PiAnQ2hhdEF2YWlsYWJpbGl0eScsCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlICA9PiAnMScsCiAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJJRCA9PiAkVXNlckRhdGF7VXNlcklEfSwKICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICAjIFNldCBDaGF0QXZhaWxhYmlsaXR5Tm90aWZpY2F0aW9uIHRvIGRpc3BsYXkgbm90aWZpY2F0aW9uIGluIGFnZW50IGludGVyZmFjZSAob25seSBvbmNlKQogICAgICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpVc2VyJyktPlNldFByZWZlcmVuY2VzKAogICAgICAgICAgICAgICAgICAgICAgICBLZXkgICAgPT4gJ0NoYXRBdmFpbGFiaWxpdHlOb3RpZmljYXRpb24nLAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZSAgPT4gJzEnLAogICAgICAgICAgICAgICAgICAgICAgICBVc2VySUQgPT4gJFVzZXJEYXRhe1VzZXJJRH0sCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyByZWRpcmVjdCB3aXRoIG5ldyBzZXNzaW9uIGlkIGFuZCBvbGQgcGFyYW1zCiAgICAgICAgIyBwcmVwYXJlIG9sZCByZWRpcmVjdCBVUkwgLS0gZG8gbm90IHJlZGlyZWN0IHRvIExvZ2luIG9yIExvZ291dCAobG9vcCkhCiAgICAgICAgaWYgKCAkUGFyYW17UmVxdWVzdGVkVVJMfSA9fiAvQWN0aW9uPShMb2dvdXR8TG9naW58TG9zdFBhc3N3b3JkfFByZUxvZ2luKS8gKSB7CiAgICAgICAgICAgICRQYXJhbXtSZXF1ZXN0ZWRVUkx9ID0gJyc7CiAgICAgICAgfQoKICAgICAgICAjIFJTCiAgICAgICAgJVVzZXJEYXRhID0gJFNlc3Npb25PYmplY3QtPkdldFNlc3Npb25JRERhdGEoCiAgICAgICAgICAgIFNlc3Npb25JRCA9PiAkTmV3U2Vzc2lvbklECiAgICAgICAgKTsKCiAgICAgICAgIyBSUyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICBwcmludCAkU2VsZi0+UHJpbnRKU09OUmVzcG9uc2UoCiAgICAgICAgICAgIFJlc3BvbnNlICAgICAgICAgICAgPT4gJ09LJywKICAgICAgICAgICAgTWVzc2FnZSAgICAgICAgICAgICA9PiAnU3VjY2Vzc2Z1bCBsb2dpbicsCiAgICAgICAgICAgIFNlc3Npb25OYW1lICAgICAgICAgPT4gJFBhcmFte1Nlc3Npb25OYW1lfSwKICAgICAgICAgICAgU2Vzc2lvblZhbHVlICAgICAgICA9PiAkTmV3U2Vzc2lvbklELAogICAgICAgICAgICBDaGFsbGVuZ2VUb2tlbiAgICAgID0+ICRVc2VyRGF0YXsgVXNlckNoYWxsZW5nZVRva2VuIH0sCiAgICAgICAgICAgIE1lID0+IHsKICAgICAgICAgICAgICAgIFVzZXJMb2dpbiA9PiAkVXNlckRhdGF7IFVzZXJMb2dpbiB9LAogICAgICAgICAgICAgICAgRW1haWwgICAgID0+ICRVc2VyRGF0YXsgVXNlckVtYWlsIH0sCiAgICAgICAgICAgICAgICBGaXJzdE5hbWUgPT4gJFVzZXJEYXRheyBVc2VyRmlyc3RuYW1lIH0sCiAgICAgICAgICAgICAgICBMYXN0TmFtZSAgPT4gJFVzZXJEYXRheyBVc2VyTGFzdG5hbWUgfSwKICAgICAgICAgICAgICAgIEZ1bGxOYW1lICA9PiAkVXNlckRhdGF7IFVzZXJGdWxsbmFtZSB9LAogICAgICAgICAgICAgICAgSUQgICAgICAgID0+ICRVc2VyRGF0YXsgVXNlcklEIH0sCiAgICAgICAgICAgICAgICBBdmF0YXIgICAgPT4gImh0dHBzOi8vd3d3LnNoYXJlaWNvbi5uZXQvZGF0YS8xMjh4MTI4LzIwMTUvMDkvMTgvMTAzMTYwX21hbl81MTJ4NTEyLnBuZyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgU2V0dGluZ3MgPT4gewogICAgICAgICAgICAgICAgTGFuZ3VhZ2UgPT4gJFVzZXJEYXRheyBVc2VyTGFuZ3VhZ2UgfSAvLyAnZW4nCiAgICAgICAgICAgIH0KICAgICAgICApOwoKICAgICAgICByZXR1cm47CiAgICAgICAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIH0KCiAgICAjIGxvZ291dAogICAgZWxzaWYgKCAkUGFyYW17QWN0aW9ufSBlcSAnTG9nb3V0JyApIHsKCiAgICAgICAgbXkgJExheW91dE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6T3V0cHV0OjpIVE1MOjpMYXlvdXQnKTsKCiAgICAgICAgIyBjaGVjayBzZXNzaW9uIGlkCiAgICAgICAgaWYgKCAhJFNlc3Npb25PYmplY3QtPkNoZWNrU2Vzc2lvbklEKCBTZXNzaW9uSUQgPT4gJFBhcmFte1Nlc3Npb25JRH0gKSApIHsKCiAgICAgICAgICAgICMgUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgIHByaW50ICRTZWxmLT5QcmludEpTT05SZXNwb25zZSgKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnU2Vzc2lvbiBpbnZhbGlkLiBQbGVhc2UgbG9nIGluIGFnYWluLicKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICB9CgogICAgICAgICMgZ2V0IHNlc3Npb24gZGF0YQogICAgICAgIG15ICVVc2VyRGF0YSA9ICRTZXNzaW9uT2JqZWN0LT5HZXRTZXNzaW9uSUREYXRhKAogICAgICAgICAgICBTZXNzaW9uSUQgPT4gJFBhcmFte1Nlc3Npb25JRH0sCiAgICAgICAgKTsKCiAgICAgICAgJFVzZXJEYXRhe1VzZXJUaW1lWm9uZX0gPSAkU2VsZi0+X1VzZXJUaW1lWm9uZUdldCglVXNlckRhdGEpOwoKICAgICAgICAjIGNyZWF0ZSBhIG5ldyBMYXlvdXRPYmplY3Qgd2l0aCAlVXNlckRhdGEKICAgICAgICAkS2VybmVsOjpPTS0+T2JqZWN0UGFyYW1BZGQoCiAgICAgICAgICAgICdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0JyA9PiB7CiAgICAgICAgICAgICAgICBTZXRDb29raWVzID0+IHsKICAgICAgICAgICAgICAgICAgICBTZXNzaW9uSURDb29raWUgPT4gJFBhcmFtT2JqZWN0LT5TZXRDb29raWUoCiAgICAgICAgICAgICAgICAgICAgICAgIEtleSAgICAgID0+ICRQYXJhbXtTZXNzaW9uTmFtZX0sCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlICAgID0+ICcnLAogICAgICAgICAgICAgICAgICAgICAgICBFeHBpcmVzICA9PiAnLTF5JywKICAgICAgICAgICAgICAgICAgICAgICAgUGF0aCAgICAgPT4gJENvbmZpZ09iamVjdC0+R2V0KCdTY3JpcHRBbGlhcycpLAogICAgICAgICAgICAgICAgICAgICAgICBTZWN1cmUgICA9PiBzY2FsYXIgJENvb2tpZVNlY3VyZUF0dHJpYnV0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgSFRUUE9ubHkgPT4gMSwKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICVVc2VyRGF0YSwKICAgICAgICAgICAgfSwKICAgICAgICApOwogICAgICAgICRLZXJuZWw6Ok9NLT5PYmplY3RzRGlzY2FyZCggT2JqZWN0cyA9PiBbJ0tlcm5lbDo6T3V0cHV0OjpIVE1MOjpMYXlvdXQnXSApOwogICAgICAgICRMYXlvdXRPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0Jyk7CgogICAgICAgICMgUlMKICAgICAgICAjIFByZXZlbnQgQ1NSRiBhdHRhY2tzCiAgICAgICAgIyRMYXlvdXRPYmplY3QtPkNoYWxsZW5nZVRva2VuQ2hlY2soKTsKICAgICAgICBteSAkVG9rZW5DaGVja1Jlc3VsdCA9ICRMYXlvdXRPYmplY3QtPkNoYWxsZW5nZVRva2VuQ2hlY2soCiAgICAgICAgICAgIFNpbGVudCAgICAgICAgID0+ICRJc01vYmlsZSwKICAgICAgICAgICAgQ2hhbGxlbmdlVG9rZW4gPT4gJFBhcmFte0NoYWxsZW5nZVRva2VufSAKICAgICAgICApOwoKICAgICAgICBpZiAoICEkVG9rZW5DaGVja1Jlc3VsdCApIHsKCiAgICAgICAgICAgICMgUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgIHByaW50ICRTZWxmLT5QcmludEpTT05SZXNwb25zZSgKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnSW52YWxpZCBDaGFsbGVuZ2UgVG9rZW4hJwogICAgICAgICAgICApOwoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIH0KCiAgICAgICAgIyByZW1vdmUgc2Vzc2lvbiBpZAogICAgICAgIGlmICggISRTZXNzaW9uT2JqZWN0LT5SZW1vdmVTZXNzaW9uSUQoIFNlc3Npb25JRCA9PiAkUGFyYW17U2Vzc2lvbklEfSApICkgewoKICAgICAgICAgICAgIyBSUyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgcHJpbnQgJFNlbGYtPlByaW50SlNPTlJlc3BvbnNlKAogICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gJ0VSUk9SJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdDYW5gdCByZW1vdmUgU2Vzc2lvbklELicKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICB9CgogICAgICAgICMgUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgbXkgJEFQSVV0aWxPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6QVBJOjpVdGlsJyk7CgogICAgICAgIGlmICggJEFQSVV0aWxPYmplY3QtPklzTW9iaWxlUGFja2FnZUluc3RhbGxlZCApIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkRCJyktPkRvKAogICAgICAgICAgICAgICAgU1FMICA9PiAnREVMRVRFIEZST00gUlNfdXNlcl9wdXNoX3Rva2VuIFdIRVJFIHVzZXJfaWQgPSA/JywKICAgICAgICAgICAgICAgIEJpbmQgPT4gWyBcJFVzZXJEYXRhe1VzZXJJRH0gXQogICAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgcHJpbnQgJFNlbGYtPlByaW50SlNPTlJlc3BvbnNlKAogICAgICAgICAgICBSZXNwb25zZSA9PiAnT0snLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTG9nb3V0IHN1Y2Nlc3NmdWwuJywKICAgICAgICApOyAgIAoKICAgICAgICByZXR1cm47CiAgICAgICAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIH0KCiAgICAjIHVzZXIgbG9zdCBwYXNzd29yZAogICAgZWxzaWYgKCAkUGFyYW17QWN0aW9ufSBlcSAnTG9zdFBhc3N3b3JkJyApIHsKCiAgICAgICAgbXkgJExheW91dE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6T3V0cHV0OjpIVE1MOjpMYXlvdXQnKTsKCiAgICAgICAgIyBjaGVjayBmZWF0dXJlCiAgICAgICAgaWYgKCAhJENvbmZpZ09iamVjdC0+R2V0KCdMb3N0UGFzc3dvcmQnKSApIHsKCiAgICAgICAgICAgICMgUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgIHByaW50ICRTZWxmLT5QcmludEpTT05SZXNwb25zZSgKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICdFUlJPUicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnRmVhdHVyZSBub3QgYWN0aXZlLicsCiAgICAgICAgICAgICk7ICAKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICB9CgogICAgICAgICMgZ2V0IHBhcmFtcwogICAgICAgIG15ICRVc2VyICA9ICRQYXJhbU9iamVjdC0+R2V0UGFyYW0oIFBhcmFtID0+ICdVc2VyJyApICB8fCAnJzsKICAgICAgICBteSAkVG9rZW4gPSAkUGFyYW1PYmplY3QtPkdldFBhcmFtKCBQYXJhbSA9PiAnVG9rZW4nICkgfHwgJyc7CgogICAgICAgICMgZ2V0IHVzZXIgbG9naW4gYnkgdG9rZW4KICAgICAgICBpZiAoICEkVXNlciAmJiAkVG9rZW4gKSB7CiAgICAgICAgICAgIG15ICVVc2VyTGlzdCA9ICRVc2VyT2JqZWN0LT5TZWFyY2hQcmVmZXJlbmNlcygKICAgICAgICAgICAgICAgIEtleSAgID0+ICdVc2VyVG9rZW4nLAogICAgICAgICAgICAgICAgVmFsdWUgPT4gJFRva2VuLAogICAgICAgICAgICApOwogICAgICAgICAgICBVU0VSUzoKICAgICAgICAgICAgZm9yIG15ICRVc2VySUQgKCBzb3J0IGtleXMgJVVzZXJMaXN0ICkgewogICAgICAgICAgICAgICAgbXkgJVVzZXJEYXRhID0gJFVzZXJPYmplY3QtPkdldFVzZXJEYXRhKAogICAgICAgICAgICAgICAgICAgIFVzZXJJRCA9PiAkVXNlcklELAogICAgICAgICAgICAgICAgICAgIFZhbGlkICA9PiAxLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGlmICglVXNlckRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAkVXNlciA9ICRVc2VyRGF0YXtVc2VyTG9naW59OwogICAgICAgICAgICAgICAgICAgIGxhc3QgVVNFUlM7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgZ2V0IHVzZXIgZGF0YQogICAgICAgIG15ICVVc2VyRGF0YSA9ICRVc2VyT2JqZWN0LT5HZXRVc2VyRGF0YSgKICAgICAgICAgICAgVXNlciAgPT4gJFVzZXIsCiAgICAgICAgICAgIFZhbGlkID0+IDEKICAgICAgICApOwoKICAgICAgICAjIHZlcmlmeSB1c2VyIGlzIHZhbGlkIHdoZW4gcmVxdWVzdGluZyBwYXNzd29yZCByZXNldAogICAgICAgIG15IEBWYWxpZElEcyA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpWYWxpZCcpLT5WYWxpZElEc0dldCgpOwogICAgICAgIG15ICRVc2VySXNWYWxpZCA9IGdyZXAgeyAkVXNlckRhdGF7VmFsaWRJRH0gJiYgJFVzZXJEYXRhe1ZhbGlkSUR9ID09ICRfIH0gQFZhbGlkSURzOwogICAgICAgIGlmICggISRVc2VyRGF0YXtVc2VySUR9IHx8ICEkVXNlcklzVmFsaWQgKSB7CgogICAgICAgICAgICAjIFNlY3VyaXR5OiBwcmV0ZW5kIHRoYXQgcGFzc3dvcmQgcmVzZXQgaW5zdHJ1Y3Rpb25zIHdlcmUgYWN0dWFsbHkgc2VudCB0bwogICAgICAgICAgICAjICAgbWFrZSBzdXJlIHRoYXQgdXNlcnMgY2Fubm90IGZpbmQgb3V0IHZhbGlkIHVzZXJuYW1lcyBieQogICAgICAgICAgICAjICAganVzdCB0cnlpbmcgYW5kIGNoZWNraW5nIHRoZSByZXN1bHQgbWVzc2FnZS4KICAgICAgICAgICAgCiAgICAgICAgICAgICMgUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgIHByaW50ICRTZWxmLT5QcmludEpTT05SZXNwb25zZSgKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICdPSycsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnU2VudCBwYXNzd29yZCByZXNldCBpbnN0cnVjdGlvbnMuIFBsZWFzZSBjaGVjayB5b3VyIGVtYWlsLicKICAgICAgICAgICAgKTsgICAKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgfQoKICAgICAgICAjIGNyZWF0ZSBlbWFpbCBvYmplY3QKICAgICAgICBteSAkRW1haWxPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6RW1haWwnKTsKCiAgICAgICAgIyBzZW5kIHBhc3N3b3JkIHJlc2V0IHRva2VuCiAgICAgICAgaWYgKCAhJFRva2VuICkgewoKICAgICAgICAgICAgIyBnZW5lcmF0ZSB0b2tlbgogICAgICAgICAgICAkVXNlckRhdGF7VG9rZW59ID0gJFVzZXJPYmplY3QtPlRva2VuR2VuZXJhdGUoCiAgICAgICAgICAgICAgICBVc2VySUQgPT4gJFVzZXJEYXRhe1VzZXJJRH0sCiAgICAgICAgICAgICk7CgogICAgICAgICAgICAjIHNlbmQgdG9rZW4gbm90aWZ5IGVtYWlsIHdpdGggbGluawogICAgICAgICAgICBteSAkQm9keSA9ICRDb25maWdPYmplY3QtPkdldCgnTm90aWZpY2F0aW9uQm9keUxvc3RQYXNzd29yZFRva2VuJykKICAgICAgICAgICAgICAgIHx8ICdFUlJPUjogTm90aWZpY2F0aW9uQm9keUxvc3RQYXNzd29yZFRva2VuIGlzIG1pc3NpbmchJzsKICAgICAgICAgICAgbXkgJFN1YmplY3QgPSAkQ29uZmlnT2JqZWN0LT5HZXQoJ05vdGlmaWNhdGlvblN1YmplY3RMb3N0UGFzc3dvcmRUb2tlbicpCiAgICAgICAgICAgICAgICB8fCAnRVJST1I6IE5vdGlmaWNhdGlvblN1YmplY3RMb3N0UGFzc3dvcmRUb2tlbiBpcyBtaXNzaW5nISc7CiAgICAgICAgICAgIGZvciAoIHNvcnQga2V5cyAlVXNlckRhdGEgKSB7CiAgICAgICAgICAgICAgICAkQm9keSA9fiBzLzxPVFJTXyRfPi8kVXNlckRhdGF7JF99L2dpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBteSAkU2VudCA9ICRFbWFpbE9iamVjdC0+U2VuZCgKICAgICAgICAgICAgICAgIFRvICAgICAgID0+ICRVc2VyRGF0YXtVc2VyRW1haWx9LAogICAgICAgICAgICAgICAgU3ViamVjdCAgPT4gJFN1YmplY3QsCiAgICAgICAgICAgICAgICBDaGFyc2V0ICA9PiAkTGF5b3V0T2JqZWN0LT57VXNlckNoYXJzZXR9LAogICAgICAgICAgICAgICAgTWltZVR5cGUgPT4gJ3RleHQvcGxhaW4nLAogICAgICAgICAgICAgICAgQm9keSAgICAgPT4gJEJvZHkKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmICggISRTZW50LT57U3VjY2Vzc30gKSB7CgogICAgICAgICAgICAgICAgIyBSUyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgICAgICBwcmludCAkU2VsZi0+UHJpbnRKU09OUmVzcG9uc2UoCiAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnUGxlYXNlIGNvbnRhY3QgdGhlIGFkbWluaXN0cmF0b3IuJwogICAgICAgICAgICAgICAgKTsgICAKCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBSUyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICAgICBwcmludCAkU2VsZi0+UHJpbnRKU09OUmVzcG9uc2UoCiAgICAgICAgICAgICAgICBSZXNwb25zZSAgPT4gIk9LIiwKICAgICAgICAgICAgICAgIE1lc3NhZ2UgICA9PiAnU2VudCBwYXNzd29yZCByZXNldCBpbnN0cnVjdGlvbnMuIFBsZWFzZSBjaGVjayB5b3VyIGVtYWlsLicKICAgICAgICAgICAgKTsgICAKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIH0KCiAgICAgICAgIyByZXNldCBwYXNzd29yZAogICAgICAgICMgY2hlY2sgaWYgdG9rZW4gaXMgdmFsaWQKICAgICAgICBteSAkVG9rZW5WYWxpZCA9ICRVc2VyT2JqZWN0LT5Ub2tlbkNoZWNrKAogICAgICAgICAgICBUb2tlbiAgPT4gJFRva2VuLAogICAgICAgICAgICBVc2VySUQgPT4gJFVzZXJEYXRhe1VzZXJJRH0sCiAgICAgICAgKTsKCiAgICAgICAgaWYgKCAhJFRva2VuVmFsaWQgKSB7CiAgICAgICAgICAgICMgUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgcHJpbnQgJFNlbGYtPlByaW50SlNPTlJlc3BvbnNlKAogICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdJbnZhbGlkIHRva2VuLicKICAgICAgICAgICAgKTsgICAKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIH0KCiAgICAgICAgIyBnZXQgbmV3IHBhc3N3b3JkCiAgICAgICAgJFVzZXJEYXRhe05ld1BXfSA9ICRVc2VyT2JqZWN0LT5HZW5lcmF0ZVJhbmRvbVBhc3N3b3JkKCk7CgogICAgICAgICMgdXBkYXRlIG5ldyBwYXNzd29yZAogICAgICAgICRVc2VyT2JqZWN0LT5TZXRQYXNzd29yZCgKICAgICAgICAgICAgVXNlckxvZ2luID0+ICRVc2VyLAogICAgICAgICAgICBQVyAgICAgICAgPT4gJFVzZXJEYXRhe05ld1BXfQogICAgICAgICk7CgogICAgICAgICMgc2VuZCBub3RpZnkgZW1haWwKICAgICAgICBteSAkQm9keSA9ICRDb25maWdPYmplY3QtPkdldCgnTm90aWZpY2F0aW9uQm9keUxvc3RQYXNzd29yZCcpCiAgICAgICAgICAgIHx8ICdOZXcgUGFzc3dvcmQgaXM6IDxPVFJTX05FV1BXPic7CiAgICAgICAgbXkgJFN1YmplY3QgPSAkQ29uZmlnT2JqZWN0LT5HZXQoJ05vdGlmaWNhdGlvblN1YmplY3RMb3N0UGFzc3dvcmQnKQogICAgICAgICAgICB8fCAnTmV3IFBhc3N3b3JkISc7CiAgICAgICAgZm9yICggc29ydCBrZXlzICVVc2VyRGF0YSApIHsKICAgICAgICAgICAgJEJvZHkgPX4gcy88T1RSU18kXz4vJFVzZXJEYXRheyRffS9naTsKICAgICAgICB9CiAgICAgICAgbXkgJFNlbnQgPSAkRW1haWxPYmplY3QtPlNlbmQoCiAgICAgICAgICAgIFRvICAgICAgID0+ICRVc2VyRGF0YXtVc2VyRW1haWx9LAogICAgICAgICAgICBTdWJqZWN0ICA9PiAkU3ViamVjdCwKICAgICAgICAgICAgQ2hhcnNldCAgPT4gJExheW91dE9iamVjdC0+e1VzZXJDaGFyc2V0fSwKICAgICAgICAgICAgTWltZVR5cGUgPT4gJ3RleHQvcGxhaW4nLAogICAgICAgICAgICBCb2R5ICAgICA9PiAkQm9keQogICAgICAgICk7CgogICAgICAgIGlmICggISRTZW50LT57U3VjY2Vzc30gKSB7CgogICAgICAgICAgICAjIFJTIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgIHByaW50ICRTZWxmLT5QcmludEpTT05SZXNwb25zZSgKICAgICAgICAgICAgICAgIFJlc3BvbnNlID0+ICJFUlJPUiIsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnUGxlYXNlIGNvbnRhY3QgdGhlIGFkbWluaXN0cmF0b3IuJwogICAgICAgICAgICApOyAgIAoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgfQoKICAgICAgICAjIFJTIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgcHJpbnQgJFNlbGYtPlByaW50SlNPTlJlc3BvbnNlKAogICAgICAgICAgICBSZXNwb25zZSA9PiAiT0siLAogICAgICAgICAgICBNZXNzYWdlICA9PiAkTGF5b3V0T2JqZWN0LT57TGFuZ3VhZ2VPYmplY3R9LT5UcmFuc2xhdGUoCiAgICAgICAgICAgICAgICAnU2VudCBuZXcgcGFzc3dvcmQgdG8gJXMuIFBsZWFzZSBjaGVjayB5b3VyIGVtYWlsLicsCiAgICAgICAgICAgICAgICAkVXNlckRhdGF7VXNlckVtYWlsfSwKICAgICAgICAgICAgKQogICAgICAgICk7ICAgCgogICAgICAgIHJldHVybjsKICAgICAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICB9CgogICAgIyBzaG93IGxvZ2luIHNpdGUKICAgIGVsc2lmICggISRQYXJhbXtTZXNzaW9uSUR9ICkgewoKICAgICAgICAjIFJTIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgcHJpbnQgJFNlbGYtPlByaW50SlNPTlJlc3BvbnNlKAogICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiU2Vzc2lvbiBpbnZhbGlkLiBQbGVhc2UgbG9nIGluLi4uIgogICAgICAgICk7ICAgCgogICAgICAgIHJldHVybjsKICAgICAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICB9CgogICAgIyBydW4gbW9kdWxlcyBpZiBhIHZlcnNpb24gdmFsdWUgZXhpc3RzCiAgICBlbHNpZiAoICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpNYWluJyktPlJlcXVpcmUoIktlcm5lbDo6TW9kdWxlczo6JFBhcmFte0FjdGlvbn0iKSApIHsKCiAgICAgICAgIyBjaGVjayBzZXNzaW9uIGlkCiAgICAgICAgaWYgKCAhJFNlc3Npb25PYmplY3QtPkNoZWNrU2Vzc2lvbklEKCBTZXNzaW9uSUQgPT4gJFBhcmFte1Nlc3Npb25JRH0gKSApIHsKCiAgICAgICAgICAgICMgcHV0ICclUGFyYW0nIGludG8gTGF5b3V0T2JqZWN0CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5PYmplY3RQYXJhbUFkZCgKICAgICAgICAgICAgICAgICdLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0JyA9PiB7CiAgICAgICAgICAgICAgICAgICAgU2V0Q29va2llcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIFNlc3Npb25JRENvb2tpZSA9PiAkUGFyYW1PYmplY3QtPlNldENvb2tpZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEtleSAgICAgID0+ICRQYXJhbXtTZXNzaW9uTmFtZX0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZSAgICA9PiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV4cGlyZXMgID0+ICctMXknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUGF0aCAgICAgPT4gJENvbmZpZ09iamVjdC0+R2V0KCdTY3JpcHRBbGlhcycpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgU2VjdXJlICAgPT4gc2NhbGFyICRDb29raWVTZWN1cmVBdHRyaWJ1dGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBIVFRQT25seSA9PiAxLAogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgJVBhcmFtLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICMgUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICAgICBwcmludCAkU2VsZi0+UHJpbnRKU09OUmVzcG9uc2UoCiAgICAgICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIlNlc3Npb24gaW52YWxpZCIKICAgICAgICAgICAgKTsgICAKICAgICAgICAgICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAjIGdldCBzZXNzaW9uIGRhdGEKICAgICAgICBteSAlVXNlckRhdGEgPSAkU2Vzc2lvbk9iamVjdC0+R2V0U2Vzc2lvbklERGF0YSgKICAgICAgICAgICAgU2Vzc2lvbklEID0+ICRQYXJhbXtTZXNzaW9uSUR9LAogICAgICAgICk7CgogICAgICAgICRVc2VyRGF0YXtVc2VyVGltZVpvbmV9ID0gJFNlbGYtPl9Vc2VyVGltZVpvbmVHZXQoJVVzZXJEYXRhKTsKCiAgICAgICAgIyBjaGVjayBuZWVkZWQgZGF0YQogICAgICAgIGlmICggISRVc2VyRGF0YXtVc2VySUR9IHx8ICEkVXNlckRhdGF7VXNlckxvZ2lufSB8fCAkVXNlckRhdGF7VXNlclR5cGV9IG5lICdVc2VyJyApIHsKCiAgICAgICAgICAgICMgUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgcHJpbnQgJFNlbGYtPlByaW50SlNPTlJlc3BvbnNlKAogICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJTZXNzaW9uIGludmFsaWQuIFN5c3RlbSBlcnJvci4iCiAgICAgICAgICAgICk7ICAgCgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICB9CgogICAgICAgICMgY2hlY2sgbW9kdWxlIHJlZ2lzdHJ5CiAgICAgICAgbXkgJE1vZHVsZVJlZyA9ICRDb25maWdPYmplY3QtPkdldCgnRnJvbnRlbmQ6Ok1vZHVsZScpLT57ICRQYXJhbXtBY3Rpb259IH07CiAgICAgICAgaWYgKCAhJE1vZHVsZVJlZyApIHsKCiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgPT4KICAgICAgICAgICAgICAgICAgICAiTW9kdWxlIEtlcm5lbDo6TW9kdWxlczo6JFBhcmFte0FjdGlvbn0gbm90IHJlZ2lzdGVyZWQgaW4gS2VybmVsL0NvbmZpZy5wbSEiLAogICAgICAgICAgICApOwoKICAgICAgICAgICAgIyBSUyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICAgICBwcmludCAkU2VsZi0+UHJpbnRKU09OUmVzcG9uc2UoCiAgICAgICAgICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ1BsZWFzZSBjb250YWN0IHRoZSBhZG1pbmlzdHJhdG9yLicKICAgICAgICAgICAgKTsgICAKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgIH0KCiAgICAgICAgIyBtb2R1bGUgcGVybWlzc29uIGNoZWNrCiAgICAgICAgaWYgKAogICAgICAgICAgICByZWYgJE1vZHVsZVJlZy0+e0dyb3VwUm99IGVxICdBUlJBWScKICAgICAgICAgICAgJiYgIXNjYWxhciBAeyAkTW9kdWxlUmVnLT57R3JvdXBSb30gfQogICAgICAgICAgICAmJiByZWYgJE1vZHVsZVJlZy0+e0dyb3VwfSBlcSAnQVJSQVknCiAgICAgICAgICAgICYmICFzY2FsYXIgQHsgJE1vZHVsZVJlZy0+e0dyb3VwfSB9CiAgICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgICRQYXJhbXtBY2Nlc3NSb30gPSAxOwogICAgICAgICAgICAkUGFyYW17QWNjZXNzUnd9ID0gMTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIG15ICRHcm91cE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpHcm91cCcpOwoKICAgICAgICAgICAgUEVSTUlTU0lPTjoKICAgICAgICAgICAgZm9yIG15ICRQZXJtaXNzaW9uIChxdyhHcm91cFJvIEdyb3VwKSkgewogICAgICAgICAgICAgICAgbXkgJEFjY2Vzc09rID0gMDsKICAgICAgICAgICAgICAgIG15ICRHcm91cCAgICA9ICRNb2R1bGVSZWctPnskUGVybWlzc2lvbn07CiAgICAgICAgICAgICAgICBuZXh0IFBFUk1JU1NJT04gaWYgISRHcm91cDsKICAgICAgICAgICAgICAgIGlmICggcmVmICRHcm91cCBlcSAnQVJSQVknICkgewogICAgICAgICAgICAgICAgICAgIElOTkVSOgogICAgICAgICAgICAgICAgICAgIGZvciBteSAkR3JvdXBOYW1lICggQHskR3JvdXB9ICkgewogICAgICAgICAgICAgICAgICAgICAgICBuZXh0IElOTkVSIGlmICEkR3JvdXBOYW1lOwogICAgICAgICAgICAgICAgICAgICAgICBuZXh0IElOTkVSIGlmICEkR3JvdXBPYmplY3QtPlBlcm1pc3Npb25DaGVjaygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJJRCAgICA9PiAkVXNlckRhdGF7VXNlcklEfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdyb3VwTmFtZSA9PiAkR3JvdXBOYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgVHlwZSAgICAgID0+ICRQZXJtaXNzaW9uIGVxICdHcm91cFJvJyA/ICdybycgOiAncncnLAoKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgICAgJEFjY2Vzc09rID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgbGFzdCBJTk5FUjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBteSAkSGFzUGVybWlzc2lvbiA9ICRHcm91cE9iamVjdC0+UGVybWlzc2lvbkNoZWNrKAogICAgICAgICAgICAgICAgICAgICAgICBVc2VySUQgICAgPT4gJFVzZXJEYXRhe1VzZXJJRH0sCiAgICAgICAgICAgICAgICAgICAgICAgIEdyb3VwTmFtZSA9PiAkR3JvdXAsCiAgICAgICAgICAgICAgICAgICAgICAgIFR5cGUgICAgICA9PiAkUGVybWlzc2lvbiBlcSAnR3JvdXBSbycgPyAncm8nIDogJ3J3JywKCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBpZiAoJEhhc1Blcm1pc3Npb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgJEFjY2Vzc09rID0gMTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoICRQZXJtaXNzaW9uIGVxICdHcm91cCcgJiYgJEFjY2Vzc09rICkgewogICAgICAgICAgICAgICAgICAgICRQYXJhbXtBY2Nlc3NSb30gPSAxOwogICAgICAgICAgICAgICAgICAgICRQYXJhbXtBY2Nlc3NSd30gPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzaWYgKCAkUGVybWlzc2lvbiBlcSAnR3JvdXBSbycgJiYgJEFjY2Vzc09rICkgewogICAgICAgICAgICAgICAgICAgICRQYXJhbXtBY2Nlc3NSb30gPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICggISRQYXJhbXtBY2Nlc3NSb30gJiYgISRQYXJhbXtBY2Nlc3NSd30gfHwgISRQYXJhbXtBY2Nlc3NSb30gJiYgJFBhcmFte0FjY2Vzc1J3fSApIHsKCiAgICAgICAgICAgICAgICAjIFJTIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgICAgICBwcmludCAkU2VsZi0+UHJpbnRKU09OUmVzcG9uc2UoCiAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UgPT4gIkVSUk9SIiwKICAgICAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnTm8gUGVybWlzc2lvbiB0byB1c2UgdGhpcyBmcm9udGVuZCBtb2R1bGUhJwogICAgICAgICAgICAgICAgKTsgICAKCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgcHV0ICclUGFyYW0nIGFuZCAnJVVzZXJEYXRhJyBpbnRvIExheW91dE9iamVjdAogICAgICAgICRLZXJuZWw6Ok9NLT5PYmplY3RQYXJhbUFkZCgKICAgICAgICAgICAgJ0tlcm5lbDo6T3V0cHV0OjpIVE1MOjpMYXlvdXQnID0+IHsKICAgICAgICAgICAgICAgICVQYXJhbSwKICAgICAgICAgICAgICAgICVVc2VyRGF0YSwKICAgICAgICAgICAgICAgIE1vZHVsZVJlZyA9PiAkTW9kdWxlUmVnLAogICAgICAgICAgICB9LAogICAgICAgICk7CiAgICAgICAgJEtlcm5lbDo6T00tPk9iamVjdHNEaXNjYXJkKCBPYmplY3RzID0+IFsnS2VybmVsOjpPdXRwdXQ6OkhUTUw6OkxheW91dCddICk7CgogICAgICAgICMgdXBkYXRlIGxhc3QgcmVxdWVzdCB0aW1lCiAgICAgICAgaWYgKAogICAgICAgICAgICAhJFBhcmFtT2JqZWN0LT5Jc0FKQVhSZXF1ZXN0KCkKICAgICAgICAgICAgfHwgJFBhcmFte0FjdGlvbn0gZXEgJ0FnZW50VmlkZW9DaGF0JwogICAgICAgICAgICB8fAogICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAkUGFyYW17QWN0aW9ufSBlcSAnQWdlbnRDaGF0JwogICAgICAgICAgICAgICAgJiYKICAgICAgICAgICAgICAgICRQYXJhbXtTdWJhY3Rpb259IG5lICdDaGF0R2V0T3BlblJlcXVlc3RzJyAmJgogICAgICAgICAgICAgICAgJFBhcmFte1N1YmFjdGlvbn0gbmUgJ0NoYXRNb25pdG9yQ2hlY2snCiAgICAgICAgICAgICkKICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgbXkgJERhdGVUaW1lT2JqZWN0ID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJyk7CgogICAgICAgICAgICAkU2Vzc2lvbk9iamVjdC0+VXBkYXRlU2Vzc2lvbklEKAogICAgICAgICAgICAgICAgU2Vzc2lvbklEID0+ICRQYXJhbXtTZXNzaW9uSUR9LAogICAgICAgICAgICAgICAgS2V5ICAgICAgID0+ICdVc2VyTGFzdFJlcXVlc3QnLAogICAgICAgICAgICAgICAgVmFsdWUgICAgID0+ICREYXRlVGltZU9iamVjdC0+VG9FcG9jaCgpLAogICAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgIyBPdmVycmlkZSB1c2VyIHNldHRpbmdzLgogICAgICAgIG15ICRIb21lID0gJENvbmZpZ09iamVjdC0+R2V0KCdIb21lJyk7CiAgICAgICAgbXkgJEZpbGUgPSAiJEhvbWUvS2VybmVsL0NvbmZpZy9GaWxlcy9Vc2VyLyRVc2VyRGF0YXtVc2VySUR9LnBtIjsKICAgICAgICBpZiAoIC1lICRGaWxlICkgewogICAgICAgICAgICBldmFsIHsKICAgICAgICAgICAgICAgIGlmICggcmVxdWlyZSAkRmlsZSApIHsKCiAgICAgICAgICAgICAgICAgICAgIyBQcmVwYXJlIGZpbGUuCiAgICAgICAgICAgICAgICAgICAgJEZpbGUgPX4gcy9cUSRIb21lXEUvL2c7CiAgICAgICAgICAgICAgICAgICAgJEZpbGUgPX4gcy9eXC8vL2c7CiAgICAgICAgICAgICAgICAgICAgJEZpbGUgPX4gcy9cL1wvL1wvL2c7CiAgICAgICAgICAgICAgICAgICAgJEZpbGUgPX4gcy9cLy86Oi9nOwogICAgICAgICAgICAgICAgICAgICRGaWxlID1+IHMvXC5wbSQvL2c7CiAgICAgICAgICAgICAgICAgICAgJEZpbGUtPkxvYWQoJENvbmZpZ09iamVjdCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBkaWUgIkNhbm5vdCBsb2FkIGZpbGUgJEZpbGU6ICQhXG4iOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgIyBMb2cgZXJyb3IgYW5kIGNvbnRpbnVlLgogICAgICAgICAgICBpZiAoJEApIHsKICAgICAgICAgICAgICAgIG15ICRFcnJvck1lc3NhZ2UgPSAkQDsKICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gJEVycm9yTWVzc2FnZSwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgcHJlIGFwcGxpY2F0aW9uIG1vZHVsZQogICAgICAgIG15ICRQcmVNb2R1bGUgPSAkQ29uZmlnT2JqZWN0LT5HZXQoJ1ByZUFwcGxpY2F0aW9uTW9kdWxlJyk7CiAgICAgICAgaWYgKCRQcmVNb2R1bGUpIHsKICAgICAgICAgICAgbXkgJVByZU1vZHVsZUxpc3Q7CiAgICAgICAgICAgIGlmICggcmVmICRQcmVNb2R1bGUgZXEgJ0hBU0gnICkgewogICAgICAgICAgICAgICAgJVByZU1vZHVsZUxpc3QgPSAleyRQcmVNb2R1bGV9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJFByZU1vZHVsZUxpc3R7SW5pdH0gPSAkUHJlTW9kdWxlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBNT0RVTEU6CiAgICAgICAgICAgIGZvciBteSAkUHJlTW9kdWxlS2V5ICggc29ydCBrZXlzICVQcmVNb2R1bGVMaXN0ICkgewogICAgICAgICAgICAgICAgbXkgJFByZU1vZHVsZSA9ICRQcmVNb2R1bGVMaXN0eyRQcmVNb2R1bGVLZXl9OwogICAgICAgICAgICAgICAgbmV4dCBNT0RVTEUgaWYgISRQcmVNb2R1bGU7CiAgICAgICAgICAgICAgICBuZXh0IE1PRFVMRSBpZiAhJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06Ok1haW4nKS0+UmVxdWlyZSgkUHJlTW9kdWxlKTsKCiAgICAgICAgICAgICAgICAjIGRlYnVnIGluZm8KICAgICAgICAgICAgICAgIGlmICggJFNlbGYtPntEZWJ1Z30gKSB7CiAgICAgICAgICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdkZWJ1ZycsCiAgICAgICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJQcmVBcHBsaWNhdGlvbiBtb2R1bGUgJFByZU1vZHVsZSBpcyB1c2VkLiIsCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBteSAkTGF5b3V0T2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpPdXRwdXQ6OkhUTUw6OkxheW91dCcpOwoKICAgICAgICAgICAgICAgICMgdXNlIG1vZHVsZQogICAgICAgICAgICAgICAgbXkgJFByZU1vZHVsZU9iamVjdCA9ICRQcmVNb2R1bGUtPm5ldygKICAgICAgICAgICAgICAgICAgICAlUGFyYW0sCiAgICAgICAgICAgICAgICAgICAgJVVzZXJEYXRhLAogICAgICAgICAgICAgICAgICAgIE1vZHVsZVJlZyA9PiAkTW9kdWxlUmVnLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIG15ICRPdXRwdXQgPSAkUHJlTW9kdWxlT2JqZWN0LT5QcmVSdW4oKTsKICAgICAgICAgICAgICAgIGlmICgkT3V0cHV0KSB7CiAgICAgICAgICAgICAgICAgICAgJExheW91dE9iamVjdC0+UHJpbnQoIE91dHB1dCA9PiBcJE91dHB1dCApOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIGRlYnVnIGluZm8KICAgICAgICBpZiAoICRTZWxmLT57RGVidWd9ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdkZWJ1ZycsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnS2VybmVsOjpNb2R1bGVzOjonIC4gJFBhcmFte0FjdGlvbn0gLiAnLT5uZXcnLAogICAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgbXkgJEZyb250ZW5kT2JqZWN0ID0gKCAnS2VybmVsOjpNb2R1bGVzOjonIC4gJFBhcmFte0FjdGlvbn0gKS0+bmV3KAogICAgICAgICAgICAlUGFyYW0sCiAgICAgICAgICAgICVVc2VyRGF0YSwKICAgICAgICAgICAgTW9kdWxlUmVnID0+ICRNb2R1bGVSZWcsCiAgICAgICAgICAgIERlYnVnICAgICA9PiAkU2VsZi0+e0RlYnVnfSwKICAgICAgICApOwoKICAgICAgICAjIGRlYnVnIGluZm8KICAgICAgICBpZiAoICRTZWxmLT57RGVidWd9ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdkZWJ1ZycsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnS2VybmVsOjpNb2R1bGVzOjonIC4gJFBhcmFte0FjdGlvbn0gLiAnLT5ydW4nLAogICAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgIyAtPlJ1biAkQWN0aW9uIHdpdGggJEZyb250ZW5kT2JqZWN0CiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpPdXRwdXQ6OkhUTUw6OkxheW91dCcpLT5QcmludCggT3V0cHV0ID0+IFwkRnJvbnRlbmRPYmplY3QtPlJ1bigpICk7CgogICAgICAgICMgbG9nIHJlcXVlc3QgdGltZQogICAgICAgIGlmICggJENvbmZpZ09iamVjdC0+R2V0KCdQZXJmb3JtYW5jZUxvZycpICkgewogICAgICAgICAgICBpZiAoICggISRRdWVyeVN0cmluZyAmJiAkUGFyYW17QWN0aW9ufSApIHx8ICRRdWVyeVN0cmluZyAhfiAvQWN0aW9uPS8gKSB7CiAgICAgICAgICAgICAgICAkUXVlcnlTdHJpbmcgPSAnQWN0aW9uPScgLiAkUGFyYW17QWN0aW9ufSAuICcmU3ViYWN0aW9uPScgLiAkUGFyYW17U3ViYWN0aW9ufTsKICAgICAgICAgICAgfQogICAgICAgICAgICBteSAkRmlsZSA9ICRDb25maWdPYmplY3QtPkdldCgnUGVyZm9ybWFuY2VMb2c6OkZpbGUnKTsKICAgICAgICAgICAgIyMgbm8gY3JpdGljCiAgICAgICAgICAgIGlmICggb3BlbiBteSAkT3V0LCAnPj4nLCAkRmlsZSApIHsKICAgICAgICAgICAgICAgICMjIHVzZSBjcml0aWMKICAgICAgICAgICAgICAgIHByaW50ICRPdXQgdGltZSgpCiAgICAgICAgICAgICAgICAgICAgLiAnOjpBZ2VudDo6JwogICAgICAgICAgICAgICAgICAgIC4gKCB0aW1lKCkgLSAkU2VsZi0+e1BlcmZvcm1hbmNlTG9nU3RhcnR9ICkKICAgICAgICAgICAgICAgICAgICAuICI6OiRVc2VyRGF0YXtVc2VyTG9naW59OjokUXVlcnlTdHJpbmdcbiI7CiAgICAgICAgICAgICAgICBjbG9zZSAkT3V0OwoKICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdkZWJ1ZycsCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIlJlc3BvbnNlOjpBZ2VudDogIgogICAgICAgICAgICAgICAgICAgICAgICAuICggdGltZSgpIC0gJFNlbGYtPntQZXJmb3JtYW5jZUxvZ1N0YXJ0fSApCiAgICAgICAgICAgICAgICAgICAgICAgIC4gInMgdGFrZW4gKFVSTDokUXVlcnlTdHJpbmc6JFVzZXJEYXRhe1VzZXJMb2dpbn0pIiwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJDYW4ndCB3cml0ZSAkRmlsZTogJCEiLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gMTsKICAgIH0KCiAgICAjIHByaW50IGFuIGVycm9yIHNjcmVlbgogICAgbXkgJURhdGEgPSAkU2Vzc2lvbk9iamVjdC0+R2V0U2Vzc2lvbklERGF0YSgKICAgICAgICBTZXNzaW9uSUQgPT4gJFBhcmFte1Nlc3Npb25JRH0sCiAgICApOwogICAgJERhdGF7VXNlclRpbWVab25lfSA9ICRTZWxmLT5fVXNlclRpbWVab25lR2V0KCVEYXRhKTsKICAgICRLZXJuZWw6Ok9NLT5PYmplY3RQYXJhbUFkZCgKICAgICAgICAnS2VybmVsOjpPdXRwdXQ6OkhUTUw6OkxheW91dCcgPT4gewogICAgICAgICAgICAlUGFyYW0sCiAgICAgICAgICAgICVEYXRhLAogICAgICAgIH0sCiAgICApOwoKICAgICMgUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIHByaW50ICRTZWxmLT5QcmludEpTT05SZXNwb25zZSgKICAgICAgICBSZXNwb25zZSA9PiAiRVJST1IiLAogICAgICAgIE1lc3NhZ2UgID0+ICdQbGVhc2UgY29udGFjdCB0aGUgYWRtaW5pc3RyYXRvciEnCiAgICApOyAgIAoKICAgIHJldHVybjsKICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KfQoKc3ViIFByaW50SlNPTlJlc3BvbnNlIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJExheW91dE9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6T3V0cHV0OjpIVE1MOjpMYXlvdXQnKTsKICAgIG15ICRKU09OICAgICAgICAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6QVBJOjpVdGlsJykKICAgICAgLT5DbGVhbkpTT04oIERhdGEgPT4gXCVQYXJhbSApOwoKICAgIHJldHVybiAkTGF5b3V0T2JqZWN0LT5BdHRhY2htZW50KAogICAgICAgIENvbnRlbnRUeXBlID0+ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PScgLiAkTGF5b3V0T2JqZWN0LT57Q2hhcnNldH0sCiAgICAgICAgQ29udGVudCAgICAgPT4gJEpTT04sCiAgICAgICAgVHlwZSAgICAgICAgPT4gJ2lubGluZScsCiAgICAgICAgTm9DYWNoZSAgICAgPT4gMQogICAgKTsgICAKfQoKPWJlZ2luIEludGVybmFsOgoKPWhlYWQyIF9Vc2VyVGltZVpvbmVHZXQoKQoKR2V0IHRpbWUgem9uZSBmb3IgdGhlIGN1cnJlbnQgdXNlci4gVGhpcyBmdW5jdGlvbiB3aWxsIHZhbGlkYXRlIHBhc3NlZCB0aW1lIHpvbmUgcGFyYW1ldGVyIGFuZCByZXR1cm4gZGVmYXVsdCB1c2VyIHRpbWUKem9uZSBpZiBpdCdzIG5vdCB2YWxpZC4KCiAgICBteSAkVXNlclRpbWVab25lID0gJFNlbGYtPl9Vc2VyVGltZVpvbmVHZXQoCiAgICAgICAgVXNlclRpbWVab25lID0+ICdFdXJvcGUvQmVybGluJywKICAgICk7Cgo9Y3V0CgpzdWIgX1VzZXJUaW1lWm9uZUdldCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRVc2VyVGltZVpvbmU7CgogICAgIyBSZXR1cm4gcGFzc2VkIHRpbWUgem9uZSBvbmx5IGlmIGl0J3MgdmFsaWQuIEl0IGNhbiBoYXBwZW4gdGhhdCB1c2VyIHByZWZlcmVuY2VzIG9yIHNlc3Npb24gc3RvcmUgYW4gb2xkLXN0eWxlCiAgICAjICAgb2Zmc2V0IHdoaWNoIGlzIG5vdCB2YWxpZCBhbnltb3JlLiBJbiB0aGlzIGNhc2UsIHJldHVybiB0aGUgZGVmYXVsdCB2YWx1ZS4KICAgICMgICBQbGVhc2Ugc2VlIGJ1ZyMxMzM3NCBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KICAgIGlmICgKICAgICAgICAkUGFyYW17VXNlclRpbWVab25lfQogICAgICAgICYmIEtlcm5lbDo6U3lzdGVtOjpEYXRlVGltZS0+SXNUaW1lWm9uZVZhbGlkKCBUaW1lWm9uZSA9PiAkUGFyYW17VXNlclRpbWVab25lfSApCiAgICAgICAgKQogICAgewogICAgICAgICRVc2VyVGltZVpvbmUgPSAkUGFyYW17VXNlclRpbWVab25lfTsKICAgIH0KCiAgICAkVXNlclRpbWVab25lIHx8PSBLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUtPlVzZXJEZWZhdWx0VGltZVpvbmVHZXQoKTsKCiAgICByZXR1cm4gJFVzZXJUaW1lWm9uZTsKfQoKPWVuZCBJbnRlcm5hbDoKCj1jdXQKCnN1YiBERVNUUk9ZIHsKICAgIG15ICRTZWxmID0gc2hpZnQ7CgogICAgIyBkZWJ1ZyBpbmZvCiAgICBpZiAoICRTZWxmLT57RGVidWd9ICkgewogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICBQcmlvcml0eSA9PiAnZGVidWcnLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnR2xvYmFsIGhhbmRsZSBzdG9wcGVkLicsCiAgICAgICAgKTsKICAgIH0KCiAgICByZXR1cm4gMTsKfQoKMTsKCj1oZWFkMSBURVJNUyBBTkQgQ09ORElUSU9OUwoKVGhpcyBzb2Z0d2FyZSBpcyBwYXJ0IG9mIHRoZSBPVFJTIHByb2plY3QgKEw8aHR0cDovL290cnMub3JnLz4pLgoKVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKdGhlIGVuY2xvc2VkIGZpbGUgQ09QWUlORyBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbiAoQUdQTCkuIElmIHlvdQpkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgTDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvYWdwbC50eHQ+LgoKPWN1dAo=</File>
        <File Location="Custom/Kernel/Language.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6Okxhbmd1YWdlOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwpubyB3YXJuaW5ncyAncmVkZWZpbmUnOwoKdXNlIEV4cG9ydGVyIHF3KGltcG9ydCk7Cm91ciBARVhQT1JUX09LID0gcXcoVHJhbnNsYXRhYmxlKTsgICAgIyMgbm8gY3JpdGljCgp1c2UgRmlsZTo6c3RhdDsKdXNlIERpZ2VzdDo6TUQ1OwoKdXNlIEtlcm5lbDo6U3lzdGVtOjpEYXRlVGltZTsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKAogICAgJ0tlcm5lbDo6Q29uZmlnJywKICAgICdLZXJuZWw6OlN5c3RlbTo6TG9nJywKICAgICdLZXJuZWw6OlN5c3RlbTo6TWFpbicsCik7Cgo9aGVhZDEgTkFNRQoKS2VybmVsOjpMYW5ndWFnZSAtIGdsb2JhbCBsYW5ndWFnZSBpbnRlcmZhY2UKCj1oZWFkMSBERVNDUklQVElPTgoKQWxsIGxhbmd1YWdlIGZ1bmN0aW9ucy4KCj1oZWFkMSBQVUJMSUMgSU5URVJGQUNFCgo9aGVhZDIgbmV3KCkKCmNyZWF0ZSBhIGxhbmd1YWdlIG9iamVjdC4gRG8gbm90IHVzZSBpdCBkaXJlY3RseSwgaW5zdGVhZCB1c2U6CgogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpPYmplY3RNYW5hZ2VyOwogICAgbG9jYWwgJEtlcm5lbDo6T00gPSBLZXJuZWw6OlN5c3RlbTo6T2JqZWN0TWFuYWdlci0+bmV3KAogICAgICAgICdLZXJuZWw6Okxhbmd1YWdlJyA9PiB7CiAgICAgICAgICAgIFVzZXJMYW5ndWFnZSA9PiAnZGUnLAogICAgICAgIH0sCiAgICApOwogICAgbXkgJExhbmd1YWdlT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpMYW5ndWFnZScpOwoKPWN1dAoKc3ViIG5ldyB7CiAgICBteSAoICRUeXBlLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgYWxsb2NhdGUgbmV3IGhhc2ggZm9yIG9iamVjdAogICAgbXkgJFNlbGYgPSB7JVBhcmFtfTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICAjIDA9b2ZmOyAxPW9uOyAyPWdldCBhbGwgbm90IHRyYW5zbGF0ZWQgd29yZHM7IDM9Z2V0IGFsbCByZXF1ZXN0cwogICAgJFNlbGYtPntEZWJ1Z30gPSAwOwoKICAgICMgZ2V0IG5lZWRlZCBvYmplY3QKICAgIG15ICRDb25maWdPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpOwogICAgbXkgJE1haW5PYmplY3QgICA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpNYWluJyk7CgogICAgIyB1c2VyIGxhbmd1YWdlCiAgICAkU2VsZi0+e1VzZXJMYW5ndWFnZX0gPSAkUGFyYW17VXNlckxhbmd1YWdlfQogICAgICAgIHx8ICRDb25maWdPYmplY3QtPkdldCgnRGVmYXVsdExhbmd1YWdlJykKICAgICAgICB8fCAnZW4nOwoKICAgICMgY2hlY2sgaWYgbGFuZ3VhZ2UgaXMgY29uZmlndXJlZAogICAgbXkgJUxhbmd1YWdlcyA9ICV7ICRDb25maWdPYmplY3QtPkdldCgnRGVmYXVsdFVzZWRMYW5ndWFnZXMnKSB9OwogICAgaWYgKCAhJExhbmd1YWdlc3sgJFNlbGYtPntVc2VyTGFuZ3VhZ2V9IH0gKSB7CiAgICAgICAgJFNlbGYtPntVc2VyTGFuZ3VhZ2V9ID0gJ2VuJzsKICAgIH0KCiAgICAjIHRha2UgdGltZSB6b25lCiAgICAkU2VsZi0+e1RpbWVab25lfSA9ICRQYXJhbXtVc2VyVGltZVpvbmV9IHx8ICRQYXJhbXtUaW1lWm9uZX0gfHwgS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lLT5PVFJTVGltZVpvbmVHZXQoKTsKCiAgICAjIERlYnVnCiAgICBpZiAoICRTZWxmLT57RGVidWd9ID4gMCApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2RlYnVnJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIlVzZXJMYW5ndWFnZSA9ICRTZWxmLT57VXNlckxhbmd1YWdlfSIsCiAgICAgICAgKTsKICAgIH0KCiAgICBteSAkSG9tZSA9ICRDb25maWdPYmplY3QtPkdldCgnSG9tZScpIC4gJy8nOwoKICAgIG15ICRMYW5ndWFnZUZpbGUgPSAiS2VybmVsOjpMYW5ndWFnZTo6JFNlbGYtPntVc2VyTGFuZ3VhZ2V9IjsKCiAgICAjIGxvYWQgdGV4dCBjYXRhbG9nIC4uLgogICAgaWYgKCAhJE1haW5PYmplY3QtPlJlcXVpcmUoJExhbmd1YWdlRmlsZSkgKSB7CiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJTb3JyeSwgY2FuJ3QgbG9jYXRlIG9yIGxvYWQgJExhbmd1YWdlRmlsZSAiCiAgICAgICAgICAgICAgICAuICJ0cmFuc2xhdGlvbiEgQ2hlY2sgdGhlIEtlcm5lbC9MYW5ndWFnZS8kU2VsZi0+e1VzZXJMYW5ndWFnZX0ucG0gKHBlcmwgLWN3KSEiLAogICAgICAgICk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBwdXNoIEB7ICRTZWxmLT57TGFuZ3VhZ2VGaWxlc30gfSwgIiRIb21lL0tlcm5lbC9MYW5ndWFnZS8kU2VsZi0+e1VzZXJMYW5ndWFnZX0ucG0iOwogICAgfQoKICAgIG15ICRMYW5ndWFnZUZpbGVEYXRhTWV0aG9kID0gJExhbmd1YWdlRmlsZS0+Y2FuKCdEYXRhJyk7CgogICAgIyBFeGVjdXRlIHRyYW5zbGF0aW9uIG1hcCBieSBjYWxsaW5nIGxhbmd1YWdlIGZpbGUgZGF0YSBtZXRob2QgdmlhIHJlZmVyZW5jZS4KICAgIGlmICgkTGFuZ3VhZ2VGaWxlRGF0YU1ldGhvZCkgewogICAgICAgIGlmICggJExhbmd1YWdlRmlsZURhdGFNZXRob2QtPigkU2VsZikgKSB7CgogICAgICAgICAgICAjIERlYnVnIGluZm8uCiAgICAgICAgICAgIGlmICggJFNlbGYtPntEZWJ1Z30gPiAwICkgewogICAgICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2RlYnVnJywKICAgICAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiS2VybmVsOjpMYW5ndWFnZTo6JFNlbGYtPntVc2VyTGFuZ3VhZ2V9IGxvYWQgLi4uIGRvbmUuIiwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIlNvcnJ5LCBjYW4ndCBsb2FkICRMYW5ndWFnZUZpbGUhIENoZWNrIGlmIGl0IHByb3ZpZGVzIERhdGEgbWV0aG9kIiwKICAgICAgICApOwogICAgfQoKICAgICMgbG9hZCBhY3Rpb24gdGV4dCBjYXRhbG9nIC4uLgogICAgbXkgJEN1c3RvbVRyYW5zbGF0aW9uTW9kdWxlID0gJyc7CiAgICBteSAkQ3VzdG9tVHJhbnNsYXRpb25GaWxlICAgPSAnJzsKCiAgICAjIGRvIG5vdCBpbmNsdWRlIGFkZGl0aW9uIHRyYW5zbGF0aW9uIGZpbGVzLCBhIG5ldyB0cmFuc2xhdGlvbiBmaWxlIGdldHMgY3JlYXRlZAogICAgaWYgKCAhJFBhcmFte1RyYW5zbGF0aW9uRmlsZX0gKSB7CgogICAgICAgICMgbG9va2luZyB0byBhZGRpdGlvbiB0cmFuc2xhdGlvbiBmaWxlcwogICAgICAgIG15IEBGaWxlcyA9ICRNYWluT2JqZWN0LT5EaXJlY3RvcnlSZWFkKAogICAgICAgICAgICBEaXJlY3RvcnkgPT4gJEhvbWUgLiAiS2VybmVsL0xhbmd1YWdlLyIsCiAgICAgICAgICAgIEZpbHRlciAgICA9PiAiJFNlbGYtPntVc2VyTGFuZ3VhZ2V9XyoucG0iLAogICAgICAgICk7CiAgICAgICAgRklMRToKICAgICAgICBmb3IgbXkgJEZpbGUgKEBGaWxlcykgewoKICAgICAgICAgICAgIyBnZXQgbW9kdWxlIG5hbWUgYmFzZWQgb24gZmlsZSBuYW1lCiAgICAgICAgICAgIG15ICRNb2R1bGUgPSAkRmlsZSA9fiBzL14kSG9tZSguKilcLnBtJC8kMS9yZzsKICAgICAgICAgICAgJE1vZHVsZSA9fiBzL1wvXC8vXC8vZzsKICAgICAgICAgICAgJE1vZHVsZSA9fiBzL1wvLzo6L2c7CgogICAgICAgICAgICAjIGlnbm9yZSBsYW5ndWFnZSB0cmFuc2xhdGlvbiBmaWxlcyBsaWtlIChlbl9HQiwgZW5fQ0EsIC4uLikKICAgICAgICAgICAgbmV4dCBGSUxFIGlmICRNb2R1bGUgPX4gLy4uXy4uJC87CgogICAgICAgICAgICAjIFJlbWVtYmVyIGN1c3RvbSBmaWxlcyB0byBsb2FkIGF0IHRoZSBlbmQuCiAgICAgICAgICAgIGlmICggJE1vZHVsZSA9fiAvX0N1c3RvbSQvICkgewogICAgICAgICAgICAgICAgJEN1c3RvbVRyYW5zbGF0aW9uTW9kdWxlID0gJE1vZHVsZTsKICAgICAgICAgICAgICAgICRDdXN0b21UcmFuc2xhdGlvbkZpbGUgICA9ICRGaWxlOwogICAgICAgICAgICAgICAgbmV4dCBGSUxFOwogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGxvYWQgdHJhbnNsYXRpb24gbW9kdWxlCiAgICAgICAgICAgIGlmICggISRNYWluT2JqZWN0LT5SZXF1aXJlKCRNb2R1bGUpICkgewogICAgICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiU29ycnksIGNhbid0IGxvYWQgJE1vZHVsZSEgQ2hlY2sgdGhlICRGaWxlIChwZXJsIC1jdykhIiwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBuZXh0IEZJTEU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBwdXNoIEB7ICRTZWxmLT57TGFuZ3VhZ2VGaWxlc30gfSwgJEZpbGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG15ICRNb2R1bGVEYXRhTWV0aG9kID0gJE1vZHVsZS0+Y2FuKCdEYXRhJyk7CgogICAgICAgICAgICBpZiAoICEkTW9kdWxlRGF0YU1ldGhvZCApIHsKICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIlNvcnJ5LCBjYW4ndCBsb2FkICRNb2R1bGUhIENoZWNrIGlmIGl0IHByb3ZpZGVzIERhdGEgbWV0aG9kLiIsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgbmV4dCBGSUxFOwogICAgICAgICAgICB9CgogICAgICAgICAgICAjIEV4ZWN1dGUgdHJhbnNsYXRpb24gbWFwIGJ5IGNhbGxpbmcgbW9kdWxlIGRhdGEgbWV0aG9kIHZpYSByZWZlcmVuY2UuCiAgICAgICAgICAgIGlmICggZXZhbCB7ICRNb2R1bGVEYXRhTWV0aG9kLT4oJFNlbGYpIH0gKSB7CgogICAgICAgICAgICAgICAgIyBkZWJ1ZyBpbmZvCiAgICAgICAgICAgICAgICBpZiAoICRTZWxmLT57RGVidWd9ID4gMCApIHsKICAgICAgICAgICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2RlYnVnJywKICAgICAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIiRNb2R1bGUgbG9hZCAuLi4gZG9uZS4iLAogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgbG9hZCBjdXN0b20gdGV4dCBjYXRhbG9nIC4uLgogICAgICAgIGlmICggJEN1c3RvbVRyYW5zbGF0aW9uTW9kdWxlICYmICRNYWluT2JqZWN0LT5SZXF1aXJlKCRDdXN0b21UcmFuc2xhdGlvbk1vZHVsZSkgKSB7CgogICAgICAgICAgICBwdXNoIEB7ICRTZWxmLT57TGFuZ3VhZ2VGaWxlc30gfSwgJEN1c3RvbVRyYW5zbGF0aW9uRmlsZTsKCiAgICAgICAgICAgIG15ICRDdXN0b21UcmFuc2xhdGlvbkRhdGFNZXRob2QgPSAkQ3VzdG9tVHJhbnNsYXRpb25Nb2R1bGUtPmNhbignRGF0YScpOwoKICAgICAgICAgICAgIyBFeGVjdXRlIHRyYW5zbGF0aW9uIG1hcCBieSBjYWxsaW5nIGN1c3RvbSBtb2R1bGUgZGF0YSBtZXRob2QgdmlhIHJlZmVyZW5jZS4KICAgICAgICAgICAgaWYgKCRDdXN0b21UcmFuc2xhdGlvbkRhdGFNZXRob2QpIHsKICAgICAgICAgICAgICAgIGlmICggZXZhbCB7ICRDdXN0b21UcmFuc2xhdGlvbkRhdGFNZXRob2QtPigkU2VsZikgfSApIHsKCiAgICAgICAgICAgICAgICAgICAgIyBEZWJ1ZyBpbmZvLgogICAgICAgICAgICAgICAgICAgIGlmICggJFNlbGYtPntEZWJ1Z30gPiAwICkgewogICAgICAgICAgICAgICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdEZWJ1ZycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiJEN1c3RvbVRyYW5zbGF0aW9uTW9kdWxlIGxvYWQgLi4uIGRvbmUuIiwKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJTb3JyeSwgY2FuJ3QgbG9hZCAkQ3VzdG9tVHJhbnNsYXRpb25Nb2R1bGUhIENoZWNrIGlmIGl0IHByb3ZpZGVzIERhdGEgbWV0aG9kLiIsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgICMgaWYgbm8gcmV0dXJuIGNoYXJzZXQgaXMgZ2l2ZW4sIHVzZSByZWNvbW1lbmRlZCByZXR1cm4gY2hhcnNldAogICAgaWYgKCAhJFNlbGYtPntSZXR1cm5DaGFyc2V0fSApIHsKICAgICAgICAkU2VsZi0+e1JldHVybkNoYXJzZXR9ID0gJFNlbGYtPkdldFJlY29tbWVuZGVkQ2hhcnNldCgpOwogICAgfQoKICAgICMgZ2V0IHNvdXJjZSBmaWxlIGNoYXJzZXQKICAgICMgd2hhdCBjaGFyc2V0IHNob3VsZCBJIHVzZSAodGFrZSBpdCBmcm9tIHRyYW5zbGF0aW9uIGZpbGUpIQogICAgaWYgKCAkU2VsZi0+e0NoYXJzZXR9ICYmIHJlZiAkU2VsZi0+e0NoYXJzZXR9IGVxICdBUlJBWScgKSB7CiAgICAgICAgJFNlbGYtPntUcmFuc2xhdGlvbkNoYXJzZXR9ID0gJFNlbGYtPntDaGFyc2V0fS0+Wy0xXTsKICAgIH0KCiAgICByZXR1cm4gJFNlbGY7Cn0KCj1oZWFkMiBUcmFuc2xhdGFibGUoKQoKdGhpcyBpcyBhIG5vLW9wIHRvIG1hcmsgYSB0ZXh0IGFzIHRyYW5zbGF0YWJsZSBpbiB0aGUgUGVybCBjb2RlLgoKPWN1dAoKc3ViIFRyYW5zbGF0YWJsZSB7CiAgICByZXR1cm4gc2hpZnQ7Cn0KCj1oZWFkMiBUcmFuc2xhdGUoKQoKdHJhbnNsYXRlIGEgdGV4dCB3aXRoIHBsYWNlaG9sZGVycy4KCiAgICAgICAgbXkgJFRleHQgPSAkTGFuZ3VhZ2VPYmplY3QtPlRyYW5zbGF0ZSgnSGVsbG8gJXMhJywgJ3dvcmxkJyk7Cgo9Y3V0CgpzdWIgVHJhbnNsYXRlIHsKICAgIG15ICggJFNlbGYsICRUZXh0LCBAUGFyYW1ldGVycyApID0gQF87CgogICAgJFRleHQgLy89ICcnOwoKICAgICRUZXh0ID0gJFNlbGYtPntUcmFuc2xhdGlvbn0tPnskVGV4dH0gfHwgJFRleHQ7CgogICAgcmV0dXJuICRUZXh0IGlmICFAUGFyYW1ldGVyczsKCiAgICBmb3IgKCAwIC4uICQjUGFyYW1ldGVycyApIHsKICAgICAgICByZXR1cm4gJFRleHQgaWYgIWRlZmluZWQgJFBhcmFtZXRlcnNbJF9dOwogICAgICAgICRUZXh0ID1+IHMvXCUoc3xkKS8kUGFyYW1ldGVyc1skX10vOwogICAgfQoKICAgIHJldHVybiAkVGV4dDsKfQoKPWhlYWQyIEZvcm1hdFRpbWVTdHJpbmcoKQoKZm9ybWF0cyBhIHRpbWVzdGFtcCBhY2NvcmRpbmcgdG8gdGhlIHNwZWNpZmllZCBkYXRlIGZvcm1hdCBmb3IgdGhlIGN1cnJlbnQKbGFuZ3VhZ2UgKGxvY2FsZSkuCgogICAgbXkgJERhdGUgPSAkTGFuZ3VhZ2VPYmplY3QtPkZvcm1hdFRpbWVTdHJpbmcoCiAgICAgICAgJzIwMDktMTItMTIgMTI6MTI6MTInLCAgIyB0aW1lc3RhbXAKICAgICAgICAnRGF0ZUZvcm1hdCcsICAgICAgICAgICAjIHdoaWNoIGRhdGUgZm9ybWF0IHRvIHVzZSwgZS4gZy4gRGF0ZUZvcm1hdExvbmcKICAgICAgICAwLCAgICAgICAgICAgICAgICAgICAgICAjIG9wdGlvbmFsLCBoaWRlcyB0aGUgc2Vjb25kcyBmcm9tIHRoZSB0aW1lIG91dHB1dAogICAgKTsKClBsZWFzZSBub3RlIHRoYXQgdGhlIFRpbWVab25lIHdpbGwgbm90IGJlIGFwcGxpZWQgaW4gdGhlIGNhc2Ugb2YgRGF0ZUZvcm1hdFNob3J0IChkYXRlIG9ubHkpCnRvIGF2b2lkIHN3aXRjaGluZyB0byBhbm90aGVyIGRhdGUuCgpJZiB5b3Ugb25seSBwYXNzIGFuIElTTyBkYXRlICgnMjAwOS0xMi0xMicpLCBpdCB3aWxsIGJlIHJldHVybmVkIHVuY2hhbmdlZC4KSW52YWxpZCBzdHJpbmdzIHdpbGwgYWxzbyBiZSByZXR1cm5lZCB3aXRoIGFuIGVycm9yIGxvZ2dlZC4KCj1jdXQKCnN1YiBGb3JtYXRUaW1lU3RyaW5nIHsKICAgIG15ICggJFNlbGYsICRTdHJpbmcsICRDb25maWcsICRTaG9ydCwgJFdpdGhvdXRUWiApID0gQF87CgogICAgcmV0dXJuICcnIGlmICEkU3RyaW5nOwoKICAgICRDb25maWcgfHw9ICdEYXRlRm9ybWF0JzsKICAgICRTaG9ydCAgfHw9IDA7CgogICAgIyBWYWxpZCB0aW1lc3RhbXAKICAgIGlmICggJFN0cmluZyA9fiAvKFxkezR9KS0oXGR7Mn0pLShcZHsyfSlccyhcZHsyfSk6KFxkezJ9KTooXGR7Mn0pLyApIHsKICAgICAgICBteSAkUmV0dXJuU3RyaW5nID0gJFNlbGYtPnskQ29uZmlnfSB8fCAiJENvbmZpZyBuZWVkcyB0byBiZSB0cmFuc2xhdGVkISI7CgogICAgICAgIG15ICREYXRlVGltZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5DcmVhdGUoCiAgICAgICAgICAgICdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnLAogICAgICAgICAgICBPYmplY3RQYXJhbXMgPT4gewogICAgICAgICAgICAgICAgU3RyaW5nID0+ICRTdHJpbmcsCiAgICAgICAgICAgIH0sCiAgICAgICAgKTsKCiAgICAgICAgaWYgKCAhJERhdGVUaW1lT2JqZWN0ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiSW52YWxpZCBkYXRlL3RpbWUgc3RyaW5nICRTdHJpbmcuIiwKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIHJldHVybiAkU3RyaW5nOwogICAgICAgIH0KCiAgICAgICAgIyBDb252ZXJ0IHRvIHRpbWUgem9uZSwgYnV0IG9ubHkgaWYgd2UgYWN0dWFsbHkgZGlzcGxheSB0aGUgdGltZSEKICAgICAgICAjIE90aGVyd2lzZSB0aGUgZGF0ZSBtaWdodCBiZSBvZmYgYnkgb25lIGRheSBiZWNhdXNlIG9mIHRoZSBUaW1lWm9uZSBkaWZmLgogICAgICAgIGlmICggJFNlbGYtPntUaW1lWm9uZX0gJiYgJENvbmZpZyBuZSAnRGF0ZUZvcm1hdFNob3J0JyApIHsKICAgICAgICAgICAgJERhdGVUaW1lT2JqZWN0LT5Ub1RpbWVab25lKCBUaW1lWm9uZSA9PiAkU2VsZi0+e1RpbWVab25lfSApOwogICAgICAgIH0KCiAgICAgICAgbXkgJERhdGVUaW1lVmFsdWVzID0gJERhdGVUaW1lT2JqZWN0LT5HZXQoKTsKCiAgICAgICAgbXkgJFllYXIgICAgICA9ICREYXRlVGltZVZhbHVlcy0+e1llYXJ9OwogICAgICAgIG15ICRNb250aCAgICAgPSBzcHJpbnRmICIlMDJkIiwgJERhdGVUaW1lVmFsdWVzLT57TW9udGh9OwogICAgICAgIG15ICRNb250aEFiYnIgPSAkRGF0ZVRpbWVWYWx1ZXMtPntNb250aEFiYnJ9OwogICAgICAgIG15ICREYXkgICAgICAgPSBzcHJpbnRmICIlMDJkIiwgJERhdGVUaW1lVmFsdWVzLT57RGF5fTsKICAgICAgICBteSAkRGF5QWJiciAgID0gJERhdGVUaW1lVmFsdWVzLT57RGF5QWJicn07CiAgICAgICAgbXkgJEhvdXIgICAgICA9IHNwcmludGYgIiUwMmQiLCAkRGF0ZVRpbWVWYWx1ZXMtPntIb3VyfTsKICAgICAgICBteSAkTWludXRlICAgID0gc3ByaW50ZiAiJTAyZCIsICREYXRlVGltZVZhbHVlcy0+e01pbnV0ZX07CiAgICAgICAgbXkgJFNlY29uZCAgICA9IHNwcmludGYgIiUwMmQiLCAkRGF0ZVRpbWVWYWx1ZXMtPntTZWNvbmR9OwoKICAgICAgICBpZiAoJFNob3J0KSB7CiAgICAgICAgICAgICRSZXR1cm5TdHJpbmcgPX4gcy9cJVQvJEhvdXI6JE1pbnV0ZS9nOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJFJldHVyblN0cmluZyA9fiBzL1wlVC8kSG91cjokTWludXRlOiRTZWNvbmQvZzsKICAgICAgICB9CiAgICAgICAgJFJldHVyblN0cmluZyA9fiBzL1wlRC8kRGF5L2c7CiAgICAgICAgJFJldHVyblN0cmluZyA9fiBzL1wlTS8kTW9udGgvZzsKICAgICAgICAkUmV0dXJuU3RyaW5nID1+IHMvXCVZLyRZZWFyL2c7CgogICAgICAgICRSZXR1cm5TdHJpbmcgPX4gc3soXCVBKX17JFNlbGYtPlRyYW5zbGF0ZSgkRGF5QWJicik7fWVneDsKICAgICAgICAkUmV0dXJuU3RyaW5nCiAgICAgICAgICAgID1+IHN7KFwlQil9eyRTZWxmLT5UcmFuc2xhdGUoJE1vbnRoQWJicik7fWVneDsKCiAgICAgICAgIyBvdXRwdXQgdGltZSB6b25lIG9ubHkgaWYgaXQgZGlmZmVycyBmcm9tIE9UUlMnIHRpbWUgem9uZQogICAgICAgICMgUlMgV2l0aG91dFRaIC0g0LTQsNCx0Ysg0L3QtSDQtNC+0LHQsNCy0LvRj9GC0YwgKFRaKQogICAgICAgIGlmICgKICAgICAgICAgICAgISRXaXRob3V0VFogJiYKICAgICAgICAgICAgJENvbmZpZyBuZSAnRGF0ZUZvcm1hdFNob3J0JwogICAgICAgICAgICAmJiAkU2VsZi0+e1RpbWVab25lfQogICAgICAgICAgICAmJiAkU2VsZi0+e1RpbWVab25lfSBuZSBLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUtPk9UUlNUaW1lWm9uZUdldCgpCiAgICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiAkUmV0dXJuU3RyaW5nIC4gIiAoJFNlbGYtPntUaW1lWm9uZX0pIjsKICAgICAgICB9CgogICAgICAgIHJldHVybiAkUmV0dXJuU3RyaW5nOwogICAgfQoKICAgICMgSW52YWxpZCBzdHJpbmcgcGFzc2VkPyAoZG9uJ3QgbG9nIGZvciBJU08gZGF0ZXMpCiAgICBpZiAoICRTdHJpbmcgIX4gL14oXGR7Mn06XGR7Mn06XGR7Mn0pJC8gKSB7CiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgIFByaW9yaXR5ID0+ICdub3RpY2UnLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiTm8gRm9ybWF0VGltZVN0cmluZygpIHRyYW5zbGF0aW9uIGZvdW5kIGZvciAnJFN0cmluZycgc3RyaW5nISIsCiAgICAgICAgKTsKICAgIH0KCiAgICByZXR1cm4gJFN0cmluZzsKCn0KCj1oZWFkMiBHZXRSZWNvbW1lbmRlZENoYXJzZXQoKQoKREVQUkVDQVRFRC4gRG9uJ3QgdXNlIHRoaXMgZnVuY3Rpb24gYW55IG1vcmUsICd1dGYtOCcgaXMgYWx3YXlzIHRoZSBpbnRlcm5hbCBjaGFyc2V0LgoKUmV0dXJucyB0aGUgcmVjb21tZW5kZWQgY2hhcnNldCBmb3IgZnJvbnRlbmQgKGJhc2VkIG9uIHRyYW5zbGF0aW9uCmZpbGUgb3IgdXRmLTgpLgoKICAgIG15ICRDaGFyc2V0ID0gJExhbmd1YWdlT2JqZWN0LT5HZXRSZWNvbW1lbmRlZENoYXJzZXQoKS4KCj1jdXQKCnN1YiBHZXRSZWNvbW1lbmRlZENoYXJzZXQgewogICAgbXkgJFNlbGYgPSBzaGlmdDsKCiAgICByZXR1cm4gJ3V0Zi04JzsKfQoKPWhlYWQyIEdldFBvc3NpYmxlQ2hhcnNldHMoKQoKUmV0dXJucyBhbiBhcnJheSBvZiBwb3NzaWJsZSBjaGFyc2V0cyAoYmFzZWQgb24gdHJhbnNsYXRpb24gZmlsZSkuCgogICAgbXkgQENoYXJzZXRzID0gJExhbmd1YWdlT2JqZWN0LT5HZXRQb3NzaWJsZUNoYXJzZXRzKCkuCgo9Y3V0CgpzdWIgR2V0UG9zc2libGVDaGFyc2V0cyB7CiAgICBteSAkU2VsZiA9IHNoaWZ0OwoKICAgIHJldHVybiBAeyAkU2VsZi0+e0NoYXJzZXR9IH0gaWYgJFNlbGYtPntDaGFyc2V0fTsKICAgIHJldHVybjsKfQoKPWhlYWQyIFRpbWUoKQoKUmV0dXJucyBhIHRpbWUgc3RyaW5nIGluIGxhbmd1YWdlIGZvcm1hdCAoYmFzZWQgb24gdHJhbnNsYXRpb24gZmlsZSkuCgogICAgJFRpbWUgPSAkTGFuZ3VhZ2VPYmplY3QtPlRpbWUoCiAgICAgICAgQWN0aW9uID0+ICdHRVQnLAogICAgICAgIEZvcm1hdCA9PiAnRGF0ZUZvcm1hdCcsCiAgICApOwoKICAgICRUaW1lTG9uZyA9ICRMYW5ndWFnZU9iamVjdC0+VGltZSgKICAgICAgICBBY3Rpb24gPT4gJ0dFVCcsCiAgICAgICAgRm9ybWF0ID0+ICdEYXRlRm9ybWF0TG9uZycsCiAgICApOwoKICAgICRUaW1lTG9uZyA9ICRMYW5ndWFnZU9iamVjdC0+VGltZSgKICAgICAgICBBY3Rpb24gPT4gJ1JFVFVSTicsCiAgICAgICAgRm9ybWF0ID0+ICdEYXRlRm9ybWF0TG9uZycsCiAgICAgICAgWWVhciAgID0+IDE5NzcsCiAgICAgICAgTW9udGggID0+IDEwLAogICAgICAgIERheSAgICA9PiAyNywKICAgICAgICBIb3VyICAgPT4gMjAsCiAgICAgICAgTWludXRlID0+IDEwLAogICAgICAgIFNlY29uZCA9PiAwNSwKICAgICk7CgpUaGVzZSB0YWdzIGFyZSBzdXBwb3J0ZWQ6ICVBPVdlZWtEYXk7JUI9TG9uZ01vbnRoOyVUPVRpbWU7JUQ9RGF5OyVNPU1vbnRoOyVZPVllYXI7CgpOb3RlIHRoYXQgJUEgb25seSB3b3JrcyBjb3JyZWN0bHkgd2l0aCBBY3Rpb24gR0VULCBpdCBtaWdodCBiZSBkcm9wcGVkIG90aGVyd2lzZS4KCkFsc28gbm90ZSB0aGF0IGl0IGlzIGFsc28gcG9zc2libGUgdG8gcGFzcyBIVE1MIHN0cmluZ3MgZm9yIGRhdGUgaW5wdXQ6CgogICAgJFRpbWVMb25nID0gJExhbmd1YWdlT2JqZWN0LT5UaW1lKAogICAgICAgIEFjdGlvbiA9PiAnUkVUVVJOJywKICAgICAgICBGb3JtYXQgPT4gJ0RhdGVJbnB1dEZvcm1hdExvbmcnLAogICAgICAgIE1vZGUgICA9PiAnTm90TnVtZXJpYycsCiAgICAgICAgWWVhciAgID0+ICc8aW5wdXQgdmFsdWU9IjIwMTQiLz4nLAogICAgICAgIE1vbnRoICA9PiAnPGlucHV0IHZhbHVlPSIxIi8+JywKICAgICAgICBEYXkgICAgPT4gJzxpbnB1dCB2YWx1ZT0iMTAiLz4nLAogICAgICAgIEhvdXIgICA9PiAnPGlucHV0IHZhbHVlPSIxMSIvPicsCiAgICAgICAgTWludXRlID0+ICc8aW5wdXQgdmFsdWU9IjEyIi8+JywKICAgICAgICBTZWNvbmQgPT4gJzxpbnB1dCB2YWx1ZT0iMTMiLz4nLAogICAgKTsKCk5vdGUgdGhhdCAlQiBtYXkgbm90IHdvcmsgaW4gTm9uTnVtZXJpYyBtb2RlLgoKPWN1dAoKc3ViIFRpbWUgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICAjIGNoZWNrIG5lZWRlZCBzdHVmZgogICAgZm9yIChxdyhBY3Rpb24gRm9ybWF0KSkgewogICAgICAgIGlmICggISRQYXJhbXskX30gKSB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJOZWVkICRfISIsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CiAgICBteSAkUmV0dXJuU3RyaW5nID0gJFNlbGYtPnsgJFBhcmFte0Zvcm1hdH0gfSB8fCAnTmVlZCB0byBiZSB0cmFuc2xhdGVkISc7CiAgICBteSAoICRZZWFyLCAkTW9udGgsICRNb250aEFiYnIsICREYXksICREYXlBYmJyLCAkSG91ciwgJE1pbnV0ZSwgJFNlY29uZCApOwoKICAgICMgc2V0IG9yIGdldCB0aW1lCiAgICBpZiAoIGxjICRQYXJhbXtBY3Rpb259IGVxICdnZXQnICkgewoKICAgICAgICBteSAkRGF0ZVRpbWVPYmplY3QgPSAkS2VybmVsOjpPTS0+Q3JlYXRlKAogICAgICAgICAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICAgICAgICAgT2JqZWN0UGFyYW1zID0+IHsKICAgICAgICAgICAgICAgIFRpbWVab25lID0+ICRTZWxmLT57VGltZVpvbmV9LAogICAgICAgICAgICB9LAogICAgICAgICk7CiAgICAgICAgbXkgJERhdGVUaW1lVmFsdWVzID0gJERhdGVUaW1lT2JqZWN0LT5HZXQoKTsKCiAgICAgICAgJFllYXIgICAgICA9ICREYXRlVGltZVZhbHVlcy0+e1llYXJ9OwogICAgICAgICRNb250aCAgICAgPSBzcHJpbnRmICIlMDJkIiwgJERhdGVUaW1lVmFsdWVzLT57TW9udGh9OwogICAgICAgICRNb250aEFiYnIgPSAkRGF0ZVRpbWVWYWx1ZXMtPntNb250aEFiYnJ9OwogICAgICAgICREYXkgICAgICAgPSBzcHJpbnRmICIlMDJkIiwgJERhdGVUaW1lVmFsdWVzLT57RGF5fTsKICAgICAgICAkRGF5QWJiciAgID0gJERhdGVUaW1lVmFsdWVzLT57RGF5QWJicn07CiAgICAgICAgJEhvdXIgICAgICA9IHNwcmludGYgIiUwMmQiLCAkRGF0ZVRpbWVWYWx1ZXMtPntIb3VyfTsKICAgICAgICAkTWludXRlICAgID0gc3ByaW50ZiAiJTAyZCIsICREYXRlVGltZVZhbHVlcy0+e01pbnV0ZX07CiAgICAgICAgJFNlY29uZCAgICA9IHNwcmludGYgIiUwMmQiLCAkRGF0ZVRpbWVWYWx1ZXMtPntTZWNvbmR9OwogICAgfQogICAgZWxzaWYgKCBsYyAkUGFyYW17QWN0aW9ufSBlcSAncmV0dXJuJyApIHsKICAgICAgICAkWWVhciAgID0gJFBhcmFte1llYXJ9ICAgfHwgMDsKICAgICAgICAkTW9udGggID0gJFBhcmFte01vbnRofSAgfHwgMDsKICAgICAgICAkRGF5ICAgID0gJFBhcmFte0RheX0gICAgfHwgMDsKICAgICAgICAkSG91ciAgID0gJFBhcmFte0hvdXJ9ICAgfHwgMDsKICAgICAgICAkTWludXRlID0gJFBhcmFte01pbnV0ZX0gfHwgMDsKICAgICAgICAkU2Vjb25kID0gJFBhcmFte1NlY29uZH0gfHwgMDsKCiAgICAgICAgbXkgQE1vbnRoQWJicnMgPSBxdy9KYW4gRmViIE1hciBBcHIgTWF5IEp1biBKdWwgQXVnIFNlcCBPY3QgTm92IERlYy87CiAgICAgICAgJE1vbnRoQWJiciA9IGRlZmluZWQgJE1vbnRoICYmICRNb250aCA9fiBtL15cZCskLyA/ICRNb250aEFiYnJzWyAkTW9udGggLSAxIF0gOiAnJzsKICAgIH0KCiAgICAjIGRvIHJlcGxhY2UKICAgIGlmICggKCBsYyAkUGFyYW17QWN0aW9ufSBlcSAnZ2V0JyApIHx8ICggbGMgJFBhcmFte0FjdGlvbn0gZXEgJ3JldHVybicgKSApIHsKICAgICAgICBteSAkVGltZSA9ICcnOwogICAgICAgIGlmICggJFBhcmFte01vZGV9ICYmICRQYXJhbXtNb2RlfSA9fiAvXk5vdE51bWVyaWMkL2kgKSB7CiAgICAgICAgICAgIGlmICggISRTZWNvbmQgKSB7CiAgICAgICAgICAgICAgICAkVGltZSA9ICIkSG91cjokTWludXRlIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRUaW1lID0gIiRIb3VyOiRNaW51dGU6JFNlY29uZCI7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRUaW1lICA9IHNwcmludGYoICIlMDJkOiUwMmQ6JTAyZCIsICRIb3VyLCAkTWludXRlLCAkU2Vjb25kICk7CiAgICAgICAgICAgICREYXkgICA9IHNwcmludGYoICIlMDJkIiwgICAgICAgICAgICREYXkgKTsKICAgICAgICAgICAgJE1vbnRoID0gc3ByaW50ZiggIiUwMmQiLCAgICAgICAgICAgJE1vbnRoICk7CiAgICAgICAgfQogICAgICAgICRSZXR1cm5TdHJpbmcgPX4gcy9cJVQvJFRpbWUvZzsKICAgICAgICAkUmV0dXJuU3RyaW5nID1+IHMvXCVELyREYXkvZzsKICAgICAgICAkUmV0dXJuU3RyaW5nID1+IHMvXCVNLyRNb250aC9nOwogICAgICAgICRSZXR1cm5TdHJpbmcgPX4gcy9cJVkvJFllYXIvZzsKICAgICAgICAkUmV0dXJuU3RyaW5nID1+IHN7KFwlQSl9e2RlZmluZWQgJERheUFiYnIgPyAkU2VsZi0+VHJhbnNsYXRlKCREYXlBYmJyKSA6ICcnO31lZ3g7CiAgICAgICAgJFJldHVyblN0cmluZwogICAgICAgICAgICA9fiBzeyhcJUIpfXtkZWZpbmVkICRNb250aEFiYnIgPyAkU2VsZi0+VHJhbnNsYXRlKCRNb250aEFiYnIpIDogJyc7fWVneDsKICAgICAgICByZXR1cm4gJFJldHVyblN0cmluZzsKICAgIH0KCiAgICByZXR1cm4gJFJldHVyblN0cmluZzsKfQoKPWhlYWQyIExhbmd1YWdlQ2hlY2tzdW0oKQoKVGhpcyBmdW5jdGlvbiByZXR1cm5zIGFuIE1ENSBzdW0gdGhhdCBpcyBnZW5lcmF0ZWQgZnJvbSBhbGwgbG9hZGVkIGxhbmd1YWdlIGZpbGVzIGFuZCB0aGVpciBtb2RpZmljYXRpb24gdGltZXN0YW1wcy4KV2hlbmV2ZXIgYSBmaWxlIGlzIGNoYW5nZWQsIGFkZGVkIG9yIHJlbW92ZWQsIHRoaXMgY2hlY2tzdW0gd2lsbCBjaGFuZ2UuCgo9Y3V0CgpzdWIgTGFuZ3VhZ2VDaGVja3N1bSB7CiAgICBteSAkU2VsZiA9IHNoaWZ0OwoKICAgICMgQ3JlYXRlIGEgc3RyaW5nIHdpdGggZmlsZW5hbWVzIGFuZCBmaWxlIG1vZGlmaWNhdGlvbiB0aW1lcyBvZiB0aGUgbG9hZGVkIGxhbmd1YWdlIGZpbGVzLgogICAgbXkgJExhbmd1YWdlU3RyaW5nID0gJyc7CiAgICBmb3IgbXkgJEZpbGUgKCBAeyAkU2VsZi0+e0xhbmd1YWdlRmlsZXN9IH0gKSB7CgogICAgICAgICMgZ2V0IGZpbGUgbWV0YWRhdGEKICAgICAgICBteSAkU3RhdCA9IHN0YXQoJEZpbGUpOwoKICAgICAgICBpZiAoICEkU3RhdCApIHsKICAgICAgICAgICAgcHJpbnQgU1RERVJSICJFcnJvcjogY2Fubm90IHN0YXQgZmlsZSAnJEZpbGUnOiAkISI7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgICRMYW5ndWFnZVN0cmluZyAuPSAkRmlsZSAuICRTdGF0LT5tdGltZSgpOwogICAgfQoKICAgIHJldHVybiBEaWdlc3Q6Ok1ENTo6bWQ1X2hleCgkTGFuZ3VhZ2VTdHJpbmcpOwp9CgoxOwoKPWhlYWQxIFRFUk1TIEFORCBDT05ESVRJT05TCgpUaGlzIHNvZnR3YXJlIGlzIHBhcnQgb2YgdGhlIE9UUlMgcHJvamVjdCAoTDxodHRwczovL290cnMub3JnLz4pLgoKVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKdGhlIGVuY2xvc2VkIGZpbGUgQ09QWUlORyBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbiAoR1BMKS4gSWYgeW91CmRpZCBub3QgcmVjZWl2ZSB0aGlzIGZpbGUsIHNlZSBMPGh0dHBzOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvZ3BsLTMuMC50eHQ+LgoKPWN1dAo=</File>
        <File Location="Custom/Kernel/Output/HTML/ZZZLayout_ChallengeTokenCheck.pm" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6Ok91dHB1dDo6SFRNTDo6WlpaTGF5b3V0X0NoYWxsZW5nZVRva2VuQ2hlY2s7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cgp1c2UgS2VybmVsOjpTeXN0ZW06OlZhcmlhYmxlQ2hlY2sgcXcoSXNIYXNoUmVmV2l0aERhdGEpOwoKewogICAgbm8gd2FybmluZ3MgJ3JlZGVmaW5lJzsKCnN1YiBLZXJuZWw6Ok91dHB1dDo6SFRNTDo6TGF5b3V0OjpDaGFsbGVuZ2VUb2tlbkNoZWNrIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgIyByZXR1cm4gaWYgZmVhdHVyZSBpcyBkaXNhYmxlZAogICAgcmV0dXJuIDEgaWYgISRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyktPkdldCgnU2Vzc2lvbkNTUkZQcm90ZWN0aW9uJyk7CgogICAgIyBnZXQgY2hhbGxlbmdlIHRva2VuIGFuZCBjaGVjayBpdAogICAgIyBSUwogICAgbXkgJENoYWxsZW5nZVRva2VuID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OldlYjo6UmVxdWVzdCcpCiAgICAgICAgLT5HZXRQYXJhbSggUGFyYW0gPT4gJ0NoYWxsZW5nZVRva2VuJyApIHx8ICRQYXJhbXtDaGFsbGVuZ2VUb2tlbn0gfHwgJyc7CgogICAgIyBjaGVjayByZWd1bGFyIENoYWxsZW5nZVRva2VuCiAgICByZXR1cm4gMSBpZiAkQ2hhbGxlbmdlVG9rZW4gZXEgJFNlbGYtPntVc2VyQ2hhbGxlbmdlVG9rZW59OwoKICAgICMgY2hlY2sgQ2hhbGxlbmdlVG9rZW4gb2YgYWxsIG93biBzZXNzaW9ucwogICAgbXkgJFNlc3Npb25PYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6QXV0aFNlc3Npb24nKTsKICAgIG15IEBTZXNzaW9ucyAgICAgID0gJFNlc3Npb25PYmplY3QtPkdldEFsbFNlc3Npb25JRHMoKTsKCiAgICBTRVNTSU9OOgogICAgZm9yIG15ICRTZXNzaW9uSUQgKEBTZXNzaW9ucykgewogICAgICAgIG15ICVEYXRhID0gJFNlc3Npb25PYmplY3QtPkdldFNlc3Npb25JRERhdGEoIFNlc3Npb25JRCA9PiAkU2Vzc2lvbklEICk7CiAgICAgICAgbmV4dCBTRVNTSU9OIGlmICEkRGF0YXtVc2VySUR9OwogICAgICAgIG5leHQgU0VTU0lPTiBpZiAkRGF0YXtVc2VySUR9IG5lICRTZWxmLT57VXNlcklEfTsKICAgICAgICBuZXh0IFNFU1NJT04gaWYgISREYXRhe1VzZXJDaGFsbGVuZ2VUb2tlbn07CgogICAgICAgICMgY2hlY2sgQ2hhbGxlbmdlVG9rZW4KICAgICAgICByZXR1cm4gMSBpZiAkQ2hhbGxlbmdlVG9rZW4gZXEgJERhdGF7VXNlckNoYWxsZW5nZVRva2VufTsKICAgIH0KCiAgICAjIFJTCiAgICBpZiAoICRQYXJhbXtTaWxlbnR9ICkgewogICAgICAgIHJldHVybjsKICAgIH0KCiAgICAjIG5vIHZhbGlkIHRva2VuIGZvdW5kCiAgICBpZiAoICRQYXJhbXtUeXBlfSAmJiBsYyAkUGFyYW17VHlwZX0gZXEgJ2N1c3RvbWVyJyApIHsKICAgICAgICAkU2VsZi0+Q3VzdG9tZXJGYXRhbEVycm9yKAogICAgICAgICAgICBNZXNzYWdlID0+ICdJbnZhbGlkIENoYWxsZW5nZSBUb2tlbiEnLAogICAgICAgICk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICAkU2VsZi0+RmF0YWxFcnJvcigKICAgICAgICAgICAgTWVzc2FnZSA9PiAnSW52YWxpZCBDaGFsbGVuZ2UgVG9rZW4hJywKICAgICAgICApOwogICAgfQoKICAgIHJldHVybjsKfQoKCn0KCjE7Cg==</File>
        <File Location="scripts/test/RS_API/Requests.t" Permission="644" Encode="Base64">IyAtLQojIENvcHlyaWdodCAoQykgMjAwMS0yMDE3IE9UUlMgQUcsIGh0dHA6Ly9vdHJzLmNvbS8KIyAgICAgICAgICAgICAgIDIwMTgtMjAyMCBSYWRpYW50IFN5c3RlbSwgaHR0cDovL3JhZGlhbnRzeXN0ZW0uY29tLwojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMy4wLnR4dC4KIyAtLQoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwoKdXNlIERhdGE6OkR1bXBlcjsKdXNlIERhdGU6OlBhcnNlOwoKdXNlIExXUDo6VXNlckFnZW50Owp1c2UgSlNPTjo6WFM7Cgp1c2UgdmFycyAocXcoJFNlbGYpKTsKCiRLZXJuZWw6Ok9NLT5PYmplY3RQYXJhbUFkZCgKICAgICdLZXJuZWw6OlN5c3RlbTo6VW5pdFRlc3Q6OkhlbHBlcicgPT4gewogICAgICAgIFJlc3RvcmVEYXRhYmFzZSA9PiAwLAogICAgfSwKKTsKbXkgJEhlbHBlciA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpVbml0VGVzdDo6SGVscGVyJyk7Cm15ICRTVCA9ICRTZWxmLT57T3JpZ2luYWxTVERPVVR9OwoKbXkgJENvbmZpZ09iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyk7CgpteSAkVGlja2V0T2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlRpY2tldCcpOwpteSAkVXNlck9iamVjdCAgID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlVzZXInKTsKbXkgJEpTT05PYmplY3QgICA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpKU09OJyk7Cm15ICRIZWxwZXJPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VW5pdFRlc3Q6OkhlbHBlcicpOwoKbXkgJFRlc3RDcmVkaXRzID0gJENvbmZpZ09iamVjdC0+R2V0KCdSUzo6QVBJOjpUZXN0Jyk7CgpteSAkVVJMQmFzZSAgICAgICAgICA9ICRUZXN0Q3JlZGl0cy0+e0RvbWFpbn0uJy9vdHJzL2FwaSc7Cm15ICRUZXN0VXNlckxvZ2luICAgID0gJFRlc3RDcmVkaXRzLT57VXNlcn07Cm15ICRUZXN0VXNlclBhc3N3b3JkID0gJFRlc3RDcmVkaXRzLT57UGFzc3dvcmR9OwoKbXkgJVVzZXIgPSAkVXNlck9iamVjdC0+R2V0VXNlckRhdGEoCiAgICBVc2VyID0+ICRUZXN0VXNlckxvZ2luCik7CgpteSAkdWEgPSBMV1A6OlVzZXJBZ2VudC0+bmV3OwoKbXkgJUFnZW50Q3JlZGVudGlhbHMgPSAoCiAgICBVc2VyICAgICA9PiAkVGVzdFVzZXJMb2dpbiwKICAgIFBhc3N3b3JkID0+ICRUZXN0VXNlclBhc3N3b3JkCik7CgpteSAlR2xvYmFsQXV0aCA9ICgpOwoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMKIyAvYXV0aC9sb2dpbgojCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojINCj0YHQv9C10YjQvdCw0Y8g0LDQstGC0L7RgNC40LfQsNGG0LjRjwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgokU2VsZi0+VHJ1ZSgxLCAnL2F1dGgvbG9naW4gLSBzdWNjZXNzZnVsIGF1dGhlbnRpY2F0aW9uJyk7CnsKICAgIG15ICRSZXF1ZXN0ID0geyAlQWdlbnRDcmVkZW50aWFscyB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwoKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL2F1dGgvbG9naW4iICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwogICAgICAgIGlmICggJFNlbGYtPklzKCAkUmVzcG9uc2UtPntSZXNwb25zZX0sICdPSycsICdyZXNwb25zZSBvaycgKSApIHsKICAgICAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPntNZXNzYWdlfSwgJ1N1Y2Nlc3NmdWwgbG9naW4nLCAnbWVzc2FnZSBvaycgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCBsZW5ndGggJFJlc3BvbnNlLT57T1RSU0FnZW50SW50ZXJmYWNlfSwgMzIsICd0b2tlbiBvaycgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCBsZW5ndGggJFJlc3BvbnNlLT57Q2hhbGxlbmdlVG9rZW59LCAzMiwgJ2NoYWxsZW5nZSB0b2tlbiBvaycgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPntTZXR0aW5nc317TGFuZ3VhZ2V9LCAnZW4nLCAnbGFuZyBvaycgKTsKCiAgICAgICAgICAgIGZvciAocXcvIElEIEZpcnN0TmFtZSBMYXN0TmFtZSBVc2VyTG9naW4gRW1haWwgQXZhdGFyIEZ1bGxOYW1lIC8pIHsKICAgICAgICAgICAgICAgICRTZWxmLT5UcnVlKCBleGlzdHMgJFJlc3BvbnNlLT57TWV9eyRffSwgIiRfIG9rIiApOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0gPSAkUmVzcG9uc2UtPnsgT1RSU0FnZW50SW50ZXJmYWNlIH07CiAgICAgICAgICAgICRHbG9iYWxBdXRoeyBDaGFsbGVuZ2VUb2tlbiB9ICAgICA9ICRSZXNwb25zZS0+eyBDaGFsbGVuZ2VUb2tlbiB9OwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMg0J3QtdGD0LTQsNGH0L3QsNGPINCw0LLRgtC+0YDQuNC30LDRhtC40Y8KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKJFNlbGYtPlRydWUoMSwgJy9hdXRoL2xvZ2luIC0gZmFpbGVkIGF1dGhlbnRpY2F0aW9uJyk7Cgp7CiAgICBteSAkUmVxdWVzdCA9IHsgVXNlciA9PiAnYWJjZCcsIFBhc3N3b3JkID0+ICcxMjM0NScgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKCiAgICBteSAkcmVxID0gSFRUUDo6UmVxdWVzdC0+bmV3KCAnUE9TVCcsICIkVVJMQmFzZS9hdXRoL2xvZ2luIiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPntSZXNwb25zZX0sICdFUlJPUicsICdyZXNwb25zZSBlcnJvcicgKTsKICAgICAgICAkU2VsZi0+VHJ1ZSggJFJlc3BvbnNlLT57TWVzc2FnZX0gPX4gL15Mb2dpbiBmYWlsZWQvLCAnbWVzc2FnZSBub3Qgb2snICk7CiAgICB9IGVsc2UgewogICAgICAgIHByaW50ICRTVCAkUmVzdWx0LT5zdGF0dXNfbGluZTsKICAgIH0KfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMKIyAvYXV0aC9sb3N0UGFzc3dvcmQKIwojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiRTZWxmLT5UcnVlKDEsICcvYXV0aC9sb3N0UGFzc3dvcmQgLSBzZW5kIGVtYWlsJyk7Cgp7CiAgICAKICAgICMgVE9ETzog0LLQvtGB0L/RgNC+0LjQt9Cy0LXRgdGC0Lgg0L7RgtC60LvRjtGH0LXQvdC40LUg0YTRg9C90LrRhtC40L7QvdCw0LvQsCBMb3N0UGFzc3dvcmQKPWEKICAgIG15ICRDb25maWdPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpOwogICAgbXkgJEN1cnJlbnRMb3N0UGFzc3dvcmRTZXR0aW5nID0gJENvbmZpZ09iamVjdC0+R2V0KCdMb3N0UGFzc3dvcmQnKTsKCiAgICAkQ29uZmlnT2JqZWN0LT5TZXQoCiAgICAgICAgS2V5ICAgPT4gJ0xvc3RQYXNzd29yZCcsCiAgICAgICAgVmFsdWUgPT4gMAogICAgKTsKPWN1dAoKICAgIG15ICRSZXF1ZXN0ID0geyBVc2VyID0+ICdhc2RmQGFzZGYuY29tJyB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwoKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL2F1dGgvbG9zdFBhc3N3b3JkIiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPntSZXNwb25zZX0sICdPSycsICdyZXNwb25zZSBub3Qgb2snICk7CiAgICAgICAgJFNlbGYtPlRydWUoICRSZXNwb25zZS0+e01lc3NhZ2V9ID1+IC9eU2VudCBwYXNzd29yZC8sICdtZXNzYWdlIG9rJyApOwogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9CiAgICAjIFRPRE86INC00L7QsdCw0LLQuNGC0Ywg0L3QtdC/0L7RgdGA0LXQtNGB0YLQstC10L3QvdGL0Lkg0LLQsNGA0LjQsNC90YIg0LTQu9GPINGB0LHRgNC+0YHQsCDQv9Cw0YDQvtC70Y8sINC40YHQv9C+0LvRjNC30YPRjiDQv9C+0LvRg9GH0LXQvdC90YvQuSBUb2tlbgp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIwojIC9maWx0ZXJzL2dldFRpY2tldFZpZXdzCiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgokU2VsZi0+VHJ1ZSgxLCAnL2ZpbHRlcnMvZ2V0VGlja2V0Vmlld3MgLSBnZXQgdGlja2V0IHZpZXdzJyk7Cgp7CiAgICBteSAkUmVxdWVzdCA9IHsKICAgICAgICBPVFJTQWdlbnRJbnRlcmZhY2UgPT4gJEdsb2JhbEF1dGh7IE9UUlNBZ2VudEludGVyZmFjZSB9CiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvZmlsdGVycy9nZXRUaWNrZXRWaWV3cyIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57UmVzcG9uc2V9LCAnT0snLCAncmVzcG9uc2Ugb2snICk7CiAgICAgICAgJFNlbGYtPklzKCBzY2FsYXIgQHsgJFJlc3BvbnNlLT57R3JvdXBzfSB9LCA1LCAnZ3JvdXBzIGl0ZW1zIGxlbmd0aCcgKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIwojIC9xdWV1ZXMvZ2V0UXVldWVMaXN0CiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgokU2VsZi0+VHJ1ZSgxLCAnL3F1ZXVlcy9nZXRRdWV1ZUxpc3QgLSBnZXQgcXVldWUgbGlzdCcpOwoKewogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfQogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3F1ZXVlcy9nZXRRdWV1ZUxpc3QiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICAkU2VsZi0+SXMoICRSZXNwb25zZS0+e1Jlc3BvbnNlfSwgJ09LJywgJ3Jlc3BvbnNlIG9rJyApOwogICAgICAgICRTZWxmLT5UcnVlKCBzY2FsYXIgQHsgJFJlc3BvbnNlLT57UXVldWVzfSB9LCAncXVldWVzIGxlbmd0aCcgKTsKCiAgICAgICAgJFNlbGYtPlRydWUoICRSZXNwb25zZS0+e1F1ZXVlc31bMF17SUR9LCAncXVldWUgaWQnICk7CiAgICAgICAgJFNlbGYtPlRydWUoIGRlZmluZWQgJFJlc3BvbnNlLT57UXVldWVzfVswXXtUaXRsZX0sICdzZXJ2aWNlIHRpdGxlJyApOwogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL3NlcnZpY2VzL2dldFNlcnZpY2VMaXN0CiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgokU2VsZi0+VHJ1ZSgxLCAnL3NlcnZpY2VzL2dldFNlcnZpY2VMaXN0IC0gZ2V0IHNlcnZpY2UgbGlzdCcpOwoKewogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfQogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3NlcnZpY2VzL2dldFNlcnZpY2VMaXN0IiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPntSZXNwb25zZX0sICdPSycsICdyZXNwb25zZSBvaycgKTsKICAgICAgICAkU2VsZi0+VHJ1ZSggc2NhbGFyIEB7ICRSZXNwb25zZS0+e1NlcnZpY2VzfSB9LCAnc2VydmljZXMgbGVuZ3RoJyApOwoKICAgICAgICAkU2VsZi0+VHJ1ZSggJFJlc3BvbnNlLT57U2VydmljZXN9WzBde0lEfSwgJ3NlcnZpY2UgaWQnICk7CiAgICAgICAgJFNlbGYtPlRydWUoIGRlZmluZWQgJFJlc3BvbnNlLT57U2VydmljZXN9WzBde1RpdGxlfSwgJ3NlcnZpY2UgdGl0bGUnICk7CiAgICB9IGVsc2UgewogICAgICAgIHByaW50ICRTVCAkUmVzdWx0LT5zdGF0dXNfbGluZTsKICAgIH0KfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMKIyAvc2xhL2dldFNMQUxpc3QKIwojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiRTZWxmLT5UcnVlKDEsICcvc2xhL2dldFNMQUxpc3QgLSBnZXQgU0xBIGxpc3QnKTsKCnsKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0KICAgIH07CgogICAgbXkgJEpTT05TdHJpbmcgPSAkSlNPTk9iamVjdC0+RW5jb2RlKCBEYXRhID0+ICRSZXF1ZXN0ICk7CiAgICBteSAkcmVxID0gSFRUUDo6UmVxdWVzdC0+bmV3KCAnUE9TVCcsICIkVVJMQmFzZS9zbGEvZ2V0U0xBTGlzdCIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57UmVzcG9uc2V9LCAnT0snLCAncmVzcG9uc2Ugb2snICk7CiAgICAgICAgJFNlbGYtPlRydWUoIHNjYWxhciBAeyAkUmVzcG9uc2UtPnsgU0xBTGlzdCB9IH0sICdzbGEgbGlzdCBsZW5ndGgnICk7CgogICAgICAgICRTZWxmLT5UcnVlKCAkUmVzcG9uc2UtPntTTEFMaXN0fVswXXtJRH0sICdzbGEgaWQnICk7CiAgICAgICAgJFNlbGYtPlRydWUoIGRlZmluZWQgJFJlc3BvbnNlLT57U0xBTGlzdH1bMF17VGl0bGV9LCAnc2xhIHRpdGxlJyApOwogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL3VzZXJzL2dldFVzZXJMaXN0CiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgokU2VsZi0+VHJ1ZSgxLCAnL3VzZXJzL2dldFVzZXJMaXN0IC0gZ2V0IHVzZXIgbGlzdCcpOwoKewogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfQogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3VzZXJzL2dldFVzZXJMaXN0IiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsgIyDQuNCx0L4gSlNPTiBPVFJTINGA0LDQsdC+0YLQsNC10YIg0LrRgNC40LLQviDRgSBVVEY4CgogICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57UmVzcG9uc2V9LCAnT0snLCAncmVzcG9uc2Ugb2snICk7CiAgICAgICAgJFNlbGYtPlRydWUoIHNjYWxhciBAeyAkUmVzcG9uc2UtPnsgVXNlcnMgfSB9LCAndXNlciBsaXN0IGxlbmd0aCcgKTsKICAgICAgICAkU2VsZi0+VHJ1ZSggJFJlc3BvbnNlLT57IENvdW50IH0sICd1c2VyIGNvdW50JyApOwoKICAgICAgICBteSBAVXNlckZpZWxkcyA9IHF3LwogICAgICAgICAgICBBZG1pbkR5bmFtaWNGaWVsZHNPdmVydmlld1BhZ2VTaG93bgogICAgICAgICAgICBDaGFuZ2VUaW1lCiAgICAgICAgICAgIENyZWF0ZVRpbWUKICAgICAgICAgICAgT3V0T2ZPZmZpY2UKICAgICAgICAgICAgT3V0T2ZPZmZpY2VFbmREYXkKICAgICAgICAgICAgT3V0T2ZPZmZpY2VFbmRNb250aAogICAgICAgICAgICBPdXRPZk9mZmljZUVuZFllYXIKICAgICAgICAgICAgT3V0T2ZPZmZpY2VTdGFydERheQogICAgICAgICAgICBPdXRPZk9mZmljZVN0YXJ0TW9udGgKICAgICAgICAgICAgT3V0T2ZPZmZpY2VTdGFydFllYXIKICAgICAgICAgICAgVXNlckF1dGhCYWNrZW5kCiAgICAgICAgICAgIFVzZXJDaGFuZ2VPdmVydmlld1NtYWxsUGFnZVNob3duCiAgICAgICAgICAgIFVzZXJDb21tZW50CiAgICAgICAgICAgIFVzZXJDb25maWdJdGVtT3ZlcnZpZXdTbWFsbFBhZ2VTaG93bgogICAgICAgICAgICBVc2VyQ3JlYXRlTmV4dE1hc2sKICAgICAgICAgICAgVXNlckNyZWF0ZVdvcmtPcmRlck5leHRNYXNrCiAgICAgICAgICAgIFVzZXJFbWFpbAogICAgICAgICAgICBVc2VyRkFRSm91cm5hbE92ZXJ2aWV3U21hbGxQYWdlU2hvd24KICAgICAgICAgICAgVXNlckZBUU92ZXJ2aWV3U21hbGxQYWdlU2hvd24KICAgICAgICAgICAgVXNlckZpcnN0bmFtZQogICAgICAgICAgICBVc2VyRnVsbG5hbWUKICAgICAgICAgICAgVXNlckdvb2dsZUF1dGhlbnRpY2F0b3JTZWNyZXRLZXkKICAgICAgICAgICAgVXNlcklECiAgICAgICAgICAgIFVzZXJJVFNNQ2hhbmdlTWFuYWdlbWVudFRlbXBsYXRlRWRpdAogICAgICAgICAgICBVc2VyTGFuZ3VhZ2UKICAgICAgICAgICAgVXNlckxhc3RMb2dpbgogICAgICAgICAgICBVc2VyTGFzdExvZ2luVGltZXN0YW1wCiAgICAgICAgICAgIFVzZXJMYXN0bmFtZQogICAgICAgICAgICBVc2VyTG9naW4KICAgICAgICAgICAgVXNlckxvZ2luRmFpbGVkCiAgICAgICAgICAgIFVzZXJNb2JpbGUKICAgICAgICAgICAgVXNlclB3CiAgICAgICAgICAgIFVzZXJSZWZyZXNoVGltZQogICAgICAgICAgICBVc2VyU2tpbgogICAgICAgICAgICBVc2VyU3VydmV5T3ZlcnZpZXdTbWFsbFBhZ2VTaG93bgogICAgICAgICAgICBVc2VyVGlja2V0T3ZlcnZpZXdNZWRpdW1QYWdlU2hvd24KICAgICAgICAgICAgVXNlclRpY2tldE92ZXJ2aWV3UHJldmlld1BhZ2VTaG93bgogICAgICAgICAgICBVc2VyVGlja2V0T3ZlcnZpZXdTbWFsbFBhZ2VTaG93bgogICAgICAgICAgICBVc2VyVGl0bGUKICAgICAgICAgICAgVmFsaWRJRAogICAgICAgIC87CgogICAgICAgICMgVE9ETzog0YPRgtC+0YfQvdC40YLRjCDRg9GB0LvQvtCy0LjRjyDQv9GA0Lgg0LrQvtGC0L7RgNGL0YUg0L7QvdC4INC/0L7Rj9Cy0LvRj9GO0YLRgdGPCiAgICAgICAgbXkgJU9wdGlvbmFsRmllbGRzID0gKAogICAgICAgICAgICBBcHBvaW50bWVudE5vdGlmaWNhdGlvblRyYW5zcG9ydCAgICAgPT4gMSwKICAgICAgICAgICAgTm90aWZpY2F0aW9uVHJhbnNwb3J0ICAgICAgICAgICAgICAgID0+IDEsCiAgICAgICAgICAgIE91dE9mT2ZmaWNlICAgICAgICAgICAgICAgICAgICAgICAgICA9PiAxLAogICAgICAgICAgICBPdXRPZk9mZmljZUVuZERheSAgICAgICAgICAgICAgICAgICAgPT4gMSwKICAgICAgICAgICAgT3V0T2ZPZmZpY2VFbmRNb250aCAgICAgICAgICAgICAgICAgID0+IDEsCiAgICAgICAgICAgIE91dE9mT2ZmaWNlRW5kWWVhciAgICAgICAgICAgICAgICAgICA9PiAxLAogICAgICAgICAgICBPdXRPZk9mZmljZVN0YXJ0RGF5ICAgICAgICAgICAgICAgICAgPT4gMSwKICAgICAgICAgICAgT3V0T2ZPZmZpY2VTdGFydE1vbnRoICAgICAgICAgICAgICAgID0+IDEsCiAgICAgICAgICAgIE91dE9mT2ZmaWNlU3RhcnRZZWFyICAgICAgICAgICAgICAgICA9PiAxLAogICAgICAgICAgICBVc2VyQ29tbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgPT4gMSwKICAgICAgICAgICAgVXNlckdvb2dsZUF1dGhlbnRpY2F0b3JTZWNyZXRLZXkgICAgID0+IDEsCiAgICAgICAgICAgIFVzZXJJVFNNQ2hhbmdlTWFuYWdlbWVudFRlbXBsYXRlRWRpdCA9PiAxLAogICAgICAgICAgICBVc2VyTGFuZ3VhZ2UgICAgICAgICAgICAgICAgICAgICAgICAgPT4gMSwKICAgICAgICAgICAgVXNlck1vYmlsZSAgICAgICAgICAgICAgICAgICAgICAgICAgID0+IDEsCiAgICAgICAgICAgIFVzZXJTa2luICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9PiAxCiAgICAgICAgKTsKCiAgICAgICAgbXkgJFVzZXIgPSAkUmVzcG9uc2UtPnsgVXNlcnMgfVswXTsKCiAgICAgICAgZm9yICggQFVzZXJGaWVsZHMgKSB7CiAgICAgICAgICAgIGlmICggISRPcHRpb25hbEZpZWxkc3skX30gKSB7CiAgICAgICAgICAgICAgICAkU2VsZi0+VHJ1ZSggZXhpc3RzICRVc2VyLT57JF99LCAiJF8gZXhpc3RzIiApOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIwojIC9zZXR0aW5ncy9nZXRMYW5ndWFnZUxpc3QKIwojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiRTZWxmLT5UcnVlKDEsICcvc2V0dGluZ3MvZ2V0TGFuZ3VhZ2VMaXN0IC0gZ2V0IGxhbmd1YWdlIGxpc3QnKTsKCnsKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0KICAgIH07CgogICAgbXkgJEpTT05TdHJpbmcgPSAkSlNPTk9iamVjdC0+RW5jb2RlKCBEYXRhID0+ICRSZXF1ZXN0ICk7CiAgICBteSAkcmVxID0gSFRUUDo6UmVxdWVzdC0+bmV3KCAnUE9TVCcsICIkVVJMQmFzZS9zZXR0aW5ncy9nZXRMYW5ndWFnZUxpc3QiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBSZXNwb25zZSB9LCAnT0snLCAncmVzcG9uc2Ugb2snICk7CiAgICAgICAgJFNlbGYtPlRydWUoIHNjYWxhciBAeyAkUmVzcG9uc2UtPnsgTGFuZ3VhZ2VzIH0gfSwgJ2xhbmd1YWdlcyBsaXN0IGxlbmd0aCcgKTsKCiAgICAgICAgJFNlbGYtPlRydWUoICRSZXNwb25zZS0+eyBMYW5ndWFnZXMgfVswXXtJRH0sICdsYW5ndWFnZSBpZCcgKTsKICAgICAgICAkU2VsZi0+VHJ1ZSggZGVmaW5lZCAkUmVzcG9uc2UtPnsgTGFuZ3VhZ2VzIH1bMF17TmFtZX0sICdsYW5ndWFnZSBuYW1lJyApOwogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL2N1c3RvbWVycy9nZXRDdXN0b21lckxpc3QKIwojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiRTZWxmLT5UcnVlKDEsICcvY3VzdG9tZXJzL2dldEN1c3RvbWVyTGlzdCAtIGdldCBjdXN0b21lciBsaXN0Jyk7Cgp7CiAgICBteSAkUmVxdWVzdCA9IHsKICAgICAgICBPVFJTQWdlbnRJbnRlcmZhY2UgPT4gJEdsb2JhbEF1dGh7IE9UUlNBZ2VudEludGVyZmFjZSB9CiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvY3VzdG9tZXJzL2dldEN1c3RvbWVyTGlzdCIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFJlc3BvbnNlIH0sICdPSycsICdyZXNwb25zZSBvaycgKTsKICAgICAgICAkU2VsZi0+VHJ1ZSggc2NhbGFyIEB7ICRSZXNwb25zZS0+eyBDdXN0b21lckNvbXBhbmllcyB9IH0sICdjdXN0b21lciBjb21wYW5pZXMgbGlzdCBsZW5ndGgnICk7CgogICAgICAgICRTZWxmLT5UcnVlKCAkUmVzcG9uc2UtPnsgQ3VzdG9tZXJDb21wYW5pZXMgfVswXXsgQ3VzdG9tZXJJRCB9LCAnY29tcGFueSBpZCcgKTsKICAgICAgICAkU2VsZi0+VHJ1ZSggZGVmaW5lZCAkUmVzcG9uc2UtPnsgQ3VzdG9tZXJDb21wYW5pZXMgfVswXXsgTmFtZSB9LCAnY29tcGFueSBuYW1lJyApOwogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL2N1c3RvbWVycy9nZXRDdXN0b21lclVzZXJMaXN0CiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgokU2VsZi0+VHJ1ZSgxLCAnL2N1c3RvbWVycy9nZXRDdXN0b21lclVzZXJMaXN0IC0gZ2V0IGN1c3RvbWVyIHVzZXIgbGlzdCcpOwoKewogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfQogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL2N1c3RvbWVycy9nZXRDdXN0b21lclVzZXJMaXN0IiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ09LJywgJ3Jlc3BvbnNlIG9rJyApOwogICAgICAgICRTZWxmLT5UcnVlKCBzY2FsYXIgQHsgJFJlc3BvbnNlLT57IEN1c3RvbWVyVXNlcnMgfSB9LCAnY3VzdG9tZXIgdXNlcnMgbGlzdCBsZW5ndGgnICk7CgogICAgICAgICRTZWxmLT5UcnVlKCAkUmVzcG9uc2UtPnsgQ3VzdG9tZXJVc2VycyB9WzBdeyBDdXN0b21lclVzZXIgfSwgJ0N1c3RvbWVyVXNlcicgKTsKICAgICAgICAkU2VsZi0+VHJ1ZSggZGVmaW5lZCAkUmVzcG9uc2UtPnsgQ3VzdG9tZXJVc2VycyB9WzBdeyBGaXJzdG5hbWUgfSwgJ0ZpcnN0bmFtZScgKTsKICAgICAgICAkU2VsZi0+VHJ1ZSggZGVmaW5lZCAkUmVzcG9uc2UtPnsgQ3VzdG9tZXJVc2VycyB9WzBdeyBMYXN0bmFtZSB9LCAnTGFzdG5hbWUnICk7CiAgICAgICAgJFNlbGYtPlRydWUoIGRlZmluZWQgJFJlc3BvbnNlLT57IEN1c3RvbWVyVXNlcnMgfVswXXsgQXZhdGFyIH0sICdBdmF0YXInICk7CiAgICAgICAgJFNlbGYtPlRydWUoIGRlZmluZWQgJFJlc3BvbnNlLT57IEN1c3RvbWVyVXNlcnMgfVswXXsgTG9naW4gfSwgJ0xvZ2luJyApOwogICAgICAgICRTZWxmLT5UcnVlKCBkZWZpbmVkICRSZXNwb25zZS0+eyBDdXN0b21lclVzZXJzIH1bMF17IEVtYWlsIH0sICdFbWFpbCcgKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIwojIC9jdXN0b21lcnMvY3JlYXRlQ3VzdG9tZXJVc2VyCiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCj0YHQv9C10YjQvdC+0LUg0YHQvtC30LTQsNC90LjQtSDQutC70LjQtdC90YLQsAoKJFNlbGYtPlRydWUoMSwgJy9jdXN0b21lcnMvY3JlYXRlQ3VzdG9tZXJVc2VyIC0gY3JlYXRlIGN1c3RvbWVyIHVzZXInKTsKCnsKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwoKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5EbyggU1FMID0+IHF7CiAgICAgICAgREVMRVRFIEZST00gY3VzdG9tZXJfdXNlciBXSEVSRSBsb2dpbiA9ICdpdmFuaXZhbm9kJwogICAgfSk7CgogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfSwKICAgICAgICBGaXJzdG5hbWUgICAgICAgICAgPT4gJ9CY0LLQsNC9JywKICAgICAgICBMYXN0bmFtZSAgICAgICAgICAgPT4gJ9CY0LLQsNC90L7QsicsCiAgICAgICAgQ3VzdG9tZXJJRCAgICAgICAgID0+ICdpdmFuaXZhbm92IGx0ZCcsCiAgICAgICAgTG9naW4gICAgICAgICAgICAgID0+ICdpdmFuaXZhbm9kJywKICAgICAgICBFbWFpbCAgICAgICAgICAgICAgPT4gJ2l2YW5vdkByYWRpYW50cy5ydScsCiAgICAgICAgUGFzc3dvcmQgICAgICAgICAgID0+ICdhYmNkZWYnLAogICAgICAgIENvdW50cnkgICAgICAgICAgICA9PiAnUnVzc2lhJywKICAgICAgICBDaXR5ICAgICAgICAgICAgICAgPT4gJ01vc2NvdycsCiAgICAgICAgU3RyZWV0ICAgICAgICAgICAgID0+ICdwbC4gTGVuaW5hJywKICAgICAgICBaaXAgICAgICAgICAgICAgICAgPT4gMTExMTEsCiAgICAgICAgUGhvbmUgICAgICAgICAgICAgID0+IDIyMjIyLAogICAgICAgIE1vYmlsZSAgICAgICAgICAgICA9PiAzMzMzMywKICAgICAgICBGYXggICAgICAgICAgICAgICAgPT4gNDQ0NDQsCiAgICAgICAgVGl0bGUgICAgICAgICAgICAgID0+ICdMb3JkJywKICAgICAgICBDb21tZW50ICAgICAgICAgICAgPT4gJ0hpJywKICAgICAgICBJbnRlcmZhY2VMYW5ndWFnZSAgPT4gJ3J1JwogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL2N1c3RvbWVycy9jcmVhdGVDdXN0b21lclVzZXIiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKICAgICAgICB1c2UgdXRmODsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICBpZiAoICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFJlc3BvbnNlIH0sICdPSycsICdyZXNwb25zZSBvaycgKSApIHsKICAgICAgICAgICAgbXkgJEN1c3RvbWVyVXNlck9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDdXN0b21lclVzZXInKTsKICAgICAgICAgICAgbXkgJVVzZXIgPSAkQ3VzdG9tZXJVc2VyT2JqZWN0LT5DdXN0b21lclVzZXJEYXRhR2V0KAogICAgICAgICAgICAgICAgVXNlciA9PiAnaXZhbml2YW5vZCcKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICRTZWxmLT5JcyggJFVzZXJ7IFVzZXJGaXJzdG5hbWUgfSwgJ9CY0LLQsNC9JywgICAgICAgICAgICAgICAnRmlyc3RuYW1lJyAgICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFVzZXJ7IFVzZXJMYXN0bmFtZSAgfSwgJ9CY0LLQsNC90L7QsicsICAgICAgICAgICAgICdMYXN0bmFtZScgICAgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkVXNlcnsgVXNlckN1c3RvbWVySUR9LCAnaXZhbml2YW5vdiBsdGQnLCAgICAgJ0N1c3RvbWVySUQnICApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRVc2VyeyBVc2VyTG9naW4gICAgIH0sICdpdmFuaXZhbm9kJywgICAgICAgICAnTG9naW4nICAgICAgICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFVzZXJ7IFVzZXJFbWFpbCAgICAgfSwgJ2l2YW5vdkByYWRpYW50cy5ydScsICdFbWFpbCcgICAgICAgKTsKICAgICAgICAgICAgJFNlbGYtPlRydWUoIGRlZmluZWQgJFVzZXJ7IFVzZXJQYXNzd29yZCAgfSwgICAgICAgICAgICAgJ1Bhc3N3b3JkJyAgICApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRVc2VyeyBVc2VyQ291bnRyeSAgIH0sICdSdXNzaWEnLCAgICAgICAgICAgICAnVXNlckNvdW50cnknICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFVzZXJ7IFVzZXJDaXR5ICAgICAgfSwgJ01vc2NvdycsICAgICAgICAgICAgICdVc2VyQ2l0eScgICAgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkVXNlcnsgVXNlclN0cmVldCAgICB9LCAncGwuIExlbmluYScsICAgICAgICAgJ1VzZXJTdHJlZXQnICApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRVc2VyeyBVc2VyWmlwICAgICAgIH0sIDExMTExLCAgICAgICAgICAgICAgICAnVXNlclppcCcgICAgICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFVzZXJ7IFVzZXJQaG9uZSAgICAgfSwgMjIyMjIsICAgICAgICAgICAgICAgICdVc2VyUGhvbmUnICAgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkVXNlcnsgVXNlck1vYmlsZSAgICB9LCAzMzMzMywgICAgICAgICAgICAgICAgJ1VzZXJNb2JpbGUnICApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRVc2VyeyBVc2VyRmF4ICAgICAgIH0sIDQ0NDQ0LCAgICAgICAgICAgICAgICAnVXNlckZheCcgICAgICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFVzZXJ7IFVzZXJUaXRsZSAgICAgfSwgJ0xvcmQnLCAgICAgICAgICAgICAgICdVc2VyVGl0bGUnICAgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkVXNlcnsgVXNlckNvbW1lbnQgICB9LCAnSGknLCAgICAgICAgICAgICAgICAgJ1VzZXJDb21tZW50JyApOwoKICAgICAgICAgICAgbXkgJVByZWZlcmVuY2VzID0gJEN1c3RvbWVyVXNlck9iamVjdC0+R2V0UHJlZmVyZW5jZXMoCiAgICAgICAgICAgICAgICBVc2VySUQgPT4gJ2l2YW5pdmFub2QnCiAgICAgICAgICAgICk7CgogICAgICAgICAgICAkU2VsZi0+SXMoICRQcmVmZXJlbmNlc3sgVXNlckxhbmd1YWdlIH0sICdydScsICdVc2VyTGFuZ3VhZ2UnICk7CgogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q2FjaGUnKS0+Q2xlYW5VcDsKICAgICAgICB9CgogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMg0J/RgNC+0L/Rg9GJ0LXQvSDQvtCx0Y/Qt9Cw0YLQtdC70YzQvdGL0Lkg0LDRgNCz0YPQvNC10L3RgiDQv9GA0Lgg0YHQvtC30LTQsNC90LjQuCDQutC70LjQtdC90YLQsAoKJFNlbGYtPlRydWUoMSwgJy9jdXN0b21lcnMvY3JlYXRlQ3VzdG9tZXJVc2VyIC0gY3JlYXRlIGN1c3RvbWVyIHVzZXInKTsKCnsKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgRmlyc3RuYW1lICAgICAgICAgID0+ICfQmNCy0LDQvScsCiAgICAgICAgTGFzdG5hbWUgICAgICAgICAgID0+ICfQmNCy0LDQvdC+0LInLAogICAgICAgIEN1c3RvbWVySUQgICAgICAgICA9PiAnaXZhbml2YW5vdiBsdGQnLAogICAgICAgIEVtYWlsICAgICAgICAgICAgICA9PiAnaXZhbm92QHJhZGlhbnRzLnJ1JwogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL2N1c3RvbWVycy9jcmVhdGVDdXN0b21lclVzZXIiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKICAgICAgICB1c2UgdXRmODsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBSZXNwb25zZSB9LCAnRVJST1InLCAncmVzcG9uc2UgZXJyb3InICk7CiAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgTWVzc2FnZSB9LCAnUmVxdWlyZWQgZmllbGRzIGlzIG5vdCBkZWZpbmVkOiBMb2dpbicsICdtZXNzYWdlJyApOwoKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojINCe0YjQuNCx0LrQsCDQv9GA0Lgg0YHQvtC30LTQsNC90LjQuCDQutC70LjQtdC90YLQsAoKJFNlbGYtPlRydWUoMSwgJy9jdXN0b21lcnMvY3JlYXRlQ3VzdG9tZXJVc2VyIC0gZXJyb3InKTsKCnsKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgRmlyc3RuYW1lICAgICAgICAgID0+ICfQmNCy0LDQvScsCiAgICAgICAgTGFzdG5hbWUgICAgICAgICAgID0+ICfQmNCy0LDQvdC+0LInLAogICAgICAgIEN1c3RvbWVySUQgICAgICAgICA9PiAnaXZhbml2YW5vdiBsdGQnLAogICAgICAgIEVtYWlsICAgICAgICAgICAgICA9PiAnaXZhbm92cmFkaWFudHNydScsCiAgICAgICAgTG9naW4gICAgICAgICAgICAgID0+ICdhc2RmYWFhJywKICAgICAgICBVc2VyRmF4ICAgICAgICAgICAgPT4gJ0YneDEwMjQKICAgIH07CgogICAgbXkgJEpTT05TdHJpbmcgPSAkSlNPTk9iamVjdC0+RW5jb2RlKCBEYXRhID0+ICRSZXF1ZXN0ICk7CiAgICBteSAkcmVxID0gSFRUUDo6UmVxdWVzdC0+bmV3KCAnUE9TVCcsICIkVVJMQmFzZS9jdXN0b21lcnMvY3JlYXRlQ3VzdG9tZXJVc2VyIiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CiAgICAgICAgdXNlIHV0Zjg7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ0VSUk9SJywgJ3Jlc3BvbnNlIGVycm9yJyApOwogICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IE1lc3NhZ2UgfSwgIkNvdWxkbid0IGNyZWF0ZSBjdXN0b21lciB1c2VyIiwgJ21lc3NhZ2UnICk7CgogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL2N1c3RvbWVycy9nZXRDdXN0b21lclVzZXIKIwojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiMg0J/QvtC70YPRh9C10L3QuNC1INC60LvQuNC10L3RgtCwCgokU2VsZi0+VHJ1ZSgxLCAnL2N1c3RvbWVycy9nZXRDdXN0b21lclVzZXIgLSBnZXQgY3VzdG9tZXIgdXNlcicpOwoKewogICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkNhY2hlJyktPkNsZWFuVXA7CgogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfSwKICAgICAgICBDdXN0b21lclVzZXIgPT4gJ2l2YW5pdmFub2QnLAogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL2N1c3RvbWVycy9nZXRDdXN0b21lclVzZXIiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKICAgICAgICB1c2UgdXRmODsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICBpZiAoICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFJlc3BvbnNlIH0sICdPSycsICdyZXNwb25zZSBvaycgKSApIHsKICAgICAgICAgICAgbXkgJEN1c3RvbWVyVXNlck9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDdXN0b21lclVzZXInKTsKCiAgICAgICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFVzZXJGaXJzdG5hbWUgfSwgJ9CY0LLQsNC9JywgICAgICAgICAgICAgICAnRmlyc3RuYW1lJyAgICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFVzZXJMYXN0bmFtZSAgfSwgJ9CY0LLQsNC90L7QsicsICAgICAgICAgICAgICdMYXN0bmFtZScgICAgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgVXNlckN1c3RvbWVySUR9LCAnaXZhbml2YW5vdiBsdGQnLCAgICAgJ0N1c3RvbWVySUQnICApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBVc2VyTG9naW4gICAgIH0sICdpdmFuaXZhbm9kJywgICAgICAgICAnTG9naW4nICAgICAgICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFVzZXJFbWFpbCAgICAgfSwgJ2l2YW5vdkByYWRpYW50cy5ydScsICdFbWFpbCcgICAgICAgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgVXNlckNvdW50cnkgICB9LCAnUnVzc2lhJywgICAgICAgICAgICAgJ1VzZXJDb3VudHJ5JyApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBVc2VyQ2l0eSAgICAgIH0sICdNb3Njb3cnLCAgICAgICAgICAgICAnVXNlckNpdHknICAgICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFVzZXJTdHJlZXQgICAgfSwgJ3BsLiBMZW5pbmEnLCAgICAgICAgICdVc2VyU3RyZWV0JyAgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgVXNlclppcCAgICAgICB9LCAxMTExMSwgICAgICAgICAgICAgICAgJ1VzZXJaaXAnICAgICApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBVc2VyUGhvbmUgICAgIH0sIDIyMjIyLCAgICAgICAgICAgICAgICAnVXNlclBob25lJyAgICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFVzZXJNb2JpbGUgICAgfSwgMzMzMzMsICAgICAgICAgICAgICAgICdVc2VyTW9iaWxlJyAgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgVXNlckZheCAgICAgICB9LCA0NDQ0NCwgICAgICAgICAgICAgICAgJ1VzZXJGYXgnICAgICApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBVc2VyVGl0bGUgICAgIH0sICdMb3JkJywgICAgICAgICAgICAgICAnVXNlclRpdGxlJyAgICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFVzZXJDb21tZW50ICAgfSwgJ0hpJywgICAgICAgICAgICAgICAgICdVc2VyQ29tbWVudCcgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgVmFsaWRJRCAgICAgICB9LCAxLCAgICAgICAgICAgICAgICAgICAgJ1ZhbGlkSUQnICAgICApOwoKICAgICAgICAgICAgbXkgJVByZWZlcmVuY2VzID0gJEN1c3RvbWVyVXNlck9iamVjdC0+R2V0UHJlZmVyZW5jZXMoCiAgICAgICAgICAgICAgICBVc2VySUQgPT4gJ2l2YW5pdmFub2QnCiAgICAgICAgICAgICk7CgogICAgICAgICAgICAkU2VsZi0+SXMoICRQcmVmZXJlbmNlc3sgVXNlckxhbmd1YWdlIH0sICdydScsICdVc2VyTGFuZ3VhZ2UnICk7CgogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6REInKS0+RG8oIFNRTCA9PiBxewogICAgICAgICAgICAgICAgREVMRVRFIEZST00gY3VzdG9tZXJfdXNlciBXSEVSRSBsb2dpbiA9ICdpdmFuaXZhbm9kJwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwogICAgICAgIH0KCiAgICB9IGVsc2UgewogICAgICAgIHByaW50ICRTVCAkUmVzdWx0LT5zdGF0dXNfbGluZTsKICAgIH0KfQoKIyDQodC+0LfQtNCw0L3QuNC1INGC0LXRgdGC0L7QstC+0Lkg0LfQsNGP0LLQutC4CgpteSAkVGlja2V0SUQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRDcmVhdGUoCiAgICBUaXRsZSAgICAgID0+ICdUZXN0T25lVGVzdCcsCiAgICBCb2R5ICAgICAgID0+ICdPbmVUZXN0T25lJywKICAgIFN0YXRlICAgICAgPT4gJ25ldycsCiAgICBMb2NrICAgICAgID0+ICd1bmxvY2snLAogICAgUHJpb3JpdHlJRCA9PiAxLAogICAgUXVldWVJRCAgICA9PiAxLAogICAgT3duZXJJRCAgICA9PiAxLAogICAgVXNlcklEICAgICA9PiAxCik7CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIwojIC90aWNrZXRzL3VwZGF0ZVF1ZXVlCiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCY0LfQvNC10L3QtdC90LjQtSDQvtGH0LXRgNC10LTQuAoKJFNlbGYtPlRydWUoMSwgJy90aWNrZXRzL3VwZGF0ZVF1ZXVlIC0gdXBkYXRlIHF1ZXVlJyk7Cgp7CiAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q2FjaGUnKS0+Q2xlYW5VcDsKCiAgICBteSAkUmVxdWVzdCA9IHsKICAgICAgICBPVFJTQWdlbnRJbnRlcmZhY2UgPT4gJEdsb2JhbEF1dGh7IE9UUlNBZ2VudEludGVyZmFjZSB9LAogICAgICAgIFF1ZXVlSUQgICAgICAgICAgICA9PiAyLAogICAgICAgIFRpY2tldElEICAgICAgICAgICA9PiAkVGlja2V0SUQKICAgIH07CgogICAgbXkgJEpTT05TdHJpbmcgPSAkSlNPTk9iamVjdC0+RW5jb2RlKCBEYXRhID0+ICRSZXF1ZXN0ICk7CiAgICBteSAkcmVxID0gSFRUUDo6UmVxdWVzdC0+bmV3KCAnUE9TVCcsICIkVVJMQmFzZS90aWNrZXRzL3VwZGF0ZVF1ZXVlIiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgaWYgKCAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBSZXNwb25zZSB9LCAnT0snLCAncmVzcG9uc2Ugb2snICkgKSB7CiAgICAgICAgICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoIFRpY2tldElEID0+ICRUaWNrZXRJRCApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRUaWNrZXR7IFF1ZXVlSUQgfSwgMiwgJ3RpY2tldCBxdWV1ZSBpZCcpOwogICAgICAgIH0KCiAgICB9IGVsc2UgewogICAgICAgIHByaW50ICRTVCAkUmVzdWx0LT5zdGF0dXNfbGluZTsKICAgIH0KfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMKIyAvdGlja2V0cy91cGRhdGVUeXBlCiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCY0LfQvNC10L3QtdC90LjQtSDRgtC40L/QsAoKJFNlbGYtPlRydWUoMSwgJy90aWNrZXRzL3VwZGF0ZVR5cGUgLSB1cGRhdGUgdHlwZScpOwoKewogICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkNhY2hlJyktPkNsZWFuVXA7CgogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfSwKICAgICAgICBUeXBlICAgICAgICAgICAgICAgPT4gJ1Byb2JsZW0nLAogICAgICAgIFRpY2tldElEICAgICAgICAgICA9PiAkVGlja2V0SUQKICAgIH07CgogICAgbXkgJEpTT05TdHJpbmcgPSAkSlNPTk9iamVjdC0+RW5jb2RlKCBEYXRhID0+ICRSZXF1ZXN0ICk7CiAgICBteSAkcmVxID0gSFRUUDo6UmVxdWVzdC0+bmV3KCAnUE9TVCcsICIkVVJMQmFzZS90aWNrZXRzL3VwZGF0ZVR5cGUiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICBpZiAoICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFJlc3BvbnNlIH0sICdPSycsICdyZXNwb25zZSBvaycgKSApIHsKICAgICAgICAgICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCggVGlja2V0SUQgPT4gJFRpY2tldElEICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFRpY2tldHsgVHlwZSB9LCAnUHJvYmxlbScsICd0aWNrZXQgdHlwZScpOwogICAgICAgIH0KCiAgICB9IGVsc2UgewogICAgICAgIHByaW50ICRTVCAkUmVzdWx0LT5zdGF0dXNfbGluZTsKICAgIH0KfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMKIyAvdGlja2V0cy91cGRhdGVTZXJ2aWNlCiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCY0LfQvNC10L3QtdC90LjQtSDRgdC10YDQstC40YHQsAoKJFNlbGYtPlRydWUoMSwgJy90aWNrZXRzL3VwZGF0ZVNlcnZpY2UgLSB1cGRhdGUgc2VydmljZScpOwoKewogICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkNhY2hlJyktPkNsZWFuVXA7CgogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfSwKICAgICAgICBTZXJ2aWNlSUQgICAgICAgICAgPT4gMSwKICAgICAgICBUaWNrZXRJRCAgICAgICAgICAgPT4gJFRpY2tldElECiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvdGlja2V0cy91cGRhdGVTZXJ2aWNlIiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgaWYgKCAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBSZXNwb25zZSB9LCAnT0snLCAncmVzcG9uc2Ugb2snICkgKSB7CiAgICAgICAgICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoIFRpY2tldElEID0+ICRUaWNrZXRJRCApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRUaWNrZXR7IFNlcnZpY2VJRCB9LCAxLCAnU2VydmljZUlEJyk7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL3RpY2tldHMvdXBkYXRlU0xBCiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCY0LfQvNC10L3QtdC90LjQtSDRgdC10YDQstC40YHQsAoKJFNlbGYtPlRydWUoMSwgJy90aWNrZXRzL3VwZGF0ZVNMQSAtIHVwZGF0ZSBzbGEnKTsKCnsKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwoKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgU0xBSUQgICAgICAgICAgICAgID0+IDEsCiAgICAgICAgVGlja2V0SUQgICAgICAgICAgID0+ICRUaWNrZXRJRAogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3RpY2tldHMvdXBkYXRlU0xBIiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgaWYgKCAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBSZXNwb25zZSB9LCAnT0snLCAncmVzcG9uc2Ugb2snICkgKSB7CiAgICAgICAgICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoIFRpY2tldElEID0+ICRUaWNrZXRJRCApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRUaWNrZXR7IFNMQUlEIH0sIDEsICdTTEFJRCcpOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIwojIC90aWNrZXRzL3VwZGF0ZUN1c3RvbWVyCiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCY0LfQvNC10L3QtdC90LjQtSDQutC70LjQtdC90YLQsAoKJFNlbGYtPlRydWUoMSwgJy90aWNrZXRzL3VwZGF0ZUN1c3RvbWVyIC0gdXBkYXRlIGN1c3RvbWVyJyk7Cgp7CiAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q2FjaGUnKS0+Q2xlYW5VcDsKCiAgICBteSAkUmVxdWVzdCA9IHsKICAgICAgICBPVFJTQWdlbnRJbnRlcmZhY2UgPT4gJEdsb2JhbEF1dGh7IE9UUlNBZ2VudEludGVyZmFjZSB9LAogICAgICAgIFRpY2tldElEICAgICAgICAgICA9PiAkVGlja2V0SUQsCiAgICAgICAgQ3VzdG9tZXJJRCAgICAgICAgID0+ICdhYmNAcmFkaWFudHMuY29tJywgIyBDb21wYW55CiAgICAgICAgQ3VzdG9tZXJVc2VySUQgICAgID0+ICdhYmNAcmFkaWFudHMucnUnCiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvdGlja2V0cy91cGRhdGVDdXN0b21lciIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgIGlmICggJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ09LJywgJ3Jlc3BvbnNlIG9rJyApICkgewogICAgICAgICAgICBteSAlVGlja2V0ID0gJFRpY2tldE9iamVjdC0+VGlja2V0R2V0KCBUaWNrZXRJRCA9PiAkVGlja2V0SUQgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkVGlja2V0eyBDdXN0b21lcklEIH0sICAgICAnYWJjQHJhZGlhbnRzLmNvbScsICAnQ3VzdG9tZXJJRCcgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkVGlja2V0eyBDdXN0b21lclVzZXJJRCB9LCAnYWJjQHJhZGlhbnRzLnJ1JywgJ0N1c3RvbWVyVXNlcklEJyApOwogICAgICAgIH0KCiAgICB9IGVsc2UgewogICAgICAgIHByaW50ICRTVCAkUmVzdWx0LT5zdGF0dXNfbGluZTsKICAgIH0KfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMKIyAvdGlja2V0cy91cGRhdGVQZW5kaW5nVGltZQojCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyDQmNC30LzQtdC90LXQvdC40LUg0LrQu9C40LXQvdGC0LAKCiRTZWxmLT5UcnVlKDEsICcvdGlja2V0cy91cGRhdGVQZW5kaW5nVGltZSAtIHVwZGF0ZSBwZW5kaW5nIHRpbWUnKTsKCnsKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwoKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgVGlja2V0SUQgICAgICAgICAgID0+ICRUaWNrZXRJRCwKICAgICAgICBVbnRpbFRpbWVEYXRlVW5peCAgPT4gc3RyMnRpbWUoJzIwMjAtMTItMzEgMTI6MTI6MTInKQogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3RpY2tldHMvdXBkYXRlUGVuZGluZ1RpbWUiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICBpZiAoICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFJlc3BvbnNlIH0sICdPSycsICdyZXNwb25zZSBvaycgKSApIHsKICAgICAgICAgICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCggVGlja2V0SUQgPT4gJFRpY2tldElEICk7CiAgICAgICAgICAgICRTZWxmLT5UcnVlKCAkVGlja2V0eyBSZWFsVGlsbFRpbWVOb3RVc2VkIH0gKyAxMDAwID4gc3RyMnRpbWUoJzIwMjAtMTItMzEgMTI6MTI6MTInKSwgJ1VudGlsVGltZURhdGVVbml4JyApOwogICAgICAgIH0KCiAgICB9IGVsc2UgewogICAgICAgIHByaW50ICRTVCAkUmVzdWx0LT5zdGF0dXNfbGluZTsKICAgIH0KfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMKIyAvdGlja2V0cy91cGRhdGVMb2NrCiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCR0LvQvtC60LjRgNC+0LLQsNC90LjQtSDQt9Cw0Y/QstC60LgKCiRTZWxmLT5UcnVlKDEsICcvdGlja2V0cy91cGRhdGVMb2NrIC0gdXBkYXRlIGxvY2snKTsKCnsKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwoKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgVGlja2V0SUQgICAgICAgICAgID0+ICRUaWNrZXRJRCwKICAgICAgICBMb2NrICAgICAgICAgICAgICAgPT4gJ2xvY2snCiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvdGlja2V0cy91cGRhdGVMb2NrIiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgaWYgKCAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBSZXNwb25zZSB9LCAnT0snLCAncmVzcG9uc2Ugb2snICkgKSB7CiAgICAgICAgICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoIFRpY2tldElEID0+ICRUaWNrZXRJRCApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRUaWNrZXR7TG9ja30sICdsb2NrJywgJ0xvY2snICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFRpY2tldHtPd25lcn0sICRUZXN0VXNlckxvZ2luLCAnT3duZXInICk7CiAgICAgICAgfQoKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIwojIC90aWNrZXRzL3VwZGF0ZVN0YXRlCiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCY0LfQvNC10L3QtdC90LjQtSDRgdC+0YHRgtC+0Y/QvdC40Y8KCiRTZWxmLT5UcnVlKDEsICcvdGlja2V0cy91cGRhdGVTdGF0ZSAtIHVwZGF0ZSBzdGF0ZScpOwoKewogICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkNhY2hlJyktPkNsZWFuVXA7CgogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfSwKICAgICAgICBUaWNrZXRJRCAgICAgICAgICAgPT4gJFRpY2tldElELAogICAgICAgIFN0YXRlSUQgICAgICAgICAgICA9PiAxCiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvdGlja2V0cy91cGRhdGVTdGF0ZSIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgIGlmICggJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ09LJywgJ3Jlc3BvbnNlIG9rJyApICkgewogICAgICAgICAgICBteSAlVGlja2V0ID0gJFRpY2tldE9iamVjdC0+VGlja2V0R2V0KCBUaWNrZXRJRCA9PiAkVGlja2V0SUQgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkVGlja2V0eyBTdGF0ZUlEIH0sIDEsICdTdGF0ZUlEJyApOwogICAgICAgIH0KCiAgICB9IGVsc2UgewogICAgICAgIHByaW50ICRTVCAkUmVzdWx0LT5zdGF0dXNfbGluZTsKICAgIH0KfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMKIyAvdGlja2V0cy91cGRhdGVPd25lcgojCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyDQmNC30LzQtdC90LXQvdC40LUg0LLQu9Cw0LTQtdC70YzRhtCwCgokU2VsZi0+VHJ1ZSgxLCAnL3RpY2tldHMvdXBkYXRlT3duZXIgLSB1cGRhdGUgb3duZXInKTsKCnsKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwoKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgVGlja2V0SUQgICAgICAgICAgID0+ICRUaWNrZXRJRCwKICAgICAgICBOZXdVc2VySUQgICAgICAgICAgPT4gMgogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3RpY2tldHMvdXBkYXRlT3duZXIiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICBpZiAoICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFJlc3BvbnNlIH0sICdPSycsICdyZXNwb25zZSBvaycgKSApIHsKICAgICAgICAgICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCggVGlja2V0SUQgPT4gJFRpY2tldElEICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFRpY2tldHsgT3duZXJJRCB9LCAyLCAnT3duZXJJRCcgKTsKICAgICAgICB9CgogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL3RpY2tldHMvdXBkYXRlUmVzcG9uc2libGUKIwojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiMg0JjQt9C80LXQvdC10L3QuNC1IAoKJFNlbGYtPlRydWUoMSwgJy90aWNrZXRzL3VwZGF0ZVJlc3BvbnNpYmxlIC0gdXBkYXRlIG93bmVyJyk7Cgp7CiAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q2FjaGUnKS0+Q2xlYW5VcDsKCiAgICBteSAkUmVxdWVzdCA9IHsKICAgICAgICBPVFJTQWdlbnRJbnRlcmZhY2UgPT4gJEdsb2JhbEF1dGh7IE9UUlNBZ2VudEludGVyZmFjZSB9LAogICAgICAgIFRpY2tldElEICAgICAgICAgICA9PiAkVGlja2V0SUQsCiAgICAgICAgTmV3VXNlcklEICAgICAgICAgID0+IDIKICAgIH07CgogICAgbXkgJEpTT05TdHJpbmcgPSAkSlNPTk9iamVjdC0+RW5jb2RlKCBEYXRhID0+ICRSZXF1ZXN0ICk7CiAgICBteSAkcmVxID0gSFRUUDo6UmVxdWVzdC0+bmV3KCAnUE9TVCcsICIkVVJMQmFzZS90aWNrZXRzL3VwZGF0ZVJlc3BvbnNpYmxlIiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgaWYgKCAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBSZXNwb25zZSB9LCAnT0snLCAncmVzcG9uc2Ugb2snICkgKSB7CiAgICAgICAgICAgIG15ICVUaWNrZXQgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRHZXQoIFRpY2tldElEID0+ICRUaWNrZXRJRCApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRUaWNrZXR7IFJlc3BvbnNpYmxlSUQgfSwgMiwgJ1Jlc3BvbnNpYmxlSUQnICk7CiAgICAgICAgfQoKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIwojIC90aWNrZXRzL3VwZGF0ZVByaW9yaXR5CiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCY0LfQvNC10L3QtdC90LjQtSAKCiRTZWxmLT5UcnVlKDEsICcvdGlja2V0cy91cGRhdGVQcmlvcml0eSAtIHVwZGF0ZSBwcmlvcml0eScpOwoKewogICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkNhY2hlJyktPkNsZWFuVXA7CgogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfSwKICAgICAgICBUaWNrZXRJRCAgICAgICAgICAgPT4gJFRpY2tldElELAogICAgICAgIFByaW9yaXR5SUQgICAgICAgICAgPT4gMgogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3RpY2tldHMvdXBkYXRlUHJpb3JpdHkiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICBpZiAoICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFJlc3BvbnNlIH0sICdPSycsICdyZXNwb25zZSBvaycgKSApIHsKICAgICAgICAgICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCggVGlja2V0SUQgPT4gJFRpY2tldElEICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFRpY2tldHsgUHJpb3JpdHlJRCB9LCAyLCAnUHJpb3JpdHlJRCcgKTsKICAgICAgICB9CgogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL3RpY2tldHMvdXBkYXRlVGlja2V0CiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCY0LfQvNC10L3QtdC90LjQtSAKCiRTZWxmLT5UcnVlKDEsICcvdGlja2V0cy91cGRhdGVUaWNrZXQgLSB1cGRhdGUgdGlja2V0Jyk7Cgp7CiAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q2FjaGUnKS0+Q2xlYW5VcDsKCiAgICBteSAkUmVxdWVzdCA9IHsKICAgICAgICBPVFJTQWdlbnRJbnRlcmZhY2UgPT4gJEdsb2JhbEF1dGh7IE9UUlNBZ2VudEludGVyZmFjZSB9LAogICAgICAgIFRpdGxlICAgICAgICAgICAgICA9PiAnT2ZmaWNlJywKICAgICAgICBUeXBlSUQgICAgICAgICAgICAgPT4gMiwKICAgICAgICBRdWV1ZUlEICAgICAgICAgICAgPT4gMiwKICAgICAgICBQcmlvcml0eUlEICAgICAgICAgPT4gMiwKICAgICAgICBTZXJ2aWNlSUQgICAgICAgICAgPT4gMSwKICAgICAgICBTTEFJRCAgICAgICAgICAgICAgPT4gMSwKICAgICAgICBDdXN0b21lclVzZXJJRCAgICAgPT4gJ2FiY0BhYmMuY29tJywKICAgICAgICBDdXN0b21lcklEICAgICAgICAgPT4gJ2FiY2FiYycsCiAgICAgICAgTG9jayAgICAgICAgICAgICAgID0+ICdsb2NrJywKICAgICAgICBTdGF0ZUlEICAgICAgICAgICAgPT4gMywKICAgICAgICBOZXdPd25lcklEICAgICAgICAgPT4gMSwKICAgICAgICBOZXdSZXNwb25zaWJsZUlEICAgPT4gMiwKICAgICAgICBVbnRpbFRpbWVEYXRlVW5peCAgPT4gc3RyMnRpbWUoJzIwMjEtMTItMzEgMTI6MTI6MTInKSwKICAgICAgICBUaWNrZXRJRCAgICAgICAgICAgPT4gJFRpY2tldElECiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvdGlja2V0cy91cGRhdGVUaWNrZXQiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICBpZiAoICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFJlc3BvbnNlIH0sICdPSycsICdyZXNwb25zZSBvaycgKSApIHsKICAgICAgICAgICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCggVGlja2V0SUQgPT4gJFRpY2tldElEICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFRpY2tldHsgVGl0bGUgfSwgJ09mZmljZScsICdUaXRsZScgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkVGlja2V0eyBUeXBlSUQgfSwgMiwgJ1R5cGVJRCcgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkVGlja2V0eyBRdWV1ZUlEIH0sIDIsICdRdWV1ZUlEJyApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRUaWNrZXR7IFByaW9yaXR5SUQgfSwgMiwgJ1ByaW9yaXR5SUQnICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFRpY2tldHsgU2VydmljZUlEIH0sIDEsICdTZXJ2aWNlSUQnICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFRpY2tldHsgU0xBSUQgfSwgMSwgJ1NMQUlEJyApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRUaWNrZXR7IEN1c3RvbWVyVXNlcklEIH0sICdhYmNAYWJjLmNvbScsICdDdXN0b21lclVzZXJJRCcgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkVGlja2V0eyBDdXN0b21lcklEIH0sICdhYmNhYmMnLCAnQ3VzdG9tZXJJRCcgKTsKICAgICAgICAgICAgJFNlbGYtPlRydWUoICRUaWNrZXR7IFJlYWxUaWxsVGltZU5vdFVzZWQgfSArIDUwMDAgPiBzdHIydGltZSgnMjAxOS0xMi0zMSAxMjoxMjoxMicpLCAnVW50aWxUaW1lRGF0ZVVuaXgnICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFRpY2tldHsgTG9jayB9LCAnbG9jaycsICdMb2NrJyApOwogICAgICAgICAgICAkU2VsZi0+SXMoICRUaWNrZXR7IFN0YXRlSUQgfSwgMywgJ1N0YXRlSUQnICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFRpY2tldHsgT3duZXJJRCB9LCAxLCAnT3duZXJJRCcgKTsKICAgICAgICAgICAgJFNlbGYtPklzKCAkVGlja2V0eyBSZXNwb25zaWJsZUlEIH0sIDIsICdSZXNwb25zaWJsZUlEJyApOwogICAgICAgIH0KCiAgICB9IGVsc2UgewogICAgICAgIHByaW50ICRTVCAkUmVzdWx0LT5zdGF0dXNfbGluZTsKICAgIH0KfQoKIyDQmNC30LzQtdC90LXQvdC40LUg0L3QtdGD0LTQsNGH0L3QvgoKJFNlbGYtPlRydWUoMSwgJy90aWNrZXRzL3VwZGF0ZVRpY2tldCAtIHVwZGF0ZSB0aWNrZXQnKTsKCnsKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwoKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgTG9jayAgICAgICAgICAgICAgID0+ICdhc2RmJywKICAgICAgICBUaWNrZXRJRCAgICAgICAgICAgPT4gJFRpY2tldElELAogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3RpY2tldHMvdXBkYXRlVGlja2V0IiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ0VSUk9SJywgJ3Jlc3BvbnNlIGVycm9yJyApOwogICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IE1lc3NhZ2UgfSwgIlRoZSBmb2xsb3cgcGFyYW1ldGVycyB3YXNuJ3QgdXBkYXRlZDogTG9jayIsICdtZXNzYWdlJyk7CiAgICB9IGVsc2UgewogICAgICAgIHByaW50ICRTVCAkUmVzdWx0LT5zdGF0dXNfbGluZTsKICAgIH0KfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMKIyAvdGlja2V0cy91cGRhdGVBcmNoaXZlRmxhZwojCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyDQpNC70LDQsyDQt9Cw0Y/QstC60LgKCj1hCiMgVE9ETzog0LHQtdC3INC90LDRgdGC0YDQvtC50LrQuCBUaWNrZXQ6OkFyY2hpdmVGbGFnINC90LUg0L/RgNC+0LLQtdGA0LjRgtGMCiRTZWxmLT5UcnVlKDEsICcvdGlja2V0cy91cGRhdGVBcmNoaXZlRmxhZyAtIHVwZGF0ZSBhcmNoaXZlIGZsYWcnKTsKCnsKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgVGlja2V0SUQgICAgICAgICAgID0+ICRUaWNrZXRJRCwKICAgICAgICBBcmNoaXZlRmxhZyAgICAgICAgPT4gJ3knCiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvdGlja2V0cy91cGRhdGVBcmNoaXZlRmxhZyIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSAkSlNPTk9iamVjdC0+RGVjb2RlKCBEYXRhID0+ICRSZXN1bHQtPmRlY29kZWRfY29udGVudCApOwoKICAgICAgICBpZiAoICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFJlc3BvbnNlIH0sICdPSycsICdyZXNwb25zZSBvaycgKSApIHsKICAgICAgICAgICAgbXkgJVRpY2tldCA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEdldCggVGlja2V0SUQgPT4gJFRpY2tldElEICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFRpY2tldHsgQXJjaGl2ZUZsYWcgfSwgJ3knLCAnQXJjaGl2ZUZsYWcnICk7CiAgICAgICAgfQoKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9Cj1jdXQKCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL3RpY2tldHMvZ2V0VGlja2V0TGlzdAojCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyDQn9C+0LvRg9GH0LjRgtGMINGB0L/QuNGB0L7QuiDQt9Cw0Y/QstC+0LoKCiRTZWxmLT5UcnVlKDEsICcvdGlja2V0cy9nZXRUaWNrZXRMaXN0IC0gZ2V0IHRpY2tldCBsaXN0Jyk7Cgp7CiAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q2FjaGUnKS0+Q2xlYW5VcDsKCiAgICBteSAkUmVxdWVzdCA9IHsKICAgICAgICBPVFJTQWdlbnRJbnRlcmZhY2UgPT4gJEdsb2JhbEF1dGh7IE9UUlNBZ2VudEludGVyZmFjZSB9LAogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3RpY2tldHMvZ2V0VGlja2V0TGlzdCIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgIGlmICggJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ09LJywgJ3Jlc3BvbnNlIG9rJyApICkgewogICAgICAgICAgICAkU2VsZi0+VHJ1ZSggc2NhbGFyIEB7ICRSZXNwb25zZS0+eyBUaWNrZXRzIH0gfSwgJ3RpY2tldHMgbGVuZ3RoJyApOwogICAgICAgICAgICAjIFRPRE86INC/0L7QtNGA0L7QsdC90YvQuSDRgtC10YHRgiDQtNC70Y8g0LLRgdC10YUg0YHQu9GD0YfQsNC10LIKICAgICAgICB9CgogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL3RpY2tldHMvY3JlYXRlVGlja2V0CiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCh0L7Qt9C00LDRgtGMINC30LDRj9Cy0LrRgwoKJFNlbGYtPlRydWUoMSwgJy90aWNrZXRzL2NyZWF0ZVRpY2tldCAtIGNyZWF0ZSB0aWNrZXQnKTsKCm15ICROZXdUaWNrZXRJRCA9IDA7CnsKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwoKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgVGl0bGUgICAgICA9PiAnTm90ZScsCiAgICAgICAgQm9keSAgICAgICA9PiAnQm9vaycsCiAgICAgICAgUXVldWVJRCAgICA9PiAxLAogICAgICAgIFByaW9yaXR5SUQgPT4gMSwKCiAgICAgICAgQXJ0aWNsZVR5cGUgICAgICAgPT4gJ2VtYWlsJywKICAgICAgICBTZW5kZXJUeXBlICAgICAgICA9PiAnYWdlbnQnLAogICAgICAgIE93bmVySUQgICAgICAgICAgID0+IDEsCiAgICAgICAgTG9jayAgICAgICAgICAgICAgPT4gJ2xvY2snLAogICAgICAgIEZyb20gICAgICAgICAgICAgID0+ICdzeXN0ZW0nLAogICAgICAgIFRvICAgICAgICAgICAgICAgID0+ICdkZGRkQHJhZGlhbnRzLnJ1JywKICAgICAgICBDYyAgICAgICAgICAgICAgICA9PiAnZWVlZUByYWRpYW50cy5ydScsCiAgICAgICAgUmVwbHlUbyAgICAgICAgICAgPT4gJ2ZmZkByYWRpYW50cy5ydScsCiAgICAgICAgQ29udGVudFR5cGUgICAgICAgPT4gJ3RleHQvaHRtbCcsCiAgICAgICAgQ3VzdG9tZXJJRCAgICAgICAgPT4gJ2ZmZmYnLAogICAgICAgIEN1c3RvbWVyVXNlciAgICAgID0+ICdhc2RmJywKICAgICAgICBTdGF0ZUlEICAgICAgICAgICA9PiAxLAogICAgICAgIEVzdGltYXRlZCAgICAgICAgID0+IDEwLAogICAgICAgIFVudGlsVGltZURhdGVVbml4ID0+IHN0cjJ0aW1lKCcyMDIwLTA1LTA0IDEyOjEyOjEyJykKICAgIH07CgogICAgbXkgJEpTT05TdHJpbmcgPSAkSlNPTk9iamVjdC0+RW5jb2RlKCBEYXRhID0+ICRSZXF1ZXN0ICk7CiAgICBteSAkcmVxID0gSFRUUDo6UmVxdWVzdC0+bmV3KCAnUE9TVCcsICIkVVJMQmFzZS90aWNrZXRzL2NyZWF0ZVRpY2tldCIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgIGlmICggJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ09LJywgJ3Jlc3BvbnNlIG9rJyApICkgewogICAgICAgICAgICAkTmV3VGlja2V0SUQgPSAkUmVzcG9uc2UtPnsgVGlja2V0SUQgfTsKICAgICAgICAgICAgJFNlbGYtPlRydWUoICRSZXNwb25zZS0+eyBUaWNrZXRJRCB9LCAndGlja2V0IGlkJyApOwogICAgICAgICAgICAjIFRPRE86INC/0L7QtNGA0L7QsdC90YvQuSDRgtC10YHRgiDQtNC70Y8g0LLRgdC10YUg0YHQu9GD0YfQsNC10LIKICAgICAgICB9CgogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL3RpY2tldHMvY3JlYXRlQXJ0aWNsZQojCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyDQodC+0LfQtNCw0YLRjCDQt9Cw0Y/QstC60YMKCiRTZWxmLT5UcnVlKDEsICcvdGlja2V0cy9jcmVhdGVBcnRpY2xlIC0gY3JlYXRlIGFydGljbGUnKTsKCm15ICRBcnRpY2xlSUQgPSAwOwp7CiAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q2FjaGUnKS0+Q2xlYW5VcDsKCiAgICBteSAkUmVxdWVzdCA9IHsKICAgICAgICBPVFJTQWdlbnRJbnRlcmZhY2UgPT4gJEdsb2JhbEF1dGh7IE9UUlNBZ2VudEludGVyZmFjZSB9LAogICAgICAgIFN1YmplY3QgICA9PiAnT25lJywKICAgICAgICBCb2R5ICAgICAgPT4gJ1R3bycsCiAgICAgICAgRXN0aW1hdGVkID0+IDIsCiAgICAgICAgVGlja2V0SUQgID0+ICRUaWNrZXRJRCwKICAgICAgICBVbnRpbFRpbWVEYXRlVW5peCAgPT4gc3RyMnRpbWUoJzIwMjEtMTItMzEgMTI6MTI6MTInKQogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3RpY2tldHMvY3JlYXRlQXJ0aWNsZSIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgIGlmICggJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ09LJywgJ3Jlc3BvbnNlIG9rJyApICkgewogICAgICAgICAgICAkQXJ0aWNsZUlEID0gJFJlc3BvbnNlLT57IEFydGljbGVJRCB9OwogICAgICAgICAgICAkU2VsZi0+VHJ1ZSggJFJlc3BvbnNlLT57IEFydGljbGVJRCB9LCAnYXJ0aWNsZSBpZCcgKTsKICAgICAgICAgICAgIyBUT0RPOiDQv9C+0LTRgNC+0LHQvdGL0Lkg0YLQtdGB0YIg0LTQu9GPINCy0YHQtdGFINGB0LvRg9GH0LDQtdCyCiAgICAgICAgfQoKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIwojIC90aWNrZXRzL2dldEFydGljbGVzCiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCf0L7Qu9GD0YfQuNGC0Ywg0LfQsNC80LXRgtC60LgKCiRTZWxmLT5UcnVlKDEsICcvdGlja2V0cy9nZXRBcnRpY2xlcyAtIGdldCBhcnRpY2xlcycpOwoKewogICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkNhY2hlJyktPkNsZWFuVXA7CgogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfSwKICAgICAgICBUaWNrZXRJRCAgICAgICAgICAgPT4gJFRpY2tldElECiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvdGlja2V0cy9nZXRBcnRpY2xlcyIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgIGlmICggJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ09LJywgJ3Jlc3BvbnNlIG9rJyApICkgewogICAgICAgICAgICAkU2VsZi0+VHJ1ZSggc2NhbGFyIEB7ICRSZXNwb25zZS0+eyBBcnRpY2xlcyB9IH0sICdhcnRpY2xlcycgKTsKICAgICAgICAgICAgIyBUT0RPOiDQv9C+0LTRgNC+0LHQvdGL0Lkg0YLQtdGB0YIg0LTQu9GPINCy0YHQtdGFINGB0LvRg9GH0LDQtdCyCiAgICAgICAgfQoKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIwojIC90aWNrZXRzL3dhdGNoVGlja2V0CiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCh0LvQtdC00LjRgtGMCgokU2VsZi0+VHJ1ZSgxLCAnL3RpY2tldHMvd2F0Y2hUaWNrZXQgLSB3YXRjaCB0aWNrZXQnKTsKCnsKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwoKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgVGlja2V0SUQgICAgICAgICAgID0+ICRUaWNrZXRJRCwKICAgICAgICBTdWJzY3JpYmUgICAgICAgICAgPT4gMQogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3RpY2tldHMvd2F0Y2hUaWNrZXQiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICBpZiAoICRTZWxmLT5JcyggJFJlc3BvbnNlLT57IFJlc3BvbnNlIH0sICdPSycsICdyZXNwb25zZSBvaycgKSApIHsKICAgICAgICAgICAgbXkgQFdhdGNoZXJzID0gJFRpY2tldE9iamVjdC0+VGlja2V0V2F0Y2hHZXQoCiAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkVGlja2V0SUQsCiAgICAgICAgICAgICAgICBSZXN1bHQgICA9PiAnQVJSQVknCiAgICAgICAgICAgICk7CiAgICAgICAgICAgICRTZWxmLT5JcyggJFdhdGNoZXJzWzBdLCAkVXNlcntVc2VySUR9LCAnd2F0Y2hlcicgKTsKICAgICAgICB9CgogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMg0J3QtSDRgdC70LXQtNC40YLRjAoKewogICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkNhY2hlJyktPkNsZWFuVXA7CgogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfSwKICAgICAgICBUaWNrZXRJRCAgICAgICAgICAgPT4gJFRpY2tldElELAogICAgICAgIFN1YnNjcmliZSAgICAgICAgICA9PiAwCiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvdGlja2V0cy93YXRjaFRpY2tldCIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgIGlmICggJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ09LJywgJ3Jlc3BvbnNlIG9rJyApICkgewogICAgICAgICAgICBteSBAV2F0Y2hlcnMgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRXYXRjaEdldCgKICAgICAgICAgICAgICAgIFRpY2tldElEID0+ICRUaWNrZXRJRCwKICAgICAgICAgICAgICAgIFJlc3VsdCAgID0+ICdBUlJBWScKICAgICAgICAgICAgKTsKICAgICAgICAgICAgJFNlbGYtPlRydWUoICFAV2F0Y2hlcnMsICdubyB3YXRjaGVycycgKTsKICAgICAgICB9CgogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL3RpY2tldHMvbWFya1RpY2tldEFzU2VlbgojCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyDQodC70LXQtNC40YLRjAoKJFNlbGYtPlRydWUoMSwgJy90aWNrZXRzL21hcmtUaWNrZXRBc1NlZW4gLSBtYXJrIHRpY2tldCcpOwoKewogICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkNhY2hlJyktPkNsZWFuVXA7CgogICAgbXkgJFJlcXVlc3QgPSB7CiAgICAgICAgT1RSU0FnZW50SW50ZXJmYWNlID0+ICRHbG9iYWxBdXRoeyBPVFJTQWdlbnRJbnRlcmZhY2UgfSwKICAgICAgICBUaWNrZXRJRCAgICAgICAgICAgPT4gJFRpY2tldElELAogICAgICAgIFNlZW4gICAgICAgICAgICAgICA9PiAxCiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvdGlja2V0cy9tYXJrVGlja2V0QXNTZWVuIiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgaWYgKCAkU2VsZi0+SXMoICRSZXNwb25zZS0+eyBSZXNwb25zZSB9LCAnT0snLCAncmVzcG9uc2Ugb2snICkgKSB7CiAgICAgICAgICAgIG15ICVGbGFncyA9ICRUaWNrZXRPYmplY3QtPlRpY2tldEZsYWdHZXQoCiAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkVGlja2V0SUQsCiAgICAgICAgICAgICAgICBVc2VySUQgICA9PiAkVXNlcntVc2VySUR9CiAgICAgICAgICAgICk7CiAgICAgICAgICAgICRTZWxmLT5UcnVlKCAkRmxhZ3N7IFNlZW4gfSwgJ3RpY2tldCBzZWVuJyk7CiAgICAgICAgfQoKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojINCd0LUg0YHQu9C10LTQuNGC0YwKCiRTZWxmLT5UcnVlKDEsICcvdGlja2V0cy9tYXJrVGlja2V0QXNTZWVuIC0gbWFyayB0aWNrZXQnKTsKCnsKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwoKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgVGlja2V0SUQgICAgICAgICAgID0+ICRUaWNrZXRJRCwKICAgICAgICBTZWVuICAgICAgICAgICAgICAgPT4gMAogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL3RpY2tldHMvbWFya1RpY2tldEFzU2VlbiIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgIGlmICggJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ09LJywgJ3Jlc3BvbnNlIG9rJyApICkgewogICAgICAgICAgICBteSAlRmxhZ3MgPSAkVGlja2V0T2JqZWN0LT5UaWNrZXRGbGFnR2V0KAogICAgICAgICAgICAgICAgVGlja2V0SUQgPT4gJFRpY2tldElELAogICAgICAgICAgICAgICAgVXNlcklEICAgPT4gJFVzZXJ7VXNlcklEfQogICAgICAgICAgICApOwogICAgICAgICAgICAkU2VsZi0+VHJ1ZSggISRGbGFnc3sgU2VlbiB9LCAndGlja2V0IG5vdCBzZWVuJyk7CiAgICAgICAgfQoKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnQgJFNUICRSZXN1bHQtPnN0YXR1c19saW5lOwogICAgfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIwojIC90aWNrZXRzL21hcmtBcnRpY2xlQXNTZWVuCiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojINCf0YDQvtGH0LjRgtCw0L3QvdCw0Y8g0LfQsNC80LXRgtC60LAKCiRTZWxmLT5UcnVlKDEsICcvdGlja2V0cy9tYXJrQXJ0aWNsZUFzU2VlbiAtIG1hcmsgYXJ0aWNsZScpOwoKZm9yIG15ICRTZWVuICgwLDEpIHsKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwoKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0sCiAgICAgICAgQXJ0aWNsZUlEICAgICAgICAgID0+ICRBcnRpY2xlSUQsCiAgICAgICAgU2VlbiAgICAgICAgICAgICAgID0+ICRTZWVuCiAgICB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvdGlja2V0cy9tYXJrQXJ0aWNsZUFzU2VlbiIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgIGlmICggJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgUmVzcG9uc2UgfSwgJ09LJywgJ3Jlc3BvbnNlIG9rJyApICkgewogICAgICAgICAgICBpZiAoICRTZWxmLT5UcnVlKCAkUmVzcG9uc2UtPnsgVGlja2V0SUQgfSwgJ3RpY2tldCBpZCcpICkgewogICAgICAgICAgICAgICAgbXkgJUZsYWdzID0gJFRpY2tldE9iamVjdC0+VGlja2V0RmxhZ0dldCgKICAgICAgICAgICAgICAgICAgICBUaWNrZXRJRCA9PiAkUmVzcG9uc2UtPnsgVGlja2V0SUQgfSwKICAgICAgICAgICAgICAgICAgICBVc2VySUQgICA9PiAkVXNlcntVc2VySUR9CiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPnsgVGlja2V0U2VlbiB9LCAkRmxhZ3N7IFNlZW4gfSwgInRpY2tldCBzZWVuICRTZWVuIik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojCiMgL2F1dGgvbG9nb3V0CiMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMg0J/RgNC+0YHRgNC+0YfQtdC90L3QsNGPINGB0LXRgdGB0LjRjwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgokU2VsZi0+VHJ1ZSgxLCAnL2F1dGgvbG9nb3V0IC0gZmFpbGVkIHNlc3Npb24nKTsKCnsKICAgIG15ICRSZXF1ZXN0ID0geyB9OwoKICAgIG15ICRKU09OU3RyaW5nID0gJEpTT05PYmplY3QtPkVuY29kZSggRGF0YSA9PiAkUmVxdWVzdCApOwoKICAgIG15ICRyZXEgPSBIVFRQOjpSZXF1ZXN0LT5uZXcoICdQT1NUJywgIiRVUkxCYXNlL2F1dGgvbG9nb3V0IiApOwogICAgJHJlcS0+aGVhZGVyKCAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vanNvbicgKTsKICAgICRyZXEtPmNvbnRlbnQoICRKU09OU3RyaW5nICk7CgogICAgbXkgJFJlc3VsdCA9ICR1YS0+cmVxdWVzdCggJHJlcSApOwoKICAgIGlmICgkUmVzdWx0LT5pc19zdWNjZXNzKSB7CiAgICAgICAgdXNlIHV0Zjg7CgogICAgICAgIG15ICRSZXNwb25zZSA9IGRlY29kZV9qc29uICRSZXN1bHQtPmRlY29kZWRfY29udGVudDsKCiAgICAgICAgJFNlbGYtPklzKCAkUmVzcG9uc2UtPntSZXNwb25zZX0sICdFUlJPUicsICdyZXNwb25zZSBlcnJvcicgKTsKICAgICAgICAkU2VsZi0+VHJ1ZSggJFJlc3BvbnNlLT57TWVzc2FnZX0gPX4gL15TZXNzaW9uIGludmFsaWQvLCAnbWVzc2FnZSBub3Qgb2snICk7CiAgICB9IGVsc2UgewogICAgICAgIHByaW50ICRTVCAkUmVzdWx0LT5zdGF0dXNfbGluZTsKICAgIH0KfQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojINCd0LXQv9GA0LDQstC40LvRjNC90YvQuSBDaGFsbGVuZ2VUb2tlbgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgokU2VsZi0+VHJ1ZSgxLCAnL2F1dGgvbG9nb3V0IC0gd3JvbmcgQ2hhbGxlbmdlVG9rZW4nKTsKCnsKICAgIG15ICRSZXF1ZXN0ID0gewogICAgICAgIE9UUlNBZ2VudEludGVyZmFjZSA9PiAkR2xvYmFsQXV0aHsgT1RSU0FnZW50SW50ZXJmYWNlIH0KICAgIH07CgogICAgbXkgJEpTT05TdHJpbmcgPSAkSlNPTk9iamVjdC0+RW5jb2RlKCBEYXRhID0+ICRSZXF1ZXN0ICk7CgogICAgbXkgJHJlcSA9IEhUVFA6OlJlcXVlc3QtPm5ldyggJ1BPU1QnLCAiJFVSTEJhc2UvYXV0aC9sb2dvdXQiICk7CiAgICAkcmVxLT5oZWFkZXIoICdDb250ZW50LVR5cGUnID0+ICdhcHBsaWNhdGlvbi9qc29uJyApOwogICAgJHJlcS0+Y29udGVudCggJEpTT05TdHJpbmcgKTsKCiAgICBteSAkUmVzdWx0ID0gJHVhLT5yZXF1ZXN0KCAkcmVxICk7CgogICAgaWYgKCRSZXN1bHQtPmlzX3N1Y2Nlc3MpIHsKICAgICAgICB1c2UgdXRmODsKCiAgICAgICAgbXkgJFJlc3BvbnNlID0gZGVjb2RlX2pzb24gJFJlc3VsdC0+ZGVjb2RlZF9jb250ZW50OwoKICAgICAgICAkU2VsZi0+SXMoICRSZXNwb25zZS0+e1Jlc3BvbnNlfSwgJ0VSUk9SJywgJ3Jlc3BvbnNlIGVycm9yJyApOwogICAgICAgICRTZWxmLT5UcnVlKCAkUmVzcG9uc2UtPntNZXNzYWdlfSA9fiAvXkludmFsaWQgQ2hhbGxlbmdlIFRva2VuLywgJ21lc3NhZ2Ugbm90IG9rJyApOwogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyDQo9GB0L/QtdGI0L3Ri9C5INCy0YvRhdC+0LQKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKJFNlbGYtPlRydWUoMSwgJy9hdXRoL2xvZ291dCAtIHN1Y2Nlc3NmdWwgbG9nb3V0Jyk7Cgp7CiAgICBteSAkUmVxdWVzdCA9IHsKICAgICAgICBPVFJTQWdlbnRJbnRlcmZhY2UgPT4gJEdsb2JhbEF1dGh7IE9UUlNBZ2VudEludGVyZmFjZSB9LAogICAgICAgIENoYWxsZW5nZVRva2VuICAgICA9PiAkR2xvYmFsQXV0aHsgQ2hhbGxlbmdlVG9rZW4gfQogICAgfTsKCiAgICBteSAkSlNPTlN0cmluZyA9ICRKU09OT2JqZWN0LT5FbmNvZGUoIERhdGEgPT4gJFJlcXVlc3QgKTsKCiAgICBteSAkcmVxID0gSFRUUDo6UmVxdWVzdC0+bmV3KCAnUE9TVCcsICIkVVJMQmFzZS9hdXRoL2xvZ291dCIgKTsKICAgICRyZXEtPmhlYWRlciggJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL2pzb24nICk7CiAgICAkcmVxLT5jb250ZW50KCAkSlNPTlN0cmluZyApOwoKICAgIG15ICRSZXN1bHQgPSAkdWEtPnJlcXVlc3QoICRyZXEgKTsKCiAgICBpZiAoJFJlc3VsdC0+aXNfc3VjY2VzcykgewogICAgICAgIHVzZSB1dGY4OwoKICAgICAgICBteSAkUmVzcG9uc2UgPSBkZWNvZGVfanNvbiAkUmVzdWx0LT5kZWNvZGVkX2NvbnRlbnQ7CgogICAgICAgICRTZWxmLT5JcyggJFJlc3BvbnNlLT57UmVzcG9uc2V9LCAnT0snLCAncmVzcG9uc2Ugb2snICk7CiAgICAgICAgJFNlbGYtPlRydWUoICRSZXNwb25zZS0+e01lc3NhZ2V9ID1+IC9eTG9nb3V0IHN1Y2Nlc3NmdWxcLi8sICdtZXNzYWdlIG9rJyApOwogICAgfSBlbHNlIHsKICAgICAgICBwcmludCAkU1QgJFJlc3VsdC0+c3RhdHVzX2xpbmU7CiAgICB9Cn0KCm15ICRUcnVlID0gJFRpY2tldE9iamVjdC0+VGlja2V0RGVsZXRlKAogICAgVGlja2V0SUQgPT4gJFRpY2tldElELAogICAgVXNlcklEICAgPT4gMSwKKTsKCiRUcnVlID0gJFRpY2tldE9iamVjdC0+VGlja2V0RGVsZXRlKAogICAgVGlja2V0SUQgPT4gJE5ld1RpY2tldElELAogICAgVXNlcklEICAgPT4gMSwKKTsKCiRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDYWNoZScpLT5DbGVhblVwOwoKMTsK</File>
        <File Location="bin/cgi-bin/json.pl" Permission="644" Encode="Base64">IyEvdXNyL2Jpbi9wZXJsCiMgLS0KIyBDb3B5cmlnaHQgKEMpIDIwMDEtMjAxNyBPVFJTIEFHLCBodHRwOi8vb3Rycy5jb20vCiMgICAgICAgICAgICAgICAyMDE4LTIwMjAgUmFkaWFudCBTeXN0ZW0sIGh0dHA6Ly9yYWRpYW50c3lzdGVtLmNvbS8KIyAtLQojIFRoaXMgc29mdHdhcmUgY29tZXMgd2l0aCBBQlNPTFVURUxZIE5PIFdBUlJBTlRZLiBGb3IgZGV0YWlscywgc2VlCiMgdGhlIGVuY2xvc2VkIGZpbGUgQ09QWUlORyBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbiAoR1BMKS4gSWYgeW91CiMgZGlkIG5vdCByZWNlaXZlIHRoaXMgZmlsZSwgc2VlIGh0dHBzOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvZ3BsLTMuMC50eHQuCiMgLS0KCnVzZSBzdHJpY3Q7CnVzZSB3YXJuaW5nczsKCiMgdXNlIC4uLy4uLyBhcyBsaWIgbG9jYXRpb24KdXNlIEZpbmRCaW4gcXcoJEJpbik7CnVzZSBsaWIgIiRCaW4vLi4vLi4iOwp1c2UgbGliICIkQmluLy4uLy4uL0tlcm5lbC9jcGFuLWxpYiI7CnVzZSBsaWIgIiRCaW4vLi4vLi4vQ3VzdG9tIjsKCiMgMD1vZmY7MT1vbjsKbXkgJERlYnVnID0gMDsKCiMgbG9hZCBhZ2VudCB3ZWIgaW50ZXJmYWNlCnVzZSBLZXJuZWw6OlN5c3RlbTo6V2ViOjpJbnRlcmZhY2VBZ2VudEpTT04oKTsKdXNlIEtlcm5lbDo6U3lzdGVtOjpPYmplY3RNYW5hZ2VyOwoKbG9jYWwgJEtlcm5lbDo6T00gPSBLZXJuZWw6OlN5c3RlbTo6T2JqZWN0TWFuYWdlci0+bmV3KCk7CgpteSAkSW50ZXJmYWNlID0gS2VybmVsOjpTeXN0ZW06OldlYjo6SW50ZXJmYWNlQWdlbnRKU09OLT5uZXcoIERlYnVnID0+ICREZWJ1ZyApOwokSW50ZXJmYWNlLT5SdW4oKTsK</File>
        <File Location="var/packagesetup/RS4OTRS_API.pm" Permission="644" Encode="Base64">cGFja2FnZSB2YXI6OnBhY2thZ2VzZXR1cDo6UlM0T1RSU19BUEk7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cgp1c2UgS2VybmVsOjpTeXN0ZW06OlN5c0NvbmZpZzsKdXNlIERhdGE6OkR1bXBlcjsKdXNlIEZpbGU6OkNvcHkgcXcoY29weSk7CgpvdXIgQE9iamVjdERlcGVuZGVuY2llcyA9ICgKICAgICdLZXJuZWw6OkNvbmZpZycsCiAgICAnS2VybmVsOjpTeXN0ZW06OkNhY2hlJywKICAgICdLZXJuZWw6OlN5c3RlbTo6REInLAogICAgJ0tlcm5lbDo6U3lzdGVtOjpMb2cnLAogICAgJ0tlcm5lbDo6U3lzdGVtOjpTdGF0cycsCiAgICAnS2VybmVsOjpTeXN0ZW06OlN5c0NvbmZpZycsCiAgICAnS2VybmVsOjpTeXN0ZW06OlZhbGlkJywKKTsKCnN1YiBuZXcgewogICAgbXkgKCAkVHlwZSwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkU2VsZiA9IHt9OwogICAgYmxlc3MoICRTZWxmLCAkVHlwZSApOwoKICAgIHJldHVybiAkU2VsZjsKfQoKc3ViIENvZGVJbnN0YWxsIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJElzQWR2YW5jZWRUaWNrZXRTZWFyY2hJbnN0YWxsZWQgPQogICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6QVBJOjpVdGlsJykKICAgICAgLT5Jc0FkdmFuY2VkVGlja2V0U2VhcmNoSW5zdGFsbGVkOwoKICAgIHJldHVybiAxIGlmICEkSXNBZHZhbmNlZFRpY2tldFNlYXJjaEluc3RhbGxlZDsKCiAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VGlja2V0OjpFdmVudDo6Q2hlY2tJbnN0YWxsZWRQYWNrYWdlJyktPlJ1bigKICAgICAgICBFdmVudCAgPT4gJ1BhY2thZ2VJbnN0YWxsJywKICAgICAgICBEYXRhICAgPT4gewogICAgICAgICAgICBOYW1lICAgID0+ICdSUzRPVFJTX0FkdmFuY2VkVGlja2V0U2VhcmNoJywKICAgICAgICAgICAgVmVyc2lvbiA9PiAnNi4xLjI0JwogICAgICAgIH0sCiAgICAgICAgQ29uZmlnID0+IHt9CiAgICApOwogICAgcmV0dXJuIDE7Cn0KCnN1YiBDb2RlVW5pbnN0YWxsIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJElzQWR2YW5jZWRUaWNrZXRTZWFyY2hJbnN0YWxsZWQgPQogICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6QVBJOjpVdGlsJykKICAgICAgLT5Jc0FkdmFuY2VkVGlja2V0U2VhcmNoSW5zdGFsbGVkOwoKICAgIHJldHVybiAxIGlmICEkSXNBZHZhbmNlZFRpY2tldFNlYXJjaEluc3RhbGxlZDsKCiAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VGlja2V0OjpFdmVudDo6Q2hlY2tJbnN0YWxsZWRQYWNrYWdlJyktPlJ1bigKICAgICAgICBFdmVudCAgPT4gJ1BhY2thZ2VVbmluc3RhbGwnLAogICAgICAgIERhdGEgICA9PiB7CiAgICAgICAgICAgIE5hbWUgICAgPT4gJ1JTNE9UUlNfQWR2YW5jZWRUaWNrZXRTZWFyY2gnLAogICAgICAgICAgICBWZXJzaW9uID0+ICc2LjEuMjQnCiAgICAgICAgfSwKICAgICAgICBDb25maWcgPT4ge30KICAgICk7CiAgICByZXR1cm4gMTsKfQoKc3ViIENvZGVSZWluc3RhbGwgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkSXNBZHZhbmNlZFRpY2tldFNlYXJjaEluc3RhbGxlZCA9CiAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpBUEk6OlV0aWwnKQogICAgICAtPklzQWR2YW5jZWRUaWNrZXRTZWFyY2hJbnN0YWxsZWQ7CgogICAgcmV0dXJuIDEgaWYgISRJc0FkdmFuY2VkVGlja2V0U2VhcmNoSW5zdGFsbGVkOwoKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUaWNrZXQ6OkV2ZW50OjpDaGVja0luc3RhbGxlZFBhY2thZ2UnKS0+UnVuKAogICAgICAgIEV2ZW50ICA9PiAnUGFja2FnZVJlaW5zdGFsbCcsCiAgICAgICAgRGF0YSAgID0+IHsKICAgICAgICAgICAgTmFtZSAgICA9PiAnUlM0T1RSU19BZHZhbmNlZFRpY2tldFNlYXJjaCcsCiAgICAgICAgICAgIFZlcnNpb24gPT4gJzYuMS4yNCcKICAgICAgICB9LAogICAgICAgIENvbmZpZyA9PiB7fQogICAgKTsKICAgIHJldHVybiAxOwp9CgpzdWIgQ29kZVVwZ3JhZGUgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICBteSAkSXNBZHZhbmNlZFRpY2tldFNlYXJjaEluc3RhbGxlZCA9CiAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpBUEk6OlV0aWwnKQogICAgICAtPklzQWR2YW5jZWRUaWNrZXRTZWFyY2hJbnN0YWxsZWQ7CgogICAgcmV0dXJuIDEgaWYgISRJc0FkdmFuY2VkVGlja2V0U2VhcmNoSW5zdGFsbGVkOwoKICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUaWNrZXQ6OkV2ZW50OjpDaGVja0luc3RhbGxlZFBhY2thZ2UnKS0+UnVuKAogICAgICAgIEV2ZW50ICA9PiAnUGFja2FnZVVwZ3JhZGUnLAogICAgICAgIERhdGEgICA9PiB7CiAgICAgICAgICAgIE5hbWUgICAgPT4gJ1JTNE9UUlNfQWR2YW5jZWRUaWNrZXRTZWFyY2gnLAogICAgICAgICAgICBWZXJzaW9uID0+ICc2LjEuMjQnCiAgICAgICAgfSwKICAgICAgICBDb25maWcgPT4ge30KICAgICk7CiAgICByZXR1cm4gMTsKfQoKMTsK</File>
        <File Location="Kernel/Autoload/RS_TicketSearch.pm" Permission="644" Encode="Base64">dXNlIEtlcm5lbDo6U3lzdGVtOjpUaWNrZXQ6OlRpY2tldFNlYXJjaDsKCnBhY2thZ2UgS2VybmVsOjpTeXN0ZW06OlRpY2tldDo6VGlja2V0U2VhcmNoOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwoKdXNlIEtlcm5lbDo6U3lzdGVtOjpWYXJpYWJsZUNoZWNrIHF3L0lzU3RyaW5nV2l0aERhdGEgSXNBcnJheVJlZldpdGhEYXRhLzsKCm5vIHdhcm5pbmdzICdyZWRlZmluZSc7CgpzdWIgVGlja2V0U2VhcmNoIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJFJlc3VsdCAgPSAkUGFyYW17UmVzdWx0fSAgfHwgJ0hBU0gnOwogICAgbXkgJE9yZGVyQnkgPSAkUGFyYW17T3JkZXJCeX0gfHwgJ0Rvd24nOwogICAgbXkgJFNvcnRCeSAgPSAkUGFyYW17U29ydEJ5fSAgfHwgJ0FnZSc7CiAgICBteSAkTGltaXQgICA9ICRQYXJhbXtMaW1pdH0gICB8fCAxMDAwMDsKCiAgICBpZiAoICEkUGFyYW17Q29udGVudFNlYXJjaH0gKSB7CiAgICAgICAgJFBhcmFte0NvbnRlbnRTZWFyY2h9ID0gJ0FORCc7CiAgICB9CgogICAgbXkgJVNvcnRPcHRpb25zID0gKAogICAgICAgIE93bmVyICAgICAgICAgICAgICAgICAgPT4gJ3N0LnVzZXJfaWQnLAogICAgICAgIFJlc3BvbnNpYmxlICAgICAgICAgICAgPT4gJ3N0LnJlc3BvbnNpYmxlX3VzZXJfaWQnLAogICAgICAgIEN1c3RvbWVySUQgICAgICAgICAgICAgPT4gJ3N0LmN1c3RvbWVyX2lkJywKICAgICAgICBTdGF0ZSAgICAgICAgICAgICAgICAgID0+ICdzdC50aWNrZXRfc3RhdGVfaWQnLAogICAgICAgIExvY2sgICAgICAgICAgICAgICAgICAgPT4gJ3N0LnRpY2tldF9sb2NrX2lkJywKICAgICAgICBUaWNrZXQgICAgICAgICAgICAgICAgID0+ICdzdC50bicsCiAgICAgICAgVGlja2V0TnVtYmVyICAgICAgICAgICA9PiAnc3QudG4nLAogICAgICAgIFRpdGxlICAgICAgICAgICAgICAgICAgPT4gJ3N0LnRpdGxlJywKICAgICAgICBRdWV1ZSAgICAgICAgICAgICAgICAgID0+ICdzcS5uYW1lJywKICAgICAgICBUeXBlICAgICAgICAgICAgICAgICAgID0+ICdzdC50eXBlX2lkJywKICAgICAgICBQcmlvcml0eSAgICAgICAgICAgICAgID0+ICdzdC50aWNrZXRfcHJpb3JpdHlfaWQnLAogICAgICAgIEFnZSAgICAgICAgICAgICAgICAgICAgPT4gJ3N0LmNyZWF0ZV90aW1lJywKICAgICAgICBDcmVhdGVkICAgICAgICAgICAgICAgID0+ICdzdC5jcmVhdGVfdGltZScsCiAgICAgICAgQ2hhbmdlZCAgICAgICAgICAgICAgICA9PiAnc3QuY2hhbmdlX3RpbWUnLAogICAgICAgIFNlcnZpY2UgICAgICAgICAgICAgICAgPT4gJ3N0LnNlcnZpY2VfaWQnLAogICAgICAgIFNMQSAgICAgICAgICAgICAgICAgICAgPT4gJ3N0LnNsYV9pZCcsCiAgICAgICAgUGVuZGluZ1RpbWUgICAgICAgICAgICA9PiAnc3QudW50aWxfdGltZScsCiAgICAgICAgVGlja2V0RXNjYWxhdGlvbiAgICAgICA9PiAnc3QuZXNjYWxhdGlvbl90aW1lJywKICAgICAgICBFc2NhbGF0aW9uVGltZSAgICAgICAgID0+ICdzdC5lc2NhbGF0aW9uX3RpbWUnLAogICAgICAgIEVzY2FsYXRpb25VcGRhdGVUaW1lICAgPT4gJ3N0LmVzY2FsYXRpb25fdXBkYXRlX3RpbWUnLAogICAgICAgIEVzY2FsYXRpb25SZXNwb25zZVRpbWUgPT4gJ3N0LmVzY2FsYXRpb25fcmVzcG9uc2VfdGltZScsCiAgICAgICAgRXNjYWxhdGlvblNvbHV0aW9uVGltZSA9PiAnc3QuZXNjYWxhdGlvbl9zb2x1dGlvbl90aW1lJywKICAgICk7CgogICAgIyBjaGVjayByZXF1aXJlZCBwYXJhbXMKICAgIGlmICggISRQYXJhbXtVc2VySUR9ICYmICEkUGFyYW17Q3VzdG9tZXJVc2VySUR9ICkgewogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnTmVlZCBVc2VySUQgb3IgQ3VzdG9tZXJVc2VySUQgcGFyYW1zIGZvciBwZXJtaXNzaW9uIGNoZWNrIScsCiAgICAgICAgKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgIyBjaGVjayB0eXBlcyBvZiBnaXZlbiBhcmd1bWVudHMKICAgIEFSR1VNRU5UOgogICAgZm9yIG15ICRLZXkgKAogICAgICAgIHF3KAogICAgICAgIFR5cGVzIFR5cGVJRHMgQ3JlYXRlZFR5cGVzIENyZWF0ZWRUeXBlSURzIFN0YXRlcyBTdGF0ZUlEcyBDcmVhdGVkU3RhdGVzIENyZWF0ZWRTdGF0ZUlEcyBTdGF0ZVR5cGVJRHMKICAgICAgICBMb2NrcyBMb2NrSURzIE93bmVySURzIFJlc3BvbnNpYmxlSURzIENyZWF0ZWRVc2VySURzIFF1ZXVlcyBRdWV1ZUlEcyBDcmVhdGVkUXVldWVzIENyZWF0ZWRRdWV1ZUlEcwogICAgICAgIFByaW9yaXRpZXMgUHJpb3JpdHlJRHMgQ3JlYXRlZFByaW9yaXRpZXMgQ3JlYXRlZFByaW9yaXR5SURzIFNlcnZpY2VzIFNlcnZpY2VJRHMgU0xBcyBTTEFJRHMgV2F0Y2hVc2VySURzCiAgICAgICAgKQogICAgICAgICkKICAgIHsKICAgICAgICBuZXh0IEFSR1VNRU5UIGlmICEkUGFyYW17JEtleX07CiAgICAgICAgbmV4dCBBUkdVTUVOVCBpZiByZWYgJFBhcmFteyRLZXl9IGVxICdBUlJBWScgJiYgQHsgJFBhcmFteyRLZXl9IH07CgogICAgICAgICMgbG9nIGVycm9yCiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJUaGUgZ2l2ZW4gcGFyYW0gJyRLZXknIGlzIGludmFsaWQgb3IgYW4gZW1wdHkgYXJyYXkgcmVmZXJlbmNlISIsCiAgICAgICAgKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgIyBnZXQgZGF0YWJhc2Ugb2JqZWN0CiAgICBteSAkREJPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6REInKTsKCiAgICAjIHF1b3RlIGlkIGFycmF5IGVsZW1lbnRzCiAgICBBUkdVTUVOVDoKICAgIGZvciBteSAkS2V5ICgKICAgICAgICBxdygKICAgICAgICBUeXBlSURzIENyZWF0ZWRUeXBlSURzIFN0YXRlSURzIENyZWF0ZWRTdGF0ZUlEcyBTdGF0ZVR5cGVJRHMgTG9ja0lEcyBPd25lcklEcyBSZXNwb25zaWJsZUlEcyBDcmVhdGVkVXNlcklEcwogICAgICAgIFF1ZXVlSURzIENyZWF0ZWRRdWV1ZUlEcyBQcmlvcml0eUlEcyBDcmVhdGVkUHJpb3JpdHlJRHMgU2VydmljZUlEcyBTTEFJRHMgV2F0Y2hVc2VySURzCiAgICAgICAgKQogICAgICAgICkKICAgIHsKICAgICAgICBuZXh0IEFSR1VNRU5UIGlmICEkUGFyYW17JEtleX07CgogICAgICAgICMgcXVvdGUgZWxlbWVudHMKICAgICAgICBmb3IgbXkgJEVsZW1lbnQgKCBAeyAkUGFyYW17JEtleX0gfSApIHsKICAgICAgICAgICAgaWYgKCAhZGVmaW5lZCAkREJPYmplY3QtPlF1b3RlKCAkRWxlbWVudCwgJ0ludGVnZXInICkgKSB7CgogICAgICAgICAgICAgICAgIyBsb2cgZXJyb3IKICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIlRoZSBnaXZlbiBwYXJhbSAnJEVsZW1lbnQnIGluICckS2V5JyBpcyBpbnZhbGlkISIsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIG15ICRUaWNrZXREeW5hbWljRmllbGRzICA9IFtdOwogICAgbXkgJEFydGljbGVEeW5hbWljRmllbGRzID0gW107CiAgICBteSAlVmFsaWREeW5hbWljRmllbGRQYXJhbXM7CiAgICBteSAlVGlja2V0RHluYW1pY0ZpZWxkTmFtZTJDb25maWc7CiAgICBteSAlQXJ0aWNsZUR5bmFtaWNGaWVsZE5hbWUyQ29uZmlnOwoKICAgICMgT25seSBmZXRjaCBEeW5hbWljRmllbGQgZGF0YSBpZiBhIGZpZWxkIHdhcyByZXF1ZXN0ZWQgZm9yIHNlYXJjaGluZyBvciBzb3J0aW5nCiAgICBteSAkUGFyYW1DaGVja1N0cmluZyA9ICggam9pbiAnJywga2V5cyAlUGFyYW0gKSB8fCAnJzsKCiAgICBpZiAoIHJlZiAkUGFyYW17U29ydEJ5fSBlcSAnQVJSQVknICkgewogICAgICAgICRQYXJhbUNoZWNrU3RyaW5nIC49ICggam9pbiAnJywgQHsgJFBhcmFte1NvcnRCeX0gfSApOwogICAgfQogICAgZWxzaWYgKCByZWYgJFBhcmFte1NvcnRCeX0gbmUgJ0hBU0gnICkgewogICAgICAgICRQYXJhbUNoZWNrU3RyaW5nIC49ICRQYXJhbXtTb3J0Qnl9IHx8ICcnOwogICAgfQoKICAgIGlmICggJFBhcmFtQ2hlY2tTdHJpbmcgPX4gbS9EeW5hbWljRmllbGRfL3NteCApIHsKCiAgICAgICAgIyBnZXQgZHluYW1pYyBmaWVsZCBvYmplY3QKICAgICAgICBteSAkRHluYW1pY0ZpZWxkT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkR5bmFtaWNGaWVsZCcpOwoKICAgICAgICAjIENoZWNrIGFsbCBjb25maWd1cmVkIHRpY2tldCBkeW5hbWljIGZpZWxkcwogICAgICAgICRUaWNrZXREeW5hbWljRmllbGRzID0gJER5bmFtaWNGaWVsZE9iamVjdC0+RHluYW1pY0ZpZWxkTGlzdEdldCgKICAgICAgICAgICAgT2JqZWN0VHlwZSA9PiAnVGlja2V0JywKICAgICAgICApOwoKICAgICAgICBmb3IgbXkgJER5bmFtaWNGaWVsZCAoIEB7JFRpY2tldER5bmFtaWNGaWVsZHN9ICkgewogICAgICAgICAgICAkVmFsaWREeW5hbWljRmllbGRQYXJhbXN7ICJEeW5hbWljRmllbGRfIiAuICREeW5hbWljRmllbGQtPntOYW1lfSB9ID0gMTsKICAgICAgICAgICAgJFRpY2tldER5bmFtaWNGaWVsZE5hbWUyQ29uZmlneyAkRHluYW1pY0ZpZWxkLT57TmFtZX0gfSA9ICREeW5hbWljRmllbGQ7CiAgICAgICAgfQoKICAgICAgICAjIENoZWNrIGFsbCBjb25maWd1cmVkIGFydGljbGUgZHluYW1pYyBmaWVsZHMKICAgICAgICAkQXJ0aWNsZUR5bmFtaWNGaWVsZHMgPSAkRHluYW1pY0ZpZWxkT2JqZWN0LT5EeW5hbWljRmllbGRMaXN0R2V0KAogICAgICAgICAgICBPYmplY3RUeXBlID0+ICdBcnRpY2xlJywKICAgICAgICApOwoKICAgICAgICBmb3IgbXkgJER5bmFtaWNGaWVsZCAoIEB7JEFydGljbGVEeW5hbWljRmllbGRzfSApIHsKICAgICAgICAgICAgJFZhbGlkRHluYW1pY0ZpZWxkUGFyYW1zeyAiRHluYW1pY0ZpZWxkXyIgLiAkRHluYW1pY0ZpZWxkLT57TmFtZX0gfSA9IDE7CiAgICAgICAgICAgICRBcnRpY2xlRHluYW1pY0ZpZWxkTmFtZTJDb25maWd7ICREeW5hbWljRmllbGQtPntOYW1lfSB9ID0gJER5bmFtaWNGaWVsZDsKICAgICAgICB9CiAgICB9CgogICAgIyBjaGVjayBzb3J0L29yZGVyIGJ5IG9wdGlvbnMKICAgIG15IEBTb3J0QnlBcnJheSAgICAgICA9ICggcmVmICRTb3J0QnkgZXEgJ0FSUkFZJyA/IEB7JFNvcnRCeX0gOiAoJFNvcnRCeSkgKTsKICAgIG15ICVMb29rdXBTb3J0QnlBcnJheSA9IG1hcCB7ICRfID0+IDEgfSBAU29ydEJ5QXJyYXk7CiAgICBteSBAT3JkZXJCeUFycmF5ICAgICAgPSAoIHJlZiAkT3JkZXJCeSBlcSAnQVJSQVknID8gQHskT3JkZXJCeX0gOiAoJE9yZGVyQnkpICk7CgogICAgZm9yIG15ICRDb3VudCAoIDAgLi4gJCNTb3J0QnlBcnJheSApIHsKICAgICAgICBpZiAoCiAgICAgICAgICAgICEkU29ydE9wdGlvbnN7ICRTb3J0QnlBcnJheVskQ291bnRdIH0KICAgICAgICAgICAgJiYgISRWYWxpZER5bmFtaWNGaWVsZFBhcmFtc3sgJFNvcnRCeUFycmF5WyRDb3VudF0gfQogICAgICAgICAgICApCiAgICAgICAgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnTmVlZCB2YWxpZCBTb3J0QnkgKCcgLiAkU29ydEJ5QXJyYXlbJENvdW50XSAuICcpIScsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCAkT3JkZXJCeUFycmF5WyRDb3VudF0gbmUgJ0Rvd24nICYmICRPcmRlckJ5QXJyYXlbJENvdW50XSBuZSAnVXAnICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnTmVlZCB2YWxpZCBPcmRlckJ5ICgnIC4gJE9yZGVyQnlBcnJheVskQ291bnRdIC4gJykhJywKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KCiAgICAjIGNyZWF0ZSBzcWwKICAgIG15ICRTUUxTZWxlY3Q7CiAgICBpZiAoICRSZXN1bHQgZXEgJ0NPVU5UJyApIHsKICAgICAgICAkU1FMU2VsZWN0ID0gJ1NFTEVDVCBDT1VOVChESVNUSU5DVChzdC5pZCkpJzsKICAgIH0KICAgIGVsc2UgewogICAgICAgICRTUUxTZWxlY3QgPSAnU0VMRUNUIERJU1RJTkNUIHN0LmlkLCBzdC50bic7CiAgICB9CgogICAgbXkgJFNRTEZyb20gPSAnIEZST00gdGlja2V0IHN0ICc7CgogICAgbXkgJEFydGljbGVPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VGlja2V0OjpBcnRpY2xlJyk7CgogICAgIyBjaGVjayBmb3IgbmVlZGVkIGFydGljbGUgdGFibGUgam9pbgogICAgbXkgJEFydGljbGVUYWJsZUpvaW5lZCA9IDA7CgogICAgIyBjaGVjayBmb3IgbmVlZGVkIGFydGljbGUgc2VhcmNoIGluZGV4IHRhYmxlIGpvaW4KICAgIGlmICggJEFydGljbGVPYmplY3QtPkFydGljbGVTZWFyY2hJbmRleFNRTEpvaW5OZWVkZWQoIFNlYXJjaFBhcmFtcyA9PiBcJVBhcmFtICkgKSB7CiAgICAgICAgJFNRTEZyb20gLj0gJyBJTk5FUiBKT0lOIGFydGljbGUgYXJ0IE9OIHN0LmlkID0gYXJ0LnRpY2tldF9pZCAnOwogICAgICAgICRTUUxGcm9tIC49ICRBcnRpY2xlT2JqZWN0LT5BcnRpY2xlU2VhcmNoSW5kZXhTUUxKb2luKCBTZWFyY2hQYXJhbXMgPT4gXCVQYXJhbSApOwogICAgICAgICRBcnRpY2xlVGFibGVKb2luZWQgPSAxOwogICAgfQoKICAgICMgVXNlIGFsc28gaGlzdG9yeSB0YWJsZSBpZiByZXF1aXJlZAogICAgIyBDcmVhdGUgYSBpbm5lciBqb2luIGZvciBlYWNoIHBhcmFtIGFuZCByZWdpc3RlciBpdC4KICAgIG15ICVUaWNrZXRIaXN0b3J5Sm9pbnMgPSAoKTsKICAgIEFSR1VNRU5UOgogICAgZm9yIG15ICRLZXkgKCBzb3J0IGtleXMgJVBhcmFtICkgewogICAgICAgIGlmICgKICAgICAgICAgICAgJFBhcmFteyRLZXl9CiAgICAgICAgICAgICYmICRLZXkgPX4gL14oVGlja2V0KExhc3QpPyhDbG9zZXxDaGFuZ2UpVGltZShOZXdlcnxPbGRlcikoRGF0ZXxNaW51dGVzKXxDcmVhdGVkLis/KS8KICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgbXkgJFRIUmVmID0gJFNlbGYtPl9UaWNrZXRIaXN0b3J5UmVmZXJlbmNlRm9yU2VhcmNoQXJndW1lbnQoCiAgICAgICAgICAgICAgICBBcmd1bWVudCA9PiAkS2V5LAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm4gaWYgISRUSFJlZjsKCiAgICAgICAgICAgIG5leHQgQVJHVU1FTlQgaWYgJFRpY2tldEhpc3RvcnlKb2luc3skVEhSZWZ9OwoKICAgICAgICAgICAgJFRpY2tldEhpc3RvcnlKb2luc3skVEhSZWZ9ID0gMTsKICAgICAgICAgICAgJFNRTEZyb20gLj0gc3ByaW50ZgogICAgICAgICAgICAgICAgJ0lOTkVSIEpPSU4gdGlja2V0X2hpc3RvcnkgJXMgT04gc3QuaWQgPSAlcy50aWNrZXRfaWQgJywKICAgICAgICAgICAgICAgICRUSFJlZiwgJFRIUmVmOwogICAgICAgIH0KICAgIH0KCiAgICAjIGFkZCB0aWNrZXQgd2F0Y2hlciB0YWJsZQogICAgaWYgKCAkUGFyYW17V2F0Y2hVc2VySURzfSApIHsKICAgICAgICAkU1FMRnJvbSAuPSAnSU5ORVIgSk9JTiB0aWNrZXRfd2F0Y2hlciB0dyBPTiBzdC5pZCA9IHR3LnRpY2tldF9pZCAnOwogICAgfQoKICAgIG15ICRTUUxFeHQgPSAnIFdIRVJFIDE9MSc7CgogICAgIyBMaW1pdCB0aGUgc2VhcmNoIHRvIGp1c3Qgb25lIChvciBhIGxpc3QpIFRpY2tldElEICh1c2VkIGJ5IHRoZSBHZW5lcmljQWdlbnQKICAgICMgICB0byBmaWx0ZXIgZm9yIGV2ZW50cyBvbiBzaW5nbGUgdGlja2V0cyB3aXRoIHRoZSBqb2IncyB0aWNrZXQgZmlsdGVyKS4KICAgIGlmICggSXNTdHJpbmdXaXRoRGF0YSggJFBhcmFte1RpY2tldElEfSApIHx8IElzQXJyYXlSZWZXaXRoRGF0YSggJFBhcmFte1RpY2tldElEfSApICkgewoKICAgICAgICBteSAkU1FMUXVlcnlJbkNvbmRpdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5RdWVyeUluQ29uZGl0aW9uKAogICAgICAgICAgICBLZXkgICAgICAgPT4gJ3N0LmlkJywKICAgICAgICAgICAgVmFsdWVzICAgID0+IHJlZiAkUGFyYW17VGlja2V0SUR9IGVxICdBUlJBWScgPyAkUGFyYW17VGlja2V0SUR9IDogWyAkUGFyYW17VGlja2V0SUR9IF0sCiAgICAgICAgICAgIFF1b3RlVHlwZSA9PiAnSW50ZWdlcicsCiAgICAgICAgICAgIEJpbmRNb2RlICA9PiAwLAogICAgICAgICk7CiAgICAgICAgJFNRTEV4dCAuPSAnIEFORCAoICcgLiAkU1FMUXVlcnlJbkNvbmRpdGlvbiAuICcgKSAnOwogICAgfQoKICAgICMgYWRkIHRpY2tldCBmbGFnIHRhYmxlCiAgICBpZiAoICRQYXJhbXtUaWNrZXRGbGFnfSApIHsKICAgICAgICBteSAkSW5kZXggPSAxOwogICAgICAgIGZvciBteSAkS2V5ICggc29ydCBrZXlzICV7ICRQYXJhbXtUaWNrZXRGbGFnfSB9ICkgewogICAgICAgICAgICAkU1FMRnJvbSAuPSAiSU5ORVIgSk9JTiB0aWNrZXRfZmxhZyB0ZiRJbmRleCBPTiBzdC5pZCA9IHRmJEluZGV4LnRpY2tldF9pZCAiOwogICAgICAgICAgICAkSW5kZXgrKzsKICAgICAgICB9CiAgICB9CgogICAgIyBhZGQgYXJ0aWNsZSBhbmQgYXJ0aWNsZV9mbGFnIHRhYmxlcwogICAgaWYgKCAkUGFyYW17QXJ0aWNsZUZsYWd9ICkgewogICAgICAgIG15ICRJbmRleCA9IDE7CiAgICAgICAgZm9yIG15ICRLZXkgKCBzb3J0IGtleXMgJXsgJFBhcmFte0FydGljbGVGbGFnfSB9ICkgewogICAgICAgICAgICAkU1FMRnJvbSAuPSAiSU5ORVIgSk9JTiBhcnRpY2xlIGF0YWYkSW5kZXggT04gc3QuaWQgPSBhdGFmJEluZGV4LnRpY2tldF9pZCAiOwogICAgICAgICAgICAkU1FMRnJvbSAuPQogICAgICAgICAgICAgICAgIklOTkVSIEpPSU4gYXJ0aWNsZV9mbGFnIHRhZiRJbmRleCBPTiBhdGFmJEluZGV4LmlkID0gdGFmJEluZGV4LmFydGljbGVfaWQgIjsKICAgICAgICAgICAgJEluZGV4Kys7CiAgICAgICAgfQogICAgfQoKICAgIGlmICggJFBhcmFte05vdFRpY2tldEZsYWd9ICkgewogICAgICAgIG15ICRUaWNrZXRGbGFnVXNlcklEID0gJFBhcmFte1RpY2tldEZsYWdVc2VySUR9IHx8ICRQYXJhbXtVc2VySUR9OwogICAgICAgIHJldHVybiBpZiAhZGVmaW5lZCAkVGlja2V0RmxhZ1VzZXJJRDsKCiAgICAgICAgbXkgJEluZGV4ID0gMTsKICAgICAgICBmb3IgbXkgJEtleSAoIHNvcnQga2V5cyAleyAkUGFyYW17Tm90VGlja2V0RmxhZ30gfSApIHsKICAgICAgICAgICAgJFNRTEZyb20gLj0gIkxFRlQgSk9JTiB0aWNrZXRfZmxhZyBudGYkSW5kZXggT04gc3QuaWQgPSBudGYkSW5kZXgudGlja2V0X2lkICAiCiAgICAgICAgICAgICAgICAuICIgQU5EIG50ZiRJbmRleC50aWNrZXRfa2V5ID0gJyIgLiAkREJPYmplY3QtPlF1b3RlKCRLZXkpIC4gIiciCiAgICAgICAgICAgICAgICAuICIgQU5EIG50ZiRJbmRleC5jcmVhdGVfYnkgPSAiCiAgICAgICAgICAgICAgICAuICREQk9iamVjdC0+UXVvdGUoICRUaWNrZXRGbGFnVXNlcklELCAnSW50ZWdlcicgKQogICAgICAgICAgICAgICAgLiAnICc7CiAgICAgICAgICAgICRJbmRleCsrOwogICAgICAgIH0KICAgIH0KCiAgICAjIGN1cnJlbnQgdHlwZSBsb29rdXAKICAgIGlmICggJFBhcmFte1R5cGVzfSApIHsKCiAgICAgICAgIyBnZXQgdHlwZSBvYmplY3QKICAgICAgICBteSAkVHlwZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUeXBlJyk7CgogICAgICAgIGZvciBteSAkVHlwZSAoIEB7ICRQYXJhbXtUeXBlc30gfSApIHsKCiAgICAgICAgICAgICMgbG9va3VwIHR5cGUgaWQKICAgICAgICAgICAgbXkgJFR5cGVJRCA9ICRUeXBlT2JqZWN0LT5UeXBlTG9va3VwKAogICAgICAgICAgICAgICAgVHlwZSA9PiAkVHlwZSwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuIGlmICEkVHlwZUlEOwogICAgICAgICAgICBwdXNoIEB7ICRQYXJhbXtUeXBlSURzfSB9LCAkVHlwZUlEOwogICAgICAgIH0KICAgIH0KCiAgICAjIHR5cGUgaWRzCiAgICBpZiAoICRQYXJhbXtUeXBlSURzfSApIHsKICAgICAgICBteSAkU1FMUXVlcnlJbkNvbmRpdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5RdWVyeUluQ29uZGl0aW9uKAogICAgICAgICAgICBLZXkgICAgICAgPT4gJ3N0LnR5cGVfaWQnLAogICAgICAgICAgICBWYWx1ZXMgICAgPT4gJFBhcmFte1R5cGVJRHN9LAogICAgICAgICAgICBRdW90ZVR5cGUgPT4gJ0ludGVnZXInLAogICAgICAgICAgICBCaW5kTW9kZSAgPT4gMCwKICAgICAgICApOwogICAgICAgICRTUUxFeHQgLj0gJyBBTkQgKCAnIC4gJFNRTFF1ZXJ5SW5Db25kaXRpb24gLiAnICkgJzsKICAgIH0KCiAgICAjIGNyZWF0ZWQgdHlwZXMgbG9va3VwCiAgICBpZiAoICRQYXJhbXtDcmVhdGVkVHlwZXN9ICkgewoKICAgICAgICAjIGdldCB0eXBlIG9iamVjdAogICAgICAgIG15ICRUeXBlT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlR5cGUnKTsKCiAgICAgICAgZm9yIG15ICRUeXBlICggQHsgJFBhcmFte0NyZWF0ZWRUeXBlc30gfSApIHsKCiAgICAgICAgICAgICMgbG9va3VwIHR5cGUgaWQKICAgICAgICAgICAgbXkgJFR5cGVJRCA9ICRUeXBlT2JqZWN0LT5UeXBlTG9va3VwKAogICAgICAgICAgICAgICAgVHlwZSA9PiAkVHlwZSwKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIHJldHVybiBpZiAhJFR5cGVJRDsKCiAgICAgICAgICAgIHB1c2ggQHsgJFBhcmFte0NyZWF0ZWRUeXBlSURzfSB9LCAkVHlwZUlEOwogICAgICAgIH0KICAgIH0KCiAgICAjIGNyZWF0ZWQgdHlwZSBpZHMKICAgIGlmICggJFBhcmFte0NyZWF0ZWRUeXBlSURzfSApIHsKCiAgICAgICAgIyBsb29rdXAgaGlzdG9yeSB0eXBlIGlkCiAgICAgICAgbXkgJEhpc3RvcnlUeXBlSUQgPSAkU2VsZi0+SGlzdG9yeVR5cGVMb29rdXAoCiAgICAgICAgICAgIFR5cGUgPT4gJ05ld1RpY2tldCcsCiAgICAgICAgKTsKCiAgICAgICAgaWYgKCRIaXN0b3J5VHlwZUlEKSB7CiAgICAgICAgICAgIG15ICRUSFJlZiA9ICRTZWxmLT5fVGlja2V0SGlzdG9yeVJlZmVyZW5jZUZvclNlYXJjaEFyZ3VtZW50KAogICAgICAgICAgICAgICAgQXJndW1lbnQgPT4gJ0NyZWF0ZWRUeXBlSURzJywKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuIGlmICEkVEhSZWY7CgogICAgICAgICAgICBteSAkU1FMUXVlcnlJbkNvbmRpdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5RdWVyeUluQ29uZGl0aW9uKAogICAgICAgICAgICAgICAgS2V5ICAgICAgID0+ICIkeyBUSFJlZiB9LnR5cGVfaWQiLAogICAgICAgICAgICAgICAgVmFsdWVzICAgID0+ICRQYXJhbXtDcmVhdGVkVHlwZUlEc30sCiAgICAgICAgICAgICAgICBRdW90ZVR5cGUgPT4gJ0ludGVnZXInLAogICAgICAgICAgICAgICAgQmluZE1vZGUgID0+IDAsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgICRTUUxFeHQgLj0gJyBBTkQgKCAnIC4gJFNRTFF1ZXJ5SW5Db25kaXRpb24gLiAnICkgJzsKICAgICAgICAgICAgJFNRTEV4dCAuPSAiIEFORCAkeyBUSFJlZiB9Lmhpc3RvcnlfdHlwZV9pZCA9ICRIaXN0b3J5VHlwZUlEICI7CiAgICAgICAgfQogICAgfQoKICAgICMgY3VycmVudCBzdGF0ZSBsb29rdXAKICAgIGlmICggJFBhcmFte1N0YXRlc30gKSB7CgogICAgICAgICMgZ2V0IHN0YXRlIG9iamVjdAogICAgICAgIG15ICRTdGF0ZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTdGF0ZScpOwoKICAgICAgICBmb3IgbXkgJFN0YXRlICggQHsgJFBhcmFte1N0YXRlc30gfSApIHsKCiAgICAgICAgICAgICMgZ2V0IHN0YXRlIGRhdGEKICAgICAgICAgICAgbXkgJVN0YXRlRGF0YSA9ICRTdGF0ZU9iamVjdC0+U3RhdGVHZXQoCiAgICAgICAgICAgICAgICBOYW1lID0+ICRTdGF0ZSwKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIHJldHVybiBpZiAhJVN0YXRlRGF0YTsKCiAgICAgICAgICAgIHB1c2ggQHsgJFBhcmFte1N0YXRlSURzfSB9LCAkU3RhdGVEYXRhe0lEfTsKICAgICAgICB9CiAgICB9CgogICAgIyBzdGF0ZSBpZHMKICAgIGlmICggJFBhcmFte1N0YXRlSURzfSApIHsKICAgICAgICBteSAkU1FMUXVlcnlJbkNvbmRpdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5RdWVyeUluQ29uZGl0aW9uKAogICAgICAgICAgICBLZXkgICAgICAgPT4gJ3N0LnRpY2tldF9zdGF0ZV9pZCcsCiAgICAgICAgICAgIFZhbHVlcyAgICA9PiAkUGFyYW17U3RhdGVJRHN9LAogICAgICAgICAgICBRdW90ZVR5cGUgPT4gJ0ludGVnZXInLAogICAgICAgICAgICBCaW5kTW9kZSAgPT4gMCwKICAgICAgICApOwogICAgICAgICRTUUxFeHQgLj0gJyBBTkQgKCAnIC4gJFNRTFF1ZXJ5SW5Db25kaXRpb24gLiAnICkgJzsKICAgIH0KCiAgICAjIGNyZWF0ZWQgc3RhdGVzIGxvb2t1cAogICAgaWYgKCAkUGFyYW17Q3JlYXRlZFN0YXRlc30gKSB7CgogICAgICAgICMgZ2V0IHN0YXRlIG9iamVjdAogICAgICAgIG15ICRTdGF0ZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTdGF0ZScpOwoKICAgICAgICBmb3IgbXkgJFN0YXRlICggQHsgJFBhcmFte0NyZWF0ZWRTdGF0ZXN9IH0gKSB7CgogICAgICAgICAgICAjIGdldCBzdGF0ZSBkYXRhCiAgICAgICAgICAgIG15ICVTdGF0ZURhdGEgPSAkU3RhdGVPYmplY3QtPlN0YXRlR2V0KAogICAgICAgICAgICAgICAgTmFtZSA9PiAkU3RhdGUsCiAgICAgICAgICAgICk7CgogICAgICAgICAgICByZXR1cm4gaWYgISVTdGF0ZURhdGE7CgogICAgICAgICAgICBwdXNoIEB7ICRQYXJhbXtDcmVhdGVkU3RhdGVJRHN9IH0sICRTdGF0ZURhdGF7SUR9OwogICAgICAgIH0KICAgIH0KCiAgICAjIGNyZWF0ZWQgc3RhdGUgaWRzCiAgICBpZiAoICRQYXJhbXtDcmVhdGVkU3RhdGVJRHN9ICkgewoKICAgICAgICAjIGxvb2t1cCBoaXN0b3J5IHR5cGUgaWQKICAgICAgICBteSAkSGlzdG9yeVR5cGVJRCA9ICRTZWxmLT5IaXN0b3J5VHlwZUxvb2t1cCgKICAgICAgICAgICAgVHlwZSA9PiAnTmV3VGlja2V0JywKICAgICAgICApOwoKICAgICAgICBpZiAoJEhpc3RvcnlUeXBlSUQpIHsKICAgICAgICAgICAgbXkgJFRIUmVmID0gJFNlbGYtPl9UaWNrZXRIaXN0b3J5UmVmZXJlbmNlRm9yU2VhcmNoQXJndW1lbnQoCiAgICAgICAgICAgICAgICBBcmd1bWVudCA9PiAnQ3JlYXRlZFN0YXRlSURzJywKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuIGlmICEkVEhSZWY7CgogICAgICAgICAgICBteSAkU1FMUXVlcnlJbkNvbmRpdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5RdWVyeUluQ29uZGl0aW9uKAogICAgICAgICAgICAgICAgS2V5ICAgICAgID0+ICIkeyBUSFJlZiB9LnN0YXRlX2lkIiwKICAgICAgICAgICAgICAgIFZhbHVlcyAgICA9PiAkUGFyYW17Q3JlYXRlZFN0YXRlSURzfSwKICAgICAgICAgICAgICAgIFF1b3RlVHlwZSA9PiAnSW50ZWdlcicsCiAgICAgICAgICAgICAgICBCaW5kTW9kZSAgPT4gMCwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgJFNRTEV4dCAuPSAnIEFORCAoICcgLiAkU1FMUXVlcnlJbkNvbmRpdGlvbiAuICcgKSAnOwoKICAgICAgICAgICAgJFNRTEV4dCAuPSAiIEFORCAkeyBUSFJlZiB9Lmhpc3RvcnlfdHlwZV9pZCA9ICRIaXN0b3J5VHlwZUlEICI7CiAgICAgICAgfQogICAgfQoKICAgICMgY3VycmVudCB0aWNrZXQgc3RhdGUgdHlwZQogICAgIyBOT1RFOiBPcGVuIGFuZCBDbG9zZWQgYXJlIG5vdCB2YWxpZCBzdGF0ZSB0eXBlcy4gSXQncyBmb3IgY29tcGF0LgogICAgIyBPcGVuICAgLT4gQWxsIHN0YXRlcyB3aGljaCBhcmUgZ3JvdXBlZCBhcyBvcGVuIChuZXcsIG9wZW4sIHBlbmRpbmcsIC4uLikKICAgICMgQ2xvc2VkIC0+IEFsbCBzdGF0ZXMgd2hpY2ggYXJlIGdyb3VwZWQgYXMgY2xvc2VkIChjbG9zZWQgc3VjY2Vzc2Z1bCwgY2xvc2VkIHVuc3VjY2Vzc2Z1bCkKICAgIGlmICggJFBhcmFte1N0YXRlVHlwZX0gJiYgJFBhcmFte1N0YXRlVHlwZX0gZXEgJ09wZW4nICkgewogICAgICAgIG15IEBWaWV3YWJsZVN0YXRlSURzID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlN0YXRlJyktPlN0YXRlR2V0U3RhdGVzQnlUeXBlKAogICAgICAgICAgICBUeXBlICAgPT4gJ1ZpZXdhYmxlJywKICAgICAgICAgICAgUmVzdWx0ID0+ICdJRCcsCiAgICAgICAgKTsKICAgICAgICAkU1FMRXh0IC49ICIgQU5EIHN0LnRpY2tldF9zdGF0ZV9pZCBJTiAoICR7XChqb2luICcsICcsIHNvcnQgQFZpZXdhYmxlU3RhdGVJRHMpfSApICI7CiAgICB9CiAgICBlbHNpZiAoICRQYXJhbXtTdGF0ZVR5cGV9ICYmICRQYXJhbXtTdGF0ZVR5cGV9IGVxICdDbG9zZWQnICkgewogICAgICAgIG15IEBWaWV3YWJsZVN0YXRlSURzID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlN0YXRlJyktPlN0YXRlR2V0U3RhdGVzQnlUeXBlKAogICAgICAgICAgICBUeXBlICAgPT4gJ1ZpZXdhYmxlJywKICAgICAgICAgICAgUmVzdWx0ID0+ICdJRCcsCiAgICAgICAgKTsKICAgICAgICAkU1FMRXh0IC49ICIgQU5EIHN0LnRpY2tldF9zdGF0ZV9pZCBOT1QgSU4gKCAke1woam9pbiAnLCAnLCBzb3J0IEBWaWV3YWJsZVN0YXRlSURzKX0gKSAiOwogICAgfQoKICAgICMgY3VycmVudCB0aWNrZXQgc3RhdGUgdHlwZQogICAgZWxzaWYgKCAkUGFyYW17U3RhdGVUeXBlfSApIHsKICAgICAgICBteSBAU3RhdGVJRHMgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U3RhdGUnKS0+U3RhdGVHZXRTdGF0ZXNCeVR5cGUoCiAgICAgICAgICAgIFN0YXRlVHlwZSA9PiAkUGFyYW17U3RhdGVUeXBlfSwKICAgICAgICAgICAgUmVzdWx0ICAgID0+ICdJRCcsCiAgICAgICAgKTsKICAgICAgICByZXR1cm4gaWYgISRTdGF0ZUlEc1swXTsKICAgICAgICAkU1FMRXh0IC49ICIgQU5EIHN0LnRpY2tldF9zdGF0ZV9pZCBJTiAoICR7XChqb2luICcsICcsIHNvcnQgeyRhIDw9PiAkYn0gQFN0YXRlSURzKX0gKSAiOwogICAgfQoKICAgIGlmICggJFBhcmFte1N0YXRlVHlwZUlEc30gKSB7CgogICAgICAgICMgZ2V0IHN0YXRlIG9iamVjdAogICAgICAgIG15ICRTdGF0ZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTdGF0ZScpOwoKICAgICAgICBteSAlU3RhdGVUeXBlTGlzdCA9ICRTdGF0ZU9iamVjdC0+U3RhdGVUeXBlTGlzdCgKICAgICAgICAgICAgVXNlcklEID0+ICRQYXJhbXtVc2VySUR9IHx8IDEsCiAgICAgICAgKTsKICAgICAgICBteSBAU3RhdGVUeXBlcyA9IG1hcCB7ICRTdGF0ZVR5cGVMaXN0eyRffSB9IEB7ICRQYXJhbXtTdGF0ZVR5cGVJRHN9IH07CiAgICAgICAgbXkgQFN0YXRlSURzICAgPSAkU3RhdGVPYmplY3QtPlN0YXRlR2V0U3RhdGVzQnlUeXBlKAogICAgICAgICAgICBTdGF0ZVR5cGUgPT4gXEBTdGF0ZVR5cGVzLAogICAgICAgICAgICBSZXN1bHQgICAgPT4gJ0lEJywKICAgICAgICApOwoKICAgICAgICByZXR1cm4gaWYgISRTdGF0ZUlEc1swXTsKCiAgICAgICAgJFNRTEV4dCAuPSAiIEFORCBzdC50aWNrZXRfc3RhdGVfaWQgSU4gKCAke1woam9pbiAnLCAnLCBzb3J0IHskYSA8PT4gJGJ9IEBTdGF0ZUlEcyl9ICkgIjsKICAgIH0KCiAgICAjIGN1cnJlbnQgbG9jayBsb29rdXAKICAgIGlmICggJFBhcmFte0xvY2tzfSApIHsKCiAgICAgICAgZm9yIG15ICRMb2NrICggQHsgJFBhcmFte0xvY2tzfSB9ICkgewoKICAgICAgICAgICAgIyBsb29rdXAgbG9jayBpZAogICAgICAgICAgICBteSAkTG9ja0lEID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvY2snKS0+TG9ja0xvb2t1cCgKICAgICAgICAgICAgICAgIExvY2sgPT4gJExvY2ssCiAgICAgICAgICAgICk7CgogICAgICAgICAgICByZXR1cm4gaWYgISRMb2NrSUQ7CgogICAgICAgICAgICBwdXNoIEB7ICRQYXJhbXtMb2NrSURzfSB9LCAkTG9ja0lEOwogICAgICAgIH0KICAgIH0KCiAgICAjIGxvY2sgaWRzCiAgICBpZiAoICRQYXJhbXtMb2NrSURzfSApIHsKICAgICAgICBteSAkU1FMUXVlcnlJbkNvbmRpdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5RdWVyeUluQ29uZGl0aW9uKAogICAgICAgICAgICBLZXkgICAgICAgPT4gJ3N0LnRpY2tldF9sb2NrX2lkJywKICAgICAgICAgICAgVmFsdWVzICAgID0+ICRQYXJhbXtMb2NrSURzfSwKICAgICAgICAgICAgUXVvdGVUeXBlID0+ICdJbnRlZ2VyJywKICAgICAgICAgICAgQmluZE1vZGUgID0+IDAsCiAgICAgICAgKTsKICAgICAgICAkU1FMRXh0IC49ICcgQU5EICggJyAuICRTUUxRdWVyeUluQ29uZGl0aW9uIC4gJyApICc7CiAgICB9CgogICAgIyBjdXJyZW50IG93bmVyIHVzZXIgaWRzCiAgICBpZiAoICRQYXJhbXtPd25lcklEc30gKSB7CiAgICAgICAgbXkgJFNRTFF1ZXJ5SW5Db25kaXRpb24gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6REInKS0+UXVlcnlJbkNvbmRpdGlvbigKICAgICAgICAgICAgS2V5ICAgICAgID0+ICdzdC51c2VyX2lkJywKICAgICAgICAgICAgVmFsdWVzICAgID0+ICRQYXJhbXtPd25lcklEc30sCiAgICAgICAgICAgIFF1b3RlVHlwZSA9PiAnSW50ZWdlcicsCiAgICAgICAgICAgIEJpbmRNb2RlICA9PiAwLAogICAgICAgICk7CiAgICAgICAgJFNRTEV4dCAuPSAnIEFORCAoICcgLiAkU1FMUXVlcnlJbkNvbmRpdGlvbiAuICcgKSAnOwogICAgfQoKICAgICMgY3VycmVudCByZXNwb25zaWJsZSB1c2VyIGlkcwogICAgaWYgKCAkUGFyYW17UmVzcG9uc2libGVJRHN9ICkgewogICAgICAgIG15ICRTUUxRdWVyeUluQ29uZGl0aW9uID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkRCJyktPlF1ZXJ5SW5Db25kaXRpb24oCiAgICAgICAgICAgIEtleSAgICAgICA9PiAnc3QucmVzcG9uc2libGVfdXNlcl9pZCcsCiAgICAgICAgICAgIFZhbHVlcyAgICA9PiAkUGFyYW17UmVzcG9uc2libGVJRHN9LAogICAgICAgICAgICBRdW90ZVR5cGUgPT4gJ0ludGVnZXInLAogICAgICAgICAgICBCaW5kTW9kZSAgPT4gMCwKICAgICAgICApOwogICAgICAgICRTUUxFeHQgLj0gJyBBTkQgKCAnIC4gJFNRTFF1ZXJ5SW5Db25kaXRpb24gLiAnICkgJzsKICAgIH0KCiAgICAjIGNyZWF0ZWQgdXNlciBpZHMKICAgIGlmICggJFBhcmFte0NyZWF0ZWRVc2VySURzfSApIHsKCiAgICAgICAgIyBsb29rdXAgaGlzdG9yeSB0eXBlIGlkCiAgICAgICAgbXkgJEhpc3RvcnlUeXBlSUQgPSAkU2VsZi0+SGlzdG9yeVR5cGVMb29rdXAoCiAgICAgICAgICAgIFR5cGUgPT4gJ05ld1RpY2tldCcsCiAgICAgICAgKTsKCiAgICAgICAgaWYgKCRIaXN0b3J5VHlwZUlEKSB7CiAgICAgICAgICAgIG15ICRUSFJlZiA9ICRTZWxmLT5fVGlja2V0SGlzdG9yeVJlZmVyZW5jZUZvclNlYXJjaEFyZ3VtZW50KAogICAgICAgICAgICAgICAgQXJndW1lbnQgPT4gJ0NyZWF0ZWRVc2VySURzJywKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuIGlmICEkVEhSZWY7CgogICAgICAgICAgICBteSAkU1FMUXVlcnlJbkNvbmRpdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5RdWVyeUluQ29uZGl0aW9uKAogICAgICAgICAgICAgICAgS2V5ICAgICAgID0+ICIkeyBUSFJlZiB9LmNyZWF0ZV9ieSIsCiAgICAgICAgICAgICAgICBWYWx1ZXMgICAgPT4gJFBhcmFte0NyZWF0ZWRVc2VySURzfSwKICAgICAgICAgICAgICAgIFF1b3RlVHlwZSA9PiAnSW50ZWdlcicsCiAgICAgICAgICAgICAgICBCaW5kTW9kZSAgPT4gMCwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgJFNRTEV4dCAuPSAnIEFORCAoICcgLiAkU1FMUXVlcnlJbkNvbmRpdGlvbiAuICcgKSAnOwoKICAgICAgICAgICAgJFNRTEV4dCAuPSAiIEFORCAkeyBUSFJlZiB9Lmhpc3RvcnlfdHlwZV9pZCA9ICRIaXN0b3J5VHlwZUlEICI7CiAgICAgICAgfQogICAgfQoKICAgICMgY3VycmVudCBxdWV1ZSBsb29rdXAKICAgIGlmICggJFBhcmFte1F1ZXVlc30gKSB7CgogICAgICAgICMgZ2V0IHF1ZXVlIG9iamVjdAogICAgICAgIG15ICRRdWV1ZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpRdWV1ZScpOwoKICAgICAgICBmb3IgbXkgJFF1ZXVlICggQHsgJFBhcmFte1F1ZXVlc30gfSApIHsKCiAgICAgICAgICAgICMgbG9va3VwIHF1ZXVlIGlkCiAgICAgICAgICAgIG15ICRRdWV1ZUlEID0gJFF1ZXVlT2JqZWN0LT5RdWV1ZUxvb2t1cCgKICAgICAgICAgICAgICAgIFF1ZXVlID0+ICRRdWV1ZSwKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIHJldHVybiBpZiAhJFF1ZXVlSUQ7CgogICAgICAgICAgICBwdXNoIEB7ICRQYXJhbXtRdWV1ZUlEc30gfSwgJFF1ZXVlSUQ7CiAgICAgICAgfQogICAgfQoKICAgICMgY3VycmVudCBzdWIgcXVldWUgaWRzCiAgICBpZiAoICRQYXJhbXtVc2VTdWJRdWV1ZXN9ICYmICRQYXJhbXtRdWV1ZUlEc30gKSB7CgogICAgICAgICMgZ2V0IHF1ZXVlIG9iamVjdAogICAgICAgIG15ICRRdWV1ZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpRdWV1ZScpOwoKICAgICAgICBteSBAU3ViUXVldWVJRHM7CiAgICAgICAgbXkgJVF1ZXVlcyA9ICRRdWV1ZU9iamVjdC0+R2V0QWxsUXVldWVzKCk7CgogICAgICAgIGZvciBteSAkUXVldWVJRCAoIEB7ICRQYXJhbXtRdWV1ZUlEc30gfSApIHsKCiAgICAgICAgICAgIG15ICRRdWV1ZSA9ICRRdWV1ZU9iamVjdC0+UXVldWVMb29rdXAoIFF1ZXVlSUQgPT4gJFF1ZXVlSUQgKTsKCiAgICAgICAgICAgIGZvciBteSAkUXVldWVzSUQgKCBzb3J0IGtleXMgJVF1ZXVlcyApIHsKICAgICAgICAgICAgICAgIGlmICggJFF1ZXVlc3skUXVldWVzSUR9ID1+IC9eXFEkUXVldWVcRTo6L2kgKSB7CiAgICAgICAgICAgICAgICAgICAgcHVzaCBAU3ViUXVldWVJRHMsICRRdWV1ZXNJRDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHVzaCBAeyAkUGFyYW17UXVldWVJRHN9IH0sIEBTdWJRdWV1ZUlEczsKICAgIH0KCiAgICAjIGN1cnJlbnQgcXVldWUgaWRzCiAgICBpZiAoICRQYXJhbXtRdWV1ZUlEc30gKSB7CgogICAgICAgIG15ICRTUUxRdWVyeUluQ29uZGl0aW9uID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkRCJyktPlF1ZXJ5SW5Db25kaXRpb24oCiAgICAgICAgICAgIEtleSAgICAgICA9PiAnc3QucXVldWVfaWQnLAogICAgICAgICAgICBWYWx1ZXMgICAgPT4gJFBhcmFte1F1ZXVlSURzfSwKICAgICAgICAgICAgUXVvdGVUeXBlID0+ICdJbnRlZ2VyJywKICAgICAgICAgICAgQmluZE1vZGUgID0+IDAsCiAgICAgICAgKTsKICAgICAgICAkU1FMRXh0IC49ICcgQU5EICggJyAuICRTUUxRdWVyeUluQ29uZGl0aW9uIC4gJyApICc7CiAgICB9CgogICAgIyBjcmVhdGVkIHF1ZXVlIGxvb2t1cAogICAgaWYgKCAkUGFyYW17Q3JlYXRlZFF1ZXVlc30gKSB7CgogICAgICAgICMgZ2V0IHF1ZXVlIG9iamVjdAogICAgICAgIG15ICRRdWV1ZU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpRdWV1ZScpOwoKICAgICAgICBmb3IgbXkgJFF1ZXVlICggQHsgJFBhcmFte0NyZWF0ZWRRdWV1ZXN9IH0gKSB7CgogICAgICAgICAgICAjIGxvb2t1cCBxdWV1ZSBpZAogICAgICAgICAgICBteSAkUXVldWVJRCA9ICRRdWV1ZU9iamVjdC0+UXVldWVMb29rdXAoCiAgICAgICAgICAgICAgICBRdWV1ZSA9PiAkUXVldWUsCiAgICAgICAgICAgICk7CgogICAgICAgICAgICByZXR1cm4gaWYgISRRdWV1ZUlEOwoKICAgICAgICAgICAgcHVzaCBAeyAkUGFyYW17Q3JlYXRlZFF1ZXVlSURzfSB9LCAkUXVldWVJRDsKICAgICAgICB9CiAgICB9CgogICAgIyBjcmVhdGVkIHF1ZXVlIGlkcwogICAgaWYgKCAkUGFyYW17Q3JlYXRlZFF1ZXVlSURzfSApIHsKCiAgICAgICAgIyBsb29rdXAgaGlzdG9yeSB0eXBlIGlkCiAgICAgICAgbXkgJEhpc3RvcnlUeXBlSUQgPSAkU2VsZi0+SGlzdG9yeVR5cGVMb29rdXAoCiAgICAgICAgICAgIFR5cGUgPT4gJ05ld1RpY2tldCcsCiAgICAgICAgKTsKCiAgICAgICAgaWYgKCRIaXN0b3J5VHlwZUlEKSB7CiAgICAgICAgICAgIG15ICRUSFJlZiA9ICRTZWxmLT5fVGlja2V0SGlzdG9yeVJlZmVyZW5jZUZvclNlYXJjaEFyZ3VtZW50KAogICAgICAgICAgICAgICAgQXJndW1lbnQgPT4gJ0NyZWF0ZWRRdWV1ZUlEcycsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybiBpZiAhJFRIUmVmOwoKICAgICAgICAgICAgbXkgJFNRTFF1ZXJ5SW5Db25kaXRpb24gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6REInKS0+UXVlcnlJbkNvbmRpdGlvbigKICAgICAgICAgICAgICAgIEtleSAgICAgICA9PiAiJHsgVEhSZWYgfS5xdWV1ZV9pZCIsCiAgICAgICAgICAgICAgICBWYWx1ZXMgICAgPT4gJFBhcmFte0NyZWF0ZWRRdWV1ZUlEc30sCiAgICAgICAgICAgICAgICBRdW90ZVR5cGUgPT4gJ0ludGVnZXInLAogICAgICAgICAgICAgICAgQmluZE1vZGUgID0+IDAsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgICRTUUxFeHQgLj0gJyBBTkQgKCAnIC4gJFNRTFF1ZXJ5SW5Db25kaXRpb24gLiAnICkgJzsKCiAgICAgICAgICAgICRTUUxFeHQgLj0gIiBBTkQgJHsgVEhSZWYgfS5oaXN0b3J5X3R5cGVfaWQgPSAkSGlzdG9yeVR5cGVJRCAiOwogICAgICAgIH0KICAgIH0KCiAgICBteSAlR3JvdXBMaXN0OwoKICAgICMgdXNlciBncm91cHMKICAgIGlmICggJFBhcmFte1VzZXJJRH0gJiYgJFBhcmFte1VzZXJJRH0gIT0gMSApIHsKCiAgICAgICAgIyBnZXQgdXNlcnMgZ3JvdXBzCiAgICAgICAgJUdyb3VwTGlzdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpHcm91cCcpLT5QZXJtaXNzaW9uVXNlckdldCgKICAgICAgICAgICAgVXNlcklEID0+ICRQYXJhbXtVc2VySUR9LAogICAgICAgICAgICBUeXBlICAgPT4gJFBhcmFte1Blcm1pc3Npb259IHx8ICdybycsCiAgICAgICAgKTsKCiAgICAgICAgIyByZXR1cm4gaWYgd2UgaGF2ZSBubyBwZXJtaXNzaW9ucwogICAgICAgIHJldHVybiBpZiAhJUdyb3VwTGlzdDsKCiAgICAgICAgIyBhZGQgZ3JvdXBzIHRvIHF1ZXJ5CiAgICAgICAgJFNRTEV4dCAuPSAnIEFORCBzcS5ncm91cF9pZCBJTiAoJyAuIGpvaW4oICcsJywgc29ydCBrZXlzICVHcm91cExpc3QgKSAuICcpICc7CiAgICB9CgogICAgIyBjdXN0b21lciBncm91cHMKICAgIGlmICggJFBhcmFte0N1c3RvbWVyVXNlcklEfSApIHsKCiAgICAgICAgJUdyb3VwTGlzdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDdXN0b21lckdyb3VwJyktPkdyb3VwTWVtYmVyTGlzdCgKICAgICAgICAgICAgVXNlcklEID0+ICRQYXJhbXtDdXN0b21lclVzZXJJRH0sCiAgICAgICAgICAgIFR5cGUgICA9PiAkUGFyYW17UGVybWlzc2lvbn0gfHwgJ3JvJywKICAgICAgICAgICAgUmVzdWx0ID0+ICdIQVNIJywKICAgICAgICApOwoKICAgICAgICAjIHJldHVybiBpZiB3ZSBoYXZlIG5vIHBlcm1pc3Npb25zCiAgICAgICAgcmV0dXJuIGlmICElR3JvdXBMaXN0OwoKICAgICAgICAjIGdldCBhbGwgY3VzdG9tZXIgaWRzCiAgICAgICAgbXkgQEN1c3RvbWVySURzID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkN1c3RvbWVyVXNlcicpLT5DdXN0b21lcklEcygKICAgICAgICAgICAgVXNlciA9PiAkUGFyYW17Q3VzdG9tZXJVc2VySUR9LAogICAgICAgICk7CgogICAgICAgICMgcHJlcGFyZSBjb21iaW5hdGlvbiBvZiBjdXN0b21lcjwtPmdyb3VwIGFjY2VzcwoKICAgICAgICAjIGFkZCBkZWZhdWx0IGNvbWJpbmF0aW9uIGZpcnN0ICggQ3VzdG9tZXJJRHMgKyBDdXN0b21lclVzZXJJRCA8LT4gcncgYWNjZXNzIGdyb3VwcyApCiAgICAgICAgIyB0aGlzIGdyb3VwIHdpbGwgYWx3YXlzIGJlIGFkZGVkIChlbnN1cmVzIHByZXZpb3VzIGJlaGF2aW9yKQogICAgICAgIG15IEBDdXN0b21lckdyb3VwUGVybWlzc2lvbjsKICAgICAgICBwdXNoIEBDdXN0b21lckdyb3VwUGVybWlzc2lvbiwgewogICAgICAgICAgICBDdXN0b21lcklEcyAgICA9PiBcQEN1c3RvbWVySURzLAogICAgICAgICAgICBDdXN0b21lclVzZXJJRCA9PiAkUGFyYW17Q3VzdG9tZXJVc2VySUR9LAogICAgICAgICAgICBHcm91cElEcyAgICAgICA9PiBbIHNvcnQga2V5cyAlR3JvdXBMaXN0IF0sCiAgICAgICAgfTsKCiAgICAgICAgIyBhZGQgYWxsIGNvbWJpbmF0aW9ucyBiYXNlZCBvbiBncm91cCBhY2Nlc3MgZm9yIG90aGVyIEN1c3RvbWVySURzIChpZiBhdmFpbGFibGUpCiAgICAgICAgIyBvbmx5IGFjdGl2ZSBpZiBjdXN0b21lciBncm91cCBzdXBwb3J0IGFuZCBleHRyYSBwZXJtaXNzaW9uIGNvbnRleHQgYXJlIGVuYWJsZWQKICAgICAgICBteSAkQ3VzdG9tZXJHcm91cE9iamVjdCAgICA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpDdXN0b21lckdyb3VwJyk7CiAgICAgICAgbXkgJEV4dHJhUGVybWlzc2lvbkNvbnRleHQgPSAkQ3VzdG9tZXJHcm91cE9iamVjdC0+R3JvdXBDb250ZXh0TmFtZUdldCgKICAgICAgICAgICAgU3lzQ29uZmlnTmFtZSA9PiAnMTAwLUN1c3RvbWVySUQtb3RoZXInLAogICAgICAgICk7CiAgICAgICAgaWYgKCAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ0N1c3RvbWVyR3JvdXBTdXBwb3J0JykgJiYgJEV4dHJhUGVybWlzc2lvbkNvbnRleHQgKSB7CgogICAgICAgICAgICAjIGFkZCBsb29rdXAgZm9yIEN1c3RvbWVySUQKICAgICAgICAgICAgbXkgJUN1c3RvbWVySURzTG9va3VwID0gbWFwIHsgJF8gPT4gJF8gfSBAQ3VzdG9tZXJJRHM7CgogICAgICAgICAgICAjIGZvciBhbGwgQ3VzdG9tZXJJRHMgZ2V0IGdyb3VwcyB3aXRoIGFjY2VzcyB0byBvdGhlciBDdXN0b21lcklEcwogICAgICAgICAgICBteSAlRXh0cmFQZXJtaXNzaW9uR3JvdXBzOwogICAgICAgICAgICBDVVNUT01FUklEOgogICAgICAgICAgICBmb3IgbXkgJEN1c3RvbWVySUQgKEBDdXN0b21lcklEcykgewogICAgICAgICAgICAgICAgbXkgJUN1c3RvbWVySURFeHRyYVBlcm1pc3Npb25Hcm91cHMgPSAkQ3VzdG9tZXJHcm91cE9iamVjdC0+R3JvdXBDdXN0b21lckxpc3QoCiAgICAgICAgICAgICAgICAgICAgQ3VzdG9tZXJJRCA9PiAkQ3VzdG9tZXJJRCwKICAgICAgICAgICAgICAgICAgICBUeXBlICAgICAgID0+ICRQYXJhbXtQZXJtaXNzaW9ufSB8fCAncm8nLAogICAgICAgICAgICAgICAgICAgIENvbnRleHQgICAgPT4gJEV4dHJhUGVybWlzc2lvbkNvbnRleHQsCiAgICAgICAgICAgICAgICAgICAgUmVzdWx0ICAgICA9PiAnSEFTSCcsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgbmV4dCBDVVNUT01FUklEIGlmICElQ3VzdG9tZXJJREV4dHJhUGVybWlzc2lvbkdyb3VwczsKCiAgICAgICAgICAgICAgICAjIGFkZCB0byBncm91cHMKICAgICAgICAgICAgICAgICVFeHRyYVBlcm1pc3Npb25Hcm91cHMgPSAoCiAgICAgICAgICAgICAgICAgICAgJUV4dHJhUGVybWlzc2lvbkdyb3VwcywKICAgICAgICAgICAgICAgICAgICAlQ3VzdG9tZXJJREV4dHJhUGVybWlzc2lvbkdyb3VwcywKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgYWRkIGFsbCB1bmlxdWUgYWNjZXNzaWJsZSBHcm91cDwtPkN1c3RvbWVyIGNvbWJpbmF0aW9ucyB0byBxdWVyeQogICAgICAgICAgICAjIGZvciBwZXJmb3JtYW5jZSByZWFzb25zIGFsbCBncm91cHMgY29ycmVzcG9uc2luZyB3aXRoIGEgdW5pcXVlIGN1c3RvbWVyIGlkIGNvbWJpbmF0aW9uCiAgICAgICAgICAgICMgICB3aWxsIGJlIGNvbWJpbmVkIGludG8gb25lIHBhcnQKICAgICAgICAgICAgbXkgJUN1c3RvbWVySURDb21iaW5hdGlvbnM7CiAgICAgICAgICAgIEdST1VQSUQ6CiAgICAgICAgICAgIGZvciBteSAkR3JvdXBJRCAoIHNvcnQga2V5cyAlRXh0cmFQZXJtaXNzaW9uR3JvdXBzICkgewogICAgICAgICAgICAgICAgbXkgQEV4dHJhQ3VzdG9tZXJJRHMgPSAkQ3VzdG9tZXJHcm91cE9iamVjdC0+R3JvdXBDdXN0b21lckxpc3QoCiAgICAgICAgICAgICAgICAgICAgR3JvdXBJRCA9PiAkR3JvdXBJRCwKICAgICAgICAgICAgICAgICAgICBUeXBlICAgID0+ICRQYXJhbXtQZXJtaXNzaW9ufSB8fCAncm8nLAogICAgICAgICAgICAgICAgICAgIFJlc3VsdCAgPT4gJ0lEJywKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBuZXh0IEdST1VQSUQgaWYgIUBFeHRyYUN1c3RvbWVySURzOwoKICAgICAgICAgICAgICAgICMgZXhjbHVkZSBvd24gQ3VzdG9tZXJJRHMgZm9yIHBlcmZvcm1hbmNlIHJlYXNvbnMKICAgICAgICAgICAgICAgIG15IEBNZXJnZWRDdXN0b21lcklEcyA9IGdyZXAgeyAhJEN1c3RvbWVySURzTG9va3VweyRffSB9IEBFeHRyYUN1c3RvbWVySURzOwogICAgICAgICAgICAgICAgbmV4dCBHUk9VUElEIGlmICFATWVyZ2VkQ3VzdG9tZXJJRHM7CgogICAgICAgICAgICAgICAgIyByZW1lbWJlciBjb21iaW5hdGlvbgogICAgICAgICAgICAgICAgbXkgJEN1c3RvbWVySURTdHJpbmcgPSBqb2luICcsJywgc29ydCBATWVyZ2VkQ3VzdG9tZXJJRHM7CiAgICAgICAgICAgICAgICBpZiAoICEkQ3VzdG9tZXJJRENvbWJpbmF0aW9uc3skQ3VzdG9tZXJJRFN0cmluZ30gKSB7CiAgICAgICAgICAgICAgICAgICAgJEN1c3RvbWVySURDb21iaW5hdGlvbnN7JEN1c3RvbWVySURTdHJpbmd9ID0gewogICAgICAgICAgICAgICAgICAgICAgICBDdXN0b21lcklEcyA9PiBcQE1lcmdlZEN1c3RvbWVySURzLAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBwdXNoIEB7ICRDdXN0b21lcklEQ29tYmluYXRpb25zeyRDdXN0b21lcklEU3RyaW5nfS0+e0dyb3VwSURzfSB9LCAkR3JvdXBJRDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBhZGQgdG8gcXVlcnkgY29tYmluYXRpb25zCiAgICAgICAgICAgIHB1c2ggQEN1c3RvbWVyR3JvdXBQZXJtaXNzaW9uLCBzb3J0IHZhbHVlcyAlQ3VzdG9tZXJJRENvbWJpbmF0aW9uczsKICAgICAgICB9CgogICAgICAgICMgcHJlcGFyZSBMT1dFUiBjYWxsIGRlcGVuZGluZyBvbiBkYXRhYmFzZQogICAgICAgIG15ICRMb3dlciA9ICcnOwogICAgICAgIGlmICggJERCT2JqZWN0LT5HZXREYXRhYmFzZUZ1bmN0aW9uKCdDYXNlU2Vuc2l0aXZlJykgKSB7CiAgICAgICAgICAgICRMb3dlciA9ICdMT1dFUic7CiAgICAgICAgfQoKICAgICAgICAjIG5vdyBhZGQgYWxsIGNvbWJpbmF0aW9ucyB0byBxdWVyeToKICAgICAgICAjIHRoaXMgd2lsbCBjb21waWxlIGEgc2VhcmNoIHJlc3RyaWN0aW9uIGJhc2VkIG9uIGN1c3RvbWVyX2lkL2N1c3RvbWVyX3VzZXJfaWQgYW5kIGdyb3VwCiAgICAgICAgIyAgIGFuZCB3aWxsIG1hdGNoIGlmIGFueSBvZiB0aGUgcGVybWlzc2lvbiBjb21iaW5hdGlvbiBpcyBtZXQKICAgICAgICAjIGEgcGVybWlzc2lvbiBjb21iaW5hdGlvbiBjb3VsZCBiZToKICAgICAgICAjICAgICAoIDxDdXN0b21lclVzZXJJRD4gT1IgPENVU1RPTUVSSUQxPiApIEFORCAoIDxHUk9VUElEMT4gKQogICAgICAgICMgb3IKICAgICAgICAjICAgICAoIDxDdXN0b21lcklEMT4gT1IgPENVU1RPTUVSSUQyPiBPUiA8Q1VTVE9NRVJJRDM+ICkgQU5EICggPEdST1VQSUQxPiBPUiA8R1JPVVBJRDI+ICkKICAgICAgICAkU1FMRXh0IC49ICcgQU5EICgnOwogICAgICAgIG15ICRDdXN0b21lckdyb3VwU1FMID0gJyc7CiAgICAgICAgRU5UUlk6CiAgICAgICAgZm9yIG15ICRFbnRyeSAoQEN1c3RvbWVyR3JvdXBQZXJtaXNzaW9uKSB7CiAgICAgICAgICAgICRDdXN0b21lckdyb3VwU1FMIC49ICRDdXN0b21lckdyb3VwU1FMID8gJyBPUiAoJyA6ICcoJzsKCiAgICAgICAgICAgIG15ICRDdXN0b21lcklEc1NRTDsKICAgICAgICAgICAgaWYgKCBJc0FycmF5UmVmV2l0aERhdGEoICRFbnRyeS0+e0N1c3RvbWVySURzfSApICkgewogICAgICAgICAgICAgICAgJEN1c3RvbWVySURzU1FMID0KICAgICAgICAgICAgICAgICAgICAkTG93ZXIgLiAnKHN0LmN1c3RvbWVyX2lkKSBJTiAoJwogICAgICAgICAgICAgICAgICAgIC4gam9pbigKICAgICAgICAgICAgICAgICAgICAnLCcsCiAgICAgICAgICAgICAgICAgICAgbWFwIHsKICAgICAgICAgICAgICAgICAgICAgICAgIiRMb3dlcignIiAuICREQk9iamVjdC0+UXVvdGUoJF8pIC4gIicpIgogICAgICAgICAgICAgICAgICAgICAgICB9IEB7CiAgICAgICAgICAgICAgICAgICAgICAgICRFbnRyeS0+e0N1c3RvbWVySURzfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIC4gJyknOwogICAgICAgICAgICB9CgogICAgICAgICAgICBteSAkQ3VzdG9tZXJVc2VySURTUUw7CiAgICAgICAgICAgIGlmICggJEVudHJ5LT57Q3VzdG9tZXJVc2VySUR9ICkgewogICAgICAgICAgICAgICAgJEN1c3RvbWVyVXNlcklEU1FMID0gJ3N0LmN1c3RvbWVyX3VzZXJfaWQgPSAnIC4gIiciIC4gJERCT2JqZWN0LT5RdW90ZSggJFBhcmFte0N1c3RvbWVyVXNlcklEfSApIC4gIiciOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoICRDdXN0b21lcklEc1NRTCAmJiAkQ3VzdG9tZXJVc2VySURTUUwgKSB7CiAgICAgICAgICAgICAgICAkQ3VzdG9tZXJHcm91cFNRTCAuPSAnKCAnIC4gJEN1c3RvbWVySURzU1FMIC4gJyBPUiAnIC4gJEN1c3RvbWVyVXNlcklEU1FMIC4gJyApJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNpZiAoJEN1c3RvbWVySURzU1FMKSB7CiAgICAgICAgICAgICAgICAkQ3VzdG9tZXJHcm91cFNRTCAuPSAkQ3VzdG9tZXJJRHNTUUw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzaWYgKCRDdXN0b21lclVzZXJJRFNRTCkgewogICAgICAgICAgICAgICAgJEN1c3RvbWVyR3JvdXBTUUwgLj0gJEN1c3RvbWVyVXNlcklEU1FMOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgbmV4dCBFTlRSWTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJEN1c3RvbWVyR3JvdXBTUUwgLj0gJyBBTkQgc3EuZ3JvdXBfaWQgSU4gKCcgLiBqb2luKCAnLCcsIEB7ICRFbnRyeS0+e0dyb3VwSURzfSB9ICkgLiAnKSApJzsKICAgICAgICB9CiAgICAgICAgJFNRTEV4dCAuPSAkQ3VzdG9tZXJHcm91cFNRTCAuICcpICc7CiAgICB9CgogICAgIyBjdXJyZW50IHByaW9yaXR5IGxvb2t1cAogICAgaWYgKCAkUGFyYW17UHJpb3JpdGllc30gKSB7CgogICAgICAgICMgZ2V0IHByaW9yaXR5IG9iamVjdAogICAgICAgIG15ICRQcmlvcml0eU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpQcmlvcml0eScpOwoKICAgICAgICBmb3IgbXkgJFByaW9yaXR5ICggQHsgJFBhcmFte1ByaW9yaXRpZXN9IH0gKSB7CgogICAgICAgICAgICAjIGxvb2t1cCBwcmlvcml0eSBpZAogICAgICAgICAgICBteSAkUHJpb3JpdHlJRCA9ICRQcmlvcml0eU9iamVjdC0+UHJpb3JpdHlMb29rdXAoCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAkUHJpb3JpdHksCiAgICAgICAgICAgICk7CgogICAgICAgICAgICByZXR1cm4gaWYgISRQcmlvcml0eUlEOwoKICAgICAgICAgICAgcHVzaCBAeyAkUGFyYW17UHJpb3JpdHlJRHN9IH0sICRQcmlvcml0eUlEOwogICAgICAgIH0KICAgIH0KCiAgICAjIHByaW9yaXR5IGlkcwogICAgaWYgKCAkUGFyYW17UHJpb3JpdHlJRHN9ICkgewoKICAgICAgICBteSAkU1FMUXVlcnlJbkNvbmRpdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5RdWVyeUluQ29uZGl0aW9uKAogICAgICAgICAgICBLZXkgICAgICAgPT4gJ3N0LnRpY2tldF9wcmlvcml0eV9pZCcsCiAgICAgICAgICAgIFZhbHVlcyAgICA9PiAkUGFyYW17UHJpb3JpdHlJRHN9LAogICAgICAgICAgICBRdW90ZVR5cGUgPT4gJ0ludGVnZXInLAogICAgICAgICAgICBCaW5kTW9kZSAgPT4gMCwKICAgICAgICApOwogICAgICAgICRTUUxFeHQgLj0gJyBBTkQgKCAnIC4gJFNRTFF1ZXJ5SW5Db25kaXRpb24gLiAnICkgJzsKICAgIH0KCiAgICAjIGNyZWF0ZWQgcHJpb3JpdHkgbG9va3VwCiAgICBpZiAoICRQYXJhbXtDcmVhdGVkUHJpb3JpdGllc30gKSB7CgogICAgICAgICMgZ2V0IHByaW9yaXR5IG9iamVjdAogICAgICAgIG15ICRQcmlvcml0eU9iamVjdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpQcmlvcml0eScpOwoKICAgICAgICBmb3IgbXkgJFByaW9yaXR5ICggQHsgJFBhcmFte0NyZWF0ZWRQcmlvcml0aWVzfSB9ICkgewoKICAgICAgICAgICAgIyBsb29rdXAgcHJpb3JpdHkgaWQKICAgICAgICAgICAgbXkgJFByaW9yaXR5SUQgPSAkUHJpb3JpdHlPYmplY3QtPlByaW9yaXR5TG9va3VwKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJFByaW9yaXR5LAogICAgICAgICAgICApOwoKICAgICAgICAgICAgcmV0dXJuIGlmICEkUHJpb3JpdHlJRDsKCiAgICAgICAgICAgIHB1c2ggQHsgJFBhcmFte0NyZWF0ZWRQcmlvcml0eUlEc30gfSwgJFByaW9yaXR5SUQ7CiAgICAgICAgfQogICAgfQoKICAgICMgY3JlYXRlZCBwcmlvcml0eSBpZHMKICAgIGlmICggJFBhcmFte0NyZWF0ZWRQcmlvcml0eUlEc30gKSB7CgogICAgICAgICMgbG9va3VwIGhpc3RvcnkgdHlwZSBpZAogICAgICAgIG15ICRIaXN0b3J5VHlwZUlEID0gJFNlbGYtPkhpc3RvcnlUeXBlTG9va3VwKAogICAgICAgICAgICBUeXBlID0+ICdOZXdUaWNrZXQnLAogICAgICAgICk7CgogICAgICAgIGlmICgkSGlzdG9yeVR5cGVJRCkgewogICAgICAgICAgICBteSAkVEhSZWYgPSAkU2VsZi0+X1RpY2tldEhpc3RvcnlSZWZlcmVuY2VGb3JTZWFyY2hBcmd1bWVudCgKICAgICAgICAgICAgICAgIEFyZ3VtZW50ID0+ICdDcmVhdGVkUHJpb3JpdHlJRHMnLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm4gaWYgISRUSFJlZjsKCiAgICAgICAgICAgIG15ICRTUUxRdWVyeUluQ29uZGl0aW9uID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkRCJyktPlF1ZXJ5SW5Db25kaXRpb24oCiAgICAgICAgICAgICAgICBLZXkgICAgICAgPT4gIiR7IFRIUmVmIH0ucHJpb3JpdHlfaWQiLAogICAgICAgICAgICAgICAgVmFsdWVzICAgID0+ICRQYXJhbXtDcmVhdGVkUHJpb3JpdHlJRHN9LAogICAgICAgICAgICAgICAgUXVvdGVUeXBlID0+ICdJbnRlZ2VyJywKICAgICAgICAgICAgICAgIEJpbmRNb2RlICA9PiAwLAogICAgICAgICAgICApOwogICAgICAgICAgICAkU1FMRXh0IC49ICcgQU5EICggJyAuICRTUUxRdWVyeUluQ29uZGl0aW9uIC4gJyApICc7CgogICAgICAgICAgICAkU1FMRXh0IC49ICIgQU5EICR7IFRIUmVmIH0uaGlzdG9yeV90eXBlX2lkID0gJEhpc3RvcnlUeXBlSUQgIjsKICAgICAgICB9CiAgICB9CgogICAgIyBjdXJyZW50IHNlcnZpY2UgbG9va3VwCiAgICBpZiAoICRQYXJhbXtTZXJ2aWNlc30gKSB7CgogICAgICAgICMgZ2V0IHNlcnZpY2Ugb2JqZWN0CiAgICAgICAgbXkgJFNlcnZpY2VPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U2VydmljZScpOwoKICAgICAgICBmb3IgbXkgJFNlcnZpY2UgKCBAeyAkUGFyYW17U2VydmljZXN9IH0gKSB7CgogICAgICAgICAgICAjIGxvb2t1cCBzZXJ2aWNlIGlkCiAgICAgICAgICAgIG15ICRTZXJ2aWNlSUQgPSAkU2VydmljZU9iamVjdC0+U2VydmljZUxvb2t1cCgKICAgICAgICAgICAgICAgIE5hbWUgPT4gJFNlcnZpY2UsCiAgICAgICAgICAgICk7CgogICAgICAgICAgICByZXR1cm4gaWYgISRTZXJ2aWNlSUQ7CgogICAgICAgICAgICBwdXNoIEB7ICRQYXJhbXtTZXJ2aWNlSURzfSB9LCAkU2VydmljZUlEOwogICAgICAgIH0KICAgIH0KCiAgICAjIHNlcnZpY2UgaWRzCiAgICBpZiAoICRQYXJhbXtTZXJ2aWNlSURzfSApIHsKICAgICAgICBteSAkU1FMUXVlcnlJbkNvbmRpdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5RdWVyeUluQ29uZGl0aW9uKAogICAgICAgICAgICBLZXkgICAgICAgPT4gJ3N0LnNlcnZpY2VfaWQnLAogICAgICAgICAgICBWYWx1ZXMgICAgPT4gJFBhcmFte1NlcnZpY2VJRHN9LAogICAgICAgICAgICBRdW90ZVR5cGUgPT4gJ0ludGVnZXInLAogICAgICAgICAgICBCaW5kTW9kZSAgPT4gMCwKICAgICAgICApOwogICAgICAgICRTUUxFeHQgLj0gJyBBTkQgKCAnIC4gJFNRTFF1ZXJ5SW5Db25kaXRpb24gLiAnICkgJzsKICAgIH0KCiAgICAjIGN1cnJlbnQgc2xhIGxvb2t1cAogICAgaWYgKCAkUGFyYW17U0xBc30gKSB7CgogICAgICAgICMgZ2V0IHNsYSBvYmplY3QKICAgICAgICBteSAkU0xBT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlNMQScpOwoKICAgICAgICBmb3IgbXkgJFNMQSAoIEB7ICRQYXJhbXtTTEFzfSB9ICkgewoKICAgICAgICAgICAgIyBsb29rdXAgc2xhIGlkCiAgICAgICAgICAgIG15ICRTTEFJRCA9ICRTTEFPYmplY3QtPlNMQUxvb2t1cCgKICAgICAgICAgICAgICAgIE5hbWUgPT4gJFNMQSwKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIHJldHVybiBpZiAhJFNMQUlEOwoKICAgICAgICAgICAgcHVzaCBAeyAkUGFyYW17U0xBSURzfSB9LCAkU0xBSUQ7CiAgICAgICAgfQogICAgfQoKICAgICMgc2xhIGlkcwogICAgaWYgKCAkUGFyYW17U0xBSURzfSApIHsKICAgICAgICBteSAkU1FMUXVlcnlJbkNvbmRpdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5RdWVyeUluQ29uZGl0aW9uKAogICAgICAgICAgICBLZXkgICAgICAgPT4gJ3N0LnNsYV9pZCcsCiAgICAgICAgICAgIFZhbHVlcyAgICA9PiAkUGFyYW17U0xBSURzfSwKICAgICAgICAgICAgUXVvdGVUeXBlID0+ICdJbnRlZ2VyJywKICAgICAgICAgICAgQmluZE1vZGUgID0+IDAsCiAgICAgICAgKTsKICAgICAgICAkU1FMRXh0IC49ICcgQU5EICggJyAuICRTUUxRdWVyeUluQ29uZGl0aW9uIC4gJyApICc7CiAgICB9CgogICAgIyB3YXRjaCB1c2VyIGlkcwogICAgaWYgKCAkUGFyYW17V2F0Y2hVc2VySURzfSApIHsKICAgICAgICBteSAkU1FMUXVlcnlJbkNvbmRpdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpEQicpLT5RdWVyeUluQ29uZGl0aW9uKAogICAgICAgICAgICBLZXkgICAgICAgPT4gJ3R3LnVzZXJfaWQnLAogICAgICAgICAgICBWYWx1ZXMgICAgPT4gJFBhcmFte1dhdGNoVXNlcklEc30sCiAgICAgICAgICAgIFF1b3RlVHlwZSA9PiAnSW50ZWdlcicsCiAgICAgICAgICAgIEJpbmRNb2RlICA9PiAwLAogICAgICAgICk7CiAgICAgICAgJFNRTEV4dCAuPSAnIEFORCAoICcgLiAkU1FMUXVlcnlJbkNvbmRpdGlvbiAuICcgKSAnOwogICAgfQoKICAgICMgYWRkIHRpY2tldCBmbGFnIGV4dGVuc2lvbgogICAgaWYgKCAkUGFyYW17VGlja2V0RmxhZ30gKSB7CgogICAgICAgIG15ICRUaWNrZXRGbGFnVXNlcklEID0gJFBhcmFte1RpY2tldEZsYWdVc2VySUR9IHx8ICRQYXJhbXtVc2VySUR9OwogICAgICAgIHJldHVybiBpZiAhZGVmaW5lZCAkVGlja2V0RmxhZ1VzZXJJRDsKCiAgICAgICAgbXkgJEluZGV4ID0gMTsKICAgICAgICBmb3IgbXkgJEtleSAoIHNvcnQga2V5cyAleyAkUGFyYW17VGlja2V0RmxhZ30gfSApIHsKICAgICAgICAgICAgbXkgJFZhbHVlID0gJFBhcmFte1RpY2tldEZsYWd9LT57JEtleX07CiAgICAgICAgICAgIHJldHVybiBpZiAhZGVmaW5lZCAkVmFsdWU7CgogICAgICAgICAgICAkU1FMRXh0IC49ICIgQU5EIHRmJEluZGV4LnRpY2tldF9rZXkgPSAnIiAuICREQk9iamVjdC0+UXVvdGUoJEtleSkgLiAiJyI7CiAgICAgICAgICAgICRTUUxFeHQgLj0gIiBBTkQgdGYkSW5kZXgudGlja2V0X3ZhbHVlID0gJyIgLiAkREJPYmplY3QtPlF1b3RlKCRWYWx1ZSkgLiAiJyI7CiAgICAgICAgICAgICRTUUxFeHQgLj0gIiBBTkQgdGYkSW5kZXguY3JlYXRlX2J5ID0gIgogICAgICAgICAgICAgICAgLiAkREJPYmplY3QtPlF1b3RlKCAkVGlja2V0RmxhZ1VzZXJJRCwgJ0ludGVnZXInICk7CgogICAgICAgICAgICAkSW5kZXgrKzsKICAgICAgICB9CiAgICB9CgogICAgIyBhZGQgYXJ0aWNsZSBmbGFnIGV4dGVuc2lvbgogICAgaWYgKCAkUGFyYW17QXJ0aWNsZUZsYWd9ICkgewogICAgICAgIG15ICRBcnRpY2xlRmxhZ1VzZXJJRCA9ICRQYXJhbXtBcnRpY2xlRmxhZ1VzZXJJRH0gfHwgJFBhcmFte1VzZXJJRH07CiAgICAgICAgcmV0dXJuIGlmICFkZWZpbmVkICRBcnRpY2xlRmxhZ1VzZXJJRDsKCiAgICAgICAgbXkgJEluZGV4ID0gMTsKICAgICAgICBmb3IgbXkgJEtleSAoIHNvcnQga2V5cyAleyAkUGFyYW17QXJ0aWNsZUZsYWd9IH0gKSB7CiAgICAgICAgICAgIG15ICRWYWx1ZSA9ICRQYXJhbXtBcnRpY2xlRmxhZ30tPnskS2V5fTsKICAgICAgICAgICAgcmV0dXJuIGlmICFkZWZpbmVkICRWYWx1ZTsKCiAgICAgICAgICAgICRTUUxFeHQgLj0gIiBBTkQgdGFmJEluZGV4LmFydGljbGVfa2V5ID0gJyIgLiAkREJPYmplY3QtPlF1b3RlKCRLZXkpIC4gIiciOwogICAgICAgICAgICAkU1FMRXh0IC49ICIgQU5EIHRhZiRJbmRleC5hcnRpY2xlX3ZhbHVlID0gJyIgLiAkREJPYmplY3QtPlF1b3RlKCRWYWx1ZSkgLiAiJyI7CiAgICAgICAgICAgICRTUUxFeHQgLj0gIiBBTkQgdGFmJEluZGV4LmNyZWF0ZV9ieSA9ICIKICAgICAgICAgICAgICAgIC4gJERCT2JqZWN0LT5RdW90ZSggJEFydGljbGVGbGFnVXNlcklELCAnSW50ZWdlcicgKTsKCiAgICAgICAgICAgICRJbmRleCsrOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAoICRQYXJhbXtOb3RUaWNrZXRGbGFnfSApIHsKICAgICAgICBteSAkSW5kZXggPSAxOwogICAgICAgIGZvciBteSAkS2V5ICggc29ydCBrZXlzICV7ICRQYXJhbXtOb3RUaWNrZXRGbGFnfSB9ICkgewogICAgICAgICAgICBteSAkVmFsdWUgPSAkUGFyYW17Tm90VGlja2V0RmxhZ30tPnskS2V5fTsKICAgICAgICAgICAgcmV0dXJuIGlmICFkZWZpbmVkICRWYWx1ZTsKCiAgICAgICAgICAgICRTUUxFeHQgLj0gIiBBTkQgKG50ZiRJbmRleC50aWNrZXRfdmFsdWUgSVMgTlVMTCAiCiAgICAgICAgICAgICAgICAuICJPUiBudGYkSW5kZXgudGlja2V0X3ZhbHVlIDw+ICciIC4gJERCT2JqZWN0LT5RdW90ZSgkVmFsdWUpIC4gIicpIjsKCiAgICAgICAgICAgICRJbmRleCsrOwogICAgICAgIH0KICAgIH0KCiAgICAjIG90aGVyIHRpY2tldCBzdHVmZgogICAgbXkgJUZpZWxkU1FMTWFwID0gKAogICAgICAgIFRpY2tldE51bWJlciAgICAgICAgID0+ICdzdC50bicsCiAgICAgICAgVGl0bGUgICAgICAgICAgICAgICAgPT4gJ3N0LnRpdGxlJywKICAgICAgICBDdXN0b21lcklEICAgICAgICAgICA9PiAnc3QuY3VzdG9tZXJfaWQnLAogICAgICAgIEN1c3RvbWVySURSYXcgICAgICAgID0+ICdzdC5jdXN0b21lcl9pZCcsCiAgICAgICAgQ3VzdG9tZXJVc2VyTG9naW4gICAgPT4gJ3N0LmN1c3RvbWVyX3VzZXJfaWQnLAogICAgICAgIEN1c3RvbWVyVXNlckxvZ2luUmF3ID0+ICdzdC5jdXN0b21lcl91c2VyX2lkJywKICAgICk7CgogICAgQVRUUklCVVRFOgogICAgZm9yIG15ICRLZXkgKCBzb3J0IGtleXMgJUZpZWxkU1FMTWFwICkgewoKICAgICAgICBuZXh0IEFUVFJJQlVURSBpZiAhZGVmaW5lZCAkUGFyYW17JEtleX07CgogICAgICAgIG5leHQgQVRUUklCVVRFIGlmICggKCAkS2V5IGVxICdDdXN0b21lcklEJyApICYmICggZGVmaW5lZCAkUGFyYW17Q3VzdG9tZXJJRFJhd30gKSApOwogICAgICAgIG5leHQgQVRUUklCVVRFCiAgICAgICAgICAgIGlmICggKCAkS2V5IGVxICdDdXN0b21lclVzZXJMb2dpbicgKSAmJiAoIGRlZmluZWQgJFBhcmFte0N1c3RvbWVyVXNlckxvZ2luUmF3fSApICk7CgogICAgICAgICMgaWYgaXQncyBubyByZWYsIHB1dCBpdCB0byBhcnJheSByZWYKICAgICAgICBpZiAoIHJlZiAkUGFyYW17JEtleX0gZXEgJycgKSB7CiAgICAgICAgICAgICRQYXJhbXskS2V5fSA9IFsgJFBhcmFteyRLZXl9IF07CiAgICAgICAgfQoKICAgICAgICAjIHByb2NjZXNzIGFycmF5IHJlZgogICAgICAgIG15ICRVc2VkID0gMDsKCiAgICAgICAgVkFMVUU6CiAgICAgICAgZm9yIG15ICRWYWx1ZSAoIEB7ICRQYXJhbXskS2V5fSB9ICkgewoKICAgICAgICAgICAgbmV4dCBWQUxVRSBpZiAhZGVmaW5lZCAkVmFsdWUgfHwgIWxlbmd0aCAkVmFsdWU7CgogICAgICAgICAgICAjIHJlcGxhY2Ugd2lsZCBjYXJkIHNlYXJjaAogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAkS2V5IG5lICdDdXN0b21lcklEUmF3JwogICAgICAgICAgICAgICAgJiYgJEtleSBuZSAnQ3VzdG9tZXJVc2VyTG9naW5SYXcnCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRWYWx1ZSA9fiBzL1wqLyUvZ2k7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgY2hlY2sgc2VhcmNoIGF0dHJpYnV0ZSwgd2UgZG8gbm90IG5lZWQgdG8gc2VhcmNoIGZvciAqCiAgICAgICAgICAgIG5leHQgVkFMVUUgaWYgJFZhbHVlID1+IC9eXCV7MSwzfSQvOwoKICAgICAgICAgICAgaWYgKCAhJFVzZWQgKSB7CiAgICAgICAgICAgICAgICAkU1FMRXh0IC49ICcgQU5EICgnOwogICAgICAgICAgICAgICAgJFVzZWQgPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJFNRTEV4dCAuPSAnIE9SICc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgYWRkICogdG8gcHJlZml4L3N1ZmZpeCBvbiB0aXRsZSBzZWFyY2gKICAgICAgICAgICAgbXkgJUNvbmRpdGlvbkZvY3VzOwogICAgICAgICAgICBpZiAoICRQYXJhbXtDb25kaXRpb25JbmxpbmV9ICYmICRLZXkgZXEgJ1RpdGxlJyApIHsKICAgICAgICAgICAgICAgICRDb25kaXRpb25Gb2N1c3tFeHRlbmRlZH0gPSAxOwogICAgICAgICAgICAgICAgaWYgKCAkUGFyYW17Q29udGVudFNlYXJjaFByZWZpeH0gKSB7CiAgICAgICAgICAgICAgICAgICAgJENvbmRpdGlvbkZvY3Vze1NlYXJjaFByZWZpeH0gPSAkUGFyYW17Q29udGVudFNlYXJjaFByZWZpeH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoICRQYXJhbXtDb250ZW50U2VhcmNoU3VmZml4fSApIHsKICAgICAgICAgICAgICAgICAgICAkQ29uZGl0aW9uRm9jdXN7U2VhcmNoU3VmZml4fSA9ICRQYXJhbXtDb250ZW50U2VhcmNoU3VmZml4fTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCAkS2V5IGVxICdDdXN0b21lcklEUmF3JyB8fCAkS2V5IGVxICdDdXN0b21lclVzZXJMb2dpblJhdycgKSB7CiAgICAgICAgICAgICAgICAkU1FMRXh0IC49ICIgJEZpZWxkU1FMTWFweyRLZXl9PSAnIiAuICREQk9iamVjdC0+UXVvdGUoJFZhbHVlKSAuICInIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKCiAgICAgICAgICAgICAgICAjIHVzZSBzZWFyY2ggY29uZGl0aW9uIGV4dGVuc2lvbgogICAgICAgICAgICAgICAgJFNRTEV4dCAuPSAkREJPYmplY3QtPlF1ZXJ5Q29uZGl0aW9uKAogICAgICAgICAgICAgICAgICAgIEtleSAgID0+ICRGaWVsZFNRTE1hcHskS2V5fSwKICAgICAgICAgICAgICAgICAgICBWYWx1ZSA9PiAkVmFsdWUsCiAgICAgICAgICAgICAgICAgICAgJUNvbmRpdGlvbkZvY3VzLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoJFVzZWQpIHsKICAgICAgICAgICAgJFNRTEV4dCAuPSAnKSc7CiAgICAgICAgfQogICAgfQoKICAgICMgU2VhcmNoIGFydGljbGUgYXR0cmlidXRlcy4KICAgIGlmICgkQXJ0aWNsZVRhYmxlSm9pbmVkKSB7CgogICAgICAgICRTUUxFeHQgLj0gJEFydGljbGVPYmplY3QtPkFydGljbGVTZWFyY2hJbmRleFdoZXJlQ29uZGl0aW9uKCBTZWFyY2hQYXJhbXMgPT4gXCVQYXJhbSApOwoKICAgICAgICAjIFJlc3RyaWN0IHNlYXJjaCBmcm9tIGN1c3RvbWVycyB0byBvbmx5IGN1c3RvbWVyIGFydGljbGVzLgogICAgICAgIGlmICggJFBhcmFte0N1c3RvbWVyVXNlcklEfSApIHsKICAgICAgICAgICAgJFNRTEV4dCAuPSAnIEFORCBhcnQuaXNfdmlzaWJsZV9mb3JfY3VzdG9tZXIgPSAxICc7CiAgICAgICAgfQogICAgfQoKICAgICMgUmVtZW1iZXIgYWxyZWFkeSBqb2luZWQgdGFibGVzIGZvciBzb3J0aW5nLgogICAgbXkgJUR5bmFtaWNGaWVsZEpvaW5UYWJsZXM7CiAgICBteSAkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIgPSAxOwoKICAgICMgZ2V0IGR5bmFtaWMgZmllbGQgYmFja2VuZCBvYmplY3QKICAgIG15ICREeW5hbWljRmllbGRCYWNrZW5kT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkR5bmFtaWNGaWVsZDo6QmFja2VuZCcpOwoKICAgIERZTkFNSUNfRklFTEQ6CiAgICBmb3IgbXkgJER5bmFtaWNGaWVsZCAoIEB7JFRpY2tldER5bmFtaWNGaWVsZHN9LCBAeyRBcnRpY2xlRHluYW1pY0ZpZWxkc30gKSB7CiAgICAgICAgbXkgJFNlYXJjaFBhcmFtID0gZGVsZXRlICRQYXJhbXsgIkR5bmFtaWNGaWVsZF8iIC4gJER5bmFtaWNGaWVsZC0+e05hbWV9IH07CgogICAgICAgIG5leHQgRFlOQU1JQ19GSUVMRCBpZiAoICEkU2VhcmNoUGFyYW0gKTsKICAgICAgICBuZXh0IERZTkFNSUNfRklFTEQgaWYgKCByZWYgJFNlYXJjaFBhcmFtIG5lICdIQVNIJyApOwoKICAgICAgICBteSAkTmVlZEpvaW47CiAgICAgICAgbXkgJFF1ZXJ5Rm9yRW1wdHlWYWx1ZXMgPSAwOwoKICAgICAgICBmb3IgbXkgJE9wZXJhdG9yICggc29ydCBrZXlzICV7JFNlYXJjaFBhcmFtfSApIHsKCiAgICAgICAgICAgIG15IEBTZWFyY2hQYXJhbXMgPSAoIHJlZiAkU2VhcmNoUGFyYW0tPnskT3BlcmF0b3J9IGVxICdBUlJBWScgKQogICAgICAgICAgICAgICAgPyBAeyAkU2VhcmNoUGFyYW0tPnskT3BlcmF0b3J9IH0KICAgICAgICAgICAgICAgIDogKCAkU2VhcmNoUGFyYW0tPnskT3BlcmF0b3J9ICk7CgogICAgICAgICAgICBteSAkU1FMRXh0U3ViID0gJyBBTkQgKCc7CiAgICAgICAgICAgIG15ICRDb3VudGVyICAgPSAwOwogICAgICAgICAgICBURVhUOgogICAgICAgICAgICBmb3IgbXkgJFRleHQgKEBTZWFyY2hQYXJhbXMpIHsKICAgICAgICAgICAgICAgIG5leHQgVEVYVCBpZiAoICFkZWZpbmVkICRUZXh0IHx8ICRUZXh0IGVxICcnICk7CgogICAgICAgICAgICAgICAgJFRleHQgPX4gcy9cKi8lL2dpOwoKICAgICAgICAgICAgICAgICMgY2hlY2sgc2VhcmNoIGF0dHJpYnV0ZSwgd2UgZG8gbm90IG5lZWQgdG8gc2VhcmNoIGZvciAqCiAgICAgICAgICAgICAgICBuZXh0IFRFWFQgaWYgJFRleHQgPX4gL15cJXsxLDN9JC87CgogICAgICAgICAgICAgICAgIyBza2lwIHZhbGlkYXRpb24gZm9yIGVtcHR5IHZhbHVlcwogICAgICAgICAgICAgICAgaWYgKCAkT3BlcmF0b3IgbmUgJ0VtcHR5JyApIHsKCiAgICAgICAgICAgICAgICAgICAgIyB2YWxpZGF0ZSBkYXRhIHR5cGUKICAgICAgICAgICAgICAgICAgICBteSAkVmFsaWRhdGVTdWNjZXNzID0gJER5bmFtaWNGaWVsZEJhY2tlbmRPYmplY3QtPlZhbHVlVmFsaWRhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIER5bmFtaWNGaWVsZENvbmZpZyA9PiAkRHluYW1pY0ZpZWxkLAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZSAgICAgICAgICAgICAgPT4gJFRleHQsCiAgICAgICAgICAgICAgICAgICAgICAgIE5vVmFsaWRhdGVSZWdleCAgICA9PiAxLAogICAgICAgICAgICAgICAgICAgICAgICBVc2VySUQgICAgICAgICAgICAgPT4gJFBhcmFte1VzZXJJRH0gfHwgMSwKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIGlmICggISRWYWxpZGF0ZVN1Y2Nlc3MgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgPT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2VhcmNoIG5vdCBleGVjdXRlZCBkdWUgdG8gaW52YWxpZCB2YWx1ZSAnIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4gJFRleHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuICInIG9uIGZpZWxkICciCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLiAkRHluYW1pY0ZpZWxkLT57TmFtZX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuICInISIsCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCRDb3VudGVyKSB7CiAgICAgICAgICAgICAgICAgICAgJFNRTEV4dFN1YiAuPSAnIE9SICc7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgIyBFbXB0eSA9PiAxIHJlcXVpcmVzIGEgTEVGVCBKT0lOLgogICAgICAgICAgICAgICAgaWYgKCAkT3BlcmF0b3IgZXEgJ0VtcHR5JyAmJiAkVGV4dCApIHsKICAgICAgICAgICAgICAgICAgICAkU1FMRXh0U3ViIC49ICREeW5hbWljRmllbGRCYWNrZW5kT2JqZWN0LT5TZWFyY2hTUUxHZXQoCiAgICAgICAgICAgICAgICAgICAgICAgIER5bmFtaWNGaWVsZENvbmZpZyA9PiAkRHluYW1pY0ZpZWxkLAogICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUFsaWFzICAgICAgICAgPT4gImRmdkVtcHR5JER5bmFtaWNGaWVsZEpvaW5Db3VudGVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgT3BlcmF0b3IgICAgICAgICAgID0+ICRPcGVyYXRvciwKICAgICAgICAgICAgICAgICAgICAgICAgU2VhcmNoVGVybSAgICAgICAgID0+ICRUZXh0LAogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgJFF1ZXJ5Rm9yRW1wdHlWYWx1ZXMgPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJFNRTEV4dFN1YiAuPSAkRHluYW1pY0ZpZWxkQmFja2VuZE9iamVjdC0+U2VhcmNoU1FMR2V0KAogICAgICAgICAgICAgICAgICAgICAgICBEeW5hbWljRmllbGRDb25maWcgPT4gJER5bmFtaWNGaWVsZCwKICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVBbGlhcyAgICAgICAgID0+ICJkZnYkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIiLAogICAgICAgICAgICAgICAgICAgICAgICBPcGVyYXRvciAgICAgICAgICAgPT4gJE9wZXJhdG9yLAogICAgICAgICAgICAgICAgICAgICAgICBTZWFyY2hUZXJtICAgICAgICAgPT4gJFRleHQsCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkQ291bnRlcisrOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRTUUxFeHRTdWIgLj0gJyknOwogICAgICAgICAgICBpZiAoJENvdW50ZXIpIHsKICAgICAgICAgICAgICAgICRTUUxFeHQgLj0gJFNRTEV4dFN1YjsKICAgICAgICAgICAgICAgICROZWVkSm9pbiA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICgkTmVlZEpvaW4pIHsKCiAgICAgICAgICAgICMgSm9pbiB0aGUgdGFibGUgZm9yIHRoaXMgZHluYW1pYyBmaWVsZAogICAgICAgICAgICBpZiAoICREeW5hbWljRmllbGQtPntPYmplY3RUeXBlfSBlcSAnVGlja2V0JyApIHsKCiAgICAgICAgICAgICAgICBpZiAoJFF1ZXJ5Rm9yRW1wdHlWYWx1ZXMpIHsKCiAgICAgICAgICAgICAgICAgICAgIyBVc2UgTEVGVCBKT0lOIHRvIGFsbG93IGZvciBudWxsIHZhbHVlcy4KICAgICAgICAgICAgICAgICAgICAkU1FMRnJvbSAuPSAiTEVGVCBKT0lOIGR5bmFtaWNfZmllbGRfdmFsdWUgZGZ2RW1wdHkkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIKICAgICAgICAgICAgICAgICAgICAgICAgT04gKHN0LmlkID0gZGZ2RW1wdHkkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIub2JqZWN0X2lkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBTkQgZGZ2RW1wdHkkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIuZmllbGRfaWQgPSAiIC4KICAgICAgICAgICAgICAgICAgICAgICAgJERCT2JqZWN0LT5RdW90ZSggJER5bmFtaWNGaWVsZC0+e0lEfSwgJ0ludGVnZXInICkgLiAiKSAiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJFNRTEZyb20gLj0gIklOTkVSIEpPSU4gZHluYW1pY19maWVsZF92YWx1ZSBkZnYkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIKICAgICAgICAgICAgICAgICAgICAgICAgT04gKHN0LmlkID0gZGZ2JER5bmFtaWNGaWVsZEpvaW5Db3VudGVyLm9iamVjdF9pZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQU5EIGRmdiREeW5hbWljRmllbGRKb2luQ291bnRlci5maWVsZF9pZCA9ICIgLgogICAgICAgICAgICAgICAgICAgICAgICAkREJPYmplY3QtPlF1b3RlKCAkRHluYW1pY0ZpZWxkLT57SUR9LCAnSW50ZWdlcicgKSAuICIpICI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzaWYgKCAkRHluYW1pY0ZpZWxkLT57T2JqZWN0VHlwZX0gZXEgJ0FydGljbGUnICkgewoKICAgICAgICAgICAgICAgIGlmICggISRBcnRpY2xlVGFibGVKb2luZWQgKSB7CiAgICAgICAgICAgICAgICAgICAgJFNRTEZyb20gLj0gJyBJTk5FUiBKT0lOIGFydGljbGUgYXJ0IE9OIHN0LmlkID0gYXJ0LnRpY2tldF9pZCAnOwogICAgICAgICAgICAgICAgICAgICRBcnRpY2xlVGFibGVKb2luZWQgPSAxOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICgkUXVlcnlGb3JFbXB0eVZhbHVlcykgewoKICAgICAgICAgICAgICAgICAgICAjIFVzZSBMRUZUIEpPSU4gdG8gYWxsb3cgZm9yIG51bGwgdmFsdWVzLgogICAgICAgICAgICAgICAgICAgICRTUUxGcm9tIC49ICJMRUZUIEpPSU4gZHluYW1pY19maWVsZF92YWx1ZSBkZnZFbXB0eSREeW5hbWljRmllbGRKb2luQ291bnRlcgogICAgICAgICAgICAgICAgICAgICAgICBPTiAoYXJ0LmlkID0gZGZ2RW1wdHkkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIub2JqZWN0X2lkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBTkQgZGZ2RW1wdHkkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIuZmllbGRfaWQgPSAiIC4KICAgICAgICAgICAgICAgICAgICAgICAgJERCT2JqZWN0LT5RdW90ZSggJER5bmFtaWNGaWVsZC0+e0lEfSwgJ0ludGVnZXInICkgLiAiKSAiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJFNRTEZyb20gLj0gIklOTkVSIEpPSU4gZHluYW1pY19maWVsZF92YWx1ZSBkZnYkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIKICAgICAgICAgICAgICAgICAgICAgICAgT04gKGFydC5pZCA9IGRmdiREeW5hbWljRmllbGRKb2luQ291bnRlci5vYmplY3RfaWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFORCBkZnYkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIuZmllbGRfaWQgPSAiIC4KICAgICAgICAgICAgICAgICAgICAgICAgJERCT2JqZWN0LT5RdW90ZSggJER5bmFtaWNGaWVsZC0+e0lEfSwgJ0ludGVnZXInICkgLiAiKSAiOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJER5bmFtaWNGaWVsZEpvaW5UYWJsZXN7ICREeW5hbWljRmllbGQtPntOYW1lfSB9ID0gImRmdiREeW5hbWljRmllbGRKb2luQ291bnRlciI7CgogICAgICAgICAgICAkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIrKzsKICAgICAgICB9CiAgICB9CgogICAgIyBjYXRjaCBzZWFyY2hlcyBmb3Igbm9uLWV4aXN0aW5nIGR5bmFtaWMgZmllbGRzCiAgICBQQVJBTVM6CiAgICBmb3IgbXkgJEtleSAoIHNvcnQga2V5cyAlUGFyYW0gKSB7CgogICAgICAgICMgT25seSBsb29rIGF0IGZpZWxkcyB3aGljaCBzdGFydCB3aXRoIER5bmFtaWNGaWVsZF8gYW5kIGNvbnRhaW4gYSBzdWJzdHJ1Y3R1cmUgdGhhdCBpcyBtZWFudCBmb3Igc2VhcmNoaW5nLgogICAgICAgICMgICBJdCBjb3VsZCBoYXBwZW4gdGhhdCBzaW1pbGFyIHNjYWxhciBwYXJhbWV0ZXJzIGFyZSBzZW50IHRvIHRoaXMgbWV0aG9kLCB0aGF0IHNob3VsZCBiZSBpZ25vcmVkCiAgICAgICAgIyAgIChzZWUgYnVnIzEzNDEyKS4KICAgICAgICBuZXh0IFBBUkFNUyBpZiAhcmVmICRQYXJhbXskS2V5fTsKICAgICAgICBuZXh0IFBBUkFNUyBpZiAkS2V5ICF+IC9eRHluYW1pY0ZpZWxkXyguKikkLzsKCiAgICAgICAgbXkgJER5bmFtaWNGaWVsZE5hbWUgPSAkMTsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ0Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gcXFbTm8gc3VjaCBkeW5hbWljIGZpZWxkICIkRHluYW1pY0ZpZWxkTmFtZSIgKG9yIGl0IGlzIGluYWN0aXZlKV0sCiAgICAgICAgKTsKCiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgICMgZ2V0IHRpbWUgb2JqZWN0CiAgICAjIHJlbWVtYmVyIGN1cnJlbnQgdGltZSB0byBwcmV2ZW50IHNlYXJjaGVzIGZvciBmdXR1cmUgdGltZXN0YW1wcwogICAgbXkgJERhdGVUaW1lT2JqZWN0ID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJyk7CgogICAgIyBnZXQgYXJ0aWNsZXMgY3JlYXRlZCBvbGRlci9uZXdlciB0aGFuIHggbWludXRlcyBvciBvbGRlci9uZXdlciB0aGFuIGEgZGF0ZQogICAgbXkgJUFydGljbGVUaW1lID0gKAogICAgICAgIEFydGljbGVDcmVhdGVUaW1lID0+ICJhcnQuY3JlYXRlX3RpbWUiLAogICAgKTsKICAgIGZvciBteSAkS2V5ICggc29ydCBrZXlzICVBcnRpY2xlVGltZSApIHsKCiAgICAgICAgIyBnZXQgYXJ0aWNsZXMgY3JlYXRlZCBvbGRlciB0aGFuIHggbWludXRlcwogICAgICAgIGlmICggZGVmaW5lZCAkUGFyYW17ICRLZXkgLiAnT2xkZXJNaW51dGVzJyB9ICkgewoKICAgICAgICAgICAgJFBhcmFteyAkS2V5IC4gJ09sZGVyTWludXRlcycgfSB8fD0gMDsKCiAgICAgICAgICAgIG15ICRUaW1lID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJyk7CiAgICAgICAgICAgICRUaW1lLT5TdWJ0cmFjdCggTWludXRlcyA9PiAkUGFyYW17ICRLZXkgLiAnT2xkZXJNaW51dGVzJyB9ICk7CgogICAgICAgICAgICAkU1FMRXh0IC49IHNwcmludGYoICIgQU5EICggJXMgPD0gJyVzJyApIiwgJEFydGljbGVUaW1leyRLZXl9LCAkVGltZS0+VG9TdHJpbmcoKSApOwogICAgICAgIH0KCiAgICAgICAgIyBnZXQgYXJ0aWNsZXMgY3JlYXRlZCBuZXdlciB0aGFuIHggbWludXRlcwogICAgICAgIGlmICggZGVmaW5lZCAkUGFyYW17ICRLZXkgLiAnTmV3ZXJNaW51dGVzJyB9ICkgewoKICAgICAgICAgICAgJFBhcmFteyAkS2V5IC4gJ05ld2VyTWludXRlcycgfSB8fD0gMDsKCiAgICAgICAgICAgIG15ICRUaW1lID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJyk7CiAgICAgICAgICAgICRUaW1lLT5TdWJ0cmFjdCggTWludXRlcyA9PiAkUGFyYW17ICRLZXkgLiAnTmV3ZXJNaW51dGVzJyB9ICk7CgogICAgICAgICAgICAkU1FMRXh0IC49IHNwcmludGYoICIgQU5EICggJXMgPj0gJyVzJyApIiwgJEFydGljbGVUaW1leyRLZXl9LCAkVGltZS0+VG9TdHJpbmcoKSApOwogICAgICAgIH0KCiAgICAgICAgIyBnZXQgYXJ0aWNsZXMgY3JlYXRlZCBvbGRlciB0aGFuIHh4eHgteHgteHggeHg6eHggZGF0ZQogICAgICAgIG15ICRDb21wYXJlT2xkZXJOZXdlckRhdGU7CiAgICAgICAgaWYgKCAkUGFyYW17ICRLZXkgLiAnT2xkZXJEYXRlJyB9ICkgewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAkUGFyYW17ICRLZXkgLiAnT2xkZXJEYXRlJyB9CiAgICAgICAgICAgICAgICAhfiAvKFxkXGRcZFxkKS0oXGRcZHxcZCktKFxkXGR8XGQpIChcZFxkfFxkKTooXGRcZHxcZCk6KFxkXGR8XGQpLwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJJbnZhbGlkIHRpbWUgZm9ybWF0ICciIC4gJFBhcmFteyAkS2V5IC4gJ09sZGVyRGF0ZScgfSAuICInISIsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBteSAkU3lzdGVtVGltZSA9ICRLZXJuZWw6Ok9NLT5DcmVhdGUoCiAgICAgICAgICAgICAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICAgICAgICAgICAgIE9iamVjdFBhcmFtcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgWWVhciAgID0+ICQxLAogICAgICAgICAgICAgICAgICAgIE1vbnRoICA9PiAkMiwKICAgICAgICAgICAgICAgICAgICBEYXkgICAgPT4gJDMsCiAgICAgICAgICAgICAgICAgICAgSG91ciAgID0+ICQ0LAogICAgICAgICAgICAgICAgICAgIE1pbnV0ZSA9PiAkNSwKICAgICAgICAgICAgICAgICAgICBTZWNvbmQgPT4gJDYsCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CgogICAgICAgICAgICBpZiAoICEkU3lzdGVtVGltZSApIHsKICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSA9PgogICAgICAgICAgICAgICAgICAgICAgICAiU2VhcmNoIG5vdCBleGVjdXRlZCBkdWUgdG8gaW52YWxpZCB0aW1lICciCiAgICAgICAgICAgICAgICAgICAgICAgIC4gJFBhcmFteyAkS2V5IC4gJ09sZGVyRGF0ZScgfSAuICInISIsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRDb21wYXJlT2xkZXJOZXdlckRhdGUgPSAkU3lzdGVtVGltZTsKCiAgICAgICAgICAgICRTUUxFeHQgLj0gIiBBTkQgKCRBcnRpY2xlVGltZXskS2V5fSA8PSAnIiAuICRQYXJhbXsgJEtleSAuICdPbGRlckRhdGUnIH0gLiAiJykiOwoKICAgICAgICB9CgogICAgICAgICMgZ2V0IGFydGljbGVzIGNyZWF0ZWQgbmV3ZXIgdGhhbiB4eHh4LXh4LXh4IHh4Onh4IGRhdGUKICAgICAgICBpZiAoICRQYXJhbXsgJEtleSAuICdOZXdlckRhdGUnIH0gKSB7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICRQYXJhbXsgJEtleSAuICdOZXdlckRhdGUnIH0KICAgICAgICAgICAgICAgICF+IC8oXGRcZFxkXGQpLShcZFxkfFxkKS0oXGRcZHxcZCkgKFxkXGR8XGQpOihcZFxkfFxkKTooXGRcZHxcZCkvCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkludmFsaWQgdGltZSBmb3JtYXQgJyIgLiAkUGFyYW17ICRLZXkgLiAnTmV3ZXJEYXRlJyB9IC4gIichIiwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgY29udmVydCBwYXJhbSBkYXRlIHRvIHN5c3RlbSB0aW1lCiAgICAgICAgICAgIG15ICRTeXN0ZW1UaW1lID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgKICAgICAgICAgICAgICAgICdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnLAogICAgICAgICAgICAgICAgT2JqZWN0UGFyYW1zID0+IHsKCiAgICAgICAgICAgICAgICAgICAgWWVhciAgID0+ICQxLAogICAgICAgICAgICAgICAgICAgIE1vbnRoICA9PiAkMiwKICAgICAgICAgICAgICAgICAgICBEYXkgICAgPT4gJDMsCiAgICAgICAgICAgICAgICAgICAgSG91ciAgID0+ICQ0LAogICAgICAgICAgICAgICAgICAgIE1pbnV0ZSA9PiAkNSwKICAgICAgICAgICAgICAgICAgICBTZWNvbmQgPT4gJDYsCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmICggISRTeXN0ZW1UaW1lICkgewogICAgICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgICAgICBNZXNzYWdlID0+CiAgICAgICAgICAgICAgICAgICAgICAgICJTZWFyY2ggbm90IGV4ZWN1dGVkIGR1ZSB0byBpbnZhbGlkIHRpbWUgJyIKICAgICAgICAgICAgICAgICAgICAgICAgLiAkUGFyYW17ICRLZXkgLiAnTmV3ZXJEYXRlJyB9IC4gIichIiwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgZG9uJ3QgZXhlY3V0ZSBxdWVyaWVzIGlmIG5ld2VyIGRhdGUgaXMgYWZ0ZXIgY3VycmVudCBkYXRlCiAgICAgICAgICAgIHJldHVybiBpZiAkU3lzdGVtVGltZSA+ICREYXRlVGltZU9iamVjdDsKCiAgICAgICAgICAgICMgZG9uJ3QgZXhlY3V0ZSBxdWVyaWVzIGlmIG9sZGVyL25ld2VyIGRhdGUgcmVzdHJpY3Rpb24gc2hvdyBub3cgdmFsaWQgdGltZWZyYW1lCiAgICAgICAgICAgIHJldHVybiBpZiAkQ29tcGFyZU9sZGVyTmV3ZXJEYXRlICYmICRTeXN0ZW1UaW1lID4gJENvbXBhcmVPbGRlck5ld2VyRGF0ZTsKCiAgICAgICAgICAgICRTUUxFeHQgLj0gIiBBTkQgKCRBcnRpY2xlVGltZXskS2V5fSA+PSAnIiAuICRQYXJhbXsgJEtleSAuICdOZXdlckRhdGUnIH0gLiAiJykiOwogICAgICAgIH0KICAgIH0KCiAgICAjIGdldCB0aWNrZXRzIGNyZWF0ZWQvZXNjYWxhdGVkIG9sZGVyL25ld2VyIHRoYW4geCBtaW51dGVzCiAgICBteSAlVGlja2V0VGltZSA9ICgKICAgICAgICBUaWNrZXRDcmVhdGVUaW1lICAgICAgICAgICAgID0+ICdzdC5jcmVhdGVfdGltZScsCiAgICAgICAgVGlja2V0RXNjYWxhdGlvblRpbWUgICAgICAgICA9PiAnc3QuZXNjYWxhdGlvbl90aW1lJywKICAgICAgICBUaWNrZXRFc2NhbGF0aW9uVXBkYXRlVGltZSAgID0+ICdzdC5lc2NhbGF0aW9uX3VwZGF0ZV90aW1lJywKICAgICAgICBUaWNrZXRFc2NhbGF0aW9uUmVzcG9uc2VUaW1lID0+ICdzdC5lc2NhbGF0aW9uX3Jlc3BvbnNlX3RpbWUnLAogICAgICAgIFRpY2tldEVzY2FsYXRpb25Tb2x1dGlvblRpbWUgPT4gJ3N0LmVzY2FsYXRpb25fc29sdXRpb25fdGltZScsCiAgICApOwogICAgZm9yIG15ICRLZXkgKCBzb3J0IGtleXMgJVRpY2tldFRpbWUgKSB7CgogICAgICAgICMgUlMKICAgICAgICBpZiAoIGRlZmluZWQgJFBhcmFteyAkS2V5IH0gYW5kICRQYXJhbXsgJEtleSB9ID09IDAgKSB7CiAgICAgICAgICAgICRTUUxFeHQgLj0gIiBBTkQgJFRpY2tldFRpbWV7ICRLZXkgfSA9IDAiOwogICAgICAgIH0KCiAgICAgICAgIyBnZXQgdGlja2V0cyBjcmVhdGVkIG9yIGVzY2FsYXRlZCBvbGRlciB0aGFuIHggbWludXRlcwogICAgICAgIGlmICggZGVmaW5lZCAkUGFyYW17ICRLZXkgLiAnT2xkZXJNaW51dGVzJyB9ICkgewoKICAgICAgICAgICAgJFBhcmFteyAkS2V5IC4gJ09sZGVyTWludXRlcycgfSB8fD0gMDsKCiAgICAgICAgICAgICMgZXhjbHVkZSB0aWNrZXRzIHdpdGggbm8gZXNjYWxhdGlvbgogICAgICAgICAgICBpZiAoICRLZXkgPX4gbXsgXEEgVGlja2V0RXNjYWxhdGlvbiB9eG1zICkgewogICAgICAgICAgICAgICAgJFNRTEV4dCAuPSAiIEFORCAkVGlja2V0VGltZXskS2V5fSAhPSAwIjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbXkgJFRpbWUgPSAkRGF0ZVRpbWVPYmplY3QtPkNsb25lKCk7CiAgICAgICAgICAgICRUaW1lLT5TdWJ0cmFjdCggTWludXRlcyA9PiAkUGFyYW17ICRLZXkgLiAnT2xkZXJNaW51dGVzJyB9ICk7CgogICAgICAgICAgICBteSAkVGFyZ2V0VGltZSA9ICRLZXkgZXEgJ1RpY2tldENyZWF0ZVRpbWUnID8gJFRpbWUtPlRvU3RyaW5nKCkgOiAkVGltZS0+VG9FcG9jaCgpOwoKICAgICAgICAgICAgJFNRTEV4dCAuPSBzcHJpbnRmKCAiIEFORCAoICVzIDw9ICclcycgKSIsICRUaWNrZXRUaW1leyRLZXl9LCAkVGFyZ2V0VGltZSApOwogICAgICAgIH0KCiAgICAgICAgIyBnZXQgdGlja2V0cyBjcmVhdGVkIG9yIGVzY2FsYXRlZCBuZXdlciB0aGFuIHggbWludXRlcwogICAgICAgIGlmICggZGVmaW5lZCAkUGFyYW17ICRLZXkgLiAnTmV3ZXJNaW51dGVzJyB9ICkgewoKICAgICAgICAgICAgJFBhcmFteyAkS2V5IC4gJ05ld2VyTWludXRlcycgfSB8fD0gMDsKCiAgICAgICAgICAgICMgZXhjbHVkZSB0aWNrZXRzIHdpdGggbm8gZXNjYWxhdGlvbgogICAgICAgICAgICBpZiAoICRLZXkgPX4gbXsgXEEgVGlja2V0RXNjYWxhdGlvbiB9eG1zICkgewogICAgICAgICAgICAgICAgJFNRTEV4dCAuPSAiIEFORCAkVGlja2V0VGltZXskS2V5fSAhPSAwIjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbXkgJFRpbWUgPSAkS2VybmVsOjpPTS0+Q3JlYXRlKCdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnKTsKICAgICAgICAgICAgJFRpbWUtPlN1YnRyYWN0KCBNaW51dGVzID0+ICRQYXJhbXsgJEtleSAuICdOZXdlck1pbnV0ZXMnIH0gKTsKCiAgICAgICAgICAgIG15ICRUYXJnZXRUaW1lID0gJEtleSBlcSAnVGlja2V0Q3JlYXRlVGltZScgPyAkVGltZS0+VG9TdHJpbmcoKSA6ICRUaW1lLT5Ub0Vwb2NoKCk7CgogICAgICAgICAgICAkU1FMRXh0IC49IHNwcmludGYoICIgQU5EICggJXMgPj0gJyVzJyApIiwgJFRpY2tldFRpbWV7JEtleX0sICRUYXJnZXRUaW1lICk7CiAgICAgICAgfQogICAgfQoKICAgICMgZ2V0IHRpY2tldHMgY3JlYXRlZC9lc2NhbGF0ZWQgb2xkZXIvbmV3ZXIgdGhhbiB4eHh4LXh4LXh4IHh4Onh4IGRhdGUKICAgIGZvciBteSAkS2V5ICggc29ydCBrZXlzICVUaWNrZXRUaW1lICkgewoKICAgICAgICAjIGdldCB0aWNrZXRzIGNyZWF0ZWQvZXNjYWxhdGVkIG9sZGVyIHRoYW4geHh4eC14eC14eCB4eDp4eCBkYXRlCiAgICAgICAgbXkgJENvbXBhcmVPbGRlck5ld2VyRGF0ZTsKICAgICAgICBpZiAoICRQYXJhbXsgJEtleSAuICdPbGRlckRhdGUnIH0gKSB7CgogICAgICAgICAgICAjIGNoZWNrIHRpbWUgZm9ybWF0CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICRQYXJhbXsgJEtleSAuICdPbGRlckRhdGUnIH0KICAgICAgICAgICAgICAgICF+IC9cZFxkXGRcZC0oXGRcZHxcZCktKFxkXGR8XGQpIChcZFxkfFxkKTooXGRcZHxcZCk6KFxkXGR8XGQpLwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJJbnZhbGlkIHRpbWUgZm9ybWF0ICciIC4gJFBhcmFteyAkS2V5IC4gJ09sZGVyRGF0ZScgfSAuICInISIsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGV4Y2x1ZGUgdGlja2V0cyB3aXRoIG5vIGVzY2FsYXRpb24KICAgICAgICAgICAgaWYgKCAkS2V5ID1+IG17IFxBIFRpY2tldEVzY2FsYXRpb24gfXhtcyApIHsKICAgICAgICAgICAgICAgICRTUUxFeHQgLj0gIiBBTkQgJFRpY2tldFRpbWV7JEtleX0gIT0gMCI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbXkgJFRpbWUgPSAkS2VybmVsOjpPTS0+Q3JlYXRlKAogICAgICAgICAgICAgICAgJ0tlcm5lbDo6U3lzdGVtOjpEYXRlVGltZScsCiAgICAgICAgICAgICAgICBPYmplY3RQYXJhbXMgPT4gewogICAgICAgICAgICAgICAgICAgIFN0cmluZyA9PiAkUGFyYW17ICRLZXkgLiAnT2xkZXJEYXRlJyB9LAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApOwoKICAgICAgICAgICAgaWYgKCAhJFRpbWUgKSB7CiAgICAgICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgPT4KICAgICAgICAgICAgICAgICAgICAgICAgIlNlYXJjaCBub3QgZXhlY3V0ZWQgZHVlIHRvIGludmFsaWQgdGltZSAnIgogICAgICAgICAgICAgICAgICAgICAgICAuICRQYXJhbXsgJEtleSAuICdPbGRlckRhdGUnIH0gLiAiJyEiLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICAkQ29tcGFyZU9sZGVyTmV3ZXJEYXRlID0gJFRpbWU7CgogICAgICAgICAgICBteSAkVGFyZ2V0VGltZSA9ICRLZXkgZXEgJ1RpY2tldENyZWF0ZVRpbWUnID8gJFRpbWUtPlRvU3RyaW5nKCkgOiAkVGltZS0+VG9FcG9jaCgpOwoKICAgICAgICAgICAgJFNRTEV4dCAuPSBzcHJpbnRmKCAiIEFORCAoICVzIDw9ICclcycgKSIsICRUaWNrZXRUaW1leyRLZXl9LCAkVGFyZ2V0VGltZSApOwogICAgICAgIH0KCiAgICAgICAgIyBnZXQgdGlja2V0cyBjcmVhdGVkL2VzY2FsYXRlZCBuZXdlciB0aGFuIHh4eHgteHgteHggeHg6eHggZGF0ZQogICAgICAgIGlmICggJFBhcmFteyAkS2V5IC4gJ05ld2VyRGF0ZScgfSApIHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgJFBhcmFteyAkS2V5IC4gJ05ld2VyRGF0ZScgfQogICAgICAgICAgICAgICAgIX4gL1xkXGRcZFxkLShcZFxkfFxkKS0oXGRcZHxcZCkgKFxkXGR8XGQpOihcZFxkfFxkKTooXGRcZHxcZCkvCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkludmFsaWQgdGltZSBmb3JtYXQgJyIgLiAkUGFyYW17ICRLZXkgLiAnTmV3ZXJEYXRlJyB9IC4gIichIiwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgZXhjbHVkZSB0aWNrZXRzIHdpdGggbm8gZXNjYWxhdGlvbgogICAgICAgICAgICBpZiAoICRLZXkgPX4gbXsgXEEgVGlja2V0RXNjYWxhdGlvbiB9eG1zICkgewogICAgICAgICAgICAgICAgJFNRTEV4dCAuPSAiIEFORCAkVGlja2V0VGltZXskS2V5fSAhPSAwIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBteSAkVGltZSA9ICRLZXJuZWw6Ok9NLT5DcmVhdGUoCiAgICAgICAgICAgICAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICAgICAgICAgICAgIE9iamVjdFBhcmFtcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nID0+ICRQYXJhbXsgJEtleSAuICdOZXdlckRhdGUnIH0sCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmICggISRUaW1lICkgewogICAgICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgICAgICBNZXNzYWdlID0+CiAgICAgICAgICAgICAgICAgICAgICAgICJTZWFyY2ggbm90IGV4ZWN1dGVkIGR1ZSB0byBpbnZhbGlkIHRpbWUgJyIKICAgICAgICAgICAgICAgICAgICAgICAgLiAkUGFyYW17ICRLZXkgLiAnTmV3ZXJEYXRlJyB9IC4gIichIiwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgZG9uJ3QgZXhlY3V0ZSBxdWVyaWVzIGlmIG5ld2VyIGRhdGUgaXMgYWZ0ZXIgY3VycmVudCBkYXRlCiAgICAgICAgICAgICMgUlMKICAgICAgICAgICAgaWYgKCAhJFBhcmFte1NtYXJ0U29ydH0gKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gaWYgJFRpbWUgPiAkRGF0ZVRpbWVPYmplY3Q7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgZG9uJ3QgZXhlY3V0ZSBxdWVyaWVzIGlmIG9sZGVyL25ld2VyIGRhdGUgcmVzdHJpY3Rpb24gc2hvdyBub3cgdmFsaWQgdGltZWZyYW1lCiAgICAgICAgICAgIHJldHVybiBpZiAkQ29tcGFyZU9sZGVyTmV3ZXJEYXRlICYmICRUaW1lID4gJENvbXBhcmVPbGRlck5ld2VyRGF0ZTsKCiAgICAgICAgICAgIG15ICRUYXJnZXRUaW1lID0gJEtleSBlcSAnVGlja2V0Q3JlYXRlVGltZScgPyAkVGltZS0+VG9TdHJpbmcoKSA6ICRUaW1lLT5Ub0Vwb2NoKCk7CgogICAgICAgICAgICAkU1FMRXh0IC49IHNwcmludGYoICIgQU5EICggJXMgPj0gJyVzJyApIiwgJFRpY2tldFRpbWV7JEtleX0sICRUYXJnZXRUaW1lICk7CiAgICAgICAgfQogICAgfQoKICAgICMgZ2V0IHRpY2tldHMgY2hhbmdlZCBvbGRlciB0aGFuIHggbWludXRlcwogICAgaWYgKCBkZWZpbmVkICRQYXJhbXtUaWNrZXRDaGFuZ2VUaW1lT2xkZXJNaW51dGVzfSApIHsKCiAgICAgICAgJFBhcmFte1RpY2tldENoYW5nZVRpbWVPbGRlck1pbnV0ZXN9IHx8PSAwOwoKICAgICAgICBteSAkVGltZVN0YW1wID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJyk7CiAgICAgICAgJFRpbWVTdGFtcC0+U3VidHJhY3QoIE1pbnV0ZXMgPT4gJFBhcmFte1RpY2tldENoYW5nZVRpbWVPbGRlck1pbnV0ZXN9ICk7CgogICAgICAgICRQYXJhbXtUaWNrZXRDaGFuZ2VUaW1lT2xkZXJEYXRlfSA9ICRUaW1lU3RhbXAtPlRvU3RyaW5nKCk7CiAgICB9CgogICAgIyBnZXQgdGlja2V0cyBjaGFuZ2VkIG5ld2VyIHRoYW4geCBtaW51dGVzCiAgICBpZiAoIGRlZmluZWQgJFBhcmFte1RpY2tldENoYW5nZVRpbWVOZXdlck1pbnV0ZXN9ICkgewoKICAgICAgICAkUGFyYW17VGlja2V0Q2hhbmdlVGltZU5ld2VyTWludXRlc30gfHw9IDA7CgogICAgICAgIG15ICRUaW1lU3RhbXAgPSAkS2VybmVsOjpPTS0+Q3JlYXRlKCdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnKTsKICAgICAgICAkVGltZVN0YW1wLT5TdWJ0cmFjdCggTWludXRlcyA9PiAkUGFyYW17VGlja2V0Q2hhbmdlVGltZU5ld2VyTWludXRlc30gKTsKCiAgICAgICAgJFBhcmFte1RpY2tldENoYW5nZVRpbWVOZXdlckRhdGV9ID0gJFRpbWVTdGFtcC0+VG9TdHJpbmcoKTsKICAgIH0KCiAgICAjIGdldCB0aWNrZXRzIGJhc2VkIG9uIHRpY2tldCBoaXN0b3J5IGNoYW5nZWQgb2xkZXIgdGhhbiB4eHh4LXh4LXh4IHh4Onh4IGRhdGUKICAgIG15ICRDb21wYXJlQ2hhbmdlVGltZU9sZGVyTmV3ZXJEYXRlOwogICAgaWYgKCAkUGFyYW17VGlja2V0Q2hhbmdlVGltZU9sZGVyRGF0ZX0gKSB7CgogICAgICAgICMgY2hlY2sgdGltZSBmb3JtYXQKICAgICAgICBpZiAoCiAgICAgICAgICAgICRQYXJhbXtUaWNrZXRDaGFuZ2VUaW1lT2xkZXJEYXRlfQogICAgICAgICAgICAhfiAvXGRcZFxkXGQtKFxkXGR8XGQpLShcZFxkfFxkKSAoXGRcZHxcZCk6KFxkXGR8XGQpOihcZFxkfFxkKS8KICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkludmFsaWQgdGltZSBmb3JtYXQgJyRQYXJhbXtUaWNrZXRDaGFuZ2VUaW1lT2xkZXJEYXRlfSchIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgbXkgJFRpbWUgPSAkS2VybmVsOjpPTS0+Q3JlYXRlKAogICAgICAgICAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICAgICAgICAgT2JqZWN0UGFyYW1zID0+IHsKICAgICAgICAgICAgICAgIFN0cmluZyA9PiAkUGFyYW17VGlja2V0Q2hhbmdlVGltZU9sZGVyRGF0ZX0sCiAgICAgICAgICAgIH0KICAgICAgICApOwoKICAgICAgICBpZiAoICEkVGltZSApIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSA9PgogICAgICAgICAgICAgICAgICAgICJTZWFyY2ggbm90IGV4ZWN1dGVkIGR1ZSB0byBpbnZhbGlkIHRpbWUgJyIKICAgICAgICAgICAgICAgICAgICAuICRQYXJhbXtUaWNrZXRDaGFuZ2VUaW1lT2xkZXJEYXRlfSAuICInISIsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgJENvbXBhcmVDaGFuZ2VUaW1lT2xkZXJOZXdlckRhdGUgPSAkVGltZTsKCiAgICAgICAgbXkgJFRIUmVmID0gJFNlbGYtPl9UaWNrZXRIaXN0b3J5UmVmZXJlbmNlRm9yU2VhcmNoQXJndW1lbnQoCiAgICAgICAgICAgIEFyZ3VtZW50ID0+ICdUaWNrZXRDaGFuZ2VUaW1lT2xkZXJEYXRlJywKICAgICAgICApOwogICAgICAgIHJldHVybiBpZiAhJFRIUmVmOwoKICAgICAgICAkU1FMRXh0IC49ICIgQU5EICR7IFRIUmVmIH0uY3JlYXRlX3RpbWUgPD0gJyIKICAgICAgICAgICAgLiAkREJPYmplY3QtPlF1b3RlKCAkUGFyYW17VGlja2V0Q2hhbmdlVGltZU9sZGVyRGF0ZX0gKSAuICInIjsKICAgIH0KCiAgICAjIGdldCB0aWNrZXRzIGJhc2VkIG9uIHRpY2tldCBoaXN0b3J5IGNoYW5nZWQgbmV3ZXIgdGhhbiB4eHh4LXh4LXh4IHh4Onh4IGRhdGUKICAgIGlmICggJFBhcmFte1RpY2tldENoYW5nZVRpbWVOZXdlckRhdGV9ICkgewogICAgICAgIGlmICgKICAgICAgICAgICAgJFBhcmFte1RpY2tldENoYW5nZVRpbWVOZXdlckRhdGV9CiAgICAgICAgICAgICF+IC9cZFxkXGRcZC0oXGRcZHxcZCktKFxkXGR8XGQpIChcZFxkfFxkKTooXGRcZHxcZCk6KFxkXGR8XGQpLwogICAgICAgICAgICApCiAgICAgICAgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiSW52YWxpZCB0aW1lIGZvcm1hdCAnJFBhcmFte1RpY2tldENoYW5nZVRpbWVOZXdlckRhdGV9JyEiLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBteSAkVGltZSA9ICRLZXJuZWw6Ok9NLT5DcmVhdGUoCiAgICAgICAgICAgICdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnLAogICAgICAgICAgICBPYmplY3RQYXJhbXMgPT4gewogICAgICAgICAgICAgICAgU3RyaW5nID0+ICRQYXJhbXtUaWNrZXRDaGFuZ2VUaW1lTmV3ZXJEYXRlfSwKICAgICAgICAgICAgfQogICAgICAgICk7CgogICAgICAgIGlmICggISRUaW1lICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlID0+CiAgICAgICAgICAgICAgICAgICAgIlNlYXJjaCBub3QgZXhlY3V0ZWQgZHVlIHRvIGludmFsaWQgdGltZSAnIgogICAgICAgICAgICAgICAgICAgIC4gJFBhcmFte1RpY2tldENoYW5nZVRpbWVOZXdlckRhdGV9IC4gIichIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgIyBkb24ndCBleGVjdXRlIHF1ZXJpZXMgaWYgbmV3ZXIgZGF0ZSBpcyBhZnRlciBjdXJyZW50IGRhdGUKICAgICAgICByZXR1cm4gaWYgJFRpbWUgPiAkRGF0ZVRpbWVPYmplY3Q7CgogICAgICAgICMgZG9uJ3QgZXhlY3V0ZSBxdWVyaWVzIGlmIG9sZGVyL25ld2VyIGRhdGUgcmVzdHJpY3Rpb24gc2hvdyBub3cgdmFsaWQgdGltZWZyYW1lCiAgICAgICAgcmV0dXJuIGlmICRDb21wYXJlQ2hhbmdlVGltZU9sZGVyTmV3ZXJEYXRlICYmICRUaW1lID4gJENvbXBhcmVDaGFuZ2VUaW1lT2xkZXJOZXdlckRhdGU7CgogICAgICAgIG15ICRUSFJlZiA9ICRTZWxmLT5fVGlja2V0SGlzdG9yeVJlZmVyZW5jZUZvclNlYXJjaEFyZ3VtZW50KAogICAgICAgICAgICBBcmd1bWVudCA9PiAnVGlja2V0Q2hhbmdlVGltZU5ld2VyRGF0ZScsCiAgICAgICAgKTsKICAgICAgICByZXR1cm4gaWYgISRUSFJlZjsKCiAgICAgICAgJFNRTEV4dCAuPSAiIEFORCAkeyBUSFJlZiB9LmNyZWF0ZV90aW1lID49ICciCiAgICAgICAgICAgIC4gJERCT2JqZWN0LT5RdW90ZSggJFBhcmFte1RpY2tldENoYW5nZVRpbWVOZXdlckRhdGV9ICkgLiAiJyI7CiAgICB9CgogICAgIyBnZXQgdGlja2V0cyBjaGFuZ2VkIG9sZGVyIHRoYW4geCBtaW51dGVzCiAgICBpZiAoIGRlZmluZWQgJFBhcmFte1RpY2tldExhc3RDaGFuZ2VUaW1lT2xkZXJNaW51dGVzfSApIHsKCiAgICAgICAgJFBhcmFte1RpY2tldExhc3RDaGFuZ2VUaW1lT2xkZXJNaW51dGVzfSB8fD0gMDsKCiAgICAgICAgbXkgJFRpbWVTdGFtcCA9ICREYXRlVGltZU9iamVjdC0+Q2xvbmUoKTsKICAgICAgICAkVGltZVN0YW1wLT5TdWJ0cmFjdCggTWludXRlcyA9PiAkUGFyYW17VGlja2V0TGFzdENoYW5nZVRpbWVPbGRlck1pbnV0ZXN9ICk7CgogICAgICAgICRQYXJhbXtUaWNrZXRMYXN0Q2hhbmdlVGltZU9sZGVyRGF0ZX0gPSAkVGltZVN0YW1wLT5Ub1N0cmluZygpOwogICAgfQoKICAgICMgZ2V0IHRpY2tldHMgY2hhbmdlZCBuZXdlciB0aGFuIHggbWludXRlcwogICAgaWYgKCBkZWZpbmVkICRQYXJhbXtUaWNrZXRMYXN0Q2hhbmdlVGltZU5ld2VyTWludXRlc30gKSB7CgogICAgICAgICRQYXJhbXtUaWNrZXRMYXN0Q2hhbmdlVGltZU5ld2VyTWludXRlc30gfHw9IDA7CgogICAgICAgIG15ICRUaW1lU3RhbXAgPSAkRGF0ZVRpbWVPYmplY3QtPkNsb25lKCk7CiAgICAgICAgJFRpbWVTdGFtcC0+U3VidHJhY3QoIE1pbnV0ZXMgPT4gJFBhcmFte1RpY2tldExhc3RDaGFuZ2VUaW1lTmV3ZXJNaW51dGVzfSApOwoKICAgICAgICAkUGFyYW17VGlja2V0TGFzdENoYW5nZVRpbWVOZXdlckRhdGV9ID0gJFRpbWVTdGFtcC0+VG9TdHJpbmcoKTsKICAgIH0KCiAgICAjIGdldCB0aWNrZXRzIGNoYW5nZWQgb2xkZXIgdGhhbiB4eHh4LXh4LXh4IHh4Onh4IGRhdGUKICAgIG15ICRDb21wYXJlTGFzdENoYW5nZVRpbWVPbGRlck5ld2VyRGF0ZTsKICAgIGlmICggJFBhcmFte1RpY2tldExhc3RDaGFuZ2VUaW1lT2xkZXJEYXRlfSApIHsKCiAgICAgICAgIyBjaGVjayB0aW1lIGZvcm1hdAogICAgICAgIGlmICgKICAgICAgICAgICAgJFBhcmFte1RpY2tldExhc3RDaGFuZ2VUaW1lT2xkZXJEYXRlfQogICAgICAgICAgICAhfiAvXGRcZFxkXGQtKFxkXGR8XGQpLShcZFxkfFxkKSAoXGRcZHxcZCk6KFxkXGR8XGQpOihcZFxkfFxkKS8KICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkludmFsaWQgdGltZSBmb3JtYXQgJyRQYXJhbXtUaWNrZXRMYXN0Q2hhbmdlVGltZU9sZGVyRGF0ZX0nISIsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIG15ICRUaW1lID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgKICAgICAgICAgICAgJ0tlcm5lbDo6U3lzdGVtOjpEYXRlVGltZScsCiAgICAgICAgICAgIE9iamVjdFBhcmFtcyA9PiB7CiAgICAgICAgICAgICAgICBTdHJpbmcgPT4gJFBhcmFte1RpY2tldExhc3RDaGFuZ2VUaW1lT2xkZXJEYXRlfSwKICAgICAgICAgICAgfQogICAgICAgICk7CgogICAgICAgIGlmICggISRUaW1lICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlID0+CiAgICAgICAgICAgICAgICAgICAgIlNlYXJjaCBub3QgZXhlY3V0ZWQgZHVlIHRvIGludmFsaWQgdGltZSAnIgogICAgICAgICAgICAgICAgICAgIC4gJFBhcmFte1RpY2tldExhc3RDaGFuZ2VUaW1lT2xkZXJEYXRlfSAuICInISIsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgJENvbXBhcmVMYXN0Q2hhbmdlVGltZU9sZGVyTmV3ZXJEYXRlID0gJFRpbWU7CgogICAgICAgICRTUUxFeHQgLj0gIiBBTkQgc3QuY2hhbmdlX3RpbWUgPD0gJyIKICAgICAgICAgICAgLiAkREJPYmplY3QtPlF1b3RlKCAkUGFyYW17VGlja2V0TGFzdENoYW5nZVRpbWVPbGRlckRhdGV9ICkgLiAiJyI7CiAgICB9CgogICAgIyBnZXQgdGlja2V0cyBjaGFuZ2VkIG5ld2VyIHRoYW4geHh4eC14eC14eCB4eDp4eCBkYXRlCiAgICBpZiAoICRQYXJhbXtUaWNrZXRMYXN0Q2hhbmdlVGltZU5ld2VyRGF0ZX0gKSB7CiAgICAgICAgaWYgKAogICAgICAgICAgICAkUGFyYW17VGlja2V0TGFzdENoYW5nZVRpbWVOZXdlckRhdGV9CiAgICAgICAgICAgICF+IC9cZFxkXGRcZC0oXGRcZHxcZCktKFxkXGR8XGQpIChcZFxkfFxkKTooXGRcZHxcZCk6KFxkXGR8XGQpLwogICAgICAgICAgICApCiAgICAgICAgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiSW52YWxpZCB0aW1lIGZvcm1hdCAnJFBhcmFte1RpY2tldExhc3RDaGFuZ2VUaW1lTmV3ZXJEYXRlfSchIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgbXkgJFRpbWUgPSAkS2VybmVsOjpPTS0+Q3JlYXRlKAogICAgICAgICAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICAgICAgICAgT2JqZWN0UGFyYW1zID0+IHsKICAgICAgICAgICAgICAgIFN0cmluZyA9PiAkUGFyYW17VGlja2V0TGFzdENoYW5nZVRpbWVOZXdlckRhdGV9LAogICAgICAgICAgICB9CiAgICAgICAgKTsKCiAgICAgICAgaWYgKCAhJFRpbWUgKSB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgPT4KICAgICAgICAgICAgICAgICAgICAiU2VhcmNoIG5vdCBleGVjdXRlZCBkdWUgdG8gaW52YWxpZCB0aW1lICciCiAgICAgICAgICAgICAgICAgICAgLiAkUGFyYW17VGlja2V0TGFzdENoYW5nZVRpbWVOZXdlckRhdGV9IC4gIichIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgIyBkb24ndCBleGVjdXRlIHF1ZXJpZXMgaWYgbmV3ZXIgZGF0ZSBpcyBhZnRlciBjdXJyZW50IGRhdGUKICAgICAgICByZXR1cm4gaWYgJFRpbWUgPiAkRGF0ZVRpbWVPYmplY3Q7CgogICAgICAgICMgZG9uJ3QgZXhlY3V0ZSBxdWVyaWVzIGlmIG9sZGVyL25ld2VyIGRhdGUgcmVzdHJpY3Rpb24gc2hvdyBub3cgdmFsaWQgdGltZWZyYW1lCiAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGlmICRDb21wYXJlTGFzdENoYW5nZVRpbWVPbGRlck5ld2VyRGF0ZSAmJiAkVGltZSA+ICRDb21wYXJlTGFzdENoYW5nZVRpbWVPbGRlck5ld2VyRGF0ZTsKCiAgICAgICAgJFNRTEV4dCAuPSAiIEFORCBzdC5jaGFuZ2VfdGltZSA+PSAnIgogICAgICAgICAgICAuICREQk9iamVjdC0+UXVvdGUoICRQYXJhbXtUaWNrZXRMYXN0Q2hhbmdlVGltZU5ld2VyRGF0ZX0gKSAuICInIjsKICAgIH0KCiAgICAjIGdldCB0aWNrZXRzIGNsb3NlZCBvbGRlciB0aGFuIHggbWludXRlcwogICAgaWYgKCBkZWZpbmVkICRQYXJhbXtUaWNrZXRDbG9zZVRpbWVPbGRlck1pbnV0ZXN9ICkgewoKICAgICAgICAkUGFyYW17VGlja2V0Q2xvc2VUaW1lT2xkZXJNaW51dGVzfSB8fD0gMDsKCiAgICAgICAgbXkgJFRpbWVTdGFtcCA9ICREYXRlVGltZU9iamVjdC0+Q2xvbmUoKTsKICAgICAgICAkVGltZVN0YW1wLT5TdWJ0cmFjdCggTWludXRlcyA9PiAkUGFyYW17VGlja2V0Q2xvc2VUaW1lT2xkZXJNaW51dGVzfSApOwoKICAgICAgICAkUGFyYW17VGlja2V0Q2xvc2VUaW1lT2xkZXJEYXRlfSA9ICRUaW1lU3RhbXAtPlRvU3RyaW5nKCk7CiAgICB9CgogICAgIyBnZXQgdGlja2V0cyBjbG9zZWQgbmV3ZXIgdGhhbiB4IG1pbnV0ZXMKICAgIGlmICggZGVmaW5lZCAkUGFyYW17VGlja2V0Q2xvc2VUaW1lTmV3ZXJNaW51dGVzfSApIHsKCiAgICAgICAgJFBhcmFte1RpY2tldENsb3NlVGltZU5ld2VyTWludXRlc30gfHw9IDA7CgogICAgICAgIG15ICRUaW1lU3RhbXAgPSAkRGF0ZVRpbWVPYmplY3QtPkNsb25lKCk7CiAgICAgICAgJFRpbWVTdGFtcC0+U3VidHJhY3QoIE1pbnV0ZXMgPT4gJFBhcmFte1RpY2tldENsb3NlVGltZU5ld2VyTWludXRlc30gKTsKCiAgICAgICAgJFBhcmFte1RpY2tldENsb3NlVGltZU5ld2VyRGF0ZX0gPSAkVGltZVN0YW1wLT5Ub1N0cmluZygpOwogICAgfQoKICAgICMgZ2V0IHRpY2tldHMgY2xvc2VkIG9sZGVyIHRoYW4geHh4eC14eC14eCB4eDp4eCBkYXRlCiAgICBteSAkQ29tcGFyZUNsb3NlVGltZU9sZGVyTmV3ZXJEYXRlOwogICAgaWYgKCAkUGFyYW17VGlja2V0Q2xvc2VUaW1lT2xkZXJEYXRlfSApIHsKICAgICAgICBteSAkVEhSZWYgPSAkU2VsZi0+X1RpY2tldEhpc3RvcnlSZWZlcmVuY2VGb3JTZWFyY2hBcmd1bWVudCgKICAgICAgICAgICAgQXJndW1lbnQgPT4gJ1RpY2tldENsb3NlVGltZU9sZGVyRGF0ZScsCiAgICAgICAgKTsKICAgICAgICByZXR1cm4gaWYgISRUSFJlZjsKCiAgICAgICAgIyBjaGVjayB0aW1lIGZvcm1hdAogICAgICAgIGlmICgKICAgICAgICAgICAgJFBhcmFte1RpY2tldENsb3NlVGltZU9sZGVyRGF0ZX0KICAgICAgICAgICAgIX4gL1xkXGRcZFxkLShcZFxkfFxkKS0oXGRcZHxcZCkgKFxkXGR8XGQpOihcZFxkfFxkKTooXGRcZHxcZCkvCiAgICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJJbnZhbGlkIHRpbWUgZm9ybWF0ICckUGFyYW17VGlja2V0Q2xvc2VUaW1lT2xkZXJEYXRlfSchIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgbXkgJFRpbWUgPSAkS2VybmVsOjpPTS0+Q3JlYXRlKAogICAgICAgICAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICAgICAgICAgT2JqZWN0UGFyYW1zID0+IHsKICAgICAgICAgICAgICAgIFN0cmluZyA9PiAkUGFyYW17VGlja2V0Q2xvc2VUaW1lT2xkZXJEYXRlfSwKICAgICAgICAgICAgfQogICAgICAgICk7CgogICAgICAgIGlmICggISRUaW1lICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlID0+CiAgICAgICAgICAgICAgICAgICAgIlNlYXJjaCBub3QgZXhlY3V0ZWQgZHVlIHRvIGludmFsaWQgdGltZSAnIgogICAgICAgICAgICAgICAgICAgIC4gJFBhcmFte1RpY2tldENsb3NlVGltZU9sZGVyRGF0ZX0gLiAiJyEiLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgICRDb21wYXJlQ2xvc2VUaW1lT2xkZXJOZXdlckRhdGUgPSAkVGltZTsKCiAgICAgICAgIyBnZXQgY2xvc2Ugc3RhdGUgaWRzCiAgICAgICAgbXkgQExpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U3RhdGUnKS0+U3RhdGVHZXRTdGF0ZXNCeVR5cGUoCiAgICAgICAgICAgIFN0YXRlVHlwZSA9PiBbJ2Nsb3NlZCddLAogICAgICAgICAgICBSZXN1bHQgICAgPT4gJ0lEJywKICAgICAgICApOwogICAgICAgIG15IEBTdGF0ZUlEID0gKCAkU2VsZi0+SGlzdG9yeVR5cGVMb29rdXAoIFR5cGUgPT4gJ05ld1RpY2tldCcgKSApOwogICAgICAgIHB1c2goIEBTdGF0ZUlELCAkU2VsZi0+SGlzdG9yeVR5cGVMb29rdXAoIFR5cGUgPT4gJ1N0YXRlVXBkYXRlJyApICk7CiAgICAgICAgaWYgKEBTdGF0ZUlEKSB7CiAgICAgICAgICAgICRTUUxFeHQgLj0gc3ByaW50ZigKICAgICAgICAgICAgICAgICIgQU5EICVzLmhpc3RvcnlfdHlwZV9pZCBJTiAoJXMpIEFORCAlcy5zdGF0ZV9pZCBJTiAoJXMpIEFORCAlcy5jcmVhdGVfdGltZSA8PSAnJXMnIiwKICAgICAgICAgICAgICAgICRUSFJlZiwKICAgICAgICAgICAgICAgICggam9pbiAnLCAnLCBzb3J0IEBTdGF0ZUlEICksCiAgICAgICAgICAgICAgICAkVEhSZWYsCiAgICAgICAgICAgICAgICAoIGpvaW4gJywgJywgc29ydCBATGlzdCApLAogICAgICAgICAgICAgICAgJFRIUmVmLAogICAgICAgICAgICAgICAgJERCT2JqZWN0LT5RdW90ZSggJFBhcmFte1RpY2tldENsb3NlVGltZU9sZGVyRGF0ZX0gKQogICAgICAgICAgICApOwogICAgICAgIH0KICAgIH0KCiAgICAjIGdldCB0aWNrZXRzIGNsb3NlZCBuZXdlciB0aGFuIHh4eHgteHgteHggeHg6eHggZGF0ZQogICAgaWYgKCAkUGFyYW17VGlja2V0Q2xvc2VUaW1lTmV3ZXJEYXRlfSApIHsKICAgICAgICBteSAkVEhSZWYgPSAkU2VsZi0+X1RpY2tldEhpc3RvcnlSZWZlcmVuY2VGb3JTZWFyY2hBcmd1bWVudCgKICAgICAgICAgICAgQXJndW1lbnQgPT4gJ1RpY2tldENsb3NlVGltZU5ld2VyRGF0ZScsCiAgICAgICAgKTsKICAgICAgICByZXR1cm4gaWYgISRUSFJlZjsKCiAgICAgICAgaWYgKAogICAgICAgICAgICAkUGFyYW17VGlja2V0Q2xvc2VUaW1lTmV3ZXJEYXRlfQogICAgICAgICAgICAhfiAvXGRcZFxkXGQtKFxkXGR8XGQpLShcZFxkfFxkKSAoXGRcZHxcZCk6KFxkXGR8XGQpOihcZFxkfFxkKS8KICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkludmFsaWQgdGltZSBmb3JtYXQgJyRQYXJhbXtUaWNrZXRDbG9zZVRpbWVOZXdlckRhdGV9JyEiLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBteSAkVGltZSA9ICRLZXJuZWw6Ok9NLT5DcmVhdGUoCiAgICAgICAgICAgICdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnLAogICAgICAgICAgICBPYmplY3RQYXJhbXMgPT4gewogICAgICAgICAgICAgICAgU3RyaW5nID0+ICRQYXJhbXtUaWNrZXRDbG9zZVRpbWVOZXdlckRhdGV9LAogICAgICAgICAgICB9CiAgICAgICAgKTsKCiAgICAgICAgaWYgKCAhJFRpbWUgKSB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgPT4KICAgICAgICAgICAgICAgICAgICAiU2VhcmNoIG5vdCBleGVjdXRlZCBkdWUgdG8gaW52YWxpZCB0aW1lICciCiAgICAgICAgICAgICAgICAgICAgLiAkUGFyYW17VGlja2V0Q2xvc2VUaW1lTmV3ZXJEYXRlfSAuICInISIsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgICMgZG9uJ3QgZXhlY3V0ZSBxdWVyaWVzIGlmIG5ld2VyIGRhdGUgaXMgYWZ0ZXIgY3VycmVudCBkYXRlCiAgICAgICAgcmV0dXJuIGlmICRUaW1lID4gJERhdGVUaW1lT2JqZWN0OwoKICAgICAgICAjIGRvbid0IGV4ZWN1dGUgcXVlcmllcyBpZiBvbGRlci9uZXdlciBkYXRlIHJlc3RyaWN0aW9uIHNob3cgbm93IHZhbGlkIHRpbWVmcmFtZQogICAgICAgIHJldHVybiBpZiAkQ29tcGFyZUNsb3NlVGltZU9sZGVyTmV3ZXJEYXRlICYmICRUaW1lID4gJENvbXBhcmVDbG9zZVRpbWVPbGRlck5ld2VyRGF0ZTsKCiAgICAgICAgIyBnZXQgY2xvc2Ugc3RhdGUgaWRzCiAgICAgICAgbXkgQExpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U3RhdGUnKS0+U3RhdGVHZXRTdGF0ZXNCeVR5cGUoCiAgICAgICAgICAgIFN0YXRlVHlwZSA9PiBbJ2Nsb3NlZCddLAogICAgICAgICAgICBSZXN1bHQgICAgPT4gJ0lEJywKICAgICAgICApOwogICAgICAgIG15IEBTdGF0ZUlEID0gKCAkU2VsZi0+SGlzdG9yeVR5cGVMb29rdXAoIFR5cGUgPT4gJ05ld1RpY2tldCcgKSApOwogICAgICAgIHB1c2goIEBTdGF0ZUlELCAkU2VsZi0+SGlzdG9yeVR5cGVMb29rdXAoIFR5cGUgPT4gJ1N0YXRlVXBkYXRlJyApICk7CiAgICAgICAgaWYgKEBTdGF0ZUlEKSB7CiAgICAgICAgICAgICRTUUxFeHQgLj0gc3ByaW50ZigKICAgICAgICAgICAgICAgICIgQU5EICVzLmhpc3RvcnlfdHlwZV9pZCBJTiAoJXMpIEFORCAlcy5zdGF0ZV9pZCBJTiAoJXMpIEFORCAlcy5jcmVhdGVfdGltZSA+PSAnJXMnIiwKICAgICAgICAgICAgICAgICRUSFJlZiwKICAgICAgICAgICAgICAgICggam9pbiAnLCAnLCBzb3J0IEBTdGF0ZUlEICksCiAgICAgICAgICAgICAgICAkVEhSZWYsCiAgICAgICAgICAgICAgICAoIGpvaW4gJywgJywgc29ydCBATGlzdCApLAogICAgICAgICAgICAgICAgJFRIUmVmLAogICAgICAgICAgICAgICAgJERCT2JqZWN0LT5RdW90ZSggJFBhcmFte1RpY2tldENsb3NlVGltZU5ld2VyRGF0ZX0gKQogICAgICAgICAgICApOwogICAgICAgIH0KICAgIH0KCiAgICAjIEdldCB0aWNrZXRzIGxhc3QgY2xvc2VkIG9sZGVyIHRoYW4geCBtaW51dGVzLgogICAgaWYgKCBkZWZpbmVkICRQYXJhbXtUaWNrZXRMYXN0Q2xvc2VUaW1lT2xkZXJNaW51dGVzfSApIHsKCiAgICAgICAgJFBhcmFte1RpY2tldExhc3RDbG9zZVRpbWVPbGRlck1pbnV0ZXN9IHx8PSAwOwoKICAgICAgICBteSAkVGltZVN0YW1wID0gJERhdGVUaW1lT2JqZWN0LT5DbG9uZSgpOwogICAgICAgICRUaW1lU3RhbXAtPlN1YnRyYWN0KCBNaW51dGVzID0+ICRQYXJhbXtUaWNrZXRMYXN0Q2xvc2VUaW1lT2xkZXJNaW51dGVzfSApOwoKICAgICAgICAkUGFyYW17VGlja2V0TGFzdENsb3NlVGltZU9sZGVyRGF0ZX0gPSAkVGltZVN0YW1wLT5Ub1N0cmluZygpOwogICAgfQoKICAgICMgR2V0IHRpY2tldHMgbGFzdCBjbG9zZWQgbmV3ZXIgdGhhbiB4IG1pbnV0ZXMuCiAgICBpZiAoIGRlZmluZWQgJFBhcmFte1RpY2tldExhc3RDbG9zZVRpbWVOZXdlck1pbnV0ZXN9ICkgewoKICAgICAgICAkUGFyYW17VGlja2V0TGFzdENsb3NlVGltZU5ld2VyTWludXRlc30gfHw9IDA7CgogICAgICAgIG15ICRUaW1lU3RhbXAgPSAkRGF0ZVRpbWVPYmplY3QtPkNsb25lKCk7CiAgICAgICAgJFRpbWVTdGFtcC0+U3VidHJhY3QoIE1pbnV0ZXMgPT4gJFBhcmFte1RpY2tldExhc3RDbG9zZVRpbWVOZXdlck1pbnV0ZXN9ICk7CgogICAgICAgICRQYXJhbXtUaWNrZXRMYXN0Q2xvc2VUaW1lTmV3ZXJEYXRlfSA9ICRUaW1lU3RhbXAtPlRvU3RyaW5nKCk7CiAgICB9CgogICAgIyBHZXQgdGlja2V0cyBsYXN0IGNsb3NlZCBvbGRlciB0aGFuIHh4eHgteHgteHggeHg6eHggZGF0ZS4KICAgIG15ICRDb21wYXJlTGFzdENsb3NlVGltZU9sZGVyTmV3ZXJEYXRlOwogICAgaWYgKCAkUGFyYW17VGlja2V0TGFzdENsb3NlVGltZU9sZGVyRGF0ZX0gKSB7CiAgICAgICAgbXkgJFRIUmVmID0gJFNlbGYtPl9UaWNrZXRIaXN0b3J5UmVmZXJlbmNlRm9yU2VhcmNoQXJndW1lbnQoCiAgICAgICAgICAgIEFyZ3VtZW50ID0+ICdUaWNrZXRMYXN0Q2xvc2VUaW1lT2xkZXJEYXRlJywKICAgICAgICApOwogICAgICAgIHJldHVybiBpZiAhJFRIUmVmOwoKICAgICAgICAjIENoZWNrIHRpbWUgZm9ybWF0LgogICAgICAgIGlmICgKICAgICAgICAgICAgJFBhcmFte1RpY2tldExhc3RDbG9zZVRpbWVPbGRlckRhdGV9CiAgICAgICAgICAgICF+IC9cZFxkXGRcZC0oXGRcZHxcZCktKFxkXGR8XGQpIChcZFxkfFxkKTooXGRcZHxcZCk6KFxkXGR8XGQpLwogICAgICAgICAgICApCiAgICAgICAgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiSW52YWxpZCB0aW1lIGZvcm1hdCAnJFBhcmFte1RpY2tldExhc3RDbG9zZVRpbWVPbGRlckRhdGV9JyEiLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBteSAkVGltZSA9ICRLZXJuZWw6Ok9NLT5DcmVhdGUoCiAgICAgICAgICAgICdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnLAogICAgICAgICAgICBPYmplY3RQYXJhbXMgPT4gewogICAgICAgICAgICAgICAgU3RyaW5nID0+ICRQYXJhbXtUaWNrZXRMYXN0Q2xvc2VUaW1lT2xkZXJEYXRlfSwKICAgICAgICAgICAgfQogICAgICAgICk7CgogICAgICAgIGlmICggISRUaW1lICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlID0+CiAgICAgICAgICAgICAgICAgICAgIlNlYXJjaCBub3QgZXhlY3V0ZWQgZHVlIHRvIGludmFsaWQgdGltZSAnIgogICAgICAgICAgICAgICAgICAgIC4gJFBhcmFte1RpY2tldExhc3RDbG9zZVRpbWVPbGRlckRhdGV9IC4gIichIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAkQ29tcGFyZUxhc3RDbG9zZVRpbWVPbGRlck5ld2VyRGF0ZSA9ICRUaW1lOwoKICAgICAgICAjIEdldCBjbG9zZSBzdGF0ZSBpZHMuCiAgICAgICAgbXkgQExpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U3RhdGUnKS0+U3RhdGVHZXRTdGF0ZXNCeVR5cGUoCiAgICAgICAgICAgIFN0YXRlVHlwZSA9PiBbJ2Nsb3NlZCddLAogICAgICAgICAgICBSZXN1bHQgICAgPT4gJ0lEJywKICAgICAgICApOwogICAgICAgIG15IEBTdGF0ZUlEID0gKCAkU2VsZi0+SGlzdG9yeVR5cGVMb29rdXAoIFR5cGUgPT4gJ05ld1RpY2tldCcgKSApOwogICAgICAgIHB1c2goIEBTdGF0ZUlELCAkU2VsZi0+SGlzdG9yeVR5cGVMb29rdXAoIFR5cGUgPT4gJ1N0YXRlVXBkYXRlJyApICk7CiAgICAgICAgaWYgKEBTdGF0ZUlEKSB7CiAgICAgICAgICAgICRTUUxFeHQgLj0gc3ByaW50ZigKICAgICAgICAgICAgICAgICIgQU5EICVzLmhpc3RvcnlfdHlwZV9pZCBJTiAoJXMpIEFORCAlcy5zdGF0ZV9pZCBJTiAoJXMpIEFORCAiCiAgICAgICAgICAgICAgICAgICAgLiAiJXMuY3JlYXRlX3RpbWUgPD0gJyVzJyBBTkQgIgogICAgICAgICAgICAgICAgICAgIC4gIiVzLmNyZWF0ZV90aW1lIElOICIKICAgICAgICAgICAgICAgICAgICAuICIoIgogICAgICAgICAgICAgICAgICAgIC4gIlNFTEVDVCBsY28xLmNyZWF0ZV90aW1lICIKICAgICAgICAgICAgICAgICAgICAuICJGUk9NIHRpY2tldF9oaXN0b3J5IGxjbzEgIgogICAgICAgICAgICAgICAgICAgIC4gIklOTkVSIEpPSU4gIgogICAgICAgICAgICAgICAgICAgIC4gIigiCiAgICAgICAgICAgICAgICAgICAgLiAiU0VMRUNUIHRpY2tldF9pZCwgTUFYKGNyZWF0ZV90aW1lKSBBUyBtYXhfdGltZSAiCiAgICAgICAgICAgICAgICAgICAgLiAiRlJPTSB0aWNrZXRfaGlzdG9yeSAiCiAgICAgICAgICAgICAgICAgICAgLiAiV0hFUkUgaGlzdG9yeV90eXBlX2lkIElOICglcykgQU5EIHN0YXRlX2lkIElOICglcykgIgogICAgICAgICAgICAgICAgICAgIC4gIkdST1VQIEJZIHRpY2tldF9pZCAiCiAgICAgICAgICAgICAgICAgICAgLiAiKSBsY28yICIKICAgICAgICAgICAgICAgICAgICAuICJPTiBsY28xLnRpY2tldF9pZCA9IGxjbzIudGlja2V0X2lkICIKICAgICAgICAgICAgICAgICAgICAuICJBTkQgbGNvMS5jcmVhdGVfdGltZSA9IGxjbzIubWF4X3RpbWUgIgogICAgICAgICAgICAgICAgICAgIC4gIikgIiwKICAgICAgICAgICAgICAgICRUSFJlZiwKICAgICAgICAgICAgICAgICggam9pbiAnLCAnLCBzb3J0IEBTdGF0ZUlEICksCiAgICAgICAgICAgICAgICAkVEhSZWYsCiAgICAgICAgICAgICAgICAoIGpvaW4gJywgJywgc29ydCBATGlzdCApLAogICAgICAgICAgICAgICAgJFRIUmVmLAogICAgICAgICAgICAgICAgJERCT2JqZWN0LT5RdW90ZSggJFBhcmFte1RpY2tldExhc3RDbG9zZVRpbWVPbGRlckRhdGV9ICksCiAgICAgICAgICAgICAgICAkVEhSZWYsCiAgICAgICAgICAgICAgICAoIGpvaW4gJywgJywgc29ydCBAU3RhdGVJRCApLAogICAgICAgICAgICAgICAgKCBqb2luICcsICcsIHNvcnQgQExpc3QgKQogICAgICAgICAgICApOwogICAgICAgIH0KICAgIH0KCiAgICAjIEdldCB0aWNrZXRzIGxhc3QgY2xvc2VkIG5ld2VyIHRoYW4geHh4eC14eC14eCB4eDp4eCBkYXRlLgogICAgaWYgKCAkUGFyYW17VGlja2V0TGFzdENsb3NlVGltZU5ld2VyRGF0ZX0gKSB7CiAgICAgICAgbXkgJFRIUmVmID0gJFNlbGYtPl9UaWNrZXRIaXN0b3J5UmVmZXJlbmNlRm9yU2VhcmNoQXJndW1lbnQoCiAgICAgICAgICAgIEFyZ3VtZW50ID0+ICdUaWNrZXRMYXN0Q2xvc2VUaW1lTmV3ZXJEYXRlJywKICAgICAgICApOwogICAgICAgIHJldHVybiBpZiAhJFRIUmVmOwoKICAgICAgICBpZiAoCiAgICAgICAgICAgICRQYXJhbXtUaWNrZXRMYXN0Q2xvc2VUaW1lTmV3ZXJEYXRlfQogICAgICAgICAgICAhfiAvXGRcZFxkXGQtKFxkXGR8XGQpLShcZFxkfFxkKSAoXGRcZHxcZCk6KFxkXGR8XGQpOihcZFxkfFxkKS8KICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkludmFsaWQgdGltZSBmb3JtYXQgJyRQYXJhbXtUaWNrZXRMYXN0Q2xvc2VUaW1lTmV3ZXJEYXRlfSchIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgbXkgJFRpbWUgPSAkS2VybmVsOjpPTS0+Q3JlYXRlKAogICAgICAgICAgICAnS2VybmVsOjpTeXN0ZW06OkRhdGVUaW1lJywKICAgICAgICAgICAgT2JqZWN0UGFyYW1zID0+IHsKICAgICAgICAgICAgICAgIFN0cmluZyA9PiAkUGFyYW17VGlja2V0TGFzdENsb3NlVGltZU5ld2VyRGF0ZX0sCiAgICAgICAgICAgIH0KICAgICAgICApOwoKICAgICAgICBpZiAoICEkVGltZSApIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSA9PgogICAgICAgICAgICAgICAgICAgICJTZWFyY2ggbm90IGV4ZWN1dGVkIGR1ZSB0byBpbnZhbGlkIHRpbWUgJyIKICAgICAgICAgICAgICAgICAgICAuICRQYXJhbXtUaWNrZXRMYXN0Q2xvc2VUaW1lTmV3ZXJEYXRlfSAuICInISIsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgICMgRG9uJ3QgZXhlY3V0ZSBxdWVyaWVzIGlmIG5ld2VyIGRhdGUgaXMgYWZ0ZXIgY3VycmVudCBkYXRlLgogICAgICAgIHJldHVybiBpZiAkVGltZSA+ICREYXRlVGltZU9iamVjdDsKCiAgICAgICAgIyBEb24ndCBleGVjdXRlIHF1ZXJpZXMgaWYgb2xkZXIvbmV3ZXIgZGF0ZSByZXN0cmljdGlvbiBzaG93IG5vdyB2YWxpZCB0aW1lZnJhbWUuCiAgICAgICAgcmV0dXJuIGlmICRDb21wYXJlTGFzdENsb3NlVGltZU9sZGVyTmV3ZXJEYXRlICYmICRUaW1lID4gJENvbXBhcmVMYXN0Q2xvc2VUaW1lT2xkZXJOZXdlckRhdGU7CgogICAgICAgICMgR2V0IGNsb3NlIHN0YXRlIGlkcy4KICAgICAgICBteSBATGlzdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTdGF0ZScpLT5TdGF0ZUdldFN0YXRlc0J5VHlwZSgKICAgICAgICAgICAgU3RhdGVUeXBlID0+IFsnY2xvc2VkJ10sCiAgICAgICAgICAgIFJlc3VsdCAgICA9PiAnSUQnLAogICAgICAgICk7CiAgICAgICAgbXkgQFN0YXRlSUQgPSAoICRTZWxmLT5IaXN0b3J5VHlwZUxvb2t1cCggVHlwZSA9PiAnTmV3VGlja2V0JyApICk7CiAgICAgICAgcHVzaCggQFN0YXRlSUQsICRTZWxmLT5IaXN0b3J5VHlwZUxvb2t1cCggVHlwZSA9PiAnU3RhdGVVcGRhdGUnICkgKTsKICAgICAgICBpZiAoQFN0YXRlSUQpIHsKICAgICAgICAgICAgJFNRTEV4dCAuPSBzcHJpbnRmKAogICAgICAgICAgICAgICAgIiBBTkQgJXMuaGlzdG9yeV90eXBlX2lkIElOICglcykgQU5EICVzLnN0YXRlX2lkIElOICglcykgQU5EICIKICAgICAgICAgICAgICAgICAgICAuICIlcy5jcmVhdGVfdGltZSA+PSAnJXMnIEFORCAiCiAgICAgICAgICAgICAgICAgICAgLiAiJXMuY3JlYXRlX3RpbWUgSU4gIgogICAgICAgICAgICAgICAgICAgIC4gIigiCiAgICAgICAgICAgICAgICAgICAgLiAiU0VMRUNUIGxjbjEuY3JlYXRlX3RpbWUgIgogICAgICAgICAgICAgICAgICAgIC4gIkZST00gdGlja2V0X2hpc3RvcnkgbGNuMSAiCiAgICAgICAgICAgICAgICAgICAgLiAiSU5ORVIgSk9JTiAiCiAgICAgICAgICAgICAgICAgICAgLiAiKCIKICAgICAgICAgICAgICAgICAgICAuICJTRUxFQ1QgdGlja2V0X2lkLCBNQVgoY3JlYXRlX3RpbWUpIEFTIG1heF90aW1lICIKICAgICAgICAgICAgICAgICAgICAuICJGUk9NIHRpY2tldF9oaXN0b3J5ICIKICAgICAgICAgICAgICAgICAgICAuICJXSEVSRSBoaXN0b3J5X3R5cGVfaWQgSU4gKCVzKSBBTkQgc3RhdGVfaWQgSU4gKCVzKSAiCiAgICAgICAgICAgICAgICAgICAgLiAiR1JPVVAgQlkgdGlja2V0X2lkICIKICAgICAgICAgICAgICAgICAgICAuICIpIGxjbjIgIgogICAgICAgICAgICAgICAgICAgIC4gIk9OIGxjbjEudGlja2V0X2lkID0gbGNuMi50aWNrZXRfaWQgIgogICAgICAgICAgICAgICAgICAgIC4gIkFORCBsY24xLmNyZWF0ZV90aW1lID0gbGNuMi5tYXhfdGltZSAiCiAgICAgICAgICAgICAgICAgICAgLiAiKSAiLAogICAgICAgICAgICAgICAgJFRIUmVmLAogICAgICAgICAgICAgICAgKCBqb2luICcsICcsIHNvcnQgQFN0YXRlSUQgKSwKICAgICAgICAgICAgICAgICRUSFJlZiwKICAgICAgICAgICAgICAgICggam9pbiAnLCAnLCBzb3J0IEBMaXN0ICksCiAgICAgICAgICAgICAgICAkVEhSZWYsCiAgICAgICAgICAgICAgICAkREJPYmplY3QtPlF1b3RlKCAkUGFyYW17VGlja2V0TGFzdENsb3NlVGltZU5ld2VyRGF0ZX0gKSwKICAgICAgICAgICAgICAgICRUSFJlZiwKICAgICAgICAgICAgICAgICggam9pbiAnLCAnLCBzb3J0IEBTdGF0ZUlEICksCiAgICAgICAgICAgICAgICAoIGpvaW4gJywgJywgc29ydCBATGlzdCApCiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgfQoKICAgICMgY2hlY2sgaWYgb25seSBwZW5kaW5nIHN0YXRlcyBhcmUgdXNlZAogICAgaWYgKAogICAgICAgIGRlZmluZWQgJFBhcmFte1RpY2tldFBlbmRpbmdUaW1lT2xkZXJNaW51dGVzfQogICAgICAgIHx8IGRlZmluZWQgJFBhcmFte1RpY2tldFBlbmRpbmdUaW1lTmV3ZXJNaW51dGVzfQogICAgICAgIHx8ICRQYXJhbXtUaWNrZXRQZW5kaW5nVGltZU9sZGVyRGF0ZX0KICAgICAgICB8fCAkUGFyYW17VGlja2V0UGVuZGluZ1RpbWVOZXdlckRhdGV9CiAgICAgICAgKQogICAgewoKICAgICAgICAjIGdldCBwZW5kaW5nIHN0YXRlIGlkcwogICAgICAgIG15IEBMaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlN0YXRlJyktPlN0YXRlR2V0U3RhdGVzQnlUeXBlKAogICAgICAgICAgICBTdGF0ZVR5cGUgPT4gWyAncGVuZGluZyByZW1pbmRlcicsICdwZW5kaW5nIGF1dG8nIF0sCiAgICAgICAgICAgIFJlc3VsdCAgICA9PiAnSUQnLAogICAgICAgICk7CiAgICAgICAgaWYgKEBMaXN0KSB7CiAgICAgICAgICAgICRTUUxFeHQgLj0gIiBBTkQgc3QudGlja2V0X3N0YXRlX2lkIElOICgke1woam9pbiAnLCAnLCBzb3J0IEBMaXN0KX0pICI7CiAgICAgICAgfQogICAgfQoKICAgICMgZ2V0IHRpY2tldHMgcGVuZGluZyBvbGRlciB0aGFuIHggbWludXRlcwogICAgaWYgKCBkZWZpbmVkICRQYXJhbXtUaWNrZXRQZW5kaW5nVGltZU9sZGVyTWludXRlc30gKSB7CgogICAgICAgICRQYXJhbXtUaWNrZXRQZW5kaW5nVGltZU9sZGVyTWludXRlc30gfHw9IDA7CgogICAgICAgIG15ICRUaW1lU3RhbXAgPSAkS2VybmVsOjpPTS0+Q3JlYXRlKCdLZXJuZWw6OlN5c3RlbTo6RGF0ZVRpbWUnKTsKCiAgICAgICAgJFRpbWVTdGFtcC0+U3VidHJhY3QoIE1pbnV0ZXMgPT4gJFBhcmFte1RpY2tldFBlbmRpbmdUaW1lT2xkZXJNaW51dGVzfSApOwoKICAgICAgICAkUGFyYW17VGlja2V0UGVuZGluZ1RpbWVPbGRlckRhdGV9ID0gJFRpbWVTdGFtcC0+VG9TdHJpbmcoKTsKICAgIH0KCiAgICAjIGdldCB0aWNrZXRzIHBlbmRpbmcgbmV3ZXIgdGhhbiB4IG1pbnV0ZXMKICAgIGlmICggZGVmaW5lZCAkUGFyYW17VGlja2V0UGVuZGluZ1RpbWVOZXdlck1pbnV0ZXN9ICkgewoKICAgICAgICAkUGFyYW17VGlja2V0UGVuZGluZ1RpbWVOZXdlck1pbnV0ZXN9IHx8PSAwOwoKICAgICAgICBteSAkVGltZVN0YW1wID0gJERhdGVUaW1lT2JqZWN0LT5DbG9uZSgpOwogICAgICAgICRUaW1lU3RhbXAtPlN1YnRyYWN0KCBNaW51dGVzID0+ICRQYXJhbXtUaWNrZXRQZW5kaW5nVGltZU5ld2VyTWludXRlc30gKTsKCiAgICAgICAgJFBhcmFte1RpY2tldFBlbmRpbmdUaW1lTmV3ZXJEYXRlfSA9ICRUaW1lU3RhbXAtPlRvU3RyaW5nKCk7CiAgICB9CgogICAgIyBnZXQgcGVuZGluZyB0aWNrZXRzIG9sZGVyIHRoYW4geHh4eC14eC14eCB4eDp4eCBkYXRlCiAgICBteSAkQ29tcGFyZVBlbmRpbmdUaW1lT2xkZXJOZXdlckRhdGU7CiAgICBpZiAoICRQYXJhbXtUaWNrZXRQZW5kaW5nVGltZU9sZGVyRGF0ZX0gKSB7CgogICAgICAgICMgY2hlY2sgdGltZSBmb3JtYXQKICAgICAgICBpZiAoCiAgICAgICAgICAgICRQYXJhbXtUaWNrZXRQZW5kaW5nVGltZU9sZGVyRGF0ZX0KICAgICAgICAgICAgIX4gL1xkXGRcZFxkLShcZFxkfFxkKS0oXGRcZHxcZCkgKFxkXGR8XGQpOihcZFxkfFxkKTooXGRcZHxcZCkvCiAgICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJJbnZhbGlkIHRpbWUgZm9ybWF0ICckUGFyYW17VGlja2V0UGVuZGluZ1RpbWVPbGRlckRhdGV9JyEiLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBteSAkVGltZVN0YW1wID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgKICAgICAgICAgICAgJ0tlcm5lbDo6U3lzdGVtOjpEYXRlVGltZScsCiAgICAgICAgICAgIE9iamVjdFBhcmFtcyA9PiB7CiAgICAgICAgICAgICAgICBTdHJpbmcgPT4gJFBhcmFte1RpY2tldFBlbmRpbmdUaW1lT2xkZXJEYXRlfSwKICAgICAgICAgICAgfQogICAgICAgICk7CgogICAgICAgIGlmICggISRUaW1lU3RhbXAgKSB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgPT4KICAgICAgICAgICAgICAgICAgICAiU2VhcmNoIG5vdCBleGVjdXRlZCBkdWUgdG8gaW52YWxpZCB0aW1lICciCiAgICAgICAgICAgICAgICAgICAgLiAkUGFyYW17VGlja2V0UGVuZGluZ1RpbWVPbGRlckRhdGV9IC4gIichIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAkQ29tcGFyZVBlbmRpbmdUaW1lT2xkZXJOZXdlckRhdGUgPSAkVGltZVN0YW1wOwoKICAgICAgICAkU1FMRXh0IC49ICIgQU5EIHN0LnVudGlsX3RpbWUgPD0gIiAuICRUaW1lU3RhbXAtPlRvRXBvY2goKTsKICAgIH0KCiAgICAjIGdldCBwZW5kaW5nIHRpY2tldHMgbmV3ZXIgdGhhbiB4eHh4LXh4LXh4IHh4Onh4IGRhdGUKICAgIGlmICggJFBhcmFte1RpY2tldFBlbmRpbmdUaW1lTmV3ZXJEYXRlfSApIHsKICAgICAgICBpZiAoCiAgICAgICAgICAgICRQYXJhbXtUaWNrZXRQZW5kaW5nVGltZU5ld2VyRGF0ZX0KICAgICAgICAgICAgIX4gL1xkXGRcZFxkLShcZFxkfFxkKS0oXGRcZHxcZCkgKFxkXGR8XGQpOihcZFxkfFxkKTooXGRcZHxcZCkvCiAgICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJJbnZhbGlkIHRpbWUgZm9ybWF0ICckUGFyYW17VGlja2V0UGVuZGluZ1RpbWVOZXdlckRhdGV9JyEiLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBteSAkVGltZVN0YW1wID0gJEtlcm5lbDo6T00tPkNyZWF0ZSgKICAgICAgICAgICAgJ0tlcm5lbDo6U3lzdGVtOjpEYXRlVGltZScsCiAgICAgICAgICAgIE9iamVjdFBhcmFtcyA9PiB7CiAgICAgICAgICAgICAgICBTdHJpbmcgPT4gJFBhcmFte1RpY2tldFBlbmRpbmdUaW1lTmV3ZXJEYXRlfSwKICAgICAgICAgICAgfQogICAgICAgICk7CgogICAgICAgIGlmICggISRUaW1lU3RhbXAgKSB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgPT4KICAgICAgICAgICAgICAgICAgICAiU2VhcmNoIG5vdCBleGVjdXRlZCBkdWUgdG8gaW52YWxpZCB0aW1lICciCiAgICAgICAgICAgICAgICAgICAgLiAkUGFyYW17VGlja2V0UGVuZGluZ1RpbWVOZXdlckRhdGV9IC4gIichIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgIyBkb24ndCBleGVjdXRlIHF1ZXJpZXMgaWYgb2xkZXIvbmV3ZXIgZGF0ZSByZXN0cmljdGlvbiBzaG93IG5vdyB2YWxpZCB0aW1lZnJhbWUKICAgICAgICByZXR1cm4KICAgICAgICAgICAgaWYgJENvbXBhcmVQZW5kaW5nVGltZU9sZGVyTmV3ZXJEYXRlICYmICRUaW1lU3RhbXAgPiAkQ29tcGFyZVBlbmRpbmdUaW1lT2xkZXJOZXdlckRhdGU7CgogICAgICAgICRTUUxFeHQgLj0gIiBBTkQgc3QudW50aWxfdGltZSA+PSAiIC4gJFRpbWVTdGFtcC0+VG9FcG9jaCgpOwogICAgfQoKICAgICMgYXJjaGl2ZSBmbGFnCiAgICBpZiAoICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyktPkdldCgnVGlja2V0OjpBcmNoaXZlU3lzdGVtJykgKSB7CgogICAgICAgICMgaWYgbm8gZmxhZyBpcyBnaXZlbiwgb25seSBzZWFyY2ggZm9yIG5vdCBhcmNoaXZlZCB0aWNrZXQKICAgICAgICBpZiAoICEkUGFyYW17QXJjaGl2ZUZsYWdzfSApIHsKICAgICAgICAgICAgJFBhcmFte0FyY2hpdmVGbGFnc30gPSBbJ24nXTsKICAgICAgICB9CgogICAgICAgICMgcHJlcGFyZSBzZWFyY2ggd2l0aCBhcmNoaXZlIGZsYWdzLCBjaGVjayBhcmd1bWVudHMKICAgICAgICBpZiAoIHJlZiAkUGFyYW17QXJjaGl2ZUZsYWdzfSBuZSAnQVJSQVknICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiSW52YWxpZCBhdHRyaWJ1dGUgQXJjaGl2ZUZsYWdzICckUGFyYW17QXJjaGl2ZUZsYWdzfSchIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgIyBwcmVwYXJlIG9wdGlvbnMKICAgICAgICBteSAlT3B0aW9uczsKICAgICAgICBmb3IgbXkgJEtleSAoIEB7ICRQYXJhbXtBcmNoaXZlRmxhZ3N9IH0gKSB7CiAgICAgICAgICAgICRPcHRpb25zeyRLZXl9ID0gMTsKICAgICAgICB9CgogICAgICAgICMgc2VhcmNoIGZvciBhcmNoaXZlZAogICAgICAgIGlmICggJE9wdGlvbnN7eX0gJiYgISRPcHRpb25ze259ICkgewogICAgICAgICAgICAkU1FMRXh0IC49ICcgQU5EIGFyY2hpdmVfZmxhZyA9IDEnOwogICAgICAgIH0KCiAgICAgICAgIyBzZWFyY2ggZm9yIG5vdCBhcmNoaXZlZAogICAgICAgIGVsc2lmICggISRPcHRpb25ze3l9ICYmICRPcHRpb25ze259ICkgewogICAgICAgICAgICAkU1FMRXh0IC49ICcgQU5EIGFyY2hpdmVfZmxhZyA9IDAnOwogICAgICAgIH0KICAgIH0KCiAgICAjIGRhdGFiYXNlIHF1ZXJ5IGZvciBzb3J0L29yZGVyIGJ5IG9wdGlvbgogICAgaWYgKCAkUmVzdWx0IG5lICdDT1VOVCcgKSB7CiAgICAgICAgJFNRTEV4dCAuPSAnIE9SREVSIEJZJzsKICAgICAgICBmb3IgbXkgJENvdW50ICggMCAuLiAkI1NvcnRCeUFycmF5ICkgewogICAgICAgICAgICBpZiAoICRDb3VudCA+IDAgKSB7CiAgICAgICAgICAgICAgICAkU1FMRXh0IC49ICcsJzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBzb3J0IGJ5IGR5bmFtaWMgZmllbGQKICAgICAgICAgICAgaWYgKCAkVmFsaWREeW5hbWljRmllbGRQYXJhbXN7ICRTb3J0QnlBcnJheVskQ291bnRdIH0gKSB7CiAgICAgICAgICAgICAgICBteSAoJER5bmFtaWNGaWVsZE5hbWUpID0gJFNvcnRCeUFycmF5WyRDb3VudF0gPX4gbS9eRHluYW1pY0ZpZWxkXyguKikkL3NteDsKCiAgICAgICAgICAgICAgICBteSAkRHluYW1pY0ZpZWxkID0gJFRpY2tldER5bmFtaWNGaWVsZE5hbWUyQ29uZmlneyREeW5hbWljRmllbGROYW1lfSB8fAogICAgICAgICAgICAgICAgICAgICRBcnRpY2xlRHluYW1pY0ZpZWxkTmFtZTJDb25maWd7JER5bmFtaWNGaWVsZE5hbWV9OwoKICAgICAgICAgICAgICAgICMgSWYgdGhlIHRhYmxlIHdhcyBhbHJlYWR5IGpvaW5lZCBmb3Igc2VhcmNoaW5nLCB3ZSByZXVzZSBpdC4KICAgICAgICAgICAgICAgIGlmICggISREeW5hbWljRmllbGRKb2luVGFibGVzeyREeW5hbWljRmllbGROYW1lfSApIHsKCiAgICAgICAgICAgICAgICAgICAgaWYgKCAkVGlja2V0RHluYW1pY0ZpZWxkTmFtZTJDb25maWd7JER5bmFtaWNGaWVsZE5hbWV9ICkgewoKICAgICAgICAgICAgICAgICAgICAgICAgIyBKb2luIHRoZSB0YWJsZSBmb3IgdGhpcyBkeW5hbWljIGZpZWxkOyB1c2UgYSBsZWZ0IG91dGVyIGpvaW4gaW4gdGhpcyBjYXNlLgogICAgICAgICAgICAgICAgICAgICAgICAjIFdpdGggYW4gSU5ORVIgSk9JTiB3ZSdkIGxpbWl0IHRoZSByZXN1bHQgc2V0IHRvIHRpY2tldHMgd2hpY2ggaGF2ZSBhbiBlbnRyeQogICAgICAgICAgICAgICAgICAgICAgICAjICAgZm9yIHRoZSBERiB3aGljaCBpcyB1c2VkIGZvciBzb3J0aW5nLgogICAgICAgICAgICAgICAgICAgICAgICAkU1FMRnJvbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLj0gIiBMRUZUIE9VVEVSIEpPSU4gZHluYW1pY19maWVsZF92YWx1ZSBkZnYkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIChzdC5pZCA9IGRmdiREeW5hbWljRmllbGRKb2luQ291bnRlci5vYmplY3RfaWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBTkQgZGZ2JER5bmFtaWNGaWVsZEpvaW5Db3VudGVyLmZpZWxkX2lkID0gIiAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkREJPYmplY3QtPlF1b3RlKCAkRHluYW1pY0ZpZWxkLT57SUR9LCAnSW50ZWdlcicgKSAuICIpICI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2lmICggJEFydGljbGVEeW5hbWljRmllbGROYW1lMkNvbmZpZ3skRHluYW1pY0ZpZWxkTmFtZX0gKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggISRBcnRpY2xlVGFibGVKb2luZWQgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkU1FMRnJvbSAuPSAnIElOTkVSIEpPSU4gYXJ0aWNsZSBhcnQgT04gc3QuaWQgPSBhcnQudGlja2V0X2lkICc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQXJ0aWNsZVRhYmxlSm9pbmVkID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgJFNRTEZyb20KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC49ICIgTEVGVCBPVVRFUiBKT0lOIGR5bmFtaWNfZmllbGRfdmFsdWUgZGZ2JER5bmFtaWNGaWVsZEpvaW5Db3VudGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPTiAoYXJ0LmlkID0gZGZ2JER5bmFtaWNGaWVsZEpvaW5Db3VudGVyLm9iamVjdF9pZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFORCBkZnYkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIuZmllbGRfaWQgPSAiIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICREQk9iamVjdC0+UXVvdGUoICREeW5hbWljRmllbGQtPntJRH0sICdJbnRlZ2VyJyApIC4gIikgIjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICREeW5hbWljRmllbGRKb2luVGFibGVzeyAkRHluYW1pY0ZpZWxkLT57TmFtZX0gfSA9ICJkZnYkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIiOwoKICAgICAgICAgICAgICAgICAgICAkRHluYW1pY0ZpZWxkSm9pbkNvdW50ZXIrKzsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBteSAkU1FMT3JkZXJGaWVsZCA9ICREeW5hbWljRmllbGRCYWNrZW5kT2JqZWN0LT5TZWFyY2hTUUxPcmRlckZpZWxkR2V0KAogICAgICAgICAgICAgICAgICAgIER5bmFtaWNGaWVsZENvbmZpZyA9PiAkRHluYW1pY0ZpZWxkLAogICAgICAgICAgICAgICAgICAgIFRhYmxlQWxpYXMgICAgICAgICA9PiAkRHluYW1pY0ZpZWxkSm9pblRhYmxlc3skRHluYW1pY0ZpZWxkTmFtZX0sCiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICRTUUxTZWxlY3QgLj0gIiwgJFNRTE9yZGVyRmllbGQgIjsKICAgICAgICAgICAgICAgICRTUUxFeHQgICAgLj0gIiAkU1FMT3JkZXJGaWVsZCAiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2lmICgKICAgICAgICAgICAgICAgICRTb3J0QnlBcnJheVskQ291bnRdIGVxICdPd25lcicKICAgICAgICAgICAgICAgIHx8ICRTb3J0QnlBcnJheVskQ291bnRdIGVxICdSZXNwb25zaWJsZScKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIyBJbmNsdWRlIGZpcnN0IG5hbWUsIGxhc3QgbmFtZSBhbmQgbG9naW4gaW4gc2VsZWN0LgogICAgICAgICAgICAgICAgJFNRTFNlbGVjdAogICAgICAgICAgICAgICAgICAgIC49ICcsICcgLiAkU29ydE9wdGlvbnN7ICRTb3J0QnlBcnJheVskQ291bnRdIH0KICAgICAgICAgICAgICAgICAgICAuICcsIHUuZmlyc3RfbmFtZSwgdS5sYXN0X25hbWUsIHUubG9naW4gJzsKCiAgICAgICAgICAgICAgICAjIEpvaW4gdGhlIHVzZXJzIHRhYmxlIG9uIHVzZXIncyBJRC4KICAgICAgICAgICAgICAgICRTUUxGcm9tCiAgICAgICAgICAgICAgICAgICAgLj0gJyBKT0lOIHVzZXJzIHUgJwogICAgICAgICAgICAgICAgICAgIC4gJyBPTiAnIC4gJFNvcnRPcHRpb25zeyAkU29ydEJ5QXJyYXlbJENvdW50XSB9IC4gJyA9IHUuaWQgJzsKCiAgICAgICAgICAgICAgICBteSAkRmlyc3RuYW1lTGFzdE5hbWVPcmRlciA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyktPkdldCgnRmlyc3RuYW1lTGFzdG5hbWVPcmRlcicpIHx8IDA7CiAgICAgICAgICAgICAgICBteSAkT3JkZXJCeVN1ZmZpeCAgICAgICAgICA9ICRPcmRlckJ5QXJyYXlbJENvdW50XSBlcSAnVXAnID8gJ0FTQycgOiAnREVTQyc7CgogICAgICAgICAgICAgICAgIyBTb3J0IGJ5IGNvbmZpZ3VyZWQgZmlyc3QgYW5kIGxhc3QgbmFtZSBvcmRlci4KICAgICAgICAgICAgICAgIGlmICggJEZpcnN0bmFtZUxhc3ROYW1lT3JkZXIgZXEgJzEnIHx8ICRGaXJzdG5hbWVMYXN0TmFtZU9yZGVyIGVxICc2JyApIHsKICAgICAgICAgICAgICAgICAgICAkU1FMRXh0IC49ICIgdS5sYXN0X25hbWUgJE9yZGVyQnlTdWZmaXgsIHUuZmlyc3RfbmFtZSAiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzaWYgKCAkRmlyc3RuYW1lTGFzdE5hbWVPcmRlciBlcSAnMicgKSB7CiAgICAgICAgICAgICAgICAgICAgJFNRTEV4dCAuPSAiIHUuZmlyc3RfbmFtZSAkT3JkZXJCeVN1ZmZpeCwgdS5sYXN0X25hbWUgJE9yZGVyQnlTdWZmaXgsIHUubG9naW4gIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2lmICggJEZpcnN0bmFtZUxhc3ROYW1lT3JkZXIgZXEgJzMnIHx8ICRGaXJzdG5hbWVMYXN0TmFtZU9yZGVyIGVxICc3JyApIHsKICAgICAgICAgICAgICAgICAgICAkU1FMRXh0IC49ICIgdS5sYXN0X25hbWUgJE9yZGVyQnlTdWZmaXgsIHUuZmlyc3RfbmFtZSAkT3JkZXJCeVN1ZmZpeCwgdS5sb2dpbiAiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzaWYgKCAkRmlyc3RuYW1lTGFzdE5hbWVPcmRlciBlcSAnNCcgKSB7CiAgICAgICAgICAgICAgICAgICAgJFNRTEV4dCAuPSAiIHUubG9naW4gJE9yZGVyQnlTdWZmaXgsIHUuZmlyc3RfbmFtZSAkT3JkZXJCeVN1ZmZpeCwgdS5sYXN0X25hbWUgIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2lmICggJEZpcnN0bmFtZUxhc3ROYW1lT3JkZXIgZXEgJzUnIHx8ICRGaXJzdG5hbWVMYXN0TmFtZU9yZGVyIGVxICc4JyApIHsKICAgICAgICAgICAgICAgICAgICAkU1FMRXh0IC49ICIgdS5sb2dpbiAkT3JkZXJCeVN1ZmZpeCwgdS5sYXN0X25hbWUgJE9yZGVyQnlTdWZmaXgsIHUuZmlyc3RfbmFtZSAiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJFNRTEV4dCAuPSAiIHUuZmlyc3RfbmFtZSAkT3JkZXJCeVN1ZmZpeCwgdS5sYXN0X25hbWUgIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNpZiAoCiAgICAgICAgICAgICAgICAkU29ydEJ5QXJyYXlbJENvdW50XSBlcSAnRXNjYWxhdGlvblVwZGF0ZVRpbWUnCiAgICAgICAgICAgICAgICB8fCAkU29ydEJ5QXJyYXlbJENvdW50XSBlcSAnRXNjYWxhdGlvblJlc3BvbnNlVGltZScKICAgICAgICAgICAgICAgIHx8ICRTb3J0QnlBcnJheVskQ291bnRdIGVxICdFc2NhbGF0aW9uU29sdXRpb25UaW1lJwogICAgICAgICAgICAgICAgfHwgJFNvcnRCeUFycmF5WyRDb3VudF0gZXEgJ0VzY2FsYXRpb25UaW1lJwogICAgICAgICAgICAgICAgfHwgJFNvcnRCeUFycmF5WyRDb3VudF0gZXEgJ1BlbmRpbmdUaW1lJwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICB7CgogICAgICAgICAgICAgICAgIyBUaWNrZXRzIHdpdGggbm8gRXNjYWxhdGlvbiBvciBQZW5kaW5nIHRpbWUgaGF2ZSAnMCcgYXMgdmFsdWUgaW4gdGhlIGFjY29yZGluZyB0aWNrZXQgY29sdW1ucy4KICAgICAgICAgICAgICAgICMgV2hlbiBzb3J0aW5nIGJ5IHRoZXNlIGNvbHVtbnMgYWx3YXlzIHBsYWNlIHRpY2tldCdzIHdpdGggJzAnIHZhbHVlIG9uIHRoZSBlbmQsIG5vIG1hdHRlciBvcmRlciBieS4KICAgICAgICAgICAgICAgIGlmICggJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkRCJyktPnsnREI6OlR5cGUnfSBlcSAnbXlzcWwnICkgewoKICAgICAgICAgICAgICAgICAgICAjIEZvciBNeVNRTCBjcmVhdGUgU1FMIG9yZGVyIGJ5IHF1ZXJ5ICdPUkRFUiBCWSBjb2x1bW5fdmFsdWUgPSAwLCBjb2x1bW5fdmFsdWUgQVNDL0RFU0MnLgogICAgICAgICAgICAgICAgICAgICRTUUxTZWxlY3QgLj0gJywgJyAuICRTb3J0T3B0aW9uc3sgJFNvcnRCeUFycmF5WyRDb3VudF0gfTsKICAgICAgICAgICAgICAgICAgICAkU1FMRXh0CiAgICAgICAgICAgICAgICAgICAgICAgIC49ICcgJyAuICRTb3J0T3B0aW9uc3sgJFNvcnRCeUFycmF5WyRDb3VudF0gfTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewoKICAgICAgICAgICAgICAgICAgICAjIEZvciBQb3N0Z3JlU1FMIGFuZCBPcmFjbGUgdHJhbnNmb3JtIHNlbGVjdGVkIDAgdmFsdWVzIHRvIE5VTEwgYW5kIHVzZSAnTlVMTFMgTEFTVCcKICAgICAgICAgICAgICAgICAgICAjICAgaW4gdGhlIGVuZCBvZiBTUUwgcXVlcnkuCiAgICAgICAgICAgICAgICAgICAgJFNRTFNlbGVjdCAuPSAnLCAnIC4gJFNvcnRPcHRpb25zeyAkU29ydEJ5QXJyYXlbJENvdW50XSB9IC4gJyBBUyBvcmRlcl92YWx1ZSAnOwogICAgICAgICAgICAgICAgICAgICRTUUxFeHQgICAgLj0gJyBvcmRlcl92YWx1ZSAnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewoKICAgICAgICAgICAgICAgICMgUmVndWxhciBzb3J0LgogICAgICAgICAgICAgICAgJFNRTFNlbGVjdCAuPSAnLCAnIC4gJFNvcnRPcHRpb25zeyAkU29ydEJ5QXJyYXlbJENvdW50XSB9OwogICAgICAgICAgICAgICAgJFNRTEV4dCAgICAuPSAnICcgLiAkU29ydE9wdGlvbnN7ICRTb3J0QnlBcnJheVskQ291bnRdIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICggJE9yZGVyQnlBcnJheVskQ291bnRdIGVxICdVcCcgKSB7CiAgICAgICAgICAgICAgICAkU1FMRXh0IC49ICcgQVNDJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRTUUxFeHQgLj0gJyBERVNDJzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAjIEFkZCBvbmx5IHRoZSBzcWwgam9pbiBmb3IgdGhlIHF1ZXVlIHRhYmxlLCBpZiBjb2x1bW5zIGZyb20gdGhlIHF1ZXVlIHRhYmxlIGV4aXN0cyBpbiB0aGUgc3FsIHN0YXRlbWVudC4KICAgIGlmICggJUdyb3VwTGlzdCB8fCAkTG9va3VwU29ydEJ5QXJyYXl7UXVldWV9ICkgewogICAgICAgICRTUUxGcm9tIC49ICcgSU5ORVIgSk9JTiBxdWV1ZSBzcSBPTiBzcS5pZCA9IHN0LnF1ZXVlX2lkICc7CiAgICB9CgogICAgIyBjaGVjayBjYWNoZQogICAgbXkgJENhY2hlT2JqZWN0OwogICAgaWYgKCAoICRBcnRpY2xlVGFibGVKb2luZWQgJiYgJFBhcmFte0Z1bGxUZXh0SW5kZXh9ICkgfHwgJFBhcmFte0NhY2hlVFRMfSApIHsKICAgICAgICAkQ2FjaGVPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6Q2FjaGUnKTsKICAgICAgICBteSAkQ2FjaGVEYXRhID0gJENhY2hlT2JqZWN0LT5HZXQoCiAgICAgICAgICAgIFR5cGUgPT4gJ1RpY2tldFNlYXJjaCcsCiAgICAgICAgICAgIEtleSAgPT4gJFNRTFNlbGVjdCAuICRTUUxGcm9tIC4gJFNRTEV4dCAuICRSZXN1bHQgLiAkTGltaXQsCiAgICAgICAgKTsKCiAgICAgICAgaWYgKCBkZWZpbmVkICRDYWNoZURhdGEgKSB7CiAgICAgICAgICAgIGlmICggcmVmICRDYWNoZURhdGEgZXEgJ0hBU0gnICkgewogICAgICAgICAgICAgICAgcmV0dXJuICV7JENhY2hlRGF0YX07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzaWYgKCByZWYgJENhY2hlRGF0YSBlcSAnQVJSQVknICkgewogICAgICAgICAgICAgICAgcmV0dXJuIEB7JENhY2hlRGF0YX07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzaWYgKCByZWYgJENhY2hlRGF0YSBlcSAnJyApIHsKICAgICAgICAgICAgICAgIHJldHVybiAkQ2FjaGVEYXRhOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdJbnZhbGlkIHJlZiAnIC4gcmVmKCRDYWNoZURhdGEpIC4gJyEnCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CgogICAgIyBkYXRhYmFzZSBxdWVyeQogICAgbXkgJVRpY2tldHM7CiAgICBteSBAVGlja2V0SURzOwogICAgbXkgJENvdW50OwoKICAgIHJldHVybiBpZiAhJERCT2JqZWN0LT5QcmVwYXJlKAogICAgICAgIFNRTCAgID0+ICRTUUxTZWxlY3QgLiAkU1FMRnJvbSAuICRTUUxFeHQsCiAgICAgICAgTGltaXQgPT4gJExpbWl0CiAgICApOwogICAgd2hpbGUgKCBteSBAUm93ID0gJERCT2JqZWN0LT5GZXRjaHJvd0FycmF5KCkgKSB7CiAgICAgICAgJENvdW50ID0gJFJvd1swXTsKICAgICAgICAkVGlja2V0c3sgJFJvd1swXSB9ID0gJFJvd1sxXTsKICAgICAgICBwdXNoIEBUaWNrZXRJRHMsICRSb3dbMF07CiAgICB9CgogICAgIyByZXR1cm4gQ09VTlQKICAgIGlmICggJFJlc3VsdCBlcSAnQ09VTlQnICkgewogICAgICAgIGlmICgkQ2FjaGVPYmplY3QpIHsKICAgICAgICAgICAgJENhY2hlT2JqZWN0LT5TZXQoCiAgICAgICAgICAgICAgICBUeXBlICA9PiAnVGlja2V0U2VhcmNoJywKICAgICAgICAgICAgICAgIEtleSAgID0+ICRTUUxTZWxlY3QgLiAkU1FMRnJvbSAuICRTUUxFeHQgLiAkUmVzdWx0IC4gJExpbWl0LAogICAgICAgICAgICAgICAgVmFsdWUgPT4gJENvdW50LAogICAgICAgICAgICAgICAgVFRMICAgPT4gJFBhcmFte0NhY2hlVFRMfSB8fCA2MCAqIDQsCiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkQ291bnQ7CiAgICB9CgogICAgIyByZXR1cm4gSEFTSAogICAgZWxzaWYgKCAkUmVzdWx0IGVxICdIQVNIJyApIHsKICAgICAgICBpZiAoJENhY2hlT2JqZWN0KSB7CiAgICAgICAgICAgICRDYWNoZU9iamVjdC0+U2V0KAogICAgICAgICAgICAgICAgVHlwZSAgPT4gJ1RpY2tldFNlYXJjaCcsCiAgICAgICAgICAgICAgICBLZXkgICA9PiAkU1FMU2VsZWN0IC4gJFNRTEZyb20gLiAkU1FMRXh0IC4gJFJlc3VsdCAuICRMaW1pdCwKICAgICAgICAgICAgICAgIFZhbHVlID0+IFwlVGlja2V0cywKICAgICAgICAgICAgICAgIFRUTCAgID0+ICRQYXJhbXtDYWNoZVRUTH0gfHwgNjAgKiA0LAogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJVRpY2tldHM7CiAgICB9CgogICAgIyByZXR1cm4gQVJSQVkKICAgIGVsc2UgewogICAgICAgIGlmICgkQ2FjaGVPYmplY3QpIHsKICAgICAgICAgICAgJENhY2hlT2JqZWN0LT5TZXQoCiAgICAgICAgICAgICAgICBUeXBlICA9PiAnVGlja2V0U2VhcmNoJywKICAgICAgICAgICAgICAgIEtleSAgID0+ICRTUUxTZWxlY3QgLiAkU1FMRnJvbSAuICRTUUxFeHQgLiAkUmVzdWx0IC4gJExpbWl0LAogICAgICAgICAgICAgICAgVmFsdWUgPT4gXEBUaWNrZXRJRHMsCiAgICAgICAgICAgICAgICBUVEwgICA9PiAkUGFyYW17Q2FjaGVUVEx9IHx8IDYwICogNCwKICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIEBUaWNrZXRJRHM7CiAgICB9Cn0KCjE7Cg==</File>
        <File Location="Kernel/Config/Files/XML/API.xml" Permission="644" Encode="Base64">PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPG90cnNfY29uZmlnIHZlcnNpb249IjIuMCIgaW5pdD0iQXBwbGljYXRpb24iPgoKICAgIDxTZXR0aW5nIE5hbWU9IkZyb250ZW5kOjpNb2R1bGUjIyNBUEk6OlRpY2tldHMiIFJlcXVpcmVkPSIxIiBWYWxpZD0iMSI+CiAgICAgICAgPERlc2NyaXB0aW9uIFRyYW5zbGF0YWJsZT0iMSI+TW9kdWxlLjwvRGVzY3JpcHRpb24+CiAgICAgICAgPE5hdmlnYXRpb24+UlNfQVBJOjpNYWluPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJGcm9udGVuZFJlZ2lzdHJhdGlvbiI+CiAgICAgICAgICAgICAgICA8SGFzaD4KPCEtLQogICAgICAgICAgICAgICAgICAgIDxJdGVtIEtleT0iR3JvdXAiPgogICAgICAgICAgICAgICAgICAgICAgICA8QXJyYXk+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvQXJyYXk+CiAgICAgICAgICAgICAgICAgICAgPC9JdGVtPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIEtleT0iR3JvdXBSbyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxBcnJheT4KICAgICAgICAgICAgICAgICAgICAgICAgPC9BcnJheT4KICAgICAgICAgICAgICAgICAgICA8L0l0ZW0+Ci0tPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIEtleT0iRGVzY3JpcHRpb24iIFRyYW5zbGF0YWJsZT0iMSI+TW9kdWxlIHJlZ2lzdHJhdGlvbjwvSXRlbT4KICAgICAgICAgICAgICAgICAgICA8SXRlbSBLZXk9Ik5hdkJhck5hbWUiPk1vZHVsZTwvSXRlbT4KICAgICAgICAgICAgICAgIDwvSGFzaD4KICAgICAgICAgICAgPC9JdGVtPgogICAgICAgIDwvVmFsdWU+CiAgICA8L1NldHRpbmc+CgogICAgPFNldHRpbmcgTmFtZT0iRnJvbnRlbmQ6Ok1vZHVsZSMjI0FQSTo6U2V0dGluZ3MiIFJlcXVpcmVkPSIxIiBWYWxpZD0iMSI+CiAgICAgICAgPERlc2NyaXB0aW9uIFRyYW5zbGF0YWJsZT0iMSI+TW9kdWxlLjwvRGVzY3JpcHRpb24+CiAgICAgICAgPE5hdmlnYXRpb24+UlNfQVBJOjpNYWluPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJGcm9udGVuZFJlZ2lzdHJhdGlvbiI+CiAgICAgICAgICAgICAgICA8SGFzaD4KICAgICAgICAgICAgICAgICAgICA8SXRlbSBLZXk9IkRlc2NyaXB0aW9uIiBUcmFuc2xhdGFibGU9IjEiPk1vZHVsZSByZWdpc3RyYXRpb248L0l0ZW0+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gS2V5PSJOYXZCYXJOYW1lIj5Nb2R1bGU8L0l0ZW0+CiAgICAgICAgICAgICAgICA8L0hhc2g+CiAgICAgICAgICAgIDwvSXRlbT4KICAgICAgICA8L1ZhbHVlPgogICAgPC9TZXR0aW5nPgoKICAgIDxTZXR0aW5nIE5hbWU9IkZyb250ZW5kOjpNb2R1bGUjIyNBUEk6OlN5c3RlbSIgUmVxdWlyZWQ9IjEiIFZhbGlkPSIxIj4KICAgICAgICA8RGVzY3JpcHRpb24gVHJhbnNsYXRhYmxlPSIxIj5Nb2R1bGUuPC9EZXNjcmlwdGlvbj4KICAgICAgICA8TmF2aWdhdGlvbj5SU19BUEk6Ok1haW48L05hdmlnYXRpb24+CiAgICAgICAgPFZhbHVlPgogICAgICAgICAgICA8SXRlbSBWYWx1ZVR5cGU9IkZyb250ZW5kUmVnaXN0cmF0aW9uIj4KICAgICAgICAgICAgICAgIDxIYXNoPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIEtleT0iRGVzY3JpcHRpb24iIFRyYW5zbGF0YWJsZT0iMSI+TW9kdWxlIHJlZ2lzdHJhdGlvbjwvSXRlbT4KICAgICAgICAgICAgICAgICAgICA8SXRlbSBLZXk9Ik5hdkJhck5hbWUiPk1vZHVsZTwvSXRlbT4KICAgICAgICAgICAgICAgIDwvSGFzaD4KICAgICAgICAgICAgPC9JdGVtPgogICAgICAgIDwvVmFsdWU+CiAgICA8L1NldHRpbmc+CgogICAgPFNldHRpbmcgTmFtZT0iRnJvbnRlbmQ6Ok1vZHVsZSMjI0FQSTo6RmlsdGVycyIgUmVxdWlyZWQ9IjEiIFZhbGlkPSIxIj4KICAgICAgICA8RGVzY3JpcHRpb24gVHJhbnNsYXRhYmxlPSIxIj5Nb2R1bGUuPC9EZXNjcmlwdGlvbj4KICAgICAgICA8TmF2aWdhdGlvbj5SU19BUEk6Ok1haW48L05hdmlnYXRpb24+CiAgICAgICAgPFZhbHVlPgogICAgICAgICAgICA8SXRlbSBWYWx1ZVR5cGU9IkZyb250ZW5kUmVnaXN0cmF0aW9uIj4KICAgICAgICAgICAgICAgIDxIYXNoPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIEtleT0iRGVzY3JpcHRpb24iIFRyYW5zbGF0YWJsZT0iMSI+TW9kdWxlIHJlZ2lzdHJhdGlvbjwvSXRlbT4KICAgICAgICAgICAgICAgICAgICA8SXRlbSBLZXk9Ik5hdkJhck5hbWUiPk1vZHVsZTwvSXRlbT4KICAgICAgICAgICAgICAgIDwvSGFzaD4KICAgICAgICAgICAgPC9JdGVtPgogICAgICAgIDwvVmFsdWU+CiAgICA8L1NldHRpbmc+CgogICAgPFNldHRpbmcgTmFtZT0iRnJvbnRlbmQ6Ok1vZHVsZSMjI0FQSTo6UXVldWVzIiBSZXF1aXJlZD0iMSIgVmFsaWQ9IjEiPgogICAgICAgIDxEZXNjcmlwdGlvbiBUcmFuc2xhdGFibGU9IjEiPk1vZHVsZS48L0Rlc2NyaXB0aW9uPgogICAgICAgIDxOYXZpZ2F0aW9uPlJTX0FQSTo6TWFpbjwvTmF2aWdhdGlvbj4KICAgICAgICA8VmFsdWU+CiAgICAgICAgICAgIDxJdGVtIFZhbHVlVHlwZT0iRnJvbnRlbmRSZWdpc3RyYXRpb24iPgogICAgICAgICAgICAgICAgPEhhc2g+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gS2V5PSJEZXNjcmlwdGlvbiIgVHJhbnNsYXRhYmxlPSIxIj5Nb2R1bGUgcmVnaXN0cmF0aW9uPC9JdGVtPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIEtleT0iTmF2QmFyTmFtZSI+TW9kdWxlPC9JdGVtPgogICAgICAgICAgICAgICAgPC9IYXNoPgogICAgICAgICAgICA8L0l0ZW0+CiAgICAgICAgPC9WYWx1ZT4KICAgIDwvU2V0dGluZz4KCiAgICA8U2V0dGluZyBOYW1lPSJGcm9udGVuZDo6TW9kdWxlIyMjQVBJOjpTZXJ2aWNlcyIgUmVxdWlyZWQ9IjEiIFZhbGlkPSIxIj4KICAgICAgICA8RGVzY3JpcHRpb24gVHJhbnNsYXRhYmxlPSIxIj5Nb2R1bGUuPC9EZXNjcmlwdGlvbj4KICAgICAgICA8TmF2aWdhdGlvbj5SU19BUEk6Ok1haW48L05hdmlnYXRpb24+CiAgICAgICAgPFZhbHVlPgogICAgICAgICAgICA8SXRlbSBWYWx1ZVR5cGU9IkZyb250ZW5kUmVnaXN0cmF0aW9uIj4KICAgICAgICAgICAgICAgIDxIYXNoPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIEtleT0iRGVzY3JpcHRpb24iIFRyYW5zbGF0YWJsZT0iMSI+TW9kdWxlIHJlZ2lzdHJhdGlvbjwvSXRlbT4KICAgICAgICAgICAgICAgICAgICA8SXRlbSBLZXk9Ik5hdkJhck5hbWUiPk1vZHVsZTwvSXRlbT4KICAgICAgICAgICAgICAgIDwvSGFzaD4KICAgICAgICAgICAgPC9JdGVtPgogICAgICAgIDwvVmFsdWU+CiAgICA8L1NldHRpbmc+CgogICAgPFNldHRpbmcgTmFtZT0iRnJvbnRlbmQ6Ok1vZHVsZSMjI0FQSTo6Q3VzdG9tZXJzIiBSZXF1aXJlZD0iMSIgVmFsaWQ9IjEiPgogICAgICAgIDxEZXNjcmlwdGlvbiBUcmFuc2xhdGFibGU9IjEiPk1vZHVsZS48L0Rlc2NyaXB0aW9uPgogICAgICAgIDxOYXZpZ2F0aW9uPlJTX0FQSTo6TWFpbjwvTmF2aWdhdGlvbj4KICAgICAgICA8VmFsdWU+CiAgICAgICAgICAgIDxJdGVtIFZhbHVlVHlwZT0iRnJvbnRlbmRSZWdpc3RyYXRpb24iPgogICAgICAgICAgICAgICAgPEhhc2g+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gS2V5PSJEZXNjcmlwdGlvbiIgVHJhbnNsYXRhYmxlPSIxIj5Nb2R1bGUgcmVnaXN0cmF0aW9uPC9JdGVtPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIEtleT0iTmF2QmFyTmFtZSI+TW9kdWxlPC9JdGVtPgogICAgICAgICAgICAgICAgPC9IYXNoPgogICAgICAgICAgICA8L0l0ZW0+CiAgICAgICAgPC9WYWx1ZT4KICAgIDwvU2V0dGluZz4KCiAgICA8U2V0dGluZyBOYW1lPSJGcm9udGVuZDo6TW9kdWxlIyMjQVBJOjpTbGEiIFJlcXVpcmVkPSIxIiBWYWxpZD0iMSI+CiAgICAgICAgPERlc2NyaXB0aW9uIFRyYW5zbGF0YWJsZT0iMSI+TW9kdWxlLjwvRGVzY3JpcHRpb24+CiAgICAgICAgPE5hdmlnYXRpb24+UlNfQVBJOjpNYWluPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJGcm9udGVuZFJlZ2lzdHJhdGlvbiI+CiAgICAgICAgICAgICAgICA8SGFzaD4KICAgICAgICAgICAgICAgICAgICA8SXRlbSBLZXk9IkRlc2NyaXB0aW9uIiBUcmFuc2xhdGFibGU9IjEiPk1vZHVsZSByZWdpc3RyYXRpb248L0l0ZW0+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gS2V5PSJOYXZCYXJOYW1lIj5Nb2R1bGU8L0l0ZW0+CiAgICAgICAgICAgICAgICA8L0hhc2g+CiAgICAgICAgICAgIDwvSXRlbT4KICAgICAgICA8L1ZhbHVlPgogICAgPC9TZXR0aW5nPgoKICAgIDxTZXR0aW5nIE5hbWU9IkZyb250ZW5kOjpNb2R1bGUjIyNBUEk6OlVzZXJzIiBSZXF1aXJlZD0iMSIgVmFsaWQ9IjEiPgogICAgICAgIDxEZXNjcmlwdGlvbiBUcmFuc2xhdGFibGU9IjEiPk1vZHVsZS48L0Rlc2NyaXB0aW9uPgogICAgICAgIDxOYXZpZ2F0aW9uPlJTX0FQSTo6TWFpbjwvTmF2aWdhdGlvbj4KICAgICAgICA8VmFsdWU+CiAgICAgICAgICAgIDxJdGVtIFZhbHVlVHlwZT0iRnJvbnRlbmRSZWdpc3RyYXRpb24iPgogICAgICAgICAgICAgICAgPEhhc2g+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gS2V5PSJEZXNjcmlwdGlvbiIgVHJhbnNsYXRhYmxlPSIxIj5Nb2R1bGUgcmVnaXN0cmF0aW9uPC9JdGVtPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIEtleT0iTmF2QmFyTmFtZSI+TW9kdWxlPC9JdGVtPgogICAgICAgICAgICAgICAgPC9IYXNoPgogICAgICAgICAgICA8L0l0ZW0+CiAgICAgICAgPC9WYWx1ZT4KICAgIDwvU2V0dGluZz4KCiAgICA8U2V0dGluZyBOYW1lPSJSUzo6QVBJOjpTdHJpcFRpY2tldE51bWJlckZyb21BcnRpY2xlU3ViamVjdCIgUmVxdWlyZWQ9IjEiIFZhbGlkPSIxIj4KICAgICAgICA8RGVzY3JpcHRpb24gVHJhbnNsYXRhYmxlPSIxIj5TdHJpcCBbVGlja2V0I051bWJlcl0gZnJvbSBhcnRpY2xlIFN1YmplY3QgaW4gL2dldEFydGljbGVzPC9EZXNjcmlwdGlvbj4KICAgICAgICA8TmF2aWdhdGlvbj5SU19BUEk6Ok1haW48L05hdmlnYXRpb24+CiAgICAgICAgPFZhbHVlPgogICAgICAgICAgICA8SXRlbSBWYWx1ZVR5cGU9IlNlbGVjdCIgU2VsZWN0ZWRJRD0iMSI+CiAgICAgICAgICAgICAgICA8SXRlbSBWYWx1ZVR5cGU9Ik9wdGlvbiIgVmFsdWU9IjAiIFRyYW5zbGF0YWJsZT0iMSI+Tm88L0l0ZW0+CiAgICAgICAgICAgICAgICA8SXRlbSBWYWx1ZVR5cGU9Ik9wdGlvbiIgVmFsdWU9IjEiIFRyYW5zbGF0YWJsZT0iMSI+WWVzPC9JdGVtPgogICAgICAgICAgICA8L0l0ZW0+CiAgICAgICAgPC9WYWx1ZT4KICAgIDwvU2V0dGluZz4KCiAgICA8U2V0dGluZyBOYW1lPSJUaWNrZXQ6OkN1c3RvbU1vZHVsZSMjI1paWkxheW91dF9DaGFsbGVuZ2VUb2tlbkNoZWNrIiBSZXF1aXJlZD0iMCIgVmFsaWQ9IjEiPgogICAgICAgIDxEZXNjcmlwdGlvbiBUcmFuc2xhdGFibGU9IjEiPlJlZGVmaW5lcyBleGlzdGluZyBmdW5jdGlvbnMgaW4gS2VybmVsOjpPdXRwdXQ6OkhUTUw6OkxheW91dC48L0Rlc2NyaXB0aW9uPgogICAgICAgIDxOYXZpZ2F0aW9uPkNvcmU6OlRpY2tldDwvTmF2aWdhdGlvbj4KICAgICAgICA8VmFsdWU+CiAgICAgICAgICAgIDxJdGVtIFZhbHVlVHlwZT0iU3RyaW5nIiBWYWx1ZVJlZ2V4PSIiPktlcm5lbDo6T3V0cHV0OjpIVE1MOjpaWlpMYXlvdXRfQ2hhbGxlbmdlVG9rZW5DaGVjazwvSXRlbT4KICAgICAgICA8L1ZhbHVlPgogICAgPC9TZXR0aW5nPgoKICAgIDxTZXR0aW5nIE5hbWU9IlJTOjpBUEk6OkRlZmF1bHRTdGF0ZSIgUmVxdWlyZWQ9IjAiIFZhbGlkPSIxIj4KICAgICAgICA8RGVzY3JpcHRpb24gVHJhbnNsYXRhYmxlPSIxIj5EZWZhbHQgdGlja2V0IHN0YXRlIHdoZW4gY3JlYXRpbmcgYSB0aWNrZXQuPC9EZXNjcmlwdGlvbj4KICAgICAgICA8TmF2aWdhdGlvbj5SU19BUEk6OlN0YXRlPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJTdHJpbmciIFZhbHVlUmVnZXg9IiI+bmV3PC9JdGVtPgogICAgICAgIDwvVmFsdWU+CiAgICA8L1NldHRpbmc+CgogICAgPFNldHRpbmcgTmFtZT0iUlM6OkFQSTo6T2JqZWN0VHlwZSMjI051bWJlciIgUmVxdWlyZWQ9IjAiIFZhbGlkPSIxIj4KICAgICAgICA8RGVzY3JpcHRpb24gVHJhbnNsYXRhYmxlPSIxIj5UeXBlIG9mIG9iamVjdCBmaWVsZHMuPC9EZXNjcmlwdGlvbj4KICAgICAgICA8TmF2aWdhdGlvbj5SU19BUEk6OkludGVybmFsPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgICA8QXJyYXk+CiAgICAgICAgICAgICAgICAgIDxJdGVtPkFjY2Vzc2libGU8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPkFkbWluQ29tbXVuaWNhdGlvbkxvZ1BhZ2VTaG93bjwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+QWRtaW5EeW5hbWljRmllbGRzT3ZlcnZpZXdQYWdlU2hvd248L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPkFnZTwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+QXJ0aWNsZUlEPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5BcnRpY2xlTnVtYmVyPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5DaGFuZ2VCeTwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+Q29tbXVuaWNhdGlvbkNoYW5uZWxJRDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+Q291bnQ8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPkNyZWF0ZUJ5PC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5DcmVhdGVUaW1lVW5peDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+RGVmYXVsdDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+RXNjYWxhdGlvbkRlc3RpbmF0aW9uVGltZTwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+RXNjYWxhdGlvblJlc3BvbnNlVGltZTwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+RXNjYWxhdGlvblNvbHV0aW9uVGltZTwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+RXNjYWxhdGlvblRpbWVXb3JraW5nVGltZTwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+RXNjYWxhdGlvblRpbWU8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPkVzY2FsYXRpb25VcGRhdGVUaW1lPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5GaWxlSUQ8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPkZpbGVzaXplUmF3PC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5GaXJzdFJlc3BvbnNlVGltZURlc3RpbmF0aW9uVGltZTwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+Rmlyc3RSZXNwb25zZVRpbWVFc2NhbGF0aW9uPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5GaXJzdFJlc3BvbnNlVGltZVdvcmtpbmdUaW1lPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5GaXJzdFJlc3BvbnNlVGltZTwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+R3JvdXBJRDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+SGFzV2F0Y2g8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPklEPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5JbmNvbWluZ1RpbWU8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPklzVmlzaWJsZUZvckN1c3RvbWVyPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5MaW5rQ291bnQ8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPkxvY2tJRDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+TmVlZFRva2VuVXBkYXRlPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5PblRpY2tldENyZWF0ZVNjcmVlbjwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+T3duZXJJRDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+UHJpb3JpdHlJRDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+UXVldWVJRDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+UmVhbFRpbGxUaW1lTm90VXNlZDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+UmVzcG9uc2libGVJRDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+U2VlbjwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+U2VuZGVyVHlwZUlEPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5TZXJ2aWNlSUQ8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlNMQUlEPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5Tb2x1dGlvblRpbWVEZXN0aW5hdGlvblRpbWU8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlNvbHV0aW9uVGltZUVzY2FsYXRpb248L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlNvbHV0aW9uVGltZVdvcmtpbmdUaW1lPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5Tb2x1dGlvblRpbWU8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlN0YXRlSUQ8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlRpY2tldElEPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5UeXBlSUQ8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVubG9ja1RpbWVvdXQ8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVudGlsVGltZURhdGVVbml4PC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5VbnRpbFRpbWU8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVwZGF0ZVRpbWVEZXN0aW5hdGlvblRpbWU8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVwZGF0ZVRpbWVFc2NhbGF0aW9uPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5VcGRhdGVUaW1lV29ya2luZ1RpbWU8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVwZGF0ZVRpbWU8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVzZXJDaGFuZ2VPdmVydmlld1NtYWxsUGFnZVNob3duPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5Vc2VyQ29uZmlnSXRlbU92ZXJ2aWV3U21hbGxQYWdlU2hvd248L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVzZXJGQVFKb3VybmFsT3ZlcnZpZXdTbWFsbFBhZ2VTaG93bjwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+VXNlckZBUU92ZXJ2aWV3U21hbGxQYWdlU2hvd248L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVzZXJJRDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+VXNlckxhc3RMb2dpbjwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+VXNlckxvZ2luRmFpbGVkPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5Vc2VyUmVmcmVzaFRpbWU8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVzZXJTdXJ2ZXlPdmVydmlld1NtYWxsUGFnZVNob3duPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5Vc2VyVGlja2V0T3ZlcnZpZXdNZWRpdW1QYWdlU2hvd248L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVzZXJUaWNrZXRPdmVydmlld1ByZXZpZXdQYWdlU2hvd248L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVzZXJUaWNrZXRPdmVydmlld1NtYWxsUGFnZVNob3duPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5WYWxpZElEPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5XYXRjaGVyQ291bnQ8L0l0ZW0+CiAgICAgICAgICAgICAgPC9BcnJheT4KICAgICAgICA8L1ZhbHVlPgogICAgPC9TZXR0aW5nPgoKICAgIDxTZXR0aW5nIE5hbWU9IlJTOjpBUEk6Ok9iamVjdFR5cGUjIyNEYXRlIiBSZXF1aXJlZD0iMCIgVmFsaWQ9IjEiPgogICAgICAgIDxEZXNjcmlwdGlvbiBUcmFuc2xhdGFibGU9IjEiPlR5cGUgb2Ygb2JqZWN0IGZpZWxkcy48L0Rlc2NyaXB0aW9uPgogICAgICAgIDxOYXZpZ2F0aW9uPlJTX0FQSTo6SW50ZXJuYWw8L05hdmlnYXRpb24+CiAgICAgICAgPFZhbHVlPgogICAgICAgICAgICAgIDxBcnJheT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+Q2hhbmdlVGltZTwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+Q2hhbmdlVGltZVNlcnZlcjwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+Q2hhbmdlZDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+Q2hhbmdlZFNlcnZlcjwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+Q3JlYXRlVGltZTwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+Q3JlYXRlVGltZVNlcnZlcjwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+Q3JlYXRlZDwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+Q3JlYXRlZFNlcnZlcjwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+RXNjYWxhdGlvbkRlc3RpbmF0aW9uRGF0ZTwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+RXNjYWxhdGlvbkRlc3RpbmF0aW9uRGF0ZVNlcnZlcjwvSXRlbT4KICAgICAgICAgICAgICAgICAgPEl0ZW0+U29sdXRpb25UaW1lRGVzdGluYXRpb25EYXRlPC9JdGVtPgogICAgICAgICAgICAgICAgICA8SXRlbT5Tb2x1dGlvblRpbWVEZXN0aW5hdGlvbkRhdGVTZXJ2ZXI8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVwZGF0ZVRpbWVEZXN0aW5hdGlvbkRhdGU8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVwZGF0ZVRpbWVEZXN0aW5hdGlvbkRhdGVTZXJ2ZXI8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVzZXJMYXN0TG9naW5UaW1lc3RhbXA8L0l0ZW0+CiAgICAgICAgICAgICAgICAgIDxJdGVtPlVudGlsVGltZURhdGU8L0l0ZW0+CiAgICAgICAgICAgICAgPC9BcnJheT4KICAgICAgICA8L1ZhbHVlPgogICAgPC9TZXR0aW5nPgoKICAgIDxTZXR0aW5nIE5hbWU9IkF1dG9sb2FkUGVybFBhY2thZ2VzIyMjMTEwMC1SU19UaWNrZXRTZWFyY2giIFJlcXVpcmVkPSIxIiBWYWxpZD0iMSI+CiAgICAgICAgPERlc2NyaXB0aW9uIFRyYW5zbGF0YWJsZT0iMSI+VGlja2V0U2VhcmNoIGF1dG9sb2FkLjwvRGVzY3JpcHRpb24+CiAgICAgICAgPE5hdmlnYXRpb24+Q29yZTo6QXV0b2xvYWQ8L05hdmlnYXRpb24+CiAgICAgICAgPFZhbHVlPgogICAgICAgICAgICA8QXJyYXk+CiAgICAgICAgICAgICAgICA8SXRlbSBWYWx1ZVR5cGU9IlN0cmluZyI+S2VybmVsOjpBdXRvbG9hZDo6UlNfVGlja2V0U2VhcmNoPC9JdGVtPgogICAgICAgICAgICA8L0FycmF5PgogICAgICAgIDwvVmFsdWU+CiAgICA8L1NldHRpbmc+CgogICAgPFNldHRpbmcgTmFtZT0iUGFja2FnZTo6RXZlbnRNb2R1bGVQb3N0IyMjMTYwMC1DaGVja0luc3RhbGxlZFBhY2thZ2UiIFJlcXVpcmVkPSIwIiBWYWxpZD0iMSI+CiAgICAgICAgPERlc2NyaXB0aW9uIFRyYW5zbGF0YWJsZT0iMSI+Q2hlY2sgaW5zdGFsbGVkIHBhY2thZ2U8L0Rlc2NyaXB0aW9uPgogICAgICAgIDxOYXZpZ2F0aW9uPkNvcmU6OkV2ZW50OjpQYWNrYWdlPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEhhc2g+CiAgICAgICAgICAgICAgICA8SXRlbSBLZXk9Ik1vZHVsZSI+S2VybmVsOjpTeXN0ZW06OlRpY2tldDo6RXZlbnQ6OkNoZWNrSW5zdGFsbGVkUGFja2FnZTwvSXRlbT4KICAgICAgICAgICAgICAgIDxJdGVtIEtleT0iRXZlbnQiPlBhY2thZ2VJbnN0YWxsfFBhY2thZ2VVcGdyYWRlfFBhY2thZ2VSZWluc3RhbGx8UGFja2FnZVVuaW5zdGFsbDwvSXRlbT4KICAgICAgICAgICAgPC9IYXNoPgogICAgICAgIDwvVmFsdWU+CiAgICA8L1NldHRpbmc+CgogICAgPFNldHRpbmcgTmFtZT0iUlM6QVBJOjpUaWNrZXQ6Ok1vYmlsZVNjcmVlbjo6RHluYW1pY0ZpZWxkcyMjI0FnZW50TW9iaWxlVGlja2V0Tm90ZSIgUmVxdWlyZWQ9IjEiIFZhbGlkPSIxIj4KICAgICAgICA8RGVzY3JpcHRpb24gVHJhbnNsYXRhYmxlPSIxIj5EeW5hbWljIGZpZWxkcyBsaXN0IHdpdGggdGhlaXIgcGVybWlzc2lvbnMgZm9yIG1vYmlsZSBhcHBsaWNhdGlvbnMgc2NyZWVuczwvRGVzY3JpcHRpb24+CiAgICAgICAgPE5hdmlnYXRpb24+UlNfQVBJOjpNYWluPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEhhc2g+CiAgICAgICAgICAgICAgICA8RGVmYXVsdEl0ZW0gVmFsdWVUeXBlPSJTZWxlY3QiPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIFZhbHVlVHlwZT0iT3B0aW9uIiBWYWx1ZT0iciIgVHJhbnNsYXRhYmxlPSIxIj5SZWFkIG9ubHk8L0l0ZW0+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJPcHRpb24iIFZhbHVlPSJ3IiBUcmFuc2xhdGFibGU9IjEiPldyaXRlIG9ubHk8L0l0ZW0+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJPcHRpb24iIFZhbHVlPSJydyIgVHJhbnNsYXRhYmxlPSIxIj5SZWFkIGFuZCB3cml0ZTwvSXRlbT4KICAgICAgICAgICAgICAgIDwvRGVmYXVsdEl0ZW0+CiAgICAgICAgICAgICAgICA8SXRlbSBLZXk9IkFCQyIgU2VsZWN0ZWRJRD0iciI+PC9JdGVtPgogICAgICAgICAgICA8L0hhc2g+CiAgICAgICAgPC9WYWx1ZT4KICAgIDwvU2V0dGluZz4KICAgIDxTZXR0aW5nIE5hbWU9IlJTOkFQSTo6VGlja2V0OjpNb2JpbGVTY3JlZW46OkR5bmFtaWNGaWVsZHMjIyNBZ2VudE1vYmlsZU5ld1RpY2tldCIgUmVxdWlyZWQ9IjEiIFZhbGlkPSIxIj4KICAgICAgICA8RGVzY3JpcHRpb24gVHJhbnNsYXRhYmxlPSIxIj5EeW5hbWljIGZpZWxkcyBsaXN0IHdpdGggdGhlaXIgcGVybWlzc2lvbnMgZm9yIG1vYmlsZSBhcHBsaWNhdGlvbnMgc2NyZWVuczwvRGVzY3JpcHRpb24+CiAgICAgICAgPE5hdmlnYXRpb24+UlNfQVBJOjpNYWluPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEhhc2g+CiAgICAgICAgICAgICAgICA8RGVmYXVsdEl0ZW0gVmFsdWVUeXBlPSJTZWxlY3QiPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIFZhbHVlVHlwZT0iT3B0aW9uIiBWYWx1ZT0iciIgVHJhbnNsYXRhYmxlPSIxIj5SZWFkIG9ubHk8L0l0ZW0+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJPcHRpb24iIFZhbHVlPSJ3IiBUcmFuc2xhdGFibGU9IjEiPldyaXRlIG9ubHk8L0l0ZW0+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJPcHRpb24iIFZhbHVlPSJydyIgVHJhbnNsYXRhYmxlPSIxIj5SZWFkIGFuZCB3cml0ZTwvSXRlbT4KICAgICAgICAgICAgICAgIDwvRGVmYXVsdEl0ZW0+CiAgICAgICAgICAgICAgICA8SXRlbSBLZXk9IkFCQyIgU2VsZWN0ZWRJRD0icnciPjwvSXRlbT4KICAgICAgICAgICAgPC9IYXNoPgogICAgICAgIDwvVmFsdWU+CiAgICA8L1NldHRpbmc+CiAgICA8U2V0dGluZyBOYW1lPSJSUzpBUEk6OlRpY2tldDo6TW9iaWxlU2NyZWVuOjpEeW5hbWljRmllbGRzIyMjQWdlbnRNb2JpbGVUaWNrZXRDbG9zZSIgUmVxdWlyZWQ9IjEiIFZhbGlkPSIxIj4KICAgICAgICA8RGVzY3JpcHRpb24gVHJhbnNsYXRhYmxlPSIxIj5EeW5hbWljIGZpZWxkcyBsaXN0IHdpdGggdGhlaXIgcGVybWlzc2lvbnMgZm9yIG1vYmlsZSBhcHBsaWNhdGlvbnMgc2NyZWVuczwvRGVzY3JpcHRpb24+CiAgICAgICAgPE5hdmlnYXRpb24+UlNfQVBJOjpNYWluPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEhhc2g+CiAgICAgICAgICAgICAgICA8RGVmYXVsdEl0ZW0gVmFsdWVUeXBlPSJTZWxlY3QiPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIFZhbHVlVHlwZT0iT3B0aW9uIiBWYWx1ZT0iciIgVHJhbnNsYXRhYmxlPSIxIj5SZWFkIG9ubHk8L0l0ZW0+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJPcHRpb24iIFZhbHVlPSJ3IiBUcmFuc2xhdGFibGU9IjEiPldyaXRlIG9ubHk8L0l0ZW0+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJPcHRpb24iIFZhbHVlPSJydyIgVHJhbnNsYXRhYmxlPSIxIj5SZWFkIGFuZCB3cml0ZTwvSXRlbT4KICAgICAgICAgICAgICAgIDwvRGVmYXVsdEl0ZW0+CiAgICAgICAgICAgICAgICA8SXRlbSBLZXk9IkFCQyIgU2VsZWN0ZWRJRD0icnciPjwvSXRlbT4KICAgICAgICAgICAgPC9IYXNoPgogICAgICAgIDwvVmFsdWU+CiAgICA8L1NldHRpbmc+CiAgICA8U2V0dGluZyBOYW1lPSJSUzpBUEk6OlRpY2tldDo6TW9iaWxlU2NyZWVuOjpEeW5hbWljRmllbGRzIyMjQWdlbnRNb2JpbGVUaWNrZXRTdGF0dXMiIFJlcXVpcmVkPSIxIiBWYWxpZD0iMSI+CiAgICAgICAgPERlc2NyaXB0aW9uIFRyYW5zbGF0YWJsZT0iMSI+RHluYW1pYyBmaWVsZHMgbGlzdCB3aXRoIHRoZWlyIHBlcm1pc3Npb25zIGZvciBtb2JpbGUgYXBwbGljYXRpb25zIHNjcmVlbnM8L0Rlc2NyaXB0aW9uPgogICAgICAgIDxOYXZpZ2F0aW9uPlJTX0FQSTo6TWFpbjwvTmF2aWdhdGlvbj4KICAgICAgICA8VmFsdWU+CiAgICAgICAgICAgIDxIYXNoPgogICAgICAgICAgICAgICAgPERlZmF1bHRJdGVtIFZhbHVlVHlwZT0iU2VsZWN0Ij4KICAgICAgICAgICAgICAgICAgICA8SXRlbSBWYWx1ZVR5cGU9Ik9wdGlvbiIgVmFsdWU9InIiIFRyYW5zbGF0YWJsZT0iMSI+UmVhZCBvbmx5PC9JdGVtPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIFZhbHVlVHlwZT0iT3B0aW9uIiBWYWx1ZT0idyIgVHJhbnNsYXRhYmxlPSIxIj5Xcml0ZSBvbmx5PC9JdGVtPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIFZhbHVlVHlwZT0iT3B0aW9uIiBWYWx1ZT0icnciIFRyYW5zbGF0YWJsZT0iMSI+UmVhZCBhbmQgd3JpdGU8L0l0ZW0+CiAgICAgICAgICAgICAgICA8L0RlZmF1bHRJdGVtPgogICAgICAgICAgICAgICAgPEl0ZW0gS2V5PSJBQkMiIFNlbGVjdGVkSUQ9InJ3Ij48L0l0ZW0+CiAgICAgICAgICAgIDwvSGFzaD4KICAgICAgICA8L1ZhbHVlPgogICAgPC9TZXR0aW5nPgogICAgPFNldHRpbmcgTmFtZT0iUlM6QVBJOjpUaWNrZXQ6Ok1vYmlsZVNjcmVlbjo6RHluYW1pY0ZpZWxkcyMjI0FnZW50TW9iaWxlRWRpdFRpY2tldCIgUmVxdWlyZWQ9IjEiIFZhbGlkPSIxIj4KICAgICAgICA8RGVzY3JpcHRpb24gVHJhbnNsYXRhYmxlPSIxIj5EeW5hbWljIGZpZWxkcyBsaXN0IHdpdGggdGhlaXIgcGVybWlzc2lvbnMgZm9yIG1vYmlsZSBhcHBsaWNhdGlvbnMgc2NyZWVuczwvRGVzY3JpcHRpb24+CiAgICAgICAgPE5hdmlnYXRpb24+UlNfQVBJOjpNYWluPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEhhc2g+CiAgICAgICAgICAgICAgICA8RGVmYXVsdEl0ZW0gVmFsdWVUeXBlPSJTZWxlY3QiPgogICAgICAgICAgICAgICAgICAgIDxJdGVtIFZhbHVlVHlwZT0iT3B0aW9uIiBWYWx1ZT0iciIgVHJhbnNsYXRhYmxlPSIxIj5SZWFkIG9ubHk8L0l0ZW0+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJPcHRpb24iIFZhbHVlPSJ3IiBUcmFuc2xhdGFibGU9IjEiPldyaXRlIG9ubHk8L0l0ZW0+CiAgICAgICAgICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJPcHRpb24iIFZhbHVlPSJydyIgVHJhbnNsYXRhYmxlPSIxIj5SZWFkIGFuZCB3cml0ZTwvSXRlbT4KICAgICAgICAgICAgICAgIDwvRGVmYXVsdEl0ZW0+CiAgICAgICAgICAgICAgICA8SXRlbSBLZXk9IkFCQyIgU2VsZWN0ZWRJRD0icnciPjwvSXRlbT4KICAgICAgICAgICAgPC9IYXNoPgogICAgICAgIDwvVmFsdWU+CiAgICA8L1NldHRpbmc+Cjwvb3Ryc19jb25maWc+Cg==</File>
    </Filelist>
</otrs_package>
